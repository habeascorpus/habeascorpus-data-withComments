/* * Licensed to the Apache Software Foundation (ASF) under one * or more contributor license agreements. See the NOTICE file * distributed with this work for additional information * regarding copyright ownership. The ASF licenses this file * to you under the Apache License, Version 2.0 (the "License"); * you may not use this file except in compliance with the License. * You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */	TokenNameCOMMENT_BLOCK	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
/* * $Id: Variable.java 468650 2006-10-28 07:03:30Z minchau $ */	TokenNameCOMMENT_BLOCK	 $Id: Variable.java 468650 2006-10-28 07:03:30Z minchau $ 
package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xalan	TokenNameIdentifier	 xalan
.	TokenNameDOT	
xsltc	TokenNameIdentifier	 xsltc
.	TokenNameDOT	
compiler	TokenNameIdentifier	 compiler
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
bcel	TokenNameIdentifier	 bcel
.	TokenNameDOT	
classfile	TokenNameIdentifier	 classfile
.	TokenNameDOT	
Field	TokenNameIdentifier	 Field
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
bcel	TokenNameIdentifier	 bcel
.	TokenNameDOT	
generic	TokenNameIdentifier	 generic
.	TokenNameDOT	
ACONST_NULL	TokenNameIdentifier	 ACONST  NULL
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
bcel	TokenNameIdentifier	 bcel
.	TokenNameDOT	
generic	TokenNameIdentifier	 generic
.	TokenNameDOT	
ConstantPoolGen	TokenNameIdentifier	 Constant Pool Gen
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
bcel	TokenNameIdentifier	 bcel
.	TokenNameDOT	
generic	TokenNameIdentifier	 generic
.	TokenNameDOT	
DCONST	TokenNameIdentifier	 DCONST
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
bcel	TokenNameIdentifier	 bcel
.	TokenNameDOT	
generic	TokenNameIdentifier	 generic
.	TokenNameDOT	
ICONST	TokenNameIdentifier	 ICONST
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
bcel	TokenNameIdentifier	 bcel
.	TokenNameDOT	
generic	TokenNameIdentifier	 generic
.	TokenNameDOT	
InstructionHandle	TokenNameIdentifier	 Instruction Handle
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
bcel	TokenNameIdentifier	 bcel
.	TokenNameDOT	
generic	TokenNameIdentifier	 generic
.	TokenNameDOT	
InstructionList	TokenNameIdentifier	 Instruction List
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
bcel	TokenNameIdentifier	 bcel
.	TokenNameDOT	
generic	TokenNameIdentifier	 generic
.	TokenNameDOT	
PUTFIELD	TokenNameIdentifier	 PUTFIELD
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xalan	TokenNameIdentifier	 xalan
.	TokenNameDOT	
xsltc	TokenNameIdentifier	 xsltc
.	TokenNameDOT	
compiler	TokenNameIdentifier	 compiler
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
BooleanType	TokenNameIdentifier	 Boolean Type
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xalan	TokenNameIdentifier	 xalan
.	TokenNameDOT	
xsltc	TokenNameIdentifier	 xsltc
.	TokenNameDOT	
compiler	TokenNameIdentifier	 compiler
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
ClassGenerator	TokenNameIdentifier	 Class Generator
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xalan	TokenNameIdentifier	 xalan
.	TokenNameDOT	
xsltc	TokenNameIdentifier	 xsltc
.	TokenNameDOT	
compiler	TokenNameIdentifier	 compiler
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
ErrorMsg	TokenNameIdentifier	 Error Msg
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xalan	TokenNameIdentifier	 xalan
.	TokenNameDOT	
xsltc	TokenNameIdentifier	 xsltc
.	TokenNameDOT	
compiler	TokenNameIdentifier	 compiler
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
IntType	TokenNameIdentifier	 Int Type
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xalan	TokenNameIdentifier	 xalan
.	TokenNameDOT	
xsltc	TokenNameIdentifier	 xsltc
.	TokenNameDOT	
compiler	TokenNameIdentifier	 compiler
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
MethodGenerator	TokenNameIdentifier	 Method Generator
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xalan	TokenNameIdentifier	 xalan
.	TokenNameDOT	
xsltc	TokenNameIdentifier	 xsltc
.	TokenNameDOT	
compiler	TokenNameIdentifier	 compiler
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
NodeType	TokenNameIdentifier	 Node Type
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xalan	TokenNameIdentifier	 xalan
.	TokenNameDOT	
xsltc	TokenNameIdentifier	 xsltc
.	TokenNameDOT	
compiler	TokenNameIdentifier	 compiler
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
RealType	TokenNameIdentifier	 Real Type
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xalan	TokenNameIdentifier	 xalan
.	TokenNameDOT	
xsltc	TokenNameIdentifier	 xsltc
.	TokenNameDOT	
compiler	TokenNameIdentifier	 compiler
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
Type	TokenNameIdentifier	 Type
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xalan	TokenNameIdentifier	 xalan
.	TokenNameDOT	
xsltc	TokenNameIdentifier	 xsltc
.	TokenNameDOT	
compiler	TokenNameIdentifier	 compiler
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
TypeCheckError	TokenNameIdentifier	 Type Check Error
;	TokenNameSEMICOLON	
final	TokenNamefinal	
class	TokenNameclass	
Variable	TokenNameIdentifier	 Variable
extends	TokenNameextends	
VariableBase	TokenNameIdentifier	 Variable Base
{	TokenNameLBRACE	
public	TokenNamepublic	
int	TokenNameint	
getIndex	TokenNameIdentifier	 get Index
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
(	TokenNameLPAREN	
_local	TokenNameIdentifier	 local
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
_local	TokenNameIdentifier	 local
.	TokenNameDOT	
getIndex	TokenNameIdentifier	 get Index
(	TokenNameLPAREN	
)	TokenNameRPAREN	
:	TokenNameCOLON	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Parse the contents of the variable */	TokenNameCOMMENT_JAVADOC	 Parse the contents of the variable 
public	TokenNamepublic	
void	TokenNamevoid	
parseContents	TokenNameIdentifier	 parse Contents
(	TokenNameLPAREN	
Parser	TokenNameIdentifier	 Parser
parser	TokenNameIdentifier	 parser
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// Parse 'name' and 'select' attributes plus parameter contents 	TokenNameCOMMENT_LINE	Parse 'name' and 'select' attributes plus parameter contents 
super	TokenNamesuper	
.	TokenNameDOT	
parseContents	TokenNameIdentifier	 parse Contents
(	TokenNameLPAREN	
parser	TokenNameIdentifier	 parser
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Add a ref to this var to its enclosing construct 	TokenNameCOMMENT_LINE	Add a ref to this var to its enclosing construct 
SyntaxTreeNode	TokenNameIdentifier	 Syntax Tree Node
parent	TokenNameIdentifier	 parent
=	TokenNameEQUAL	
getParent	TokenNameIdentifier	 get Parent
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
parent	TokenNameIdentifier	 parent
instanceof	TokenNameinstanceof	
Stylesheet	TokenNameIdentifier	 Stylesheet
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// Mark this as a global variable 	TokenNameCOMMENT_LINE	Mark this as a global variable 
_isLocal	TokenNameIdentifier	 is Local
=	TokenNameEQUAL	
false	TokenNamefalse	
;	TokenNameSEMICOLON	
// Check if a global variable with this name already exists... 	TokenNameCOMMENT_LINE	Check if a global variable with this name already exists... 
Variable	TokenNameIdentifier	 Variable
var	TokenNameIdentifier	 var
=	TokenNameEQUAL	
parser	TokenNameIdentifier	 parser
.	TokenNameDOT	
getSymbolTable	TokenNameIdentifier	 get Symbol Table
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
lookupVariable	TokenNameIdentifier	 lookup Variable
(	TokenNameLPAREN	
_name	TokenNameIdentifier	 name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// ...and if it does we need to check import precedence 	TokenNameCOMMENT_LINE	...and if it does we need to check import precedence 
if	TokenNameif	
(	TokenNameLPAREN	
var	TokenNameIdentifier	 var
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
int	TokenNameint	
us	TokenNameIdentifier	 us
=	TokenNameEQUAL	
this	TokenNamethis	
.	TokenNameDOT	
getImportPrecedence	TokenNameIdentifier	 get Import Precedence
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
int	TokenNameint	
them	TokenNameIdentifier	 them
=	TokenNameEQUAL	
var	TokenNameIdentifier	 var
.	TokenNameDOT	
getImportPrecedence	TokenNameIdentifier	 get Import Precedence
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// It is an error if the two have the same import precedence 	TokenNameCOMMENT_LINE	It is an error if the two have the same import precedence 
if	TokenNameif	
(	TokenNameLPAREN	
us	TokenNameIdentifier	 us
==	TokenNameEQUAL_EQUAL	
them	TokenNameIdentifier	 them
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
name	TokenNameIdentifier	 name
=	TokenNameEQUAL	
_name	TokenNameIdentifier	 name
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
reportError	TokenNameIdentifier	 report Error
(	TokenNameLPAREN	
this	TokenNamethis	
,	TokenNameCOMMA	
parser	TokenNameIdentifier	 parser
,	TokenNameCOMMA	
ErrorMsg	TokenNameIdentifier	 Error Msg
.	TokenNameDOT	
VARIABLE_REDEF_ERR	TokenNameIdentifier	 VARIABLE  REDEF  ERR
,	TokenNameCOMMA	
name	TokenNameIdentifier	 name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Ignore this if previous definition has higher precedence 	TokenNameCOMMENT_LINE	Ignore this if previous definition has higher precedence 
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
them	TokenNameIdentifier	 them
>	TokenNameGREATER	
us	TokenNameIdentifier	 us
)	TokenNameRPAREN	
{	TokenNameLBRACE	
_ignore	TokenNameIdentifier	 ignore
=	TokenNameEQUAL	
true	TokenNametrue	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
var	TokenNameIdentifier	 var
.	TokenNameDOT	
disable	TokenNameIdentifier	 disable
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Add this variable if we have higher precedence 	TokenNameCOMMENT_LINE	Add this variable if we have higher precedence 
}	TokenNameRBRACE	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
Stylesheet	TokenNameIdentifier	 Stylesheet
)	TokenNameRPAREN	
parent	TokenNameIdentifier	 parent
)	TokenNameRPAREN	
.	TokenNameDOT	
addVariable	TokenNameIdentifier	 add Variable
(	TokenNameLPAREN	
this	TokenNamethis	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
parser	TokenNameIdentifier	 parser
.	TokenNameDOT	
getSymbolTable	TokenNameIdentifier	 get Symbol Table
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
addVariable	TokenNameIdentifier	 add Variable
(	TokenNameLPAREN	
this	TokenNamethis	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
_isLocal	TokenNameIdentifier	 is Local
=	TokenNameEQUAL	
true	TokenNametrue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** * Runs a type check on either the variable element body or the * expression in the 'select' attribute */	TokenNameCOMMENT_JAVADOC	 Runs a type check on either the variable element body or the expression in the 'select' attribute 
public	TokenNamepublic	
Type	TokenNameIdentifier	 Type
typeCheck	TokenNameIdentifier	 type Check
(	TokenNameLPAREN	
SymbolTable	TokenNameIdentifier	 Symbol Table
stable	TokenNameIdentifier	 stable
)	TokenNameRPAREN	
throws	TokenNamethrows	
TypeCheckError	TokenNameIdentifier	 Type Check Error
{	TokenNameLBRACE	
// Type check the 'select' expression if present 	TokenNameCOMMENT_LINE	Type check the 'select' expression if present 
if	TokenNameif	
(	TokenNameLPAREN	
_select	TokenNameIdentifier	 select
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
_type	TokenNameIdentifier	 type
=	TokenNameEQUAL	
_select	TokenNameIdentifier	 select
.	TokenNameDOT	
typeCheck	TokenNameIdentifier	 type Check
(	TokenNameLPAREN	
stable	TokenNameIdentifier	 stable
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Type check the element contents otherwise 	TokenNameCOMMENT_LINE	Type check the element contents otherwise 
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
hasContents	TokenNameIdentifier	 has Contents
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
typeCheckContents	TokenNameIdentifier	 type Check Contents
(	TokenNameLPAREN	
stable	TokenNameIdentifier	 stable
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
_type	TokenNameIdentifier	 type
=	TokenNameEQUAL	
Type	TokenNameIdentifier	 Type
.	TokenNameDOT	
ResultTree	TokenNameIdentifier	 Result Tree
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
_type	TokenNameIdentifier	 type
=	TokenNameEQUAL	
Type	TokenNameIdentifier	 Type
.	TokenNameDOT	
Reference	TokenNameIdentifier	 Reference
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// The return type is void as the variable element does not leave 	TokenNameCOMMENT_LINE	The return type is void as the variable element does not leave 
// anything on the JVM's stack. The '_type' global will be returned 	TokenNameCOMMENT_LINE	anything on the JVM's stack. The '_type' global will be returned 
// by the references to this variable, and not by the variable itself. 	TokenNameCOMMENT_LINE	by the references to this variable, and not by the variable itself. 
return	TokenNamereturn	
Type	TokenNameIdentifier	 Type
.	TokenNameDOT	
Void	TokenNameIdentifier	 Void
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * This method is part of a little trick that is needed to use local * variables inside nested for-each loops. See the initializeVariables() * method in the ForEach class for an explanation */	TokenNameCOMMENT_JAVADOC	 This method is part of a little trick that is needed to use local variables inside nested for-each loops. See the initializeVariables() method in the ForEach class for an explanation 
public	TokenNamepublic	
void	TokenNamevoid	
initialize	TokenNameIdentifier	 initialize
(	TokenNameLPAREN	
ClassGenerator	TokenNameIdentifier	 Class Generator
classGen	TokenNameIdentifier	 class Gen
,	TokenNameCOMMA	
MethodGenerator	TokenNameIdentifier	 Method Generator
methodGen	TokenNameIdentifier	 method Gen
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
ConstantPoolGen	TokenNameIdentifier	 Constant Pool Gen
cpg	TokenNameIdentifier	 cpg
=	TokenNameEQUAL	
classGen	TokenNameIdentifier	 class Gen
.	TokenNameDOT	
getConstantPool	TokenNameIdentifier	 get Constant Pool
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
InstructionList	TokenNameIdentifier	 Instruction List
il	TokenNameIdentifier	 il
=	TokenNameEQUAL	
methodGen	TokenNameIdentifier	 method Gen
.	TokenNameDOT	
getInstructionList	TokenNameIdentifier	 get Instruction List
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// This is only done for local variables that are actually used 	TokenNameCOMMENT_LINE	This is only done for local variables that are actually used 
if	TokenNameif	
(	TokenNameLPAREN	
isLocal	TokenNameIdentifier	 is Local
(	TokenNameLPAREN	
)	TokenNameRPAREN	
&&	TokenNameAND_AND	
!	TokenNameNOT	
_refs	TokenNameIdentifier	 refs
.	TokenNameDOT	
isEmpty	TokenNameIdentifier	 is Empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// Create a variable slot if none is allocated 	TokenNameCOMMENT_LINE	Create a variable slot if none is allocated 
if	TokenNameif	
(	TokenNameLPAREN	
_local	TokenNameIdentifier	 local
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
_local	TokenNameIdentifier	 local
=	TokenNameEQUAL	
methodGen	TokenNameIdentifier	 method Gen
.	TokenNameDOT	
addLocalVariable2	TokenNameIdentifier	 add Local Variable2
(	TokenNameLPAREN	
getEscapedName	TokenNameIdentifier	 get Escaped Name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
_type	TokenNameIdentifier	 type
.	TokenNameDOT	
toJCType	TokenNameIdentifier	 to JC Type
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Push the default value on the JVM's stack 	TokenNameCOMMENT_LINE	Push the default value on the JVM's stack 
if	TokenNameif	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
_type	TokenNameIdentifier	 type
instanceof	TokenNameinstanceof	
IntType	TokenNameIdentifier	 Int Type
)	TokenNameRPAREN	
||	TokenNameOR_OR	
(	TokenNameLPAREN	
_type	TokenNameIdentifier	 type
instanceof	TokenNameinstanceof	
NodeType	TokenNameIdentifier	 Node Type
)	TokenNameRPAREN	
||	TokenNameOR_OR	
(	TokenNameLPAREN	
_type	TokenNameIdentifier	 type
instanceof	TokenNameinstanceof	
BooleanType	TokenNameIdentifier	 Boolean Type
)	TokenNameRPAREN	
)	TokenNameRPAREN	
il	TokenNameIdentifier	 il
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
new	TokenNamenew	
ICONST	TokenNameIdentifier	 ICONST
(	TokenNameLPAREN	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// 0 for node-id, integer and boolean 	TokenNameCOMMENT_LINE	0 for node-id, integer and boolean 
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
_type	TokenNameIdentifier	 type
instanceof	TokenNameinstanceof	
RealType	TokenNameIdentifier	 Real Type
)	TokenNameRPAREN	
il	TokenNameIdentifier	 il
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
new	TokenNamenew	
DCONST	TokenNameIdentifier	 DCONST
(	TokenNameLPAREN	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// 0.0 for floating point numbers 	TokenNameCOMMENT_LINE	0.0 for floating point numbers 
else	TokenNameelse	
il	TokenNameIdentifier	 il
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
new	TokenNamenew	
ACONST_NULL	TokenNameIdentifier	 ACONST  NULL
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// and 'null' for anything else 	TokenNameCOMMENT_LINE	and 'null' for anything else 
// Mark the store as the start of the live range of the variable 	TokenNameCOMMENT_LINE	Mark the store as the start of the live range of the variable 
_local	TokenNameIdentifier	 local
.	TokenNameDOT	
setStart	TokenNameIdentifier	 set Start
(	TokenNameLPAREN	
il	TokenNameIdentifier	 il
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
_type	TokenNameIdentifier	 type
.	TokenNameDOT	
STORE	TokenNameIdentifier	 STORE
(	TokenNameLPAREN	
_local	TokenNameIdentifier	 local
.	TokenNameDOT	
getIndex	TokenNameIdentifier	 get Index
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
translate	TokenNameIdentifier	 translate
(	TokenNameLPAREN	
ClassGenerator	TokenNameIdentifier	 Class Generator
classGen	TokenNameIdentifier	 class Gen
,	TokenNameCOMMA	
MethodGenerator	TokenNameIdentifier	 Method Generator
methodGen	TokenNameIdentifier	 method Gen
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
ConstantPoolGen	TokenNameIdentifier	 Constant Pool Gen
cpg	TokenNameIdentifier	 cpg
=	TokenNameEQUAL	
classGen	TokenNameIdentifier	 class Gen
.	TokenNameDOT	
getConstantPool	TokenNameIdentifier	 get Constant Pool
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
InstructionList	TokenNameIdentifier	 Instruction List
il	TokenNameIdentifier	 il
=	TokenNameEQUAL	
methodGen	TokenNameIdentifier	 method Gen
.	TokenNameDOT	
getInstructionList	TokenNameIdentifier	 get Instruction List
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Don't generate code for unreferenced variables 	TokenNameCOMMENT_LINE	Don't generate code for unreferenced variables 
if	TokenNameif	
(	TokenNameLPAREN	
_refs	TokenNameIdentifier	 refs
.	TokenNameDOT	
isEmpty	TokenNameIdentifier	 is Empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
_ignore	TokenNameIdentifier	 ignore
=	TokenNameEQUAL	
true	TokenNametrue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Make sure that a variable instance is only compiled once 	TokenNameCOMMENT_LINE	Make sure that a variable instance is only compiled once 
if	TokenNameif	
(	TokenNameLPAREN	
_ignore	TokenNameIdentifier	 ignore
)	TokenNameRPAREN	
return	TokenNamereturn	
;	TokenNameSEMICOLON	
_ignore	TokenNameIdentifier	 ignore
=	TokenNameEQUAL	
true	TokenNametrue	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
name	TokenNameIdentifier	 name
=	TokenNameEQUAL	
getEscapedName	TokenNameIdentifier	 get Escaped Name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
isLocal	TokenNameIdentifier	 is Local
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// Compile variable value computation 	TokenNameCOMMENT_LINE	Compile variable value computation 
translateValue	TokenNameIdentifier	 translate Value
(	TokenNameLPAREN	
classGen	TokenNameIdentifier	 class Gen
,	TokenNameCOMMA	
methodGen	TokenNameIdentifier	 method Gen
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Add a new local variable and store value 	TokenNameCOMMENT_LINE	Add a new local variable and store value 
boolean	TokenNameboolean	
createLocal	TokenNameIdentifier	 create Local
=	TokenNameEQUAL	
_local	TokenNameIdentifier	 local
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
createLocal	TokenNameIdentifier	 create Local
)	TokenNameRPAREN	
{	TokenNameLBRACE	
mapRegister	TokenNameIdentifier	 map Register
(	TokenNameLPAREN	
methodGen	TokenNameIdentifier	 method Gen
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
InstructionHandle	TokenNameIdentifier	 Instruction Handle
storeInst	TokenNameIdentifier	 store Inst
=	TokenNameEQUAL	
il	TokenNameIdentifier	 il
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
_type	TokenNameIdentifier	 type
.	TokenNameDOT	
STORE	TokenNameIdentifier	 STORE
(	TokenNameLPAREN	
_local	TokenNameIdentifier	 local
.	TokenNameDOT	
getIndex	TokenNameIdentifier	 get Index
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// If the local is just being created, mark the store as the start 	TokenNameCOMMENT_LINE	If the local is just being created, mark the store as the start 
// of its live range. Note that it might have been created by 	TokenNameCOMMENT_LINE	of its live range. Note that it might have been created by 
// initializeVariables already, which would have set the start of 	TokenNameCOMMENT_LINE	initializeVariables already, which would have set the start of 
// the live range already. 	TokenNameCOMMENT_LINE	the live range already. 
if	TokenNameif	
(	TokenNameLPAREN	
createLocal	TokenNameIdentifier	 create Local
)	TokenNameRPAREN	
{	TokenNameLBRACE	
_local	TokenNameIdentifier	 local
.	TokenNameDOT	
setStart	TokenNameIdentifier	 set Start
(	TokenNameLPAREN	
storeInst	TokenNameIdentifier	 store Inst
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
signature	TokenNameIdentifier	 signature
=	TokenNameEQUAL	
_type	TokenNameIdentifier	 type
.	TokenNameDOT	
toSignature	TokenNameIdentifier	 to Signature
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Global variables are store in class fields 	TokenNameCOMMENT_LINE	Global variables are store in class fields 
if	TokenNameif	
(	TokenNameLPAREN	
classGen	TokenNameIdentifier	 class Gen
.	TokenNameDOT	
containsField	TokenNameIdentifier	 contains Field
(	TokenNameLPAREN	
name	TokenNameIdentifier	 name
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
classGen	TokenNameIdentifier	 class Gen
.	TokenNameDOT	
addField	TokenNameIdentifier	 add Field
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
ACC_PUBLIC	TokenNameIdentifier	 ACC  PUBLIC
,	TokenNameCOMMA	
cpg	TokenNameIdentifier	 cpg
.	TokenNameDOT	
addUtf8	TokenNameIdentifier	 add Utf8
(	TokenNameLPAREN	
name	TokenNameIdentifier	 name
)	TokenNameRPAREN	
,	TokenNameCOMMA	
cpg	TokenNameIdentifier	 cpg
.	TokenNameDOT	
addUtf8	TokenNameIdentifier	 add Utf8
(	TokenNameLPAREN	
signature	TokenNameIdentifier	 signature
)	TokenNameRPAREN	
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
cpg	TokenNameIdentifier	 cpg
.	TokenNameDOT	
getConstantPool	TokenNameIdentifier	 get Constant Pool
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Push a reference to "this" for putfield 	TokenNameCOMMENT_LINE	Push a reference to "this" for putfield 
il	TokenNameIdentifier	 il
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
classGen	TokenNameIdentifier	 class Gen
.	TokenNameDOT	
loadTranslet	TokenNameIdentifier	 load Translet
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Compile variable value computation 	TokenNameCOMMENT_LINE	Compile variable value computation 
translateValue	TokenNameIdentifier	 translate Value
(	TokenNameLPAREN	
classGen	TokenNameIdentifier	 class Gen
,	TokenNameCOMMA	
methodGen	TokenNameIdentifier	 method Gen
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Store the variable in the allocated field 	TokenNameCOMMENT_LINE	Store the variable in the allocated field 
il	TokenNameIdentifier	 il
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
new	TokenNamenew	
PUTFIELD	TokenNameIdentifier	 PUTFIELD
(	TokenNameLPAREN	
cpg	TokenNameIdentifier	 cpg
.	TokenNameDOT	
addFieldref	TokenNameIdentifier	 add Fieldref
(	TokenNameLPAREN	
classGen	TokenNameIdentifier	 class Gen
.	TokenNameDOT	
getClassName	TokenNameIdentifier	 get Class Name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
name	TokenNameIdentifier	 name
,	TokenNameCOMMA	
signature	TokenNameIdentifier	 signature
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
