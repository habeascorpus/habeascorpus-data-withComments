/** * Licensed to the Apache Software Foundation (ASF) under one or more * contributor license agreements. See the NOTICE file distributed with * this work for additional information regarding copyright ownership. * The ASF licenses this file to You under the Apache License, Version 2.0 * (the "License"); you may not use this file except in compliance with * the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */	TokenNameCOMMENT_JAVADOC	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
spatial	TokenNameIdentifier	 spatial
.	TokenNameDOT	
tier	TokenNameIdentifier	 tier
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
IOException	TokenNameIdentifier	 IO Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
LinkedList	TokenNameIdentifier	 Linked List
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
List	TokenNameIdentifier	 List
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
Map	TokenNameIdentifier	 Map
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
analysis	TokenNameIdentifier	 analysis
.	TokenNameDOT	
MockAnalyzer	TokenNameIdentifier	 Mock Analyzer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
document	TokenNameIdentifier	 document
.	TokenNameDOT	
Document	TokenNameIdentifier	 Document
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
document	TokenNameIdentifier	 document
.	TokenNameDOT	
Field	TokenNameIdentifier	 Field
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
IndexReader	TokenNameIdentifier	 Index Reader
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
IndexWriter	TokenNameIdentifier	 Index Writer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
IndexReader	TokenNameIdentifier	 Index Reader
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
Term	TokenNameIdentifier	 Term
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
IndexSearcher	TokenNameIdentifier	 Index Searcher
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
Query	TokenNameIdentifier	 Query
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
ScoreDoc	TokenNameIdentifier	 Score Doc
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
Sort	TokenNameIdentifier	 Sort
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
SortField	TokenNameIdentifier	 Sort Field
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
TermQuery	TokenNameIdentifier	 Term Query
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
TopDocs	TokenNameIdentifier	 Top Docs
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
function	TokenNameIdentifier	 function
.	TokenNameDOT	
CustomScoreQuery	TokenNameIdentifier	 Custom Score Query
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
function	TokenNameIdentifier	 function
.	TokenNameDOT	
CustomScoreProvider	TokenNameIdentifier	 Custom Score Provider
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
function	TokenNameIdentifier	 function
.	TokenNameDOT	
FieldScoreQuery	TokenNameIdentifier	 Field Score Query
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
function	TokenNameIdentifier	 function
.	TokenNameDOT	
FieldScoreQuery	TokenNameIdentifier	 Field Score Query
.	TokenNameDOT	
Type	TokenNameIdentifier	 Type
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
spatial	TokenNameIdentifier	 spatial
.	TokenNameDOT	
DistanceUtils	TokenNameIdentifier	 Distance Utils
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
spatial	TokenNameIdentifier	 spatial
.	TokenNameDOT	
geohash	TokenNameIdentifier	 geohash
.	TokenNameDOT	
GeoHashUtils	TokenNameIdentifier	 Geo Hash Utils
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
spatial	TokenNameIdentifier	 spatial
.	TokenNameDOT	
geometry	TokenNameIdentifier	 geometry
.	TokenNameDOT	
DistanceUnits	TokenNameIdentifier	 Distance Units
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
spatial	TokenNameIdentifier	 spatial
.	TokenNameDOT	
geometry	TokenNameIdentifier	 geometry
.	TokenNameDOT	
FloatLatLng	TokenNameIdentifier	 Float Lat Lng
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
spatial	TokenNameIdentifier	 spatial
.	TokenNameDOT	
geometry	TokenNameIdentifier	 geometry
.	TokenNameDOT	
LatLng	TokenNameIdentifier	 Lat Lng
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
spatial	TokenNameIdentifier	 spatial
.	TokenNameDOT	
tier	TokenNameIdentifier	 tier
.	TokenNameDOT	
projections	TokenNameIdentifier	 projections
.	TokenNameDOT	
CartesianTierPlotter	TokenNameIdentifier	 Cartesian Tier Plotter
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
spatial	TokenNameIdentifier	 spatial
.	TokenNameDOT	
tier	TokenNameIdentifier	 tier
.	TokenNameDOT	
projections	TokenNameIdentifier	 projections
.	TokenNameDOT	
IProjector	TokenNameIdentifier	 I Projector
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
spatial	TokenNameIdentifier	 spatial
.	TokenNameDOT	
tier	TokenNameIdentifier	 tier
.	TokenNameDOT	
projections	TokenNameIdentifier	 projections
.	TokenNameDOT	
SinusoidalProjector	TokenNameIdentifier	 Sinusoidal Projector
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
store	TokenNameIdentifier	 store
.	TokenNameDOT	
Directory	TokenNameIdentifier	 Directory
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
LuceneTestCase	TokenNameIdentifier	 Lucene Test Case
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
NumericUtils	TokenNameIdentifier	 Numeric Utils
;	TokenNameSEMICOLON	
public	TokenNamepublic	
class	TokenNameclass	
TestCartesian	TokenNameIdentifier	 Test Cartesian
extends	TokenNameextends	
LuceneTestCase	TokenNameIdentifier	 Lucene Test Case
{	TokenNameLBRACE	
private	TokenNameprivate	
Directory	TokenNameIdentifier	 Directory
directory	TokenNameIdentifier	 directory
;	TokenNameSEMICOLON	
private	TokenNameprivate	
IndexSearcher	TokenNameIdentifier	 Index Searcher
searcher	TokenNameIdentifier	 searcher
;	TokenNameSEMICOLON	
// reston va 	TokenNameCOMMENT_LINE	reston va 
private	TokenNameprivate	
double	TokenNamedouble	
lat	TokenNameIdentifier	 lat
=	TokenNameEQUAL	
38.969398	TokenNameDoubleLiteral	
;	TokenNameSEMICOLON	
private	TokenNameprivate	
double	TokenNamedouble	
lng	TokenNameIdentifier	 lng
=	TokenNameEQUAL	
-	TokenNameMINUS	
77.386398	TokenNameDoubleLiteral	
;	TokenNameSEMICOLON	
private	TokenNameprivate	
String	TokenNameIdentifier	 String
latField	TokenNameIdentifier	 lat Field
=	TokenNameEQUAL	
"lat"	TokenNameStringLiteral	lat
;	TokenNameSEMICOLON	
private	TokenNameprivate	
String	TokenNameIdentifier	 String
lngField	TokenNameIdentifier	 lng Field
=	TokenNameEQUAL	
"lng"	TokenNameStringLiteral	lng
;	TokenNameSEMICOLON	
private	TokenNameprivate	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
CartesianTierPlotter	TokenNameIdentifier	 Cartesian Tier Plotter
>	TokenNameGREATER	
ctps	TokenNameIdentifier	 ctps
=	TokenNameEQUAL	
new	TokenNamenew	
LinkedList	TokenNameIdentifier	 Linked List
<	TokenNameLESS	
CartesianTierPlotter	TokenNameIdentifier	 Cartesian Tier Plotter
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
private	TokenNameprivate	
String	TokenNameIdentifier	 String
geoHashPrefix	TokenNameIdentifier	 geo Hash Prefix
=	TokenNameEQUAL	
"_geoHash_"	TokenNameStringLiteral	_geoHash_
;	TokenNameSEMICOLON	
private	TokenNameprivate	
IProjector	TokenNameIdentifier	 I Projector
project	TokenNameIdentifier	 project
=	TokenNameEQUAL	
new	TokenNamenew	
SinusoidalProjector	TokenNameIdentifier	 Sinusoidal Projector
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
void	TokenNamevoid	
setUp	TokenNameIdentifier	 set Up
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
super	TokenNamesuper	
.	TokenNameDOT	
setUp	TokenNameIdentifier	 set Up
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
directory	TokenNameIdentifier	 directory
=	TokenNameEQUAL	
newDirectory	TokenNameIdentifier	 new Directory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IndexWriter	TokenNameIdentifier	 Index Writer
writer	TokenNameIdentifier	 writer
=	TokenNameEQUAL	
new	TokenNamenew	
IndexWriter	TokenNameIdentifier	 Index Writer
(	TokenNameLPAREN	
directory	TokenNameIdentifier	 directory
,	TokenNameCOMMA	
newIndexWriterConfig	TokenNameIdentifier	 new Index Writer Config
(	TokenNameLPAREN	
TEST_VERSION_CURRENT	TokenNameIdentifier	 TEST  VERSION  CURRENT
,	TokenNameCOMMA	
new	TokenNamenew	
MockAnalyzer	TokenNameIdentifier	 Mock Analyzer
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
setUpPlotter	TokenNameIdentifier	 set Up Plotter
(	TokenNameLPAREN	
2	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
15	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addData	TokenNameIdentifier	 add Data
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
void	TokenNamevoid	
tearDown	TokenNameIdentifier	 tear Down
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
directory	TokenNameIdentifier	 directory
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
super	TokenNamesuper	
.	TokenNameDOT	
tearDown	TokenNameIdentifier	 tear Down
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
setUpPlotter	TokenNameIdentifier	 set Up Plotter
(	TokenNameLPAREN	
int	TokenNameint	
base	TokenNameIdentifier	 base
,	TokenNameCOMMA	
int	TokenNameint	
top	TokenNameIdentifier	 top
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
;	TokenNameSEMICOLON	
base	TokenNameIdentifier	 base
<=	TokenNameLESS_EQUAL	
top	TokenNameIdentifier	 top
;	TokenNameSEMICOLON	
base	TokenNameIdentifier	 base
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
ctps	TokenNameIdentifier	 ctps
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
CartesianTierPlotter	TokenNameIdentifier	 Cartesian Tier Plotter
(	TokenNameLPAREN	
base	TokenNameIdentifier	 base
,	TokenNameCOMMA	
project	TokenNameIdentifier	 project
,	TokenNameCOMMA	
CartesianTierPlotter	TokenNameIdentifier	 Cartesian Tier Plotter
.	TokenNameDOT	
DEFALT_FIELD_PREFIX	TokenNameIdentifier	 DEFALT  FIELD  PREFIX
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
IndexWriter	TokenNameIdentifier	 Index Writer
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
name	TokenNameIdentifier	 name
,	TokenNameCOMMA	
double	TokenNamedouble	
lat	TokenNameIdentifier	 lat
,	TokenNameCOMMA	
double	TokenNamedouble	
lng	TokenNameIdentifier	 lng
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
Document	TokenNameIdentifier	 Document
doc	TokenNameIdentifier	 doc
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"name"	TokenNameStringLiteral	name
,	TokenNameCOMMA	
name	TokenNameIdentifier	 name
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
ANALYZED	TokenNameIdentifier	 ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// convert the lat / long to lucene fields 	TokenNameCOMMENT_LINE	convert the lat / long to lucene fields 
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
latField	TokenNameIdentifier	 lat Field
,	TokenNameCOMMA	
NumericUtils	TokenNameIdentifier	 Numeric Utils
.	TokenNameDOT	
doubleToPrefixCoded	TokenNameIdentifier	 double To Prefix Coded
(	TokenNameLPAREN	
lat	TokenNameIdentifier	 lat
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
lngField	TokenNameIdentifier	 lng Field
,	TokenNameCOMMA	
NumericUtils	TokenNameIdentifier	 Numeric Utils
.	TokenNameDOT	
doubleToPrefixCoded	TokenNameIdentifier	 double To Prefix Coded
(	TokenNameLPAREN	
lng	TokenNameIdentifier	 lng
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// add a default meta field to make searching all documents easy 	TokenNameCOMMENT_LINE	add a default meta field to make searching all documents easy 
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"metafile"	TokenNameStringLiteral	metafile
,	TokenNameCOMMA	
"doc"	TokenNameStringLiteral	doc
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
ANALYZED	TokenNameIdentifier	 ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
int	TokenNameint	
ctpsize	TokenNameIdentifier	 ctpsize
=	TokenNameEQUAL	
ctps	TokenNameIdentifier	 ctps
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
ctpsize	TokenNameIdentifier	 ctpsize
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
CartesianTierPlotter	TokenNameIdentifier	 Cartesian Tier Plotter
ctp	TokenNameIdentifier	 ctp
=	TokenNameEQUAL	
ctps	TokenNameIdentifier	 ctps
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
ctp	TokenNameIdentifier	 ctp
.	TokenNameDOT	
getTierFieldName	TokenNameIdentifier	 get Tier Field Name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
NumericUtils	TokenNameIdentifier	 Numeric Utils
.	TokenNameDOT	
doubleToPrefixCoded	TokenNameIdentifier	 double To Prefix Coded
(	TokenNameLPAREN	
ctp	TokenNameIdentifier	 ctp
.	TokenNameDOT	
getTierBoxId	TokenNameIdentifier	 get Tier Box Id
(	TokenNameLPAREN	
lat	TokenNameIdentifier	 lat
,	TokenNameCOMMA	
lng	TokenNameIdentifier	 lng
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED_NO_NORMS	TokenNameIdentifier	 NOT  ANALYZED  NO  NORMS
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
geoHashPrefix	TokenNameIdentifier	 geo Hash Prefix
,	TokenNameCOMMA	
GeoHashUtils	TokenNameIdentifier	 Geo Hash Utils
.	TokenNameDOT	
encode	TokenNameIdentifier	 encode
(	TokenNameLPAREN	
lat	TokenNameIdentifier	 lat
,	TokenNameCOMMA	
lng	TokenNameIdentifier	 lng
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED_NO_NORMS	TokenNameIdentifier	 NOT  ANALYZED  NO  NORMS
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
writer	TokenNameIdentifier	 writer
.	TokenNameDOT	
addDocument	TokenNameIdentifier	 add Document
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
addData	TokenNameIdentifier	 add Data
(	TokenNameLPAREN	
IndexWriter	TokenNameIdentifier	 Index Writer
writer	TokenNameIdentifier	 writer
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
"McCormick &amp; Schmick's Seafood Restaurant"	TokenNameStringLiteral	McCormick &amp; Schmick's Seafood Restaurant
,	TokenNameCOMMA	
38.9579000	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
-	TokenNameMINUS	
77.3572000	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
"Jimmy's Old Town Tavern"	TokenNameStringLiteral	Jimmy's Old Town Tavern
,	TokenNameCOMMA	
38.9690000	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
-	TokenNameMINUS	
77.3862000	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
"Ned Devine's"	TokenNameStringLiteral	Ned Devine's
,	TokenNameCOMMA	
38.9510000	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
-	TokenNameMINUS	
77.4107000	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
"Old Brogue Irish Pub"	TokenNameStringLiteral	Old Brogue Irish Pub
,	TokenNameCOMMA	
38.9955000	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
-	TokenNameMINUS	
77.2884000	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
"Alf Laylah Wa Laylah"	TokenNameStringLiteral	Alf Laylah Wa Laylah
,	TokenNameCOMMA	
38.8956000	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
-	TokenNameMINUS	
77.4258000	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
"Sully's Restaurant &amp; Supper"	TokenNameStringLiteral	Sully's Restaurant &amp; Supper
,	TokenNameCOMMA	
38.9003000	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
-	TokenNameMINUS	
77.4467000	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
"TGIFriday"	TokenNameStringLiteral	TGIFriday
,	TokenNameCOMMA	
38.8725000	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
-	TokenNameMINUS	
77.3829000	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
"Potomac Swing Dance Club"	TokenNameStringLiteral	Potomac Swing Dance Club
,	TokenNameCOMMA	
38.9027000	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
-	TokenNameMINUS	
77.2639000	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
"White Tiger Restaurant"	TokenNameStringLiteral	White Tiger Restaurant
,	TokenNameCOMMA	
38.9027000	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
-	TokenNameMINUS	
77.2638000	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
"Jammin' Java"	TokenNameStringLiteral	Jammin' Java
,	TokenNameCOMMA	
38.9039000	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
-	TokenNameMINUS	
77.2622000	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
"Potomac Swing Dance Club"	TokenNameStringLiteral	Potomac Swing Dance Club
,	TokenNameCOMMA	
38.9027000	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
-	TokenNameMINUS	
77.2639000	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
"WiseAcres Comedy Club"	TokenNameStringLiteral	WiseAcres Comedy Club
,	TokenNameCOMMA	
38.9248000	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
-	TokenNameMINUS	
77.2344000	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
"Glen Echo Spanish Ballroom"	TokenNameStringLiteral	Glen Echo Spanish Ballroom
,	TokenNameCOMMA	
38.9691000	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
-	TokenNameMINUS	
77.1400000	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
"Whitlow's on Wilson"	TokenNameStringLiteral	Whitlow's on Wilson
,	TokenNameCOMMA	
38.8889000	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
-	TokenNameMINUS	
77.0926000	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
"Iota Club and Cafe"	TokenNameStringLiteral	Iota Club and Cafe
,	TokenNameCOMMA	
38.8890000	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
-	TokenNameMINUS	
77.0923000	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
"Hilton Washington Embassy Row"	TokenNameStringLiteral	Hilton Washington Embassy Row
,	TokenNameCOMMA	
38.9103000	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
-	TokenNameMINUS	
77.0451000	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
"HorseFeathers, Bar & Grill"	TokenNameStringLiteral	HorseFeathers, Bar & Grill
,	TokenNameCOMMA	
39.01220000000001	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
-	TokenNameMINUS	
77.3942	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
"Marshall Island Airfield"	TokenNameStringLiteral	Marshall Island Airfield
,	TokenNameCOMMA	
7.06	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
171.2	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
"Wonga Wongue Reserve, Gabon"	TokenNameStringLiteral	Wonga Wongue Reserve, Gabon
,	TokenNameCOMMA	
-	TokenNameMINUS	
0.546562	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
9.459229	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
"Midway Island"	TokenNameStringLiteral	Midway Island
,	TokenNameCOMMA	
25.7	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
-	TokenNameMINUS	
171.7	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addPoint	TokenNameIdentifier	 add Point
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
,	TokenNameCOMMA	
"North Pole Way"	TokenNameStringLiteral	North Pole Way
,	TokenNameCOMMA	
55.0	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
4.0	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
writer	TokenNameIdentifier	 writer
.	TokenNameDOT	
commit	TokenNameIdentifier	 commit
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// TODO: fix CustomScoreQuery usage in testRange/testGeoHashRange so we don't need this. 	TokenNameCOMMENT_LINE	TODO: fix CustomScoreQuery usage in testRange/testGeoHashRange so we don't need this. 
writer	TokenNameIdentifier	 writer
.	TokenNameDOT	
forceMerge	TokenNameIdentifier	 force Merge
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
writer	TokenNameIdentifier	 writer
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
testDistances	TokenNameIdentifier	 test Distances
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
,	TokenNameCOMMA	
InvalidGeoException	TokenNameIdentifier	 Invalid Geo Exception
{	TokenNameLBRACE	
LatLng	TokenNameIdentifier	 Lat Lng
p1	TokenNameIdentifier	 p1
=	TokenNameEQUAL	
new	TokenNamenew	
FloatLatLng	TokenNameIdentifier	 Float Lat Lng
(	TokenNameLPAREN	
7.06	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
171.2	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
LatLng	TokenNameIdentifier	 Lat Lng
p2	TokenNameIdentifier	 p2
=	TokenNameEQUAL	
new	TokenNamenew	
FloatLatLng	TokenNameIdentifier	 Float Lat Lng
(	TokenNameLPAREN	
21.6032207	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
-	TokenNameMINUS	
158.0	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
miles	TokenNameIdentifier	 miles
=	TokenNameEQUAL	
p1	TokenNameIdentifier	 p1
.	TokenNameDOT	
arcDistance	TokenNameIdentifier	 arc Distance
(	TokenNameLPAREN	
p2	TokenNameIdentifier	 p2
,	TokenNameCOMMA	
DistanceUnits	TokenNameIdentifier	 Distance Units
.	TokenNameDOT	
MILES	TokenNameIdentifier	 MILES
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"testDistances"	TokenNameStringLiteral	testDistances
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"miles:"	TokenNameStringLiteral	miles:
+	TokenNamePLUS	
miles	TokenNameIdentifier	 miles
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
2288.82495932794	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
miles	TokenNameIdentifier	 miles
,	TokenNameCOMMA	
0.001	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
LatLng	TokenNameIdentifier	 Lat Lng
p3	TokenNameIdentifier	 p3
=	TokenNameEQUAL	
new	TokenNamenew	
FloatLatLng	TokenNameIdentifier	 Float Lat Lng
(	TokenNameLPAREN	
41.6032207	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
-	TokenNameMINUS	
73.087749	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
LatLng	TokenNameIdentifier	 Lat Lng
p4	TokenNameIdentifier	 p4
=	TokenNameEQUAL	
new	TokenNamenew	
FloatLatLng	TokenNameIdentifier	 Float Lat Lng
(	TokenNameLPAREN	
55.0	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
4.0	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
miles	TokenNameIdentifier	 miles
=	TokenNameEQUAL	
p3	TokenNameIdentifier	 p3
.	TokenNameDOT	
arcDistance	TokenNameIdentifier	 arc Distance
(	TokenNameLPAREN	
p4	TokenNameIdentifier	 p4
,	TokenNameCOMMA	
DistanceUnits	TokenNameIdentifier	 Distance Units
.	TokenNameDOT	
MILES	TokenNameIdentifier	 MILES
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"miles:"	TokenNameStringLiteral	miles:
+	TokenNamePLUS	
miles	TokenNameIdentifier	 miles
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
3474.331719997617	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
miles	TokenNameIdentifier	 miles
,	TokenNameCOMMA	
0.001	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/*public void testCartesianPolyFilterBuilder() throws Exception { CartesianPolyFilterBuilder cpfb = new CartesianPolyFilterBuilder(CartesianTierPlotter.DEFALT_FIELD_PREFIX, 2, 15); //try out some shapes final double miles = 20.0; // Hawaii // 2300 miles to Marshall Island Airfield //Hawaii to Midway is 911 miles lat = 0; lng = -179.9; Shape shape; shape = cpfb.getBoxShape(lat, lng, miles); System.out.println("Tier: " + shape.getTierLevel()); System.out.println("area: " + shape.getArea().size()); lat = 30; lng = -100; shape = cpfb.getBoxShape(lat, lng, miles); System.out.println("Tier: " + shape.getTierLevel()); System.out.println("area: " + shape.getArea().size()); lat = 30; lng = 100; shape = cpfb.getBoxShape(lat, lng, miles); System.out.println("Tier: " + shape.getTierLevel()); System.out.println("area: " + shape.getArea().size()); } */	TokenNameCOMMENT_BLOCK	public void testCartesianPolyFilterBuilder() throws Exception { CartesianPolyFilterBuilder cpfb = new CartesianPolyFilterBuilder(CartesianTierPlotter.DEFALT_FIELD_PREFIX, 2, 15); //try out some shapes final double miles = 20.0; // Hawaii // 2300 miles to Marshall Island Airfield //Hawaii to Midway is 911 miles lat = 0; lng = -179.9; Shape shape; shape = cpfb.getBoxShape(lat, lng, miles); System.out.println("Tier: " + shape.getTierLevel()); System.out.println("area: " + shape.getArea().size()); lat = 30; lng = -100; shape = cpfb.getBoxShape(lat, lng, miles); System.out.println("Tier: " + shape.getTierLevel()); System.out.println("area: " + shape.getArea().size()); lat = 30; lng = 100; shape = cpfb.getBoxShape(lat, lng, miles); System.out.println("Tier: " + shape.getTierLevel()); System.out.println("area: " + shape.getArea().size()); } 
public	TokenNamepublic	
void	TokenNamevoid	
testAntiM	TokenNameIdentifier	 test Anti M
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
,	TokenNameCOMMA	
InvalidGeoException	TokenNameIdentifier	 Invalid Geo Exception
{	TokenNameLBRACE	
IndexReader	TokenNameIdentifier	 Index Reader
reader	TokenNameIdentifier	 reader
=	TokenNameEQUAL	
IndexReader	TokenNameIdentifier	 Index Reader
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
directory	TokenNameIdentifier	 directory
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
searcher	TokenNameIdentifier	 searcher
=	TokenNameEQUAL	
new	TokenNamenew	
IndexSearcher	TokenNameIdentifier	 Index Searcher
(	TokenNameLPAREN	
reader	TokenNameIdentifier	 reader
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
double	TokenNamedouble	
miles	TokenNameIdentifier	 miles
=	TokenNameEQUAL	
2800.0	TokenNameDoubleLiteral	
;	TokenNameSEMICOLON	
// Hawaii 	TokenNameCOMMENT_LINE	Hawaii 
// 2300 miles to Marshall Island Airfield 	TokenNameCOMMENT_LINE	2300 miles to Marshall Island Airfield 
//Hawaii to Midway is 911 miles 	TokenNameCOMMENT_LINE	Hawaii to Midway is 911 miles 
lat	TokenNameIdentifier	 lat
=	TokenNameEQUAL	
21.6032207	TokenNameDoubleLiteral	
;	TokenNameSEMICOLON	
lng	TokenNameIdentifier	 lng
=	TokenNameEQUAL	
-	TokenNameMINUS	
158.0	TokenNameDoubleLiteral	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"testAntiM"	TokenNameStringLiteral	testAntiM
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// create a distance query 	TokenNameCOMMENT_LINE	create a distance query 
final	TokenNamefinal	
DistanceQueryBuilder	TokenNameIdentifier	 Distance Query Builder
dq	TokenNameIdentifier	 dq
=	TokenNameEQUAL	
new	TokenNamenew	
DistanceQueryBuilder	TokenNameIdentifier	 Distance Query Builder
(	TokenNameLPAREN	
lat	TokenNameIdentifier	 lat
,	TokenNameCOMMA	
lng	TokenNameIdentifier	 lng
,	TokenNameCOMMA	
miles	TokenNameIdentifier	 miles
,	TokenNameCOMMA	
latField	TokenNameIdentifier	 lat Field
,	TokenNameCOMMA	
lngField	TokenNameIdentifier	 lng Field
,	TokenNameCOMMA	
CartesianTierPlotter	TokenNameIdentifier	 Cartesian Tier Plotter
.	TokenNameDOT	
DEFALT_FIELD_PREFIX	TokenNameIdentifier	 DEFALT  FIELD  PREFIX
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
2	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
15	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
dq	TokenNameIdentifier	 dq
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//create a term query to search against all documents 	TokenNameCOMMENT_LINE	create a term query to search against all documents 
Query	TokenNameIdentifier	 Query
tq	TokenNameIdentifier	 tq
=	TokenNameEQUAL	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"metafile"	TokenNameStringLiteral	metafile
,	TokenNameCOMMA	
"doc"	TokenNameStringLiteral	doc
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
FieldScoreQuery	TokenNameIdentifier	 Field Score Query
fsQuery	TokenNameIdentifier	 fs Query
=	TokenNameEQUAL	
new	TokenNamenew	
FieldScoreQuery	TokenNameIdentifier	 Field Score Query
(	TokenNameLPAREN	
"geo_distance"	TokenNameStringLiteral	geo_distance
,	TokenNameCOMMA	
Type	TokenNameIdentifier	 Type
.	TokenNameDOT	
FLOAT	TokenNameIdentifier	 FLOAT
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
CustomScoreQuery	TokenNameIdentifier	 Custom Score Query
customScore	TokenNameIdentifier	 custom Score
=	TokenNameEQUAL	
new	TokenNamenew	
CustomScoreQuery	TokenNameIdentifier	 Custom Score Query
(	TokenNameLPAREN	
dq	TokenNameIdentifier	 dq
.	TokenNameDOT	
getQuery	TokenNameIdentifier	 get Query
(	TokenNameLPAREN	
tq	TokenNameIdentifier	 tq
)	TokenNameRPAREN	
,	TokenNameCOMMA	
fsQuery	TokenNameIdentifier	 fs Query
)	TokenNameRPAREN	
{	TokenNameLBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
protected	TokenNameprotected	
CustomScoreProvider	TokenNameIdentifier	 Custom Score Provider
getCustomScoreProvider	TokenNameIdentifier	 get Custom Score Provider
(	TokenNameLPAREN	
IndexReader	TokenNameIdentifier	 Index Reader
reader	TokenNameIdentifier	 reader
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
new	TokenNamenew	
CustomScoreProvider	TokenNameIdentifier	 Custom Score Provider
(	TokenNameLPAREN	
reader	TokenNameIdentifier	 reader
)	TokenNameRPAREN	
{	TokenNameLBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
// TODO: broken, as reader is not used! 	TokenNameCOMMENT_LINE	TODO: broken, as reader is not used! 
public	TokenNamepublic	
float	TokenNamefloat	
customScore	TokenNameIdentifier	 custom Score
(	TokenNameLPAREN	
int	TokenNameint	
doc	TokenNameIdentifier	 doc
,	TokenNameCOMMA	
float	TokenNamefloat	
subQueryScore	TokenNameIdentifier	 sub Query Score
,	TokenNameCOMMA	
float	TokenNamefloat	
valSrcScore	TokenNameIdentifier	 val Src Score
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
dq	TokenNameIdentifier	 dq
.	TokenNameDOT	
distanceFilter	TokenNameIdentifier	 distance Filter
.	TokenNameDOT	
getDistance	TokenNameIdentifier	 get Distance
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
return	TokenNamereturn	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
distance	TokenNameIdentifier	 distance
=	TokenNameEQUAL	
dq	TokenNameIdentifier	 dq
.	TokenNameDOT	
distanceFilter	TokenNameIdentifier	 distance Filter
.	TokenNameDOT	
getDistance	TokenNameIdentifier	 get Distance
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// boost score shouldn't exceed 1 	TokenNameCOMMENT_LINE	boost score shouldn't exceed 1 
if	TokenNameif	
(	TokenNameLPAREN	
distance	TokenNameIdentifier	 distance
<	TokenNameLESS	
1.0d	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
distance	TokenNameIdentifier	 distance
=	TokenNameEQUAL	
1.0d	TokenNameDoubleLiteral	
;	TokenNameSEMICOLON	
//boost by distance is invertly proportional to 	TokenNameCOMMENT_LINE	boost by distance is invertly proportional to 
// to distance from center point to location 	TokenNameCOMMENT_LINE	to distance from center point to location 
float	TokenNamefloat	
score	TokenNameIdentifier	 score
=	TokenNameEQUAL	
(	TokenNameLPAREN	
float	TokenNamefloat	
)	TokenNameRPAREN	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
miles	TokenNameIdentifier	 miles
-	TokenNameMINUS	
distance	TokenNameIdentifier	 distance
)	TokenNameRPAREN	
/	TokenNameDIVIDE	
miles	TokenNameIdentifier	 miles
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
score	TokenNameIdentifier	 score
*	TokenNameMULTIPLY	
subQueryScore	TokenNameIdentifier	 sub Query Score
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
// Create a distance sort 	TokenNameCOMMENT_LINE	Create a distance sort 
// As the radius filter has performed the distance calculations 	TokenNameCOMMENT_LINE	As the radius filter has performed the distance calculations 
// already, pass in the filter to reuse the results. 	TokenNameCOMMENT_LINE	already, pass in the filter to reuse the results. 
// 	TokenNameCOMMENT_LINE	 
DistanceFieldComparatorSource	TokenNameIdentifier	 Distance Field Comparator Source
dsort	TokenNameIdentifier	 dsort
=	TokenNameEQUAL	
new	TokenNamenew	
DistanceFieldComparatorSource	TokenNameIdentifier	 Distance Field Comparator Source
(	TokenNameLPAREN	
dq	TokenNameIdentifier	 dq
.	TokenNameDOT	
distanceFilter	TokenNameIdentifier	 distance Filter
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Sort	TokenNameIdentifier	 Sort
sort	TokenNameIdentifier	 sort
=	TokenNameEQUAL	
new	TokenNamenew	
Sort	TokenNameIdentifier	 Sort
(	TokenNameLPAREN	
new	TokenNamenew	
SortField	TokenNameIdentifier	 Sort Field
(	TokenNameLPAREN	
"foo"	TokenNameStringLiteral	foo
,	TokenNameCOMMA	
dsort	TokenNameIdentifier	 dsort
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Perform the search, using the term query, the serial chain filter, and the 	TokenNameCOMMENT_LINE	Perform the search, using the term query, the serial chain filter, and the 
// distance sort 	TokenNameCOMMENT_LINE	distance sort 
TopDocs	TokenNameIdentifier	 Top Docs
hits	TokenNameIdentifier	 hits
=	TokenNameEQUAL	
searcher	TokenNameIdentifier	 searcher
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
customScore	TokenNameIdentifier	 custom Score
.	TokenNameDOT	
createWeight	TokenNameIdentifier	 create Weight
(	TokenNameLPAREN	
searcher	TokenNameIdentifier	 searcher
)	TokenNameRPAREN	
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
1000	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
sort	TokenNameIdentifier	 sort
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
int	TokenNameint	
results	TokenNameIdentifier	 results
=	TokenNameEQUAL	
hits	TokenNameIdentifier	 hits
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
;	TokenNameSEMICOLON	
ScoreDoc	TokenNameIdentifier	 Score Doc
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
scoreDocs	TokenNameIdentifier	 score Docs
=	TokenNameEQUAL	
hits	TokenNameIdentifier	 hits
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
;	TokenNameSEMICOLON	
// Get a list of distances 	TokenNameCOMMENT_LINE	Get a list of distances 
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
,	TokenNameCOMMA	
Double	TokenNameIdentifier	 Double
>	TokenNameGREATER	
distances	TokenNameIdentifier	 distances
=	TokenNameEQUAL	
dq	TokenNameIdentifier	 dq
.	TokenNameDOT	
distanceFilter	TokenNameIdentifier	 distance Filter
.	TokenNameDOT	
getDistances	TokenNameIdentifier	 get Distances
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// distances calculated from filter first pass must be less than total 	TokenNameCOMMENT_LINE	distances calculated from filter first pass must be less than total 
// docs, from the above test of 20 items, 12 will come from the boundary box 	TokenNameCOMMENT_LINE	docs, from the above test of 20 items, 12 will come from the boundary box 
// filter, but only 5 are actually in the radius of the results. 	TokenNameCOMMENT_LINE	filter, but only 5 are actually in the radius of the results. 
// Note Boundary Box filtering, is not accurate enough for most systems. 	TokenNameCOMMENT_LINE	Note Boundary Box filtering, is not accurate enough for most systems. 
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Distance Filter filtered: "	TokenNameStringLiteral	Distance Filter filtered: 
+	TokenNamePLUS	
distances	TokenNameIdentifier	 distances
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Results: "	TokenNameStringLiteral	Results: 
+	TokenNamePLUS	
results	TokenNameIdentifier	 results
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"============================="	TokenNameStringLiteral	=============================
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Distances should be 2 "	TokenNameStringLiteral	Distances should be 2 
+	TokenNamePLUS	
distances	TokenNameIdentifier	 distances
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Results should be 2 "	TokenNameStringLiteral	Results should be 2 
+	TokenNamePLUS	
results	TokenNameIdentifier	 results
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
2	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
distances	TokenNameIdentifier	 distances
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// fixed a store of only needed distances 	TokenNameCOMMENT_LINE	fixed a store of only needed distances 
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
2	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
results	TokenNameIdentifier	 results
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
lastDistance	TokenNameIdentifier	 last Distance
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
results	TokenNameIdentifier	 results
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Document	TokenNameIdentifier	 Document
d	TokenNameIdentifier	 d
=	TokenNameEQUAL	
searcher	TokenNameIdentifier	 searcher
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
(	TokenNameLPAREN	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
name	TokenNameIdentifier	 name
=	TokenNameEQUAL	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"name"	TokenNameStringLiteral	name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
rsLat	TokenNameIdentifier	 rs Lat
=	TokenNameEQUAL	
NumericUtils	TokenNameIdentifier	 Numeric Utils
.	TokenNameDOT	
prefixCodedToDouble	TokenNameIdentifier	 prefix Coded To Double
(	TokenNameLPAREN	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
latField	TokenNameIdentifier	 lat Field
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
rsLng	TokenNameIdentifier	 rs Lng
=	TokenNameEQUAL	
NumericUtils	TokenNameIdentifier	 Numeric Utils
.	TokenNameDOT	
prefixCodedToDouble	TokenNameIdentifier	 prefix Coded To Double
(	TokenNameLPAREN	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
lngField	TokenNameIdentifier	 lng Field
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Double	TokenNameIdentifier	 Double
geo_distance	TokenNameIdentifier	 geo distance
=	TokenNameEQUAL	
distances	TokenNameIdentifier	 distances
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
distance	TokenNameIdentifier	 distance
=	TokenNameEQUAL	
DistanceUtils	TokenNameIdentifier	 Distance Utils
.	TokenNameDOT	
getDistanceMi	TokenNameIdentifier	 get Distance Mi
(	TokenNameLPAREN	
lat	TokenNameIdentifier	 lat
,	TokenNameCOMMA	
lng	TokenNameIdentifier	 lng
,	TokenNameCOMMA	
rsLat	TokenNameIdentifier	 rs Lat
,	TokenNameCOMMA	
rsLng	TokenNameIdentifier	 rs Lng
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
llm	TokenNameIdentifier	 llm
=	TokenNameEQUAL	
DistanceUtils	TokenNameIdentifier	 Distance Utils
.	TokenNameDOT	
getLLMDistance	TokenNameIdentifier	 get LLM Distance
(	TokenNameLPAREN	
lat	TokenNameIdentifier	 lat
,	TokenNameCOMMA	
lng	TokenNameIdentifier	 lng
,	TokenNameCOMMA	
rsLat	TokenNameIdentifier	 rs Lat
,	TokenNameCOMMA	
rsLng	TokenNameIdentifier	 rs Lng
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Name: "	TokenNameStringLiteral	Name: 
+	TokenNamePLUS	
name	TokenNameIdentifier	 name
+	TokenNamePLUS	
", Distance "	TokenNameStringLiteral	, Distance 
+	TokenNamePLUS	
distance	TokenNameIdentifier	 distance
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//(res, ortho, harvesine):"+ distance +" |"+ geo_distance +"|"+ llm +" | score "+ hits.score(i)); 	TokenNameCOMMENT_LINE	(res, ortho, harvesine):"+ distance +" |"+ geo_distance +"|"+ llm +" | score "+ hits.score(i)); 
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
Math	TokenNameIdentifier	 Math
.	TokenNameDOT	
abs	TokenNameIdentifier	 abs
(	TokenNameLPAREN	
(	TokenNameLPAREN	
distance	TokenNameIdentifier	 distance
-	TokenNameMINUS	
llm	TokenNameIdentifier	 llm
)	TokenNameRPAREN	
)	TokenNameRPAREN	
<	TokenNameLESS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
(	TokenNameLPAREN	
distance	TokenNameIdentifier	 distance
<	TokenNameLESS	
miles	TokenNameIdentifier	 miles
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
geo_distance	TokenNameIdentifier	 geo distance
>=	TokenNameGREATER_EQUAL	
lastDistance	TokenNameIdentifier	 last Distance
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
lastDistance	TokenNameIdentifier	 last Distance
=	TokenNameEQUAL	
geo_distance	TokenNameIdentifier	 geo distance
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
searcher	TokenNameIdentifier	 searcher
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
reader	TokenNameIdentifier	 reader
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
testPoleFlipping	TokenNameIdentifier	 test Pole Flipping
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
,	TokenNameCOMMA	
InvalidGeoException	TokenNameIdentifier	 Invalid Geo Exception
{	TokenNameLBRACE	
IndexReader	TokenNameIdentifier	 Index Reader
reader	TokenNameIdentifier	 reader
=	TokenNameEQUAL	
IndexReader	TokenNameIdentifier	 Index Reader
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
directory	TokenNameIdentifier	 directory
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
searcher	TokenNameIdentifier	 searcher
=	TokenNameEQUAL	
new	TokenNamenew	
IndexSearcher	TokenNameIdentifier	 Index Searcher
(	TokenNameLPAREN	
reader	TokenNameIdentifier	 reader
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
double	TokenNamedouble	
miles	TokenNameIdentifier	 miles
=	TokenNameEQUAL	
3500.0	TokenNameDoubleLiteral	
;	TokenNameSEMICOLON	
lat	TokenNameIdentifier	 lat
=	TokenNameEQUAL	
41.6032207	TokenNameDoubleLiteral	
;	TokenNameSEMICOLON	
lng	TokenNameIdentifier	 lng
=	TokenNameEQUAL	
-	TokenNameMINUS	
73.087749	TokenNameDoubleLiteral	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"testPoleFlipping"	TokenNameStringLiteral	testPoleFlipping
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// create a distance query 	TokenNameCOMMENT_LINE	create a distance query 
final	TokenNamefinal	
DistanceQueryBuilder	TokenNameIdentifier	 Distance Query Builder
dq	TokenNameIdentifier	 dq
=	TokenNameEQUAL	
new	TokenNamenew	
DistanceQueryBuilder	TokenNameIdentifier	 Distance Query Builder
(	TokenNameLPAREN	
lat	TokenNameIdentifier	 lat
,	TokenNameCOMMA	
lng	TokenNameIdentifier	 lng
,	TokenNameCOMMA	
miles	TokenNameIdentifier	 miles
,	TokenNameCOMMA	
latField	TokenNameIdentifier	 lat Field
,	TokenNameCOMMA	
lngField	TokenNameIdentifier	 lng Field
,	TokenNameCOMMA	
CartesianTierPlotter	TokenNameIdentifier	 Cartesian Tier Plotter
.	TokenNameDOT	
DEFALT_FIELD_PREFIX	TokenNameIdentifier	 DEFALT  FIELD  PREFIX
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
2	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
15	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
dq	TokenNameIdentifier	 dq
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//create a term query to search against all documents 	TokenNameCOMMENT_LINE	create a term query to search against all documents 
Query	TokenNameIdentifier	 Query
tq	TokenNameIdentifier	 tq
=	TokenNameEQUAL	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"metafile"	TokenNameStringLiteral	metafile
,	TokenNameCOMMA	
"doc"	TokenNameStringLiteral	doc
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
FieldScoreQuery	TokenNameIdentifier	 Field Score Query
fsQuery	TokenNameIdentifier	 fs Query
=	TokenNameEQUAL	
new	TokenNamenew	
FieldScoreQuery	TokenNameIdentifier	 Field Score Query
(	TokenNameLPAREN	
"geo_distance"	TokenNameStringLiteral	geo_distance
,	TokenNameCOMMA	
Type	TokenNameIdentifier	 Type
.	TokenNameDOT	
FLOAT	TokenNameIdentifier	 FLOAT
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
CustomScoreQuery	TokenNameIdentifier	 Custom Score Query
customScore	TokenNameIdentifier	 custom Score
=	TokenNameEQUAL	
new	TokenNamenew	
CustomScoreQuery	TokenNameIdentifier	 Custom Score Query
(	TokenNameLPAREN	
dq	TokenNameIdentifier	 dq
.	TokenNameDOT	
getQuery	TokenNameIdentifier	 get Query
(	TokenNameLPAREN	
tq	TokenNameIdentifier	 tq
)	TokenNameRPAREN	
,	TokenNameCOMMA	
fsQuery	TokenNameIdentifier	 fs Query
)	TokenNameRPAREN	
{	TokenNameLBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
protected	TokenNameprotected	
CustomScoreProvider	TokenNameIdentifier	 Custom Score Provider
getCustomScoreProvider	TokenNameIdentifier	 get Custom Score Provider
(	TokenNameLPAREN	
IndexReader	TokenNameIdentifier	 Index Reader
reader	TokenNameIdentifier	 reader
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
new	TokenNamenew	
CustomScoreProvider	TokenNameIdentifier	 Custom Score Provider
(	TokenNameLPAREN	
reader	TokenNameIdentifier	 reader
)	TokenNameRPAREN	
{	TokenNameLBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
// TODO: broken, as reader is not used! 	TokenNameCOMMENT_LINE	TODO: broken, as reader is not used! 
public	TokenNamepublic	
float	TokenNamefloat	
customScore	TokenNameIdentifier	 custom Score
(	TokenNameLPAREN	
int	TokenNameint	
doc	TokenNameIdentifier	 doc
,	TokenNameCOMMA	
float	TokenNamefloat	
subQueryScore	TokenNameIdentifier	 sub Query Score
,	TokenNameCOMMA	
float	TokenNamefloat	
valSrcScore	TokenNameIdentifier	 val Src Score
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
dq	TokenNameIdentifier	 dq
.	TokenNameDOT	
distanceFilter	TokenNameIdentifier	 distance Filter
.	TokenNameDOT	
getDistance	TokenNameIdentifier	 get Distance
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
return	TokenNamereturn	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
distance	TokenNameIdentifier	 distance
=	TokenNameEQUAL	
dq	TokenNameIdentifier	 dq
.	TokenNameDOT	
distanceFilter	TokenNameIdentifier	 distance Filter
.	TokenNameDOT	
getDistance	TokenNameIdentifier	 get Distance
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// boost score shouldn't exceed 1 	TokenNameCOMMENT_LINE	boost score shouldn't exceed 1 
if	TokenNameif	
(	TokenNameLPAREN	
distance	TokenNameIdentifier	 distance
<	TokenNameLESS	
1.0d	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
distance	TokenNameIdentifier	 distance
=	TokenNameEQUAL	
1.0d	TokenNameDoubleLiteral	
;	TokenNameSEMICOLON	
//boost by distance is invertly proportional to 	TokenNameCOMMENT_LINE	boost by distance is invertly proportional to 
// to distance from center point to location 	TokenNameCOMMENT_LINE	to distance from center point to location 
float	TokenNamefloat	
score	TokenNameIdentifier	 score
=	TokenNameEQUAL	
(	TokenNameLPAREN	
float	TokenNamefloat	
)	TokenNameRPAREN	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
miles	TokenNameIdentifier	 miles
-	TokenNameMINUS	
distance	TokenNameIdentifier	 distance
)	TokenNameRPAREN	
/	TokenNameDIVIDE	
miles	TokenNameIdentifier	 miles
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
score	TokenNameIdentifier	 score
*	TokenNameMULTIPLY	
subQueryScore	TokenNameIdentifier	 sub Query Score
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
// Create a distance sort 	TokenNameCOMMENT_LINE	Create a distance sort 
// As the radius filter has performed the distance calculations 	TokenNameCOMMENT_LINE	As the radius filter has performed the distance calculations 
// already, pass in the filter to reuse the results. 	TokenNameCOMMENT_LINE	already, pass in the filter to reuse the results. 
// 	TokenNameCOMMENT_LINE	 
DistanceFieldComparatorSource	TokenNameIdentifier	 Distance Field Comparator Source
dsort	TokenNameIdentifier	 dsort
=	TokenNameEQUAL	
new	TokenNamenew	
DistanceFieldComparatorSource	TokenNameIdentifier	 Distance Field Comparator Source
(	TokenNameLPAREN	
dq	TokenNameIdentifier	 dq
.	TokenNameDOT	
distanceFilter	TokenNameIdentifier	 distance Filter
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Sort	TokenNameIdentifier	 Sort
sort	TokenNameIdentifier	 sort
=	TokenNameEQUAL	
new	TokenNamenew	
Sort	TokenNameIdentifier	 Sort
(	TokenNameLPAREN	
new	TokenNamenew	
SortField	TokenNameIdentifier	 Sort Field
(	TokenNameLPAREN	
"foo"	TokenNameStringLiteral	foo
,	TokenNameCOMMA	
dsort	TokenNameIdentifier	 dsort
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Perform the search, using the term query, the serial chain filter, and the 	TokenNameCOMMENT_LINE	Perform the search, using the term query, the serial chain filter, and the 
// distance sort 	TokenNameCOMMENT_LINE	distance sort 
TopDocs	TokenNameIdentifier	 Top Docs
hits	TokenNameIdentifier	 hits
=	TokenNameEQUAL	
searcher	TokenNameIdentifier	 searcher
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
customScore	TokenNameIdentifier	 custom Score
.	TokenNameDOT	
createWeight	TokenNameIdentifier	 create Weight
(	TokenNameLPAREN	
searcher	TokenNameIdentifier	 searcher
)	TokenNameRPAREN	
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
1000	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
sort	TokenNameIdentifier	 sort
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
int	TokenNameint	
results	TokenNameIdentifier	 results
=	TokenNameEQUAL	
hits	TokenNameIdentifier	 hits
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
;	TokenNameSEMICOLON	
ScoreDoc	TokenNameIdentifier	 Score Doc
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
scoreDocs	TokenNameIdentifier	 score Docs
=	TokenNameEQUAL	
hits	TokenNameIdentifier	 hits
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
;	TokenNameSEMICOLON	
// Get a list of distances 	TokenNameCOMMENT_LINE	Get a list of distances 
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
,	TokenNameCOMMA	
Double	TokenNameIdentifier	 Double
>	TokenNameGREATER	
distances	TokenNameIdentifier	 distances
=	TokenNameEQUAL	
dq	TokenNameIdentifier	 dq
.	TokenNameDOT	
distanceFilter	TokenNameIdentifier	 distance Filter
.	TokenNameDOT	
getDistances	TokenNameIdentifier	 get Distances
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// distances calculated from filter first pass must be less than total 	TokenNameCOMMENT_LINE	distances calculated from filter first pass must be less than total 
// docs, from the above test of 20 items, 12 will come from the boundary box 	TokenNameCOMMENT_LINE	docs, from the above test of 20 items, 12 will come from the boundary box 
// filter, but only 5 are actually in the radius of the results. 	TokenNameCOMMENT_LINE	filter, but only 5 are actually in the radius of the results. 
// Note Boundary Box filtering, is not accurate enough for most systems. 	TokenNameCOMMENT_LINE	Note Boundary Box filtering, is not accurate enough for most systems. 
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Distance Filter filtered: "	TokenNameStringLiteral	Distance Filter filtered: 
+	TokenNamePLUS	
distances	TokenNameIdentifier	 distances
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Results: "	TokenNameStringLiteral	Results: 
+	TokenNamePLUS	
results	TokenNameIdentifier	 results
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"============================="	TokenNameStringLiteral	=============================
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Distances should be 18 "	TokenNameStringLiteral	Distances should be 18 
+	TokenNamePLUS	
distances	TokenNameIdentifier	 distances
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Results should be 18 "	TokenNameStringLiteral	Results should be 18 
+	TokenNamePLUS	
results	TokenNameIdentifier	 results
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
18	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
distances	TokenNameIdentifier	 distances
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// fixed a store of only needed distances 	TokenNameCOMMENT_LINE	fixed a store of only needed distances 
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
18	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
results	TokenNameIdentifier	 results
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
lastDistance	TokenNameIdentifier	 last Distance
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
results	TokenNameIdentifier	 results
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Document	TokenNameIdentifier	 Document
d	TokenNameIdentifier	 d
=	TokenNameEQUAL	
searcher	TokenNameIdentifier	 searcher
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
(	TokenNameLPAREN	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
name	TokenNameIdentifier	 name
=	TokenNameEQUAL	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"name"	TokenNameStringLiteral	name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
rsLat	TokenNameIdentifier	 rs Lat
=	TokenNameEQUAL	
NumericUtils	TokenNameIdentifier	 Numeric Utils
.	TokenNameDOT	
prefixCodedToDouble	TokenNameIdentifier	 prefix Coded To Double
(	TokenNameLPAREN	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
latField	TokenNameIdentifier	 lat Field
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
rsLng	TokenNameIdentifier	 rs Lng
=	TokenNameEQUAL	
NumericUtils	TokenNameIdentifier	 Numeric Utils
.	TokenNameDOT	
prefixCodedToDouble	TokenNameIdentifier	 prefix Coded To Double
(	TokenNameLPAREN	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
lngField	TokenNameIdentifier	 lng Field
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Double	TokenNameIdentifier	 Double
geo_distance	TokenNameIdentifier	 geo distance
=	TokenNameEQUAL	
distances	TokenNameIdentifier	 distances
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
distance	TokenNameIdentifier	 distance
=	TokenNameEQUAL	
DistanceUtils	TokenNameIdentifier	 Distance Utils
.	TokenNameDOT	
getDistanceMi	TokenNameIdentifier	 get Distance Mi
(	TokenNameLPAREN	
lat	TokenNameIdentifier	 lat
,	TokenNameCOMMA	
lng	TokenNameIdentifier	 lng
,	TokenNameCOMMA	
rsLat	TokenNameIdentifier	 rs Lat
,	TokenNameCOMMA	
rsLng	TokenNameIdentifier	 rs Lng
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
llm	TokenNameIdentifier	 llm
=	TokenNameEQUAL	
DistanceUtils	TokenNameIdentifier	 Distance Utils
.	TokenNameDOT	
getLLMDistance	TokenNameIdentifier	 get LLM Distance
(	TokenNameLPAREN	
lat	TokenNameIdentifier	 lat
,	TokenNameCOMMA	
lng	TokenNameIdentifier	 lng
,	TokenNameCOMMA	
rsLat	TokenNameIdentifier	 rs Lat
,	TokenNameCOMMA	
rsLng	TokenNameIdentifier	 rs Lng
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Name: "	TokenNameStringLiteral	Name: 
+	TokenNamePLUS	
name	TokenNameIdentifier	 name
+	TokenNamePLUS	
", Distance "	TokenNameStringLiteral	, Distance 
+	TokenNamePLUS	
distance	TokenNameIdentifier	 distance
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//(res, ortho, harvesine):"+ distance +" |"+ geo_distance +"|"+ llm +" | score "+ hits.score(i)); 	TokenNameCOMMENT_LINE	(res, ortho, harvesine):"+ distance +" |"+ geo_distance +"|"+ llm +" | score "+ hits.score(i)); 
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
Math	TokenNameIdentifier	 Math
.	TokenNameDOT	
abs	TokenNameIdentifier	 abs
(	TokenNameLPAREN	
(	TokenNameLPAREN	
distance	TokenNameIdentifier	 distance
-	TokenNameMINUS	
llm	TokenNameIdentifier	 llm
)	TokenNameRPAREN	
)	TokenNameRPAREN	
<	TokenNameLESS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"checking limit "	TokenNameStringLiteral	checking limit 
+	TokenNamePLUS	
distance	TokenNameIdentifier	 distance
+	TokenNamePLUS	
" < "	TokenNameStringLiteral	 < 
+	TokenNamePLUS	
miles	TokenNameIdentifier	 miles
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
(	TokenNameLPAREN	
distance	TokenNameIdentifier	 distance
<	TokenNameLESS	
miles	TokenNameIdentifier	 miles
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"checking sort "	TokenNameStringLiteral	checking sort 
+	TokenNamePLUS	
geo_distance	TokenNameIdentifier	 geo distance
+	TokenNamePLUS	
" >= "	TokenNameStringLiteral	 >= 
+	TokenNamePLUS	
lastDistance	TokenNameIdentifier	 last Distance
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
geo_distance	TokenNameIdentifier	 geo distance
>=	TokenNameGREATER_EQUAL	
lastDistance	TokenNameIdentifier	 last Distance
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
lastDistance	TokenNameIdentifier	 last Distance
=	TokenNameEQUAL	
geo_distance	TokenNameIdentifier	 geo distance
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
searcher	TokenNameIdentifier	 searcher
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
reader	TokenNameIdentifier	 reader
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
testRange	TokenNameIdentifier	 test Range
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
,	TokenNameCOMMA	
InvalidGeoException	TokenNameIdentifier	 Invalid Geo Exception
{	TokenNameLBRACE	
IndexReader	TokenNameIdentifier	 Index Reader
reader	TokenNameIdentifier	 reader
=	TokenNameEQUAL	
IndexReader	TokenNameIdentifier	 Index Reader
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
directory	TokenNameIdentifier	 directory
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
searcher	TokenNameIdentifier	 searcher
=	TokenNameEQUAL	
new	TokenNamenew	
IndexSearcher	TokenNameIdentifier	 Index Searcher
(	TokenNameLPAREN	
reader	TokenNameIdentifier	 reader
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
double	TokenNamedouble	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
milesToTest	TokenNameIdentifier	 miles To Test
=	TokenNameEQUAL	
new	TokenNamenew	
double	TokenNamedouble	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
{	TokenNameLBRACE	
6.0	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
0.5	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
0.001	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
0.0	TokenNameDoubleLiteral	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
expected	TokenNameIdentifier	 expected
=	TokenNameEQUAL	
new	TokenNamenew	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
{	TokenNameLBRACE	
7	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
x	TokenNameIdentifier	 x
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
x	TokenNameIdentifier	 x
<	TokenNameLESS	
expected	TokenNameIdentifier	 expected
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
x	TokenNameIdentifier	 x
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
double	TokenNamedouble	
miles	TokenNameIdentifier	 miles
=	TokenNameEQUAL	
milesToTest	TokenNameIdentifier	 miles To Test
[	TokenNameLBRACKET	
x	TokenNameIdentifier	 x
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
// create a distance query 	TokenNameCOMMENT_LINE	create a distance query 
final	TokenNamefinal	
DistanceQueryBuilder	TokenNameIdentifier	 Distance Query Builder
dq	TokenNameIdentifier	 dq
=	TokenNameEQUAL	
new	TokenNamenew	
DistanceQueryBuilder	TokenNameIdentifier	 Distance Query Builder
(	TokenNameLPAREN	
lat	TokenNameIdentifier	 lat
,	TokenNameCOMMA	
lng	TokenNameIdentifier	 lng
,	TokenNameCOMMA	
miles	TokenNameIdentifier	 miles
,	TokenNameCOMMA	
latField	TokenNameIdentifier	 lat Field
,	TokenNameCOMMA	
lngField	TokenNameIdentifier	 lng Field
,	TokenNameCOMMA	
CartesianTierPlotter	TokenNameIdentifier	 Cartesian Tier Plotter
.	TokenNameDOT	
DEFALT_FIELD_PREFIX	TokenNameIdentifier	 DEFALT  FIELD  PREFIX
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
2	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
15	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
dq	TokenNameIdentifier	 dq
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//create a term query to search against all documents 	TokenNameCOMMENT_LINE	create a term query to search against all documents 
Query	TokenNameIdentifier	 Query
tq	TokenNameIdentifier	 tq
=	TokenNameEQUAL	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"metafile"	TokenNameStringLiteral	metafile
,	TokenNameCOMMA	
"doc"	TokenNameStringLiteral	doc
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
FieldScoreQuery	TokenNameIdentifier	 Field Score Query
fsQuery	TokenNameIdentifier	 fs Query
=	TokenNameEQUAL	
new	TokenNamenew	
FieldScoreQuery	TokenNameIdentifier	 Field Score Query
(	TokenNameLPAREN	
"geo_distance"	TokenNameStringLiteral	geo_distance
,	TokenNameCOMMA	
Type	TokenNameIdentifier	 Type
.	TokenNameDOT	
FLOAT	TokenNameIdentifier	 FLOAT
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
CustomScoreQuery	TokenNameIdentifier	 Custom Score Query
customScore	TokenNameIdentifier	 custom Score
=	TokenNameEQUAL	
new	TokenNamenew	
CustomScoreQuery	TokenNameIdentifier	 Custom Score Query
(	TokenNameLPAREN	
dq	TokenNameIdentifier	 dq
.	TokenNameDOT	
getQuery	TokenNameIdentifier	 get Query
(	TokenNameLPAREN	
tq	TokenNameIdentifier	 tq
)	TokenNameRPAREN	
,	TokenNameCOMMA	
fsQuery	TokenNameIdentifier	 fs Query
)	TokenNameRPAREN	
{	TokenNameLBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
protected	TokenNameprotected	
CustomScoreProvider	TokenNameIdentifier	 Custom Score Provider
getCustomScoreProvider	TokenNameIdentifier	 get Custom Score Provider
(	TokenNameLPAREN	
IndexReader	TokenNameIdentifier	 Index Reader
reader	TokenNameIdentifier	 reader
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
new	TokenNamenew	
CustomScoreProvider	TokenNameIdentifier	 Custom Score Provider
(	TokenNameLPAREN	
reader	TokenNameIdentifier	 reader
)	TokenNameRPAREN	
{	TokenNameLBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
// TODO: broken, as reader is not used! 	TokenNameCOMMENT_LINE	TODO: broken, as reader is not used! 
public	TokenNamepublic	
float	TokenNamefloat	
customScore	TokenNameIdentifier	 custom Score
(	TokenNameLPAREN	
int	TokenNameint	
doc	TokenNameIdentifier	 doc
,	TokenNameCOMMA	
float	TokenNamefloat	
subQueryScore	TokenNameIdentifier	 sub Query Score
,	TokenNameCOMMA	
float	TokenNamefloat	
valSrcScore	TokenNameIdentifier	 val Src Score
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
dq	TokenNameIdentifier	 dq
.	TokenNameDOT	
distanceFilter	TokenNameIdentifier	 distance Filter
.	TokenNameDOT	
getDistance	TokenNameIdentifier	 get Distance
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
return	TokenNamereturn	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
distance	TokenNameIdentifier	 distance
=	TokenNameEQUAL	
dq	TokenNameIdentifier	 dq
.	TokenNameDOT	
distanceFilter	TokenNameIdentifier	 distance Filter
.	TokenNameDOT	
getDistance	TokenNameIdentifier	 get Distance
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// boost score shouldn't exceed 1 	TokenNameCOMMENT_LINE	boost score shouldn't exceed 1 
if	TokenNameif	
(	TokenNameLPAREN	
distance	TokenNameIdentifier	 distance
<	TokenNameLESS	
1.0d	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
distance	TokenNameIdentifier	 distance
=	TokenNameEQUAL	
1.0d	TokenNameDoubleLiteral	
;	TokenNameSEMICOLON	
//boost by distance is invertly proportional to 	TokenNameCOMMENT_LINE	boost by distance is invertly proportional to 
// to distance from center point to location 	TokenNameCOMMENT_LINE	to distance from center point to location 
float	TokenNamefloat	
score	TokenNameIdentifier	 score
=	TokenNameEQUAL	
(	TokenNameLPAREN	
float	TokenNamefloat	
)	TokenNameRPAREN	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
miles	TokenNameIdentifier	 miles
-	TokenNameMINUS	
distance	TokenNameIdentifier	 distance
)	TokenNameRPAREN	
/	TokenNameDIVIDE	
miles	TokenNameIdentifier	 miles
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
score	TokenNameIdentifier	 score
*	TokenNameMULTIPLY	
subQueryScore	TokenNameIdentifier	 sub Query Score
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
// Create a distance sort 	TokenNameCOMMENT_LINE	Create a distance sort 
// As the radius filter has performed the distance calculations 	TokenNameCOMMENT_LINE	As the radius filter has performed the distance calculations 
// already, pass in the filter to reuse the results. 	TokenNameCOMMENT_LINE	already, pass in the filter to reuse the results. 
// 	TokenNameCOMMENT_LINE	 
DistanceFieldComparatorSource	TokenNameIdentifier	 Distance Field Comparator Source
dsort	TokenNameIdentifier	 dsort
=	TokenNameEQUAL	
new	TokenNamenew	
DistanceFieldComparatorSource	TokenNameIdentifier	 Distance Field Comparator Source
(	TokenNameLPAREN	
dq	TokenNameIdentifier	 dq
.	TokenNameDOT	
distanceFilter	TokenNameIdentifier	 distance Filter
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Sort	TokenNameIdentifier	 Sort
sort	TokenNameIdentifier	 sort
=	TokenNameEQUAL	
new	TokenNamenew	
Sort	TokenNameIdentifier	 Sort
(	TokenNameLPAREN	
new	TokenNamenew	
SortField	TokenNameIdentifier	 Sort Field
(	TokenNameLPAREN	
"foo"	TokenNameStringLiteral	foo
,	TokenNameCOMMA	
dsort	TokenNameIdentifier	 dsort
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Perform the search, using the term query, the serial chain filter, and the 	TokenNameCOMMENT_LINE	Perform the search, using the term query, the serial chain filter, and the 
// distance sort 	TokenNameCOMMENT_LINE	distance sort 
TopDocs	TokenNameIdentifier	 Top Docs
hits	TokenNameIdentifier	 hits
=	TokenNameEQUAL	
searcher	TokenNameIdentifier	 searcher
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
customScore	TokenNameIdentifier	 custom Score
.	TokenNameDOT	
createWeight	TokenNameIdentifier	 create Weight
(	TokenNameLPAREN	
searcher	TokenNameIdentifier	 searcher
)	TokenNameRPAREN	
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
1000	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
sort	TokenNameIdentifier	 sort
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
int	TokenNameint	
results	TokenNameIdentifier	 results
=	TokenNameEQUAL	
hits	TokenNameIdentifier	 hits
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
;	TokenNameSEMICOLON	
ScoreDoc	TokenNameIdentifier	 Score Doc
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
scoreDocs	TokenNameIdentifier	 score Docs
=	TokenNameEQUAL	
hits	TokenNameIdentifier	 hits
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
;	TokenNameSEMICOLON	
// Get a list of distances 	TokenNameCOMMENT_LINE	Get a list of distances 
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
,	TokenNameCOMMA	
Double	TokenNameIdentifier	 Double
>	TokenNameGREATER	
distances	TokenNameIdentifier	 distances
=	TokenNameEQUAL	
dq	TokenNameIdentifier	 dq
.	TokenNameDOT	
distanceFilter	TokenNameIdentifier	 distance Filter
.	TokenNameDOT	
getDistances	TokenNameIdentifier	 get Distances
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// distances calculated from filter first pass must be less than total 	TokenNameCOMMENT_LINE	distances calculated from filter first pass must be less than total 
// docs, from the above test of 20 items, 12 will come from the boundary box 	TokenNameCOMMENT_LINE	docs, from the above test of 20 items, 12 will come from the boundary box 
// filter, but only 5 are actually in the radius of the results. 	TokenNameCOMMENT_LINE	filter, but only 5 are actually in the radius of the results. 
// Note Boundary Box filtering, is not accurate enough for most systems. 	TokenNameCOMMENT_LINE	Note Boundary Box filtering, is not accurate enough for most systems. 
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Distance Filter filtered: "	TokenNameStringLiteral	Distance Filter filtered: 
+	TokenNamePLUS	
distances	TokenNameIdentifier	 distances
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Results: "	TokenNameStringLiteral	Results: 
+	TokenNamePLUS	
results	TokenNameIdentifier	 results
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"============================="	TokenNameStringLiteral	=============================
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Distances should be 7 "	TokenNameStringLiteral	Distances should be 7 
+	TokenNamePLUS	
expected	TokenNameIdentifier	 expected
[	TokenNameLBRACKET	
x	TokenNameIdentifier	 x
]	TokenNameRBRACKET	
+	TokenNamePLUS	
":"	TokenNameStringLiteral	:
+	TokenNamePLUS	
distances	TokenNameIdentifier	 distances
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Results should be 7 "	TokenNameStringLiteral	Results should be 7 
+	TokenNamePLUS	
expected	TokenNameIdentifier	 expected
[	TokenNameLBRACKET	
x	TokenNameIdentifier	 x
]	TokenNameRBRACKET	
+	TokenNamePLUS	
":"	TokenNameStringLiteral	:
+	TokenNamePLUS	
results	TokenNameIdentifier	 results
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
expected	TokenNameIdentifier	 expected
[	TokenNameLBRACKET	
x	TokenNameIdentifier	 x
]	TokenNameRBRACKET	
,	TokenNameCOMMA	
distances	TokenNameIdentifier	 distances
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// fixed a store of only needed distances 	TokenNameCOMMENT_LINE	fixed a store of only needed distances 
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
expected	TokenNameIdentifier	 expected
[	TokenNameLBRACKET	
x	TokenNameIdentifier	 x
]	TokenNameRBRACKET	
,	TokenNameCOMMA	
results	TokenNameIdentifier	 results
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
lastDistance	TokenNameIdentifier	 last Distance
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
results	TokenNameIdentifier	 results
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Document	TokenNameIdentifier	 Document
d	TokenNameIdentifier	 d
=	TokenNameEQUAL	
searcher	TokenNameIdentifier	 searcher
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
(	TokenNameLPAREN	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
name	TokenNameIdentifier	 name
=	TokenNameEQUAL	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"name"	TokenNameStringLiteral	name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
rsLat	TokenNameIdentifier	 rs Lat
=	TokenNameEQUAL	
NumericUtils	TokenNameIdentifier	 Numeric Utils
.	TokenNameDOT	
prefixCodedToDouble	TokenNameIdentifier	 prefix Coded To Double
(	TokenNameLPAREN	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
latField	TokenNameIdentifier	 lat Field
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
rsLng	TokenNameIdentifier	 rs Lng
=	TokenNameEQUAL	
NumericUtils	TokenNameIdentifier	 Numeric Utils
.	TokenNameDOT	
prefixCodedToDouble	TokenNameIdentifier	 prefix Coded To Double
(	TokenNameLPAREN	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
lngField	TokenNameIdentifier	 lng Field
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Double	TokenNameIdentifier	 Double
geo_distance	TokenNameIdentifier	 geo distance
=	TokenNameEQUAL	
distances	TokenNameIdentifier	 distances
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
distance	TokenNameIdentifier	 distance
=	TokenNameEQUAL	
DistanceUtils	TokenNameIdentifier	 Distance Utils
.	TokenNameDOT	
getDistanceMi	TokenNameIdentifier	 get Distance Mi
(	TokenNameLPAREN	
lat	TokenNameIdentifier	 lat
,	TokenNameCOMMA	
lng	TokenNameIdentifier	 lng
,	TokenNameCOMMA	
rsLat	TokenNameIdentifier	 rs Lat
,	TokenNameCOMMA	
rsLng	TokenNameIdentifier	 rs Lng
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
llm	TokenNameIdentifier	 llm
=	TokenNameEQUAL	
DistanceUtils	TokenNameIdentifier	 Distance Utils
.	TokenNameDOT	
getLLMDistance	TokenNameIdentifier	 get LLM Distance
(	TokenNameLPAREN	
lat	TokenNameIdentifier	 lat
,	TokenNameCOMMA	
lng	TokenNameIdentifier	 lng
,	TokenNameCOMMA	
rsLat	TokenNameIdentifier	 rs Lat
,	TokenNameCOMMA	
rsLng	TokenNameIdentifier	 rs Lng
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Name: "	TokenNameStringLiteral	Name: 
+	TokenNamePLUS	
name	TokenNameIdentifier	 name
+	TokenNamePLUS	
", Distance "	TokenNameStringLiteral	, Distance 
+	TokenNamePLUS	
distance	TokenNameIdentifier	 distance
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//(res, ortho, harvesine):"+ distance +" |"+ geo_distance +"|"+ llm +" | score "+ hits.score(i)); 	TokenNameCOMMENT_LINE	(res, ortho, harvesine):"+ distance +" |"+ geo_distance +"|"+ llm +" | score "+ hits.score(i)); 
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
Math	TokenNameIdentifier	 Math
.	TokenNameDOT	
abs	TokenNameIdentifier	 abs
(	TokenNameLPAREN	
(	TokenNameLPAREN	
distance	TokenNameIdentifier	 distance
-	TokenNameMINUS	
llm	TokenNameIdentifier	 llm
)	TokenNameRPAREN	
)	TokenNameRPAREN	
<	TokenNameLESS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
(	TokenNameLPAREN	
distance	TokenNameIdentifier	 distance
<	TokenNameLESS	
miles	TokenNameIdentifier	 miles
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
geo_distance	TokenNameIdentifier	 geo distance
>	TokenNameGREATER	
lastDistance	TokenNameIdentifier	 last Distance
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
lastDistance	TokenNameIdentifier	 last Distance
=	TokenNameEQUAL	
geo_distance	TokenNameIdentifier	 geo distance
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
searcher	TokenNameIdentifier	 searcher
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
reader	TokenNameIdentifier	 reader
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
testGeoHashRange	TokenNameIdentifier	 test Geo Hash Range
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
,	TokenNameCOMMA	
InvalidGeoException	TokenNameIdentifier	 Invalid Geo Exception
{	TokenNameLBRACE	
IndexReader	TokenNameIdentifier	 Index Reader
reader	TokenNameIdentifier	 reader
=	TokenNameEQUAL	
IndexReader	TokenNameIdentifier	 Index Reader
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
directory	TokenNameIdentifier	 directory
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
searcher	TokenNameIdentifier	 searcher
=	TokenNameEQUAL	
new	TokenNamenew	
IndexSearcher	TokenNameIdentifier	 Index Searcher
(	TokenNameLPAREN	
reader	TokenNameIdentifier	 reader
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
double	TokenNamedouble	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
milesToTest	TokenNameIdentifier	 miles To Test
=	TokenNameEQUAL	
new	TokenNamenew	
double	TokenNamedouble	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
{	TokenNameLBRACE	
6.0	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
0.5	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
0.001	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
0.0	TokenNameDoubleLiteral	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
expected	TokenNameIdentifier	 expected
=	TokenNameEQUAL	
new	TokenNamenew	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
{	TokenNameLBRACE	
7	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
x	TokenNameIdentifier	 x
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
x	TokenNameIdentifier	 x
<	TokenNameLESS	
expected	TokenNameIdentifier	 expected
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
x	TokenNameIdentifier	 x
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
double	TokenNamedouble	
miles	TokenNameIdentifier	 miles
=	TokenNameEQUAL	
milesToTest	TokenNameIdentifier	 miles To Test
[	TokenNameLBRACKET	
x	TokenNameIdentifier	 x
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
// create a distance query 	TokenNameCOMMENT_LINE	create a distance query 
final	TokenNamefinal	
DistanceQueryBuilder	TokenNameIdentifier	 Distance Query Builder
dq	TokenNameIdentifier	 dq
=	TokenNameEQUAL	
new	TokenNamenew	
DistanceQueryBuilder	TokenNameIdentifier	 Distance Query Builder
(	TokenNameLPAREN	
lat	TokenNameIdentifier	 lat
,	TokenNameCOMMA	
lng	TokenNameIdentifier	 lng
,	TokenNameCOMMA	
miles	TokenNameIdentifier	 miles
,	TokenNameCOMMA	
geoHashPrefix	TokenNameIdentifier	 geo Hash Prefix
,	TokenNameCOMMA	
CartesianTierPlotter	TokenNameIdentifier	 Cartesian Tier Plotter
.	TokenNameDOT	
DEFALT_FIELD_PREFIX	TokenNameIdentifier	 DEFALT  FIELD  PREFIX
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
2	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
15	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
dq	TokenNameIdentifier	 dq
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//create a term query to search against all documents 	TokenNameCOMMENT_LINE	create a term query to search against all documents 
Query	TokenNameIdentifier	 Query
tq	TokenNameIdentifier	 tq
=	TokenNameEQUAL	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"metafile"	TokenNameStringLiteral	metafile
,	TokenNameCOMMA	
"doc"	TokenNameStringLiteral	doc
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
FieldScoreQuery	TokenNameIdentifier	 Field Score Query
fsQuery	TokenNameIdentifier	 fs Query
=	TokenNameEQUAL	
new	TokenNamenew	
FieldScoreQuery	TokenNameIdentifier	 Field Score Query
(	TokenNameLPAREN	
"geo_distance"	TokenNameStringLiteral	geo_distance
,	TokenNameCOMMA	
Type	TokenNameIdentifier	 Type
.	TokenNameDOT	
FLOAT	TokenNameIdentifier	 FLOAT
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
CustomScoreQuery	TokenNameIdentifier	 Custom Score Query
customScore	TokenNameIdentifier	 custom Score
=	TokenNameEQUAL	
new	TokenNamenew	
CustomScoreQuery	TokenNameIdentifier	 Custom Score Query
(	TokenNameLPAREN	
tq	TokenNameIdentifier	 tq
,	TokenNameCOMMA	
fsQuery	TokenNameIdentifier	 fs Query
)	TokenNameRPAREN	
{	TokenNameLBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
protected	TokenNameprotected	
CustomScoreProvider	TokenNameIdentifier	 Custom Score Provider
getCustomScoreProvider	TokenNameIdentifier	 get Custom Score Provider
(	TokenNameLPAREN	
IndexReader	TokenNameIdentifier	 Index Reader
reader	TokenNameIdentifier	 reader
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
new	TokenNamenew	
CustomScoreProvider	TokenNameIdentifier	 Custom Score Provider
(	TokenNameLPAREN	
reader	TokenNameIdentifier	 reader
)	TokenNameRPAREN	
{	TokenNameLBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
// TODO: broken, as reader is not used! 	TokenNameCOMMENT_LINE	TODO: broken, as reader is not used! 
public	TokenNamepublic	
float	TokenNamefloat	
customScore	TokenNameIdentifier	 custom Score
(	TokenNameLPAREN	
int	TokenNameint	
doc	TokenNameIdentifier	 doc
,	TokenNameCOMMA	
float	TokenNamefloat	
subQueryScore	TokenNameIdentifier	 sub Query Score
,	TokenNameCOMMA	
float	TokenNamefloat	
valSrcScore	TokenNameIdentifier	 val Src Score
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
dq	TokenNameIdentifier	 dq
.	TokenNameDOT	
distanceFilter	TokenNameIdentifier	 distance Filter
.	TokenNameDOT	
getDistance	TokenNameIdentifier	 get Distance
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
return	TokenNamereturn	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
distance	TokenNameIdentifier	 distance
=	TokenNameEQUAL	
dq	TokenNameIdentifier	 dq
.	TokenNameDOT	
distanceFilter	TokenNameIdentifier	 distance Filter
.	TokenNameDOT	
getDistance	TokenNameIdentifier	 get Distance
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// boost score shouldn't exceed 1 	TokenNameCOMMENT_LINE	boost score shouldn't exceed 1 
if	TokenNameif	
(	TokenNameLPAREN	
distance	TokenNameIdentifier	 distance
<	TokenNameLESS	
1.0d	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
distance	TokenNameIdentifier	 distance
=	TokenNameEQUAL	
1.0d	TokenNameDoubleLiteral	
;	TokenNameSEMICOLON	
//boost by distance is invertly proportional to 	TokenNameCOMMENT_LINE	boost by distance is invertly proportional to 
// to distance from center point to location 	TokenNameCOMMENT_LINE	to distance from center point to location 
float	TokenNamefloat	
score	TokenNameIdentifier	 score
=	TokenNameEQUAL	
(	TokenNameLPAREN	
float	TokenNamefloat	
)	TokenNameRPAREN	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
miles	TokenNameIdentifier	 miles
-	TokenNameMINUS	
distance	TokenNameIdentifier	 distance
)	TokenNameRPAREN	
/	TokenNameDIVIDE	
miles	TokenNameIdentifier	 miles
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
score	TokenNameIdentifier	 score
*	TokenNameMULTIPLY	
subQueryScore	TokenNameIdentifier	 sub Query Score
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
// Create a distance sort 	TokenNameCOMMENT_LINE	Create a distance sort 
// As the radius filter has performed the distance calculations 	TokenNameCOMMENT_LINE	As the radius filter has performed the distance calculations 
// already, pass in the filter to reuse the results. 	TokenNameCOMMENT_LINE	already, pass in the filter to reuse the results. 
// 	TokenNameCOMMENT_LINE	 
//DistanceFieldComparatorSource dsort = new DistanceFieldComparatorSource(dq.distanceFilter); 	TokenNameCOMMENT_LINE	DistanceFieldComparatorSource dsort = new DistanceFieldComparatorSource(dq.distanceFilter); 
//Sort sort = new Sort(new SortField("foo", dsort)); 	TokenNameCOMMENT_LINE	Sort sort = new Sort(new SortField("foo", dsort)); 
// Perform the search, using the term query, the serial chain filter, and the 	TokenNameCOMMENT_LINE	Perform the search, using the term query, the serial chain filter, and the 
// distance sort 	TokenNameCOMMENT_LINE	distance sort 
TopDocs	TokenNameIdentifier	 Top Docs
hits	TokenNameIdentifier	 hits
=	TokenNameEQUAL	
searcher	TokenNameIdentifier	 searcher
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
customScore	TokenNameIdentifier	 custom Score
.	TokenNameDOT	
createWeight	TokenNameIdentifier	 create Weight
(	TokenNameLPAREN	
searcher	TokenNameIdentifier	 searcher
)	TokenNameRPAREN	
,	TokenNameCOMMA	
dq	TokenNameIdentifier	 dq
.	TokenNameDOT	
getFilter	TokenNameIdentifier	 get Filter
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
1000	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//,sort); 	TokenNameCOMMENT_LINE	,sort); 
int	TokenNameint	
results	TokenNameIdentifier	 results
=	TokenNameEQUAL	
hits	TokenNameIdentifier	 hits
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
;	TokenNameSEMICOLON	
ScoreDoc	TokenNameIdentifier	 Score Doc
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
scoreDocs	TokenNameIdentifier	 score Docs
=	TokenNameEQUAL	
hits	TokenNameIdentifier	 hits
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
;	TokenNameSEMICOLON	
// Get a list of distances 	TokenNameCOMMENT_LINE	Get a list of distances 
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
,	TokenNameCOMMA	
Double	TokenNameIdentifier	 Double
>	TokenNameGREATER	
distances	TokenNameIdentifier	 distances
=	TokenNameEQUAL	
dq	TokenNameIdentifier	 dq
.	TokenNameDOT	
distanceFilter	TokenNameIdentifier	 distance Filter
.	TokenNameDOT	
getDistances	TokenNameIdentifier	 get Distances
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// distances calculated from filter first pass must be less than total 	TokenNameCOMMENT_LINE	distances calculated from filter first pass must be less than total 
// docs, from the above test of 20 items, 12 will come from the boundary box 	TokenNameCOMMENT_LINE	docs, from the above test of 20 items, 12 will come from the boundary box 
// filter, but only 5 are actually in the radius of the results. 	TokenNameCOMMENT_LINE	filter, but only 5 are actually in the radius of the results. 
// Note Boundary Box filtering, is not accurate enough for most systems. 	TokenNameCOMMENT_LINE	Note Boundary Box filtering, is not accurate enough for most systems. 
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Distance Filter filtered: "	TokenNameStringLiteral	Distance Filter filtered: 
+	TokenNamePLUS	
distances	TokenNameIdentifier	 distances
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Results: "	TokenNameStringLiteral	Results: 
+	TokenNamePLUS	
results	TokenNameIdentifier	 results
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"============================="	TokenNameStringLiteral	=============================
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Distances should be 14 "	TokenNameStringLiteral	Distances should be 14 
+	TokenNamePLUS	
expected	TokenNameIdentifier	 expected
[	TokenNameLBRACKET	
x	TokenNameIdentifier	 x
]	TokenNameRBRACKET	
+	TokenNamePLUS	
":"	TokenNameStringLiteral	:
+	TokenNamePLUS	
distances	TokenNameIdentifier	 distances
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Results should be 7 "	TokenNameStringLiteral	Results should be 7 
+	TokenNamePLUS	
expected	TokenNameIdentifier	 expected
[	TokenNameLBRACKET	
x	TokenNameIdentifier	 x
]	TokenNameRBRACKET	
+	TokenNamePLUS	
":"	TokenNameStringLiteral	:
+	TokenNamePLUS	
results	TokenNameIdentifier	 results
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
expected	TokenNameIdentifier	 expected
[	TokenNameLBRACKET	
x	TokenNameIdentifier	 x
]	TokenNameRBRACKET	
,	TokenNameCOMMA	
distances	TokenNameIdentifier	 distances
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
expected	TokenNameIdentifier	 expected
[	TokenNameLBRACKET	
x	TokenNameIdentifier	 x
]	TokenNameRBRACKET	
,	TokenNameCOMMA	
results	TokenNameIdentifier	 results
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
results	TokenNameIdentifier	 results
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Document	TokenNameIdentifier	 Document
d	TokenNameIdentifier	 d
=	TokenNameEQUAL	
searcher	TokenNameIdentifier	 searcher
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
(	TokenNameLPAREN	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
name	TokenNameIdentifier	 name
=	TokenNameEQUAL	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"name"	TokenNameStringLiteral	name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
rsLat	TokenNameIdentifier	 rs Lat
=	TokenNameEQUAL	
NumericUtils	TokenNameIdentifier	 Numeric Utils
.	TokenNameDOT	
prefixCodedToDouble	TokenNameIdentifier	 prefix Coded To Double
(	TokenNameLPAREN	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
latField	TokenNameIdentifier	 lat Field
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
rsLng	TokenNameIdentifier	 rs Lng
=	TokenNameEQUAL	
NumericUtils	TokenNameIdentifier	 Numeric Utils
.	TokenNameDOT	
prefixCodedToDouble	TokenNameIdentifier	 prefix Coded To Double
(	TokenNameLPAREN	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
lngField	TokenNameIdentifier	 lng Field
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Double	TokenNameIdentifier	 Double
geo_distance	TokenNameIdentifier	 geo distance
=	TokenNameEQUAL	
distances	TokenNameIdentifier	 distances
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
distance	TokenNameIdentifier	 distance
=	TokenNameEQUAL	
DistanceUtils	TokenNameIdentifier	 Distance Utils
.	TokenNameDOT	
getDistanceMi	TokenNameIdentifier	 get Distance Mi
(	TokenNameLPAREN	
lat	TokenNameIdentifier	 lat
,	TokenNameCOMMA	
lng	TokenNameIdentifier	 lng
,	TokenNameCOMMA	
rsLat	TokenNameIdentifier	 rs Lat
,	TokenNameCOMMA	
rsLng	TokenNameIdentifier	 rs Lng
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
llm	TokenNameIdentifier	 llm
=	TokenNameEQUAL	
DistanceUtils	TokenNameIdentifier	 Distance Utils
.	TokenNameDOT	
getLLMDistance	TokenNameIdentifier	 get LLM Distance
(	TokenNameLPAREN	
lat	TokenNameIdentifier	 lat
,	TokenNameCOMMA	
lng	TokenNameIdentifier	 lng
,	TokenNameCOMMA	
rsLat	TokenNameIdentifier	 rs Lat
,	TokenNameCOMMA	
rsLng	TokenNameIdentifier	 rs Lng
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Name: "	TokenNameStringLiteral	Name: 
+	TokenNamePLUS	
name	TokenNameIdentifier	 name
+	TokenNamePLUS	
", Distance (res, ortho, harvesine):"	TokenNameStringLiteral	, Distance (res, ortho, harvesine):
+	TokenNamePLUS	
distance	TokenNameIdentifier	 distance
+	TokenNamePLUS	
" |"	TokenNameStringLiteral	 |
+	TokenNamePLUS	
geo_distance	TokenNameIdentifier	 geo distance
+	TokenNamePLUS	
"|"	TokenNameStringLiteral	|
+	TokenNamePLUS	
llm	TokenNameIdentifier	 llm
+	TokenNamePLUS	
" | score "	TokenNameStringLiteral	 | score 
+	TokenNamePLUS	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
.	TokenNameDOT	
score	TokenNameIdentifier	 score
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
Math	TokenNameIdentifier	 Math
.	TokenNameDOT	
abs	TokenNameIdentifier	 abs
(	TokenNameLPAREN	
(	TokenNameLPAREN	
distance	TokenNameIdentifier	 distance
-	TokenNameMINUS	
llm	TokenNameIdentifier	 llm
)	TokenNameRPAREN	
)	TokenNameRPAREN	
<	TokenNameLESS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
(	TokenNameLPAREN	
distance	TokenNameIdentifier	 distance
<	TokenNameLESS	
miles	TokenNameIdentifier	 miles
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
searcher	TokenNameIdentifier	 searcher
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
reader	TokenNameIdentifier	 reader
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
