/* * Licensed to the Apache Software Foundation (ASF) under one * or more contributor license agreements. See the NOTICE file * distributed with this work for additional information * regarding copyright ownership. The ASF licenses this file * to you under the Apache License, Version 2.0 (the * "License"); you may not use this file except in compliance * with the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */	TokenNameCOMMENT_BLOCK	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
DataInputStream	TokenNameIdentifier	 Data Input Stream
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
DataOutputStream	TokenNameIdentifier	 Data Output Stream
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
IOException	TokenNameIdentifier	 IO Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
net	TokenNameIdentifier	 net
.	TokenNameDOT	
InetAddress	TokenNameIdentifier	 Inet Address
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
nio	TokenNameIdentifier	 nio
.	TokenNameDOT	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
nio	TokenNameIdentifier	 nio
.	TokenNameDOT	
charset	TokenNameIdentifier	 charset
.	TokenNameDOT	
CharacterCodingException	TokenNameIdentifier	 Character Coding Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
ExecutionException	TokenNameIdentifier	 Execution Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
com	TokenNameIdentifier	 com
.	TokenNameDOT	
google	TokenNameIdentifier	 google
.	TokenNameDOT	
common	TokenNameIdentifier	 common
.	TokenNameDOT	
collect	TokenNameIdentifier	 collect
.	TokenNameDOT	
HashMultimap	TokenNameIdentifier	 Hash Multimap
;	TokenNameSEMICOLON	
import	TokenNameimport	
com	TokenNameIdentifier	 com
.	TokenNameDOT	
google	TokenNameIdentifier	 google
.	TokenNameDOT	
common	TokenNameIdentifier	 common
.	TokenNameDOT	
collect	TokenNameIdentifier	 collect
.	TokenNameDOT	
SetMultimap	TokenNameIdentifier	 Set Multimap
;	TokenNameSEMICOLON	
import	TokenNameimport	
com	TokenNameIdentifier	 com
.	TokenNameDOT	
google	TokenNameIdentifier	 google
.	TokenNameDOT	
common	TokenNameIdentifier	 common
.	TokenNameDOT	
collect	TokenNameIdentifier	 collect
.	TokenNameDOT	
Sets	TokenNameIdentifier	 Sets
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
Logger	TokenNameIdentifier	 Logger
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
LoggerFactory	TokenNameIdentifier	 Logger Factory
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
avro	TokenNameIdentifier	 avro
.	TokenNameDOT	
ipc	TokenNameIdentifier	 ipc
.	TokenNameDOT	
ByteBufferInputStream	TokenNameIdentifier	 Byte Buffer Input Stream
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
config	TokenNameIdentifier	 config
.	TokenNameDOT	
KSMetaData	TokenNameIdentifier	 KS Meta Data
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
config	TokenNameIdentifier	 config
.	TokenNameDOT	
Schema	TokenNameIdentifier	 Schema
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
commitlog	TokenNameIdentifier	 commitlog
.	TokenNameDOT	
ReplayPosition	TokenNameIdentifier	 Replay Position
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
marshal	TokenNameIdentifier	 marshal
.	TokenNameDOT	
UUIDType	TokenNameIdentifier	 UUID Type
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
exceptions	TokenNameIdentifier	 exceptions
.	TokenNameDOT	
ConfigurationException	TokenNameIdentifier	 Configuration Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
config	TokenNameIdentifier	 config
.	TokenNameDOT	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
cql3	TokenNameIdentifier	 cql3
.	TokenNameDOT	
QueryProcessor	TokenNameIdentifier	 Query Processor
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
cql3	TokenNameIdentifier	 cql3
.	TokenNameDOT	
UntypedResultSet	TokenNameIdentifier	 Untyped Result Set
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
columniterator	TokenNameIdentifier	 columniterator
.	TokenNameDOT	
IdentityQueryFilter	TokenNameIdentifier	 Identity Query Filter
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
filter	TokenNameIdentifier	 filter
.	TokenNameDOT	
QueryFilter	TokenNameIdentifier	 Query Filter
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
filter	TokenNameIdentifier	 filter
.	TokenNameDOT	
QueryPath	TokenNameIdentifier	 Query Path
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
marshal	TokenNameIdentifier	 marshal
.	TokenNameDOT	
AsciiType	TokenNameIdentifier	 Ascii Type
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
marshal	TokenNameIdentifier	 marshal
.	TokenNameDOT	
BytesType	TokenNameIdentifier	 Bytes Type
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
marshal	TokenNameIdentifier	 marshal
.	TokenNameDOT	
UTF8Type	TokenNameIdentifier	 UT F8 Type
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
dht	TokenNameIdentifier	 dht
.	TokenNameDOT	
Range	TokenNameIdentifier	 Range
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
dht	TokenNameIdentifier	 dht
.	TokenNameDOT	
Token	TokenNameIdentifier	 Token
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
DataOutputBuffer	TokenNameIdentifier	 Data Output Buffer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
FastByteArrayOutputStream	TokenNameIdentifier	 Fast Byte Array Output Stream
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
locator	TokenNameIdentifier	 locator
.	TokenNameDOT	
IEndpointSnitch	TokenNameIdentifier	 I Endpoint Snitch
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
service	TokenNameIdentifier	 service
.	TokenNameDOT	
StorageService	TokenNameIdentifier	 Storage Service
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
Constants	TokenNameIdentifier	 Constants
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
CounterId	TokenNameIdentifier	 Counter Id
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
FBUtilities	TokenNameIdentifier	 FB Utilities
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
Pair	TokenNameIdentifier	 Pair
;	TokenNameSEMICOLON	
import	TokenNameimport	
static	TokenNamestatic	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
cql3	TokenNameIdentifier	 cql3
.	TokenNameDOT	
QueryProcessor	TokenNameIdentifier	 Query Processor
.	TokenNameDOT	
processInternal	TokenNameIdentifier	 process Internal
;	TokenNameSEMICOLON	
public	TokenNamepublic	
class	TokenNameclass	
SystemTable	TokenNameIdentifier	 System Table
{	TokenNameLBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
Logger	TokenNameIdentifier	 Logger
logger	TokenNameIdentifier	 logger
=	TokenNameEQUAL	
LoggerFactory	TokenNameIdentifier	 Logger Factory
.	TokenNameDOT	
getLogger	TokenNameIdentifier	 get Logger
(	TokenNameLPAREN	
SystemTable	TokenNameIdentifier	 System Table
.	TokenNameDOT	
class	TokenNameclass	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// see CFMetaData for schema definitions 	TokenNameCOMMENT_LINE	see CFMetaData for schema definitions 
public	TokenNamepublic	
static	TokenNamestatic	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
PEERS_CF	TokenNameIdentifier	 PEERS  CF
=	TokenNameEQUAL	
"peers"	TokenNameStringLiteral	peers
;	TokenNameSEMICOLON	
public	TokenNamepublic	
static	TokenNamestatic	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
LOCAL_CF	TokenNameIdentifier	 LOCAL  CF
=	TokenNameEQUAL	
"local"	TokenNameStringLiteral	local
;	TokenNameSEMICOLON	
public	TokenNamepublic	
static	TokenNamestatic	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
INDEX_CF	TokenNameIdentifier	 INDEX  CF
=	TokenNameEQUAL	
"IndexInfo"	TokenNameStringLiteral	IndexInfo
;	TokenNameSEMICOLON	
public	TokenNamepublic	
static	TokenNamestatic	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
COUNTER_ID_CF	TokenNameIdentifier	 COUNTER  ID  CF
=	TokenNameEQUAL	
"NodeIdInfo"	TokenNameStringLiteral	NodeIdInfo
;	TokenNameSEMICOLON	
public	TokenNamepublic	
static	TokenNamestatic	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
HINTS_CF	TokenNameIdentifier	 HINTS  CF
=	TokenNameEQUAL	
"hints"	TokenNameStringLiteral	hints
;	TokenNameSEMICOLON	
public	TokenNamepublic	
static	TokenNamestatic	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
RANGE_XFERS_CF	TokenNameIdentifier	 RANGE  XFERS  CF
=	TokenNameEQUAL	
"range_xfers"	TokenNameStringLiteral	range_xfers
;	TokenNameSEMICOLON	
public	TokenNamepublic	
static	TokenNamestatic	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
BATCHLOG_CF	TokenNameIdentifier	 BATCHLOG  CF
=	TokenNameEQUAL	
"batchlog"	TokenNameStringLiteral	batchlog
;	TokenNameSEMICOLON	
// see layout description in the DefsTable class header 	TokenNameCOMMENT_LINE	see layout description in the DefsTable class header 
public	TokenNamepublic	
static	TokenNamestatic	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
SCHEMA_KEYSPACES_CF	TokenNameIdentifier	 SCHEMA  KEYSPACES  CF
=	TokenNameEQUAL	
"schema_keyspaces"	TokenNameStringLiteral	schema_keyspaces
;	TokenNameSEMICOLON	
public	TokenNamepublic	
static	TokenNamestatic	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
SCHEMA_COLUMNFAMILIES_CF	TokenNameIdentifier	 SCHEMA  COLUMNFAMILIES  CF
=	TokenNameEQUAL	
"schema_columnfamilies"	TokenNameStringLiteral	schema_columnfamilies
;	TokenNameSEMICOLON	
public	TokenNamepublic	
static	TokenNamestatic	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
SCHEMA_COLUMNS_CF	TokenNameIdentifier	 SCHEMA  COLUMNS  CF
=	TokenNameEQUAL	
"schema_columns"	TokenNameStringLiteral	schema_columns
;	TokenNameSEMICOLON	
@	TokenNameAT	
Deprecated	TokenNameIdentifier	 Deprecated
public	TokenNamepublic	
static	TokenNamestatic	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
OLD_STATUS_CF	TokenNameIdentifier	 OLD  STATUS  CF
=	TokenNameEQUAL	
"LocationInfo"	TokenNameStringLiteral	LocationInfo
;	TokenNameSEMICOLON	
@	TokenNameAT	
Deprecated	TokenNameIdentifier	 Deprecated
public	TokenNamepublic	
static	TokenNamestatic	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
OLD_HINTS_CF	TokenNameIdentifier	 OLD  HINTS  CF
=	TokenNameEQUAL	
"HintsColumnFamily"	TokenNameStringLiteral	HintsColumnFamily
;	TokenNameSEMICOLON	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
LOCAL_KEY	TokenNameIdentifier	 LOCAL  KEY
=	TokenNameEQUAL	
"local"	TokenNameStringLiteral	local
;	TokenNameSEMICOLON	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
CURRENT_LOCAL_NODE_ID_KEY	TokenNameIdentifier	 CURRENT  LOCAL  NODE  ID  KEY
=	TokenNameEQUAL	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
bytes	TokenNameIdentifier	 bytes
(	TokenNameLPAREN	
"CurrentLocal"	TokenNameStringLiteral	CurrentLocal
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
ALL_LOCAL_NODE_ID_KEY	TokenNameIdentifier	 ALL  LOCAL  NODE  ID  KEY
=	TokenNameEQUAL	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
bytes	TokenNameIdentifier	 bytes
(	TokenNameLPAREN	
"Local"	TokenNameStringLiteral	Local
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
public	TokenNamepublic	
enum	TokenNameenum	
BootstrapState	TokenNameIdentifier	 Bootstrap State
{	TokenNameLBRACE	
NEEDS_BOOTSTRAP	TokenNameIdentifier	 NEEDS  BOOTSTRAP
,	TokenNameCOMMA	
COMPLETED	TokenNameIdentifier	 COMPLETED
,	TokenNameCOMMA	
IN_PROGRESS	TokenNameIdentifier	 IN  PROGRESS
}	TokenNameRBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
DecoratedKey	TokenNameIdentifier	 Decorated Key
decorate	TokenNameIdentifier	 decorate
(	TokenNameLPAREN	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
key	TokenNameIdentifier	 key
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
StorageService	TokenNameIdentifier	 Storage Service
.	TokenNameDOT	
getPartitioner	TokenNameIdentifier	 get Partitioner
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
decorateKey	TokenNameIdentifier	 decorate Key
(	TokenNameLPAREN	
key	TokenNameIdentifier	 key
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
void	TokenNamevoid	
finishStartup	TokenNameIdentifier	 finish Startup
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
DefsTable	TokenNameIdentifier	 Defs Table
.	TokenNameDOT	
fixSchemaNanoTimestamps	TokenNameIdentifier	 fix Schema Nano Timestamps
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
setupVersion	TokenNameIdentifier	 setup Version
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
upgradeSystemData	TokenNameIdentifier	 upgrade System Data
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
ExecutionException	TokenNameIdentifier	 Execution Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
InterruptedException	TokenNameIdentifier	 Interrupted Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// add entries to system schema columnfamilies for the hardcoded system definitions 	TokenNameCOMMENT_LINE	add entries to system schema columnfamilies for the hardcoded system definitions 
for	TokenNamefor	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
ksname	TokenNameIdentifier	 ksname
:	TokenNameCOLON	
Schema	TokenNameIdentifier	 Schema
.	TokenNameDOT	
systemKeyspaceNames	TokenNameIdentifier	 system Keyspace Names
)	TokenNameRPAREN	
{	TokenNameLBRACE	
KSMetaData	TokenNameIdentifier	 KS Meta Data
ksmd	TokenNameIdentifier	 ksmd
=	TokenNameEQUAL	
Schema	TokenNameIdentifier	 Schema
.	TokenNameDOT	
instance	TokenNameIdentifier	 instance
.	TokenNameDOT	
getKSMetaData	TokenNameIdentifier	 get KS Meta Data
(	TokenNameLPAREN	
ksname	TokenNameIdentifier	 ksname
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// delete old, possibly obsolete entries in schema columnfamilies 	TokenNameCOMMENT_LINE	delete old, possibly obsolete entries in schema columnfamilies 
for	TokenNamefor	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
cfname	TokenNameIdentifier	 cfname
:	TokenNameCOLON	
Arrays	TokenNameIdentifier	 Arrays
.	TokenNameDOT	
asList	TokenNameIdentifier	 as List
(	TokenNameLPAREN	
SystemTable	TokenNameIdentifier	 System Table
.	TokenNameDOT	
SCHEMA_KEYSPACES_CF	TokenNameIdentifier	 SCHEMA  KEYSPACES  CF
,	TokenNameCOMMA	
SystemTable	TokenNameIdentifier	 System Table
.	TokenNameDOT	
SCHEMA_COLUMNFAMILIES_CF	TokenNameIdentifier	 SCHEMA  COLUMNFAMILIES  CF
,	TokenNameCOMMA	
SystemTable	TokenNameIdentifier	 System Table
.	TokenNameDOT	
SCHEMA_COLUMNS_CF	TokenNameIdentifier	 SCHEMA  COLUMNS  CF
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
req	TokenNameIdentifier	 req
=	TokenNameEQUAL	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"DELETE FROM system.%s WHERE keyspace_name = '%s'"	TokenNameStringLiteral	DELETE FROM system.%s WHERE keyspace_name = '%s'
,	TokenNameCOMMA	
cfname	TokenNameIdentifier	 cfname
,	TokenNameCOMMA	
ksmd	TokenNameIdentifier	 ksmd
.	TokenNameDOT	
name	TokenNameIdentifier	 name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
processInternal	TokenNameIdentifier	 process Internal
(	TokenNameLPAREN	
req	TokenNameIdentifier	 req
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// (+1 to timestamp to make sure we don't get shadowed by the tombstones we just added) 	TokenNameCOMMENT_LINE	(+1 to timestamp to make sure we don't get shadowed by the tombstones we just added) 
ksmd	TokenNameIdentifier	 ksmd
.	TokenNameDOT	
toSchema	TokenNameIdentifier	 to Schema
(	TokenNameLPAREN	
FBUtilities	TokenNameIdentifier	 FB Utilities
.	TokenNameDOT	
timestampMicros	TokenNameIdentifier	 timestamp Micros
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
.	TokenNameDOT	
apply	TokenNameIdentifier	 apply
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
void	TokenNamevoid	
setupVersion	TokenNameIdentifier	 setup Version
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
req	TokenNameIdentifier	 req
=	TokenNameEQUAL	
"INSERT INTO system.%s (key, release_version, cql_version, thrift_version, data_center, rack, partitioner) VALUES ('%s', '%s', '%s', '%s', '%s', '%s', '%s')"	TokenNameStringLiteral	INSERT INTO system.%s (key, release_version, cql_version, thrift_version, data_center, rack, partitioner) VALUES ('%s', '%s', '%s', '%s', '%s', '%s', '%s')
;	TokenNameSEMICOLON	
IEndpointSnitch	TokenNameIdentifier	 I Endpoint Snitch
snitch	TokenNameIdentifier	 snitch
=	TokenNameEQUAL	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
.	TokenNameDOT	
getEndpointSnitch	TokenNameIdentifier	 get Endpoint Snitch
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
processInternal	TokenNameIdentifier	 process Internal
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
req	TokenNameIdentifier	 req
,	TokenNameCOMMA	
LOCAL_CF	TokenNameIdentifier	 LOCAL  CF
,	TokenNameCOMMA	
LOCAL_KEY	TokenNameIdentifier	 LOCAL  KEY
,	TokenNameCOMMA	
FBUtilities	TokenNameIdentifier	 FB Utilities
.	TokenNameDOT	
getReleaseVersionString	TokenNameIdentifier	 get Release Version String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
QueryProcessor	TokenNameIdentifier	 Query Processor
.	TokenNameDOT	
CQL_VERSION	TokenNameIdentifier	 CQL  VERSION
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Constants	TokenNameIdentifier	 Constants
.	TokenNameDOT	
VERSION	TokenNameIdentifier	 VERSION
,	TokenNameCOMMA	
snitch	TokenNameIdentifier	 snitch
.	TokenNameDOT	
getDatacenter	TokenNameIdentifier	 get Datacenter
(	TokenNameLPAREN	
FBUtilities	TokenNameIdentifier	 FB Utilities
.	TokenNameDOT	
getBroadcastAddress	TokenNameIdentifier	 get Broadcast Address
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
snitch	TokenNameIdentifier	 snitch
.	TokenNameDOT	
getRack	TokenNameIdentifier	 get Rack
(	TokenNameLPAREN	
FBUtilities	TokenNameIdentifier	 FB Utilities
.	TokenNameDOT	
getBroadcastAddress	TokenNameIdentifier	 get Broadcast Address
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
.	TokenNameDOT	
getPartitioner	TokenNameIdentifier	 get Partitioner
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getClass	TokenNameIdentifier	 get Class
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getName	TokenNameIdentifier	 get Name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** if system data becomes incompatible across versions of cassandra, that logic (and associated purging) is managed here */	TokenNameCOMMENT_JAVADOC	 if system data becomes incompatible across versions of cassandra, that logic (and associated purging) is managed here 
private	TokenNameprivate	
static	TokenNamestatic	
void	TokenNamevoid	
upgradeSystemData	TokenNameIdentifier	 upgrade System Data
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
ExecutionException	TokenNameIdentifier	 Execution Exception
,	TokenNameCOMMA	
InterruptedException	TokenNameIdentifier	 Interrupted Exception
{	TokenNameLBRACE	
Table	TokenNameIdentifier	 Table
table	TokenNameIdentifier	 table
=	TokenNameEQUAL	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
SYSTEM_KS	TokenNameIdentifier	 SYSTEM  KS
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
oldStatusCfs	TokenNameIdentifier	 old Status Cfs
=	TokenNameEQUAL	
table	TokenNameIdentifier	 table
.	TokenNameDOT	
getColumnFamilyStore	TokenNameIdentifier	 get Column Family Store
(	TokenNameLPAREN	
OLD_STATUS_CF	TokenNameIdentifier	 OLD  STATUS  CF
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
oldStatusCfs	TokenNameIdentifier	 old Status Cfs
.	TokenNameDOT	
getSSTables	TokenNameIdentifier	 get SS Tables
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
>	TokenNameGREATER	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
SortedSet	TokenNameIdentifier	 Sorted Set
<	TokenNameLESS	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
>	TokenNameGREATER	
cols	TokenNameIdentifier	 cols
=	TokenNameEQUAL	
new	TokenNamenew	
TreeSet	TokenNameIdentifier	 Tree Set
<	TokenNameLESS	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
>	TokenNameGREATER	
(	TokenNameLPAREN	
BytesType	TokenNameIdentifier	 Bytes Type
.	TokenNameDOT	
instance	TokenNameIdentifier	 instance
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
cols	TokenNameIdentifier	 cols
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
bytes	TokenNameIdentifier	 bytes
(	TokenNameLPAREN	
"ClusterName"	TokenNameStringLiteral	ClusterName
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
cols	TokenNameIdentifier	 cols
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
bytes	TokenNameIdentifier	 bytes
(	TokenNameLPAREN	
"Token"	TokenNameStringLiteral	Token
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
QueryFilter	TokenNameIdentifier	 Query Filter
filter	TokenNameIdentifier	 filter
=	TokenNameEQUAL	
QueryFilter	TokenNameIdentifier	 Query Filter
.	TokenNameDOT	
getNamesFilter	TokenNameIdentifier	 get Names Filter
(	TokenNameLPAREN	
decorate	TokenNameIdentifier	 decorate
(	TokenNameLPAREN	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
bytes	TokenNameIdentifier	 bytes
(	TokenNameLPAREN	
"L"	TokenNameStringLiteral	L
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
new	TokenNamenew	
QueryPath	TokenNameIdentifier	 Query Path
(	TokenNameLPAREN	
OLD_STATUS_CF	TokenNameIdentifier	 OLD  STATUS  CF
)	TokenNameRPAREN	
,	TokenNameCOMMA	
cols	TokenNameIdentifier	 cols
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ColumnFamily	TokenNameIdentifier	 Column Family
oldCf	TokenNameIdentifier	 old Cf
=	TokenNameEQUAL	
oldStatusCfs	TokenNameIdentifier	 old Status Cfs
.	TokenNameDOT	
getColumnFamily	TokenNameIdentifier	 get Column Family
(	TokenNameLPAREN	
filter	TokenNameIdentifier	 filter
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Iterator	TokenNameIdentifier	 Iterator
<	TokenNameLESS	
IColumn	TokenNameIdentifier	 I Column
>	TokenNameGREATER	
oldColumns	TokenNameIdentifier	 old Columns
=	TokenNameEQUAL	
oldCf	TokenNameIdentifier	 old Cf
.	TokenNameDOT	
columns	TokenNameIdentifier	 columns
.	TokenNameDOT	
iterator	TokenNameIdentifier	 iterator
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
clusterName	TokenNameIdentifier	 cluster Name
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
clusterName	TokenNameIdentifier	 cluster Name
=	TokenNameEQUAL	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
string	TokenNameIdentifier	 string
(	TokenNameLPAREN	
oldColumns	TokenNameIdentifier	 old Columns
.	TokenNameDOT	
next	TokenNameIdentifier	 next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
value	TokenNameIdentifier	 value
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
CharacterCodingException	TokenNameIdentifier	 Character Coding Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// serialize the old token as a collection of (one )tokens. 	TokenNameCOMMENT_LINE	serialize the old token as a collection of (one )tokens. 
Token	TokenNameIdentifier	 Token
token	TokenNameIdentifier	 token
=	TokenNameEQUAL	
StorageService	TokenNameIdentifier	 Storage Service
.	TokenNameDOT	
getPartitioner	TokenNameIdentifier	 get Partitioner
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getTokenFactory	TokenNameIdentifier	 get Token Factory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
fromByteArray	TokenNameIdentifier	 from Byte Array
(	TokenNameLPAREN	
oldColumns	TokenNameIdentifier	 old Columns
.	TokenNameDOT	
next	TokenNameIdentifier	 next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
value	TokenNameIdentifier	 value
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
tokenBytes	TokenNameIdentifier	 token Bytes
=	TokenNameEQUAL	
tokensAsSet	TokenNameIdentifier	 tokens As Set
(	TokenNameLPAREN	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
singleton	TokenNameIdentifier	 singleton
(	TokenNameLPAREN	
token	TokenNameIdentifier	 token
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// (assume that any node getting upgraded was bootstrapped, since that was stored in a separate row for no particular reason) 	TokenNameCOMMENT_LINE	(assume that any node getting upgraded was bootstrapped, since that was stored in a separate row for no particular reason) 
String	TokenNameIdentifier	 String
req	TokenNameIdentifier	 req
=	TokenNameEQUAL	
"INSERT INTO system.%s (key, cluster_name, tokens, bootstrapped) VALUES ('%s', '%s', %s, '%s')"	TokenNameStringLiteral	INSERT INTO system.%s (key, cluster_name, tokens, bootstrapped) VALUES ('%s', '%s', %s, '%s')
;	TokenNameSEMICOLON	
processInternal	TokenNameIdentifier	 process Internal
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
req	TokenNameIdentifier	 req
,	TokenNameCOMMA	
LOCAL_CF	TokenNameIdentifier	 LOCAL  CF
,	TokenNameCOMMA	
LOCAL_KEY	TokenNameIdentifier	 LOCAL  KEY
,	TokenNameCOMMA	
clusterName	TokenNameIdentifier	 cluster Name
,	TokenNameCOMMA	
tokenBytes	TokenNameIdentifier	 token Bytes
,	TokenNameCOMMA	
BootstrapState	TokenNameIdentifier	 Bootstrap State
.	TokenNameDOT	
COMPLETED	TokenNameIdentifier	 COMPLETED
.	TokenNameDOT	
name	TokenNameIdentifier	 name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
oldStatusCfs	TokenNameIdentifier	 old Status Cfs
.	TokenNameDOT	
truncate	TokenNameIdentifier	 truncate
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
oldHintsCfs	TokenNameIdentifier	 old Hints Cfs
=	TokenNameEQUAL	
table	TokenNameIdentifier	 table
.	TokenNameDOT	
getColumnFamilyStore	TokenNameIdentifier	 get Column Family Store
(	TokenNameLPAREN	
OLD_HINTS_CF	TokenNameIdentifier	 OLD  HINTS  CF
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
oldHintsCfs	TokenNameIdentifier	 old Hints Cfs
.	TokenNameDOT	
getSSTables	TokenNameIdentifier	 get SS Tables
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
>	TokenNameGREATER	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
info	TokenNameIdentifier	 info
(	TokenNameLPAREN	
"Possible old-format hints found. Truncating"	TokenNameStringLiteral	Possible old-format hints found. Truncating
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
oldHintsCfs	TokenNameIdentifier	 old Hints Cfs
.	TokenNameDOT	
truncate	TokenNameIdentifier	 truncate
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
void	TokenNamevoid	
saveTruncationPosition	TokenNameIdentifier	 save Truncation Position
(	TokenNameLPAREN	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
cfs	TokenNameIdentifier	 cfs
,	TokenNameCOMMA	
ReplayPosition	TokenNameIdentifier	 Replay Position
position	TokenNameIdentifier	 position
)	TokenNameRPAREN	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
req	TokenNameIdentifier	 req
=	TokenNameEQUAL	
"UPDATE system.%s SET truncated_at = truncated_at + %s WHERE key = '%s'"	TokenNameStringLiteral	UPDATE system.%s SET truncated_at = truncated_at + %s WHERE key = '%s'
;	TokenNameSEMICOLON	
processInternal	TokenNameIdentifier	 process Internal
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
req	TokenNameIdentifier	 req
,	TokenNameCOMMA	
LOCAL_CF	TokenNameIdentifier	 LOCAL  CF
,	TokenNameCOMMA	
positionAsMapEntry	TokenNameIdentifier	 position As Map Entry
(	TokenNameLPAREN	
cfs	TokenNameIdentifier	 cfs
,	TokenNameCOMMA	
position	TokenNameIdentifier	 position
)	TokenNameRPAREN	
,	TokenNameCOMMA	
LOCAL_KEY	TokenNameIdentifier	 LOCAL  KEY
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
forceBlockingFlush	TokenNameIdentifier	 force Blocking Flush
(	TokenNameLPAREN	
LOCAL_CF	TokenNameIdentifier	 LOCAL  CF
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
String	TokenNameIdentifier	 String
positionAsMapEntry	TokenNameIdentifier	 position As Map Entry
(	TokenNameLPAREN	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
cfs	TokenNameIdentifier	 cfs
,	TokenNameCOMMA	
ReplayPosition	TokenNameIdentifier	 Replay Position
position	TokenNameIdentifier	 position
)	TokenNameRPAREN	
{	TokenNameLBRACE	
DataOutputBuffer	TokenNameIdentifier	 Data Output Buffer
out	TokenNameIdentifier	 out
=	TokenNameEQUAL	
new	TokenNamenew	
DataOutputBuffer	TokenNameIdentifier	 Data Output Buffer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
ReplayPosition	TokenNameIdentifier	 Replay Position
.	TokenNameDOT	
serializer	TokenNameIdentifier	 serializer
.	TokenNameDOT	
serialize	TokenNameIdentifier	 serialize
(	TokenNameLPAREN	
position	TokenNameIdentifier	 position
,	TokenNameCOMMA	
out	TokenNameIdentifier	 out
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
IOException	TokenNameIdentifier	 IO Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"{'%s': '%s'}"	TokenNameStringLiteral	{'%s': '%s'}
,	TokenNameCOMMA	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
metadata	TokenNameIdentifier	 metadata
.	TokenNameDOT	
cfId	TokenNameIdentifier	 cf Id
,	TokenNameCOMMA	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
bytesToHex	TokenNameIdentifier	 bytes To Hex
(	TokenNameLPAREN	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
.	TokenNameDOT	
wrap	TokenNameIdentifier	 wrap
(	TokenNameLPAREN	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
getData	TokenNameIdentifier	 get Data
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
getLength	TokenNameIdentifier	 get Length
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
UUID	TokenNameIdentifier	 UUID
,	TokenNameCOMMA	
ReplayPosition	TokenNameIdentifier	 Replay Position
>	TokenNameGREATER	
getTruncationPositions	TokenNameIdentifier	 get Truncation Positions
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
req	TokenNameIdentifier	 req
=	TokenNameEQUAL	
"SELECT truncated_at FROM system.%s WHERE key = '%s'"	TokenNameStringLiteral	SELECT truncated_at FROM system.%s WHERE key = '%s'
;	TokenNameSEMICOLON	
UntypedResultSet	TokenNameIdentifier	 Untyped Result Set
rows	TokenNameIdentifier	 rows
=	TokenNameEQUAL	
processInternal	TokenNameIdentifier	 process Internal
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
req	TokenNameIdentifier	 req
,	TokenNameCOMMA	
LOCAL_CF	TokenNameIdentifier	 LOCAL  CF
,	TokenNameCOMMA	
LOCAL_KEY	TokenNameIdentifier	 LOCAL  KEY
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
rows	TokenNameIdentifier	 rows
.	TokenNameDOT	
isEmpty	TokenNameIdentifier	 is Empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
return	TokenNamereturn	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
emptyMap	TokenNameIdentifier	 empty Map
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
UntypedResultSet	TokenNameIdentifier	 Untyped Result Set
.	TokenNameDOT	
Row	TokenNameIdentifier	 Row
row	TokenNameIdentifier	 row
=	TokenNameEQUAL	
rows	TokenNameIdentifier	 rows
.	TokenNameDOT	
one	TokenNameIdentifier	 one
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
UUID	TokenNameIdentifier	 UUID
,	TokenNameCOMMA	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
>	TokenNameGREATER	
rawMap	TokenNameIdentifier	 raw Map
=	TokenNameEQUAL	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
getMap	TokenNameIdentifier	 get Map
(	TokenNameLPAREN	
"truncated_at"	TokenNameStringLiteral	truncated_at
,	TokenNameCOMMA	
UUIDType	TokenNameIdentifier	 UUID Type
.	TokenNameDOT	
instance	TokenNameIdentifier	 instance
,	TokenNameCOMMA	
BytesType	TokenNameIdentifier	 Bytes Type
.	TokenNameDOT	
instance	TokenNameIdentifier	 instance
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
rawMap	TokenNameIdentifier	 raw Map
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
return	TokenNamereturn	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
emptyMap	TokenNameIdentifier	 empty Map
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
UUID	TokenNameIdentifier	 UUID
,	TokenNameCOMMA	
ReplayPosition	TokenNameIdentifier	 Replay Position
>	TokenNameGREATER	
positions	TokenNameIdentifier	 positions
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
UUID	TokenNameIdentifier	 UUID
,	TokenNameCOMMA	
ReplayPosition	TokenNameIdentifier	 Replay Position
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
Map	TokenNameIdentifier	 Map
.	TokenNameDOT	
Entry	TokenNameIdentifier	 Entry
<	TokenNameLESS	
UUID	TokenNameIdentifier	 UUID
,	TokenNameCOMMA	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
>	TokenNameGREATER	
entry	TokenNameIdentifier	 entry
:	TokenNameCOLON	
rawMap	TokenNameIdentifier	 raw Map
.	TokenNameDOT	
entrySet	TokenNameIdentifier	 entry Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
positions	TokenNameIdentifier	 positions
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
entry	TokenNameIdentifier	 entry
.	TokenNameDOT	
getKey	TokenNameIdentifier	 get Key
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
positionFromBlob	TokenNameIdentifier	 position From Blob
(	TokenNameLPAREN	
entry	TokenNameIdentifier	 entry
.	TokenNameDOT	
getValue	TokenNameIdentifier	 get Value
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
positions	TokenNameIdentifier	 positions
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
ReplayPosition	TokenNameIdentifier	 Replay Position
positionFromBlob	TokenNameIdentifier	 position From Blob
(	TokenNameLPAREN	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
bytes	TokenNameIdentifier	 bytes
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
return	TokenNamereturn	
ReplayPosition	TokenNameIdentifier	 Replay Position
.	TokenNameDOT	
serializer	TokenNameIdentifier	 serializer
.	TokenNameDOT	
deserialize	TokenNameIdentifier	 deserialize
(	TokenNameLPAREN	
new	TokenNamenew	
DataInputStream	TokenNameIdentifier	 Data Input Stream
(	TokenNameLPAREN	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
inputStream	TokenNameIdentifier	 input Stream
(	TokenNameLPAREN	
bytes	TokenNameIdentifier	 bytes
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
IOException	TokenNameIdentifier	 IO Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** * Record tokens being used by another node */	TokenNameCOMMENT_JAVADOC	 Record tokens being used by another node 
public	TokenNamepublic	
static	TokenNamestatic	
synchronized	TokenNamesynchronized	
void	TokenNamevoid	
updateTokens	TokenNameIdentifier	 update Tokens
(	TokenNameLPAREN	
InetAddress	TokenNameIdentifier	 Inet Address
ep	TokenNameIdentifier	 ep
,	TokenNameCOMMA	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
tokens	TokenNameIdentifier	 tokens
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
ep	TokenNameIdentifier	 ep
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
FBUtilities	TokenNameIdentifier	 FB Utilities
.	TokenNameDOT	
getBroadcastAddress	TokenNameIdentifier	 get Broadcast Address
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
removeTokens	TokenNameIdentifier	 remove Tokens
(	TokenNameLPAREN	
tokens	TokenNameIdentifier	 tokens
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
String	TokenNameIdentifier	 String
req	TokenNameIdentifier	 req
=	TokenNameEQUAL	
"INSERT INTO system.%s (peer, tokens) VALUES ('%s', %s)"	TokenNameStringLiteral	INSERT INTO system.%s (peer, tokens) VALUES ('%s', %s)
;	TokenNameSEMICOLON	
processInternal	TokenNameIdentifier	 process Internal
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
req	TokenNameIdentifier	 req
,	TokenNameCOMMA	
PEERS_CF	TokenNameIdentifier	 PEERS  CF
,	TokenNameCOMMA	
ep	TokenNameIdentifier	 ep
.	TokenNameDOT	
getHostAddress	TokenNameIdentifier	 get Host Address
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
tokensAsSet	TokenNameIdentifier	 tokens As Set
(	TokenNameLPAREN	
tokens	TokenNameIdentifier	 tokens
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
forceBlockingFlush	TokenNameIdentifier	 force Blocking Flush
(	TokenNameLPAREN	
PEERS_CF	TokenNameIdentifier	 PEERS  CF
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
synchronized	TokenNamesynchronized	
void	TokenNamevoid	
updatePeerInfo	TokenNameIdentifier	 update Peer Info
(	TokenNameLPAREN	
InetAddress	TokenNameIdentifier	 Inet Address
ep	TokenNameIdentifier	 ep
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
columnName	TokenNameIdentifier	 column Name
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
value	TokenNameIdentifier	 value
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
ep	TokenNameIdentifier	 ep
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
FBUtilities	TokenNameIdentifier	 FB Utilities
.	TokenNameDOT	
getBroadcastAddress	TokenNameIdentifier	 get Broadcast Address
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
return	TokenNamereturn	
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
req	TokenNameIdentifier	 req
=	TokenNameEQUAL	
"INSERT INTO system.%s (peer, %s) VALUES ('%s', '%s')"	TokenNameStringLiteral	INSERT INTO system.%s (peer, %s) VALUES ('%s', '%s')
;	TokenNameSEMICOLON	
processInternal	TokenNameIdentifier	 process Internal
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
req	TokenNameIdentifier	 req
,	TokenNameCOMMA	
PEERS_CF	TokenNameIdentifier	 PEERS  CF
,	TokenNameCOMMA	
columnName	TokenNameIdentifier	 column Name
,	TokenNameCOMMA	
ep	TokenNameIdentifier	 ep
.	TokenNameDOT	
getHostAddress	TokenNameIdentifier	 get Host Address
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
value	TokenNameIdentifier	 value
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
synchronized	TokenNamesynchronized	
void	TokenNamevoid	
updateSchemaVersion	TokenNameIdentifier	 update Schema Version
(	TokenNameLPAREN	
UUID	TokenNameIdentifier	 UUID
version	TokenNameIdentifier	 version
)	TokenNameRPAREN	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
req	TokenNameIdentifier	 req
=	TokenNameEQUAL	
"INSERT INTO system.%s (key, schema_version) VALUES ('%s', %s)"	TokenNameStringLiteral	INSERT INTO system.%s (key, schema_version) VALUES ('%s', %s)
;	TokenNameSEMICOLON	
processInternal	TokenNameIdentifier	 process Internal
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
req	TokenNameIdentifier	 req
,	TokenNameCOMMA	
LOCAL_CF	TokenNameIdentifier	 LOCAL  CF
,	TokenNameCOMMA	
LOCAL_KEY	TokenNameIdentifier	 LOCAL  KEY
,	TokenNameCOMMA	
version	TokenNameIdentifier	 version
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
String	TokenNameIdentifier	 String
tokensAsSet	TokenNameIdentifier	 tokens As Set
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
tokens	TokenNameIdentifier	 tokens
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Token	TokenNameIdentifier	 Token
.	TokenNameDOT	
TokenFactory	TokenNameIdentifier	 Token Factory
factory	TokenNameIdentifier	 factory
=	TokenNameEQUAL	
StorageService	TokenNameIdentifier	 Storage Service
.	TokenNameDOT	
getPartitioner	TokenNameIdentifier	 get Partitioner
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getTokenFactory	TokenNameIdentifier	 get Token Factory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
StringBuilder	TokenNameIdentifier	 String Builder
sb	TokenNameIdentifier	 sb
=	TokenNameEQUAL	
new	TokenNamenew	
StringBuilder	TokenNameIdentifier	 String Builder
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
"{"	TokenNameStringLiteral	{
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Iterator	TokenNameIdentifier	 Iterator
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
iter	TokenNameIdentifier	 iter
=	TokenNameEQUAL	
tokens	TokenNameIdentifier	 tokens
.	TokenNameDOT	
iterator	TokenNameIdentifier	 iterator
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
while	TokenNamewhile	
(	TokenNameLPAREN	
iter	TokenNameIdentifier	 iter
.	TokenNameDOT	
hasNext	TokenNameIdentifier	 has Next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
"'"	TokenNameStringLiteral	'
)	TokenNameRPAREN	
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
factory	TokenNameIdentifier	 factory
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
iter	TokenNameIdentifier	 iter
.	TokenNameDOT	
next	TokenNameIdentifier	 next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
"'"	TokenNameStringLiteral	'
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
iter	TokenNameIdentifier	 iter
.	TokenNameDOT	
hasNext	TokenNameIdentifier	 has Next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
","	TokenNameStringLiteral	,
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
"}"	TokenNameStringLiteral	}
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
deserializeTokens	TokenNameIdentifier	 deserialize Tokens
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
tokensStrings	TokenNameIdentifier	 tokens Strings
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Token	TokenNameIdentifier	 Token
.	TokenNameDOT	
TokenFactory	TokenNameIdentifier	 Token Factory
factory	TokenNameIdentifier	 factory
=	TokenNameEQUAL	
StorageService	TokenNameIdentifier	 Storage Service
.	TokenNameDOT	
getPartitioner	TokenNameIdentifier	 get Partitioner
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getTokenFactory	TokenNameIdentifier	 get Token Factory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
tokens	TokenNameIdentifier	 tokens
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
(	TokenNameLPAREN	
tokensStrings	TokenNameIdentifier	 tokens Strings
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
tk	TokenNameIdentifier	 tk
:	TokenNameCOLON	
tokensStrings	TokenNameIdentifier	 tokens Strings
)	TokenNameRPAREN	
tokens	TokenNameIdentifier	 tokens
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
factory	TokenNameIdentifier	 factory
.	TokenNameDOT	
fromString	TokenNameIdentifier	 from String
(	TokenNameLPAREN	
tk	TokenNameIdentifier	 tk
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
tokens	TokenNameIdentifier	 tokens
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Remove stored tokens being used by another node */	TokenNameCOMMENT_JAVADOC	 Remove stored tokens being used by another node 
public	TokenNamepublic	
static	TokenNamestatic	
synchronized	TokenNamesynchronized	
void	TokenNamevoid	
removeTokens	TokenNameIdentifier	 remove Tokens
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
tokens	TokenNameIdentifier	 tokens
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
tokenSet	TokenNameIdentifier	 token Set
=	TokenNameEQUAL	
new	TokenNamenew	
HashSet	TokenNameIdentifier	 Hash Set
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
(	TokenNameLPAREN	
tokens	TokenNameIdentifier	 tokens
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
Map	TokenNameIdentifier	 Map
.	TokenNameDOT	
Entry	TokenNameIdentifier	 Entry
<	TokenNameLESS	
InetAddress	TokenNameIdentifier	 Inet Address
,	TokenNameCOMMA	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>>	TokenNameRIGHT_SHIFT	
entry	TokenNameIdentifier	 entry
:	TokenNameCOLON	
loadTokens	TokenNameIdentifier	 load Tokens
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
asMap	TokenNameIdentifier	 as Map
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
entrySet	TokenNameIdentifier	 entry Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
toRemove	TokenNameIdentifier	 to Remove
=	TokenNameEQUAL	
Sets	TokenNameIdentifier	 Sets
.	TokenNameDOT	
intersection	TokenNameIdentifier	 intersection
(	TokenNameLPAREN	
tokenSet	TokenNameIdentifier	 token Set
,	TokenNameCOMMA	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
)	TokenNameRPAREN	
entry	TokenNameIdentifier	 entry
.	TokenNameDOT	
getValue	TokenNameIdentifier	 get Value
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
immutableCopy	TokenNameIdentifier	 immutable Copy
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
toRemove	TokenNameIdentifier	 to Remove
.	TokenNameDOT	
isEmpty	TokenNameIdentifier	 is Empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
continue	TokenNamecontinue	
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
req	TokenNameIdentifier	 req
=	TokenNameEQUAL	
"UPDATE system.%s SET tokens = tokens - %s WHERE peer = '%s'"	TokenNameStringLiteral	UPDATE system.%s SET tokens = tokens - %s WHERE peer = '%s'
;	TokenNameSEMICOLON	
processInternal	TokenNameIdentifier	 process Internal
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
req	TokenNameIdentifier	 req
,	TokenNameCOMMA	
PEERS_CF	TokenNameIdentifier	 PEERS  CF
,	TokenNameCOMMA	
tokensAsSet	TokenNameIdentifier	 tokens As Set
(	TokenNameLPAREN	
toRemove	TokenNameIdentifier	 to Remove
)	TokenNameRPAREN	
,	TokenNameCOMMA	
entry	TokenNameIdentifier	 entry
.	TokenNameDOT	
getKey	TokenNameIdentifier	 get Key
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getHostAddress	TokenNameIdentifier	 get Host Address
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
forceBlockingFlush	TokenNameIdentifier	 force Blocking Flush
(	TokenNameLPAREN	
PEERS_CF	TokenNameIdentifier	 PEERS  CF
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * This method is used to update the System Table with the new tokens for this node */	TokenNameCOMMENT_JAVADOC	 This method is used to update the System Table with the new tokens for this node 
public	TokenNamepublic	
static	TokenNamestatic	
synchronized	TokenNamesynchronized	
void	TokenNamevoid	
updateTokens	TokenNameIdentifier	 update Tokens
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
tokens	TokenNameIdentifier	 tokens
)	TokenNameRPAREN	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
req	TokenNameIdentifier	 req
=	TokenNameEQUAL	
"INSERT INTO system.%s (key, tokens) VALUES ('%s', %s)"	TokenNameStringLiteral	INSERT INTO system.%s (key, tokens) VALUES ('%s', %s)
;	TokenNameSEMICOLON	
processInternal	TokenNameIdentifier	 process Internal
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
req	TokenNameIdentifier	 req
,	TokenNameCOMMA	
LOCAL_CF	TokenNameIdentifier	 LOCAL  CF
,	TokenNameCOMMA	
LOCAL_KEY	TokenNameIdentifier	 LOCAL  KEY
,	TokenNameCOMMA	
tokensAsSet	TokenNameIdentifier	 tokens As Set
(	TokenNameLPAREN	
tokens	TokenNameIdentifier	 tokens
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
forceBlockingFlush	TokenNameIdentifier	 force Blocking Flush
(	TokenNameLPAREN	
LOCAL_CF	TokenNameIdentifier	 LOCAL  CF
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Convenience method to update the list of tokens in the local system table. * * @param addTokens tokens to add * @param rmTokens tokens to remove * @return the collection of persisted tokens */	TokenNameCOMMENT_JAVADOC	 Convenience method to update the list of tokens in the local system table. * @param addTokens tokens to add @param rmTokens tokens to remove @return the collection of persisted tokens 
public	TokenNamepublic	
static	TokenNamestatic	
synchronized	TokenNamesynchronized	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
updateLocalTokens	TokenNameIdentifier	 update Local Tokens
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
addTokens	TokenNameIdentifier	 add Tokens
,	TokenNameCOMMA	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
rmTokens	TokenNameIdentifier	 rm Tokens
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
tokens	TokenNameIdentifier	 tokens
=	TokenNameEQUAL	
getSavedTokens	TokenNameIdentifier	 get Saved Tokens
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
tokens	TokenNameIdentifier	 tokens
.	TokenNameDOT	
removeAll	TokenNameIdentifier	 remove All
(	TokenNameLPAREN	
rmTokens	TokenNameIdentifier	 rm Tokens
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
tokens	TokenNameIdentifier	 tokens
.	TokenNameDOT	
addAll	TokenNameIdentifier	 add All
(	TokenNameLPAREN	
addTokens	TokenNameIdentifier	 add Tokens
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
updateTokens	TokenNameIdentifier	 update Tokens
(	TokenNameLPAREN	
tokens	TokenNameIdentifier	 tokens
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
tokens	TokenNameIdentifier	 tokens
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
void	TokenNamevoid	
forceBlockingFlush	TokenNameIdentifier	 force Blocking Flush
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
cfname	TokenNameIdentifier	 cfname
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
SYSTEM_KS	TokenNameIdentifier	 SYSTEM  KS
)	TokenNameRPAREN	
.	TokenNameDOT	
getColumnFamilyStore	TokenNameIdentifier	 get Column Family Store
(	TokenNameLPAREN	
cfname	TokenNameIdentifier	 cfname
)	TokenNameRPAREN	
.	TokenNameDOT	
forceBlockingFlush	TokenNameIdentifier	 force Blocking Flush
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
ExecutionException	TokenNameIdentifier	 Execution Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
InterruptedException	TokenNameIdentifier	 Interrupted Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
AssertionError	TokenNameIdentifier	 Assertion Error
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** * Return a map of stored tokens to IP addresses * */	TokenNameCOMMENT_JAVADOC	 Return a map of stored tokens to IP addresses 
public	TokenNamepublic	
static	TokenNamestatic	
SetMultimap	TokenNameIdentifier	 Set Multimap
<	TokenNameLESS	
InetAddress	TokenNameIdentifier	 Inet Address
,	TokenNameCOMMA	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
loadTokens	TokenNameIdentifier	 load Tokens
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
SetMultimap	TokenNameIdentifier	 Set Multimap
<	TokenNameLESS	
InetAddress	TokenNameIdentifier	 Inet Address
,	TokenNameCOMMA	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
tokenMap	TokenNameIdentifier	 token Map
=	TokenNameEQUAL	
HashMultimap	TokenNameIdentifier	 Hash Multimap
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
UntypedResultSet	TokenNameIdentifier	 Untyped Result Set
.	TokenNameDOT	
Row	TokenNameIdentifier	 Row
row	TokenNameIdentifier	 row
:	TokenNameCOLON	
processInternal	TokenNameIdentifier	 process Internal
(	TokenNameLPAREN	
"SELECT peer, tokens FROM system."	TokenNameStringLiteral	SELECT peer, tokens FROM system.
+	TokenNamePLUS	
PEERS_CF	TokenNameIdentifier	 PEERS  CF
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
InetAddress	TokenNameIdentifier	 Inet Address
peer	TokenNameIdentifier	 peer
=	TokenNameEQUAL	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
getInetAddress	TokenNameIdentifier	 get Inet Address
(	TokenNameLPAREN	
"peer"	TokenNameStringLiteral	peer
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
has	TokenNameIdentifier	 has
(	TokenNameLPAREN	
"tokens"	TokenNameStringLiteral	tokens
)	TokenNameRPAREN	
)	TokenNameRPAREN	
tokenMap	TokenNameIdentifier	 token Map
.	TokenNameDOT	
putAll	TokenNameIdentifier	 put All
(	TokenNameLPAREN	
peer	TokenNameIdentifier	 peer
,	TokenNameCOMMA	
deserializeTokens	TokenNameIdentifier	 deserialize Tokens
(	TokenNameLPAREN	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
getSet	TokenNameIdentifier	 get Set
(	TokenNameLPAREN	
"tokens"	TokenNameStringLiteral	tokens
,	TokenNameCOMMA	
UTF8Type	TokenNameIdentifier	 UT F8 Type
.	TokenNameDOT	
instance	TokenNameIdentifier	 instance
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
tokenMap	TokenNameIdentifier	 token Map
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Return a map of store host_ids to IP addresses * */	TokenNameCOMMENT_JAVADOC	 Return a map of store host_ids to IP addresses 
public	TokenNamepublic	
static	TokenNamestatic	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
InetAddress	TokenNameIdentifier	 Inet Address
,	TokenNameCOMMA	
UUID	TokenNameIdentifier	 UUID
>	TokenNameGREATER	
loadHostIds	TokenNameIdentifier	 load Host Ids
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
InetAddress	TokenNameIdentifier	 Inet Address
,	TokenNameCOMMA	
UUID	TokenNameIdentifier	 UUID
>	TokenNameGREATER	
hostIdMap	TokenNameIdentifier	 host Id Map
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
InetAddress	TokenNameIdentifier	 Inet Address
,	TokenNameCOMMA	
UUID	TokenNameIdentifier	 UUID
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
UntypedResultSet	TokenNameIdentifier	 Untyped Result Set
.	TokenNameDOT	
Row	TokenNameIdentifier	 Row
row	TokenNameIdentifier	 row
:	TokenNameCOLON	
processInternal	TokenNameIdentifier	 process Internal
(	TokenNameLPAREN	
"SELECT peer, host_id FROM system."	TokenNameStringLiteral	SELECT peer, host_id FROM system.
+	TokenNamePLUS	
PEERS_CF	TokenNameIdentifier	 PEERS  CF
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
InetAddress	TokenNameIdentifier	 Inet Address
peer	TokenNameIdentifier	 peer
=	TokenNameEQUAL	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
getInetAddress	TokenNameIdentifier	 get Inet Address
(	TokenNameLPAREN	
"peer"	TokenNameStringLiteral	peer
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
has	TokenNameIdentifier	 has
(	TokenNameLPAREN	
"host_id"	TokenNameStringLiteral	host_id
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
hostIdMap	TokenNameIdentifier	 host Id Map
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
peer	TokenNameIdentifier	 peer
,	TokenNameCOMMA	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
getUUID	TokenNameIdentifier	 get UUID
(	TokenNameLPAREN	
"host_id"	TokenNameStringLiteral	host_id
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
return	TokenNamereturn	
hostIdMap	TokenNameIdentifier	 host Id Map
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * One of three things will happen if you try to read the system table: * 1. files are present and you can read them: great * 2. no files are there: great (new node is assumed) * 3. files are present but you can't read them: bad * @throws ConfigurationException */	TokenNameCOMMENT_JAVADOC	 One of three things will happen if you try to read the system table: 1. files are present and you can read them: great 2. no files are there: great (new node is assumed) 3. files are present but you can't read them: bad @throws ConfigurationException 
public	TokenNamepublic	
static	TokenNamestatic	
void	TokenNamevoid	
checkHealth	TokenNameIdentifier	 check Health
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
ConfigurationException	TokenNameIdentifier	 Configuration Exception
{	TokenNameLBRACE	
Table	TokenNameIdentifier	 Table
table	TokenNameIdentifier	 table
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
table	TokenNameIdentifier	 table
=	TokenNameEQUAL	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
SYSTEM_KS	TokenNameIdentifier	 SYSTEM  KS
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
AssertionError	TokenNameIdentifier	 Assertion Error
err	TokenNameIdentifier	 err
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// this happens when a user switches from OPP to RP. 	TokenNameCOMMENT_LINE	this happens when a user switches from OPP to RP. 
ConfigurationException	TokenNameIdentifier	 Configuration Exception
ex	TokenNameIdentifier	 ex
=	TokenNameEQUAL	
new	TokenNamenew	
ConfigurationException	TokenNameIdentifier	 Configuration Exception
(	TokenNameLPAREN	
"Could not read system table!"	TokenNameStringLiteral	Could not read system table!
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ex	TokenNameIdentifier	 ex
.	TokenNameDOT	
initCause	TokenNameIdentifier	 init Cause
(	TokenNameLPAREN	
err	TokenNameIdentifier	 err
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
throw	TokenNamethrow	
ex	TokenNameIdentifier	 ex
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
cfs	TokenNameIdentifier	 cfs
=	TokenNameEQUAL	
table	TokenNameIdentifier	 table
.	TokenNameDOT	
getColumnFamilyStore	TokenNameIdentifier	 get Column Family Store
(	TokenNameLPAREN	
LOCAL_CF	TokenNameIdentifier	 LOCAL  CF
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
req	TokenNameIdentifier	 req
=	TokenNameEQUAL	
"SELECT cluster_name FROM system.%s WHERE key='%s'"	TokenNameStringLiteral	SELECT cluster_name FROM system.%s WHERE key='%s'
;	TokenNameSEMICOLON	
UntypedResultSet	TokenNameIdentifier	 Untyped Result Set
result	TokenNameIdentifier	 result
=	TokenNameEQUAL	
processInternal	TokenNameIdentifier	 process Internal
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
req	TokenNameIdentifier	 req
,	TokenNameCOMMA	
LOCAL_CF	TokenNameIdentifier	 LOCAL  CF
,	TokenNameCOMMA	
LOCAL_KEY	TokenNameIdentifier	 LOCAL  KEY
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
result	TokenNameIdentifier	 result
.	TokenNameDOT	
isEmpty	TokenNameIdentifier	 is Empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
||	TokenNameOR_OR	
!	TokenNameNOT	
result	TokenNameIdentifier	 result
.	TokenNameDOT	
one	TokenNameIdentifier	 one
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
has	TokenNameIdentifier	 has
(	TokenNameLPAREN	
"cluster_name"	TokenNameStringLiteral	cluster_name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// this is a brand new node 	TokenNameCOMMENT_LINE	this is a brand new node 
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
getSSTables	TokenNameIdentifier	 get SS Tables
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
isEmpty	TokenNameIdentifier	 is Empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
throw	TokenNamethrow	
new	TokenNamenew	
ConfigurationException	TokenNameIdentifier	 Configuration Exception
(	TokenNameLPAREN	
"Found system table files, but they couldn't be loaded!"	TokenNameStringLiteral	Found system table files, but they couldn't be loaded!
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// no system files. this is a new node. 	TokenNameCOMMENT_LINE	no system files. this is a new node. 
req	TokenNameIdentifier	 req
=	TokenNameEQUAL	
"INSERT INTO system.%s (key, cluster_name) VALUES ('%s', '%s')"	TokenNameStringLiteral	INSERT INTO system.%s (key, cluster_name) VALUES ('%s', '%s')
;	TokenNameSEMICOLON	
processInternal	TokenNameIdentifier	 process Internal
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
req	TokenNameIdentifier	 req
,	TokenNameCOMMA	
LOCAL_CF	TokenNameIdentifier	 LOCAL  CF
,	TokenNameCOMMA	
LOCAL_KEY	TokenNameIdentifier	 LOCAL  KEY
,	TokenNameCOMMA	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
.	TokenNameDOT	
getClusterName	TokenNameIdentifier	 get Cluster Name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
String	TokenNameIdentifier	 String
savedClusterName	TokenNameIdentifier	 saved Cluster Name
=	TokenNameEQUAL	
result	TokenNameIdentifier	 result
.	TokenNameDOT	
one	TokenNameIdentifier	 one
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getString	TokenNameIdentifier	 get String
(	TokenNameLPAREN	
"cluster_name"	TokenNameStringLiteral	cluster_name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
.	TokenNameDOT	
getClusterName	TokenNameIdentifier	 get Cluster Name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
savedClusterName	TokenNameIdentifier	 saved Cluster Name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
throw	TokenNamethrow	
new	TokenNamenew	
ConfigurationException	TokenNameIdentifier	 Configuration Exception
(	TokenNameLPAREN	
"Saved cluster name "	TokenNameStringLiteral	Saved cluster name 
+	TokenNamePLUS	
savedClusterName	TokenNameIdentifier	 saved Cluster Name
+	TokenNamePLUS	
" != configured name "	TokenNameStringLiteral	 != configured name 
+	TokenNamePLUS	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
.	TokenNameDOT	
getClusterName	TokenNameIdentifier	 get Cluster Name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
getSavedTokens	TokenNameIdentifier	 get Saved Tokens
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
req	TokenNameIdentifier	 req
=	TokenNameEQUAL	
"SELECT tokens FROM system.%s WHERE key='%s'"	TokenNameStringLiteral	SELECT tokens FROM system.%s WHERE key='%s'
;	TokenNameSEMICOLON	
UntypedResultSet	TokenNameIdentifier	 Untyped Result Set
result	TokenNameIdentifier	 result
=	TokenNameEQUAL	
processInternal	TokenNameIdentifier	 process Internal
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
req	TokenNameIdentifier	 req
,	TokenNameCOMMA	
LOCAL_CF	TokenNameIdentifier	 LOCAL  CF
,	TokenNameCOMMA	
LOCAL_KEY	TokenNameIdentifier	 LOCAL  KEY
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
result	TokenNameIdentifier	 result
.	TokenNameDOT	
isEmpty	TokenNameIdentifier	 is Empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
||	TokenNameOR_OR	
!	TokenNameNOT	
result	TokenNameIdentifier	 result
.	TokenNameDOT	
one	TokenNameIdentifier	 one
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
has	TokenNameIdentifier	 has
(	TokenNameLPAREN	
"tokens"	TokenNameStringLiteral	tokens
)	TokenNameRPAREN	
?	TokenNameQUESTION	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
emptyList	TokenNameIdentifier	 empty List
(	TokenNameLPAREN	
)	TokenNameRPAREN	
:	TokenNameCOLON	
deserializeTokens	TokenNameIdentifier	 deserialize Tokens
(	TokenNameLPAREN	
result	TokenNameIdentifier	 result
.	TokenNameDOT	
one	TokenNameIdentifier	 one
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
getSet	TokenNameIdentifier	 get Set
(	TokenNameLPAREN	
"tokens"	TokenNameStringLiteral	tokens
,	TokenNameCOMMA	
UTF8Type	TokenNameIdentifier	 UT F8 Type
.	TokenNameDOT	
instance	TokenNameIdentifier	 instance
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
int	TokenNameint	
incrementAndGetGeneration	TokenNameIdentifier	 increment And Get Generation
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
req	TokenNameIdentifier	 req
=	TokenNameEQUAL	
"SELECT gossip_generation FROM system.%s WHERE key='%s'"	TokenNameStringLiteral	SELECT gossip_generation FROM system.%s WHERE key='%s'
;	TokenNameSEMICOLON	
UntypedResultSet	TokenNameIdentifier	 Untyped Result Set
result	TokenNameIdentifier	 result
=	TokenNameEQUAL	
processInternal	TokenNameIdentifier	 process Internal
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
req	TokenNameIdentifier	 req
,	TokenNameCOMMA	
LOCAL_CF	TokenNameIdentifier	 LOCAL  CF
,	TokenNameCOMMA	
LOCAL_KEY	TokenNameIdentifier	 LOCAL  KEY
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
int	TokenNameint	
generation	TokenNameIdentifier	 generation
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
result	TokenNameIdentifier	 result
.	TokenNameDOT	
isEmpty	TokenNameIdentifier	 is Empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
||	TokenNameOR_OR	
!	TokenNameNOT	
result	TokenNameIdentifier	 result
.	TokenNameDOT	
one	TokenNameIdentifier	 one
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
has	TokenNameIdentifier	 has
(	TokenNameLPAREN	
"gossip_generation"	TokenNameStringLiteral	gossip_generation
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// seconds-since-epoch isn't a foolproof new generation 	TokenNameCOMMENT_LINE	seconds-since-epoch isn't a foolproof new generation 
// (where foolproof is "guaranteed to be larger than the last one seen at this ip address"), 	TokenNameCOMMENT_LINE	(where foolproof is "guaranteed to be larger than the last one seen at this ip address"), 
// but it's as close as sanely possible 	TokenNameCOMMENT_LINE	but it's as close as sanely possible 
generation	TokenNameIdentifier	 generation
=	TokenNameEQUAL	
(	TokenNameLPAREN	
int	TokenNameint	
)	TokenNameRPAREN	
(	TokenNameLPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
currentTimeMillis	TokenNameIdentifier	 current Time Millis
(	TokenNameLPAREN	
)	TokenNameRPAREN	
/	TokenNameDIVIDE	
1000	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
// Other nodes will ignore gossip messages about a node that have a lower generation than previously seen. 	TokenNameCOMMENT_LINE	Other nodes will ignore gossip messages about a node that have a lower generation than previously seen. 
final	TokenNamefinal	
int	TokenNameint	
storedGeneration	TokenNameIdentifier	 stored Generation
=	TokenNameEQUAL	
result	TokenNameIdentifier	 result
.	TokenNameDOT	
one	TokenNameIdentifier	 one
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getInt	TokenNameIdentifier	 get Int
(	TokenNameLPAREN	
"gossip_generation"	TokenNameStringLiteral	gossip_generation
)	TokenNameRPAREN	
+	TokenNamePLUS	
1	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
int	TokenNameint	
now	TokenNameIdentifier	 now
=	TokenNameEQUAL	
(	TokenNameLPAREN	
int	TokenNameint	
)	TokenNameRPAREN	
(	TokenNameLPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
currentTimeMillis	TokenNameIdentifier	 current Time Millis
(	TokenNameLPAREN	
)	TokenNameRPAREN	
/	TokenNameDIVIDE	
1000	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
storedGeneration	TokenNameIdentifier	 stored Generation
>=	TokenNameGREATER_EQUAL	
now	TokenNameIdentifier	 now
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
warn	TokenNameIdentifier	 warn
(	TokenNameLPAREN	
"Using stored Gossip Generation {} as it is greater than current system time {}. See CASSANDRA-3654 if you experience problems"	TokenNameStringLiteral	Using stored Gossip Generation {} as it is greater than current system time {}. See CASSANDRA-3654 if you experience problems
,	TokenNameCOMMA	
storedGeneration	TokenNameIdentifier	 stored Generation
,	TokenNameCOMMA	
now	TokenNameIdentifier	 now
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
generation	TokenNameIdentifier	 generation
=	TokenNameEQUAL	
storedGeneration	TokenNameIdentifier	 stored Generation
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
generation	TokenNameIdentifier	 generation
=	TokenNameEQUAL	
now	TokenNameIdentifier	 now
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
req	TokenNameIdentifier	 req
=	TokenNameEQUAL	
"INSERT INTO system.%s (key, gossip_generation) VALUES ('%s', %d)"	TokenNameStringLiteral	INSERT INTO system.%s (key, gossip_generation) VALUES ('%s', %d)
;	TokenNameSEMICOLON	
processInternal	TokenNameIdentifier	 process Internal
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
req	TokenNameIdentifier	 req
,	TokenNameCOMMA	
LOCAL_CF	TokenNameIdentifier	 LOCAL  CF
,	TokenNameCOMMA	
LOCAL_KEY	TokenNameIdentifier	 LOCAL  KEY
,	TokenNameCOMMA	
generation	TokenNameIdentifier	 generation
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
forceBlockingFlush	TokenNameIdentifier	 force Blocking Flush
(	TokenNameLPAREN	
LOCAL_CF	TokenNameIdentifier	 LOCAL  CF
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
generation	TokenNameIdentifier	 generation
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
BootstrapState	TokenNameIdentifier	 Bootstrap State
getBootstrapState	TokenNameIdentifier	 get Bootstrap State
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
req	TokenNameIdentifier	 req
=	TokenNameEQUAL	
"SELECT bootstrapped FROM system.%s WHERE key='%s'"	TokenNameStringLiteral	SELECT bootstrapped FROM system.%s WHERE key='%s'
;	TokenNameSEMICOLON	
UntypedResultSet	TokenNameIdentifier	 Untyped Result Set
result	TokenNameIdentifier	 result
=	TokenNameEQUAL	
processInternal	TokenNameIdentifier	 process Internal
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
req	TokenNameIdentifier	 req
,	TokenNameCOMMA	
LOCAL_CF	TokenNameIdentifier	 LOCAL  CF
,	TokenNameCOMMA	
LOCAL_KEY	TokenNameIdentifier	 LOCAL  KEY
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
result	TokenNameIdentifier	 result
.	TokenNameDOT	
isEmpty	TokenNameIdentifier	 is Empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
||	TokenNameOR_OR	
!	TokenNameNOT	
result	TokenNameIdentifier	 result
.	TokenNameDOT	
one	TokenNameIdentifier	 one
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
has	TokenNameIdentifier	 has
(	TokenNameLPAREN	
"bootstrapped"	TokenNameStringLiteral	bootstrapped
)	TokenNameRPAREN	
)	TokenNameRPAREN	
return	TokenNamereturn	
BootstrapState	TokenNameIdentifier	 Bootstrap State
.	TokenNameDOT	
NEEDS_BOOTSTRAP	TokenNameIdentifier	 NEEDS  BOOTSTRAP
;	TokenNameSEMICOLON	
return	TokenNamereturn	
BootstrapState	TokenNameIdentifier	 Bootstrap State
.	TokenNameDOT	
valueOf	TokenNameIdentifier	 value Of
(	TokenNameLPAREN	
result	TokenNameIdentifier	 result
.	TokenNameDOT	
one	TokenNameIdentifier	 one
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getString	TokenNameIdentifier	 get String
(	TokenNameLPAREN	
"bootstrapped"	TokenNameStringLiteral	bootstrapped
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
boolean	TokenNameboolean	
bootstrapComplete	TokenNameIdentifier	 bootstrap Complete
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
getBootstrapState	TokenNameIdentifier	 get Bootstrap State
(	TokenNameLPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
BootstrapState	TokenNameIdentifier	 Bootstrap State
.	TokenNameDOT	
COMPLETED	TokenNameIdentifier	 COMPLETED
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
boolean	TokenNameboolean	
bootstrapInProgress	TokenNameIdentifier	 bootstrap In Progress
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
getBootstrapState	TokenNameIdentifier	 get Bootstrap State
(	TokenNameLPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
BootstrapState	TokenNameIdentifier	 Bootstrap State
.	TokenNameDOT	
IN_PROGRESS	TokenNameIdentifier	 IN  PROGRESS
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
void	TokenNamevoid	
setBootstrapState	TokenNameIdentifier	 set Bootstrap State
(	TokenNameLPAREN	
BootstrapState	TokenNameIdentifier	 Bootstrap State
state	TokenNameIdentifier	 state
)	TokenNameRPAREN	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
req	TokenNameIdentifier	 req
=	TokenNameEQUAL	
"INSERT INTO system.%s (key, bootstrapped) VALUES ('%s', '%s')"	TokenNameStringLiteral	INSERT INTO system.%s (key, bootstrapped) VALUES ('%s', '%s')
;	TokenNameSEMICOLON	
processInternal	TokenNameIdentifier	 process Internal
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
req	TokenNameIdentifier	 req
,	TokenNameCOMMA	
LOCAL_CF	TokenNameIdentifier	 LOCAL  CF
,	TokenNameCOMMA	
LOCAL_KEY	TokenNameIdentifier	 LOCAL  KEY
,	TokenNameCOMMA	
state	TokenNameIdentifier	 state
.	TokenNameDOT	
name	TokenNameIdentifier	 name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
forceBlockingFlush	TokenNameIdentifier	 force Blocking Flush
(	TokenNameLPAREN	
LOCAL_CF	TokenNameIdentifier	 LOCAL  CF
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
boolean	TokenNameboolean	
isIndexBuilt	TokenNameIdentifier	 is Index Built
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
table	TokenNameIdentifier	 table
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
indexName	TokenNameIdentifier	 index Name
)	TokenNameRPAREN	
{	TokenNameLBRACE	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
cfs	TokenNameIdentifier	 cfs
=	TokenNameEQUAL	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
SYSTEM_KS	TokenNameIdentifier	 SYSTEM  KS
)	TokenNameRPAREN	
.	TokenNameDOT	
getColumnFamilyStore	TokenNameIdentifier	 get Column Family Store
(	TokenNameLPAREN	
INDEX_CF	TokenNameIdentifier	 INDEX  CF
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
QueryFilter	TokenNameIdentifier	 Query Filter
filter	TokenNameIdentifier	 filter
=	TokenNameEQUAL	
QueryFilter	TokenNameIdentifier	 Query Filter
.	TokenNameDOT	
getNamesFilter	TokenNameIdentifier	 get Names Filter
(	TokenNameLPAREN	
decorate	TokenNameIdentifier	 decorate
(	TokenNameLPAREN	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
bytes	TokenNameIdentifier	 bytes
(	TokenNameLPAREN	
table	TokenNameIdentifier	 table
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
new	TokenNamenew	
QueryPath	TokenNameIdentifier	 Query Path
(	TokenNameLPAREN	
INDEX_CF	TokenNameIdentifier	 INDEX  CF
)	TokenNameRPAREN	
,	TokenNameCOMMA	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
bytes	TokenNameIdentifier	 bytes
(	TokenNameLPAREN	
indexName	TokenNameIdentifier	 index Name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
.	TokenNameDOT	
removeDeleted	TokenNameIdentifier	 remove Deleted
(	TokenNameLPAREN	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
getColumnFamily	TokenNameIdentifier	 get Column Family
(	TokenNameLPAREN	
filter	TokenNameIdentifier	 filter
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Integer	TokenNameIdentifier	 Integer
.	TokenNameDOT	
MAX_VALUE	TokenNameIdentifier	 MAX  VALUE
)	TokenNameRPAREN	
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
void	TokenNamevoid	
setIndexBuilt	TokenNameIdentifier	 set Index Built
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
table	TokenNameIdentifier	 table
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
indexName	TokenNameIdentifier	 index Name
)	TokenNameRPAREN	
{	TokenNameLBRACE	
ColumnFamily	TokenNameIdentifier	 Column Family
cf	TokenNameIdentifier	 cf
=	TokenNameEQUAL	
ColumnFamily	TokenNameIdentifier	 Column Family
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
SYSTEM_KS	TokenNameIdentifier	 SYSTEM  KS
,	TokenNameCOMMA	
INDEX_CF	TokenNameIdentifier	 INDEX  CF
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
cf	TokenNameIdentifier	 cf
.	TokenNameDOT	
addColumn	TokenNameIdentifier	 add Column
(	TokenNameLPAREN	
new	TokenNamenew	
Column	TokenNameIdentifier	 Column
(	TokenNameLPAREN	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
bytes	TokenNameIdentifier	 bytes
(	TokenNameLPAREN	
indexName	TokenNameIdentifier	 index Name
)	TokenNameRPAREN	
,	TokenNameCOMMA	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
EMPTY_BYTE_BUFFER	TokenNameIdentifier	 EMPTY  BYTE  BUFFER
,	TokenNameCOMMA	
FBUtilities	TokenNameIdentifier	 FB Utilities
.	TokenNameDOT	
timestampMicros	TokenNameIdentifier	 timestamp Micros
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
RowMutation	TokenNameIdentifier	 Row Mutation
rm	TokenNameIdentifier	 rm
=	TokenNameEQUAL	
new	TokenNamenew	
RowMutation	TokenNameIdentifier	 Row Mutation
(	TokenNameLPAREN	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
SYSTEM_KS	TokenNameIdentifier	 SYSTEM  KS
,	TokenNameCOMMA	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
bytes	TokenNameIdentifier	 bytes
(	TokenNameLPAREN	
table	TokenNameIdentifier	 table
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
rm	TokenNameIdentifier	 rm
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
cf	TokenNameIdentifier	 cf
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
rm	TokenNameIdentifier	 rm
.	TokenNameDOT	
apply	TokenNameIdentifier	 apply
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
forceBlockingFlush	TokenNameIdentifier	 force Blocking Flush
(	TokenNameLPAREN	
INDEX_CF	TokenNameIdentifier	 INDEX  CF
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
void	TokenNamevoid	
setIndexRemoved	TokenNameIdentifier	 set Index Removed
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
table	TokenNameIdentifier	 table
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
indexName	TokenNameIdentifier	 index Name
)	TokenNameRPAREN	
{	TokenNameLBRACE	
RowMutation	TokenNameIdentifier	 Row Mutation
rm	TokenNameIdentifier	 rm
=	TokenNameEQUAL	
new	TokenNamenew	
RowMutation	TokenNameIdentifier	 Row Mutation
(	TokenNameLPAREN	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
SYSTEM_KS	TokenNameIdentifier	 SYSTEM  KS
,	TokenNameCOMMA	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
bytes	TokenNameIdentifier	 bytes
(	TokenNameLPAREN	
table	TokenNameIdentifier	 table
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
rm	TokenNameIdentifier	 rm
.	TokenNameDOT	
delete	TokenNameIdentifier	 delete
(	TokenNameLPAREN	
new	TokenNamenew	
QueryPath	TokenNameIdentifier	 Query Path
(	TokenNameLPAREN	
INDEX_CF	TokenNameIdentifier	 INDEX  CF
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
bytes	TokenNameIdentifier	 bytes
(	TokenNameLPAREN	
indexName	TokenNameIdentifier	 index Name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
FBUtilities	TokenNameIdentifier	 FB Utilities
.	TokenNameDOT	
timestampMicros	TokenNameIdentifier	 timestamp Micros
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
rm	TokenNameIdentifier	 rm
.	TokenNameDOT	
apply	TokenNameIdentifier	 apply
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
forceBlockingFlush	TokenNameIdentifier	 force Blocking Flush
(	TokenNameLPAREN	
INDEX_CF	TokenNameIdentifier	 INDEX  CF
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Read the host ID from the system table, creating (and storing) one if * none exists. */	TokenNameCOMMENT_JAVADOC	 Read the host ID from the system table, creating (and storing) one if none exists. 
public	TokenNamepublic	
static	TokenNamestatic	
UUID	TokenNameIdentifier	 UUID
getLocalHostId	TokenNameIdentifier	 get Local Host Id
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
UUID	TokenNameIdentifier	 UUID
hostId	TokenNameIdentifier	 host Id
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
req	TokenNameIdentifier	 req
=	TokenNameEQUAL	
"SELECT host_id FROM system.%s WHERE key='%s'"	TokenNameStringLiteral	SELECT host_id FROM system.%s WHERE key='%s'
;	TokenNameSEMICOLON	
UntypedResultSet	TokenNameIdentifier	 Untyped Result Set
result	TokenNameIdentifier	 result
=	TokenNameEQUAL	
processInternal	TokenNameIdentifier	 process Internal
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
req	TokenNameIdentifier	 req
,	TokenNameCOMMA	
LOCAL_CF	TokenNameIdentifier	 LOCAL  CF
,	TokenNameCOMMA	
LOCAL_KEY	TokenNameIdentifier	 LOCAL  KEY
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Look up the Host UUID (return it if found) 	TokenNameCOMMENT_LINE	Look up the Host UUID (return it if found) 
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
result	TokenNameIdentifier	 result
.	TokenNameDOT	
isEmpty	TokenNameIdentifier	 is Empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
&&	TokenNameAND_AND	
result	TokenNameIdentifier	 result
.	TokenNameDOT	
one	TokenNameIdentifier	 one
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
has	TokenNameIdentifier	 has
(	TokenNameLPAREN	
"host_id"	TokenNameStringLiteral	host_id
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
result	TokenNameIdentifier	 result
.	TokenNameDOT	
one	TokenNameIdentifier	 one
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getUUID	TokenNameIdentifier	 get UUID
(	TokenNameLPAREN	
"host_id"	TokenNameStringLiteral	host_id
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// ID not found, generate a new one, persist, and then return it. 	TokenNameCOMMENT_LINE	ID not found, generate a new one, persist, and then return it. 
hostId	TokenNameIdentifier	 host Id
=	TokenNameEQUAL	
UUID	TokenNameIdentifier	 UUID
.	TokenNameDOT	
randomUUID	TokenNameIdentifier	 random UUID
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
warn	TokenNameIdentifier	 warn
(	TokenNameLPAREN	
"No host ID found, created {} (Note: This should happen exactly once per node)."	TokenNameStringLiteral	No host ID found, created {} (Note: This should happen exactly once per node).
,	TokenNameCOMMA	
hostId	TokenNameIdentifier	 host Id
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
req	TokenNameIdentifier	 req
=	TokenNameEQUAL	
"INSERT INTO system.%s (key, host_id) VALUES ('%s', '%s')"	TokenNameStringLiteral	INSERT INTO system.%s (key, host_id) VALUES ('%s', '%s')
;	TokenNameSEMICOLON	
processInternal	TokenNameIdentifier	 process Internal
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
req	TokenNameIdentifier	 req
,	TokenNameCOMMA	
LOCAL_CF	TokenNameIdentifier	 LOCAL  CF
,	TokenNameCOMMA	
LOCAL_KEY	TokenNameIdentifier	 LOCAL  KEY
,	TokenNameCOMMA	
hostId	TokenNameIdentifier	 host Id
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
hostId	TokenNameIdentifier	 host Id
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Read the current local node id from the system table or null if no * such node id is recorded. */	TokenNameCOMMENT_JAVADOC	 Read the current local node id from the system table or null if no such node id is recorded. 
public	TokenNamepublic	
static	TokenNamestatic	
CounterId	TokenNameIdentifier	 Counter Id
getCurrentLocalCounterId	TokenNameIdentifier	 get Current Local Counter Id
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Table	TokenNameIdentifier	 Table
table	TokenNameIdentifier	 table
=	TokenNameEQUAL	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
SYSTEM_KS	TokenNameIdentifier	 SYSTEM  KS
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Get the last CounterId (since CounterId are timeuuid is thus ordered from the older to the newer one) 	TokenNameCOMMENT_LINE	Get the last CounterId (since CounterId are timeuuid is thus ordered from the older to the newer one) 
QueryFilter	TokenNameIdentifier	 Query Filter
filter	TokenNameIdentifier	 filter
=	TokenNameEQUAL	
QueryFilter	TokenNameIdentifier	 Query Filter
.	TokenNameDOT	
getSliceFilter	TokenNameIdentifier	 get Slice Filter
(	TokenNameLPAREN	
decorate	TokenNameIdentifier	 decorate
(	TokenNameLPAREN	
ALL_LOCAL_NODE_ID_KEY	TokenNameIdentifier	 ALL  LOCAL  NODE  ID  KEY
)	TokenNameRPAREN	
,	TokenNameCOMMA	
new	TokenNamenew	
QueryPath	TokenNameIdentifier	 Query Path
(	TokenNameLPAREN	
COUNTER_ID_CF	TokenNameIdentifier	 COUNTER  ID  CF
)	TokenNameRPAREN	
,	TokenNameCOMMA	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
EMPTY_BYTE_BUFFER	TokenNameIdentifier	 EMPTY  BYTE  BUFFER
,	TokenNameCOMMA	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
EMPTY_BYTE_BUFFER	TokenNameIdentifier	 EMPTY  BYTE  BUFFER
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ColumnFamily	TokenNameIdentifier	 Column Family
cf	TokenNameIdentifier	 cf
=	TokenNameEQUAL	
table	TokenNameIdentifier	 table
.	TokenNameDOT	
getColumnFamilyStore	TokenNameIdentifier	 get Column Family Store
(	TokenNameLPAREN	
COUNTER_ID_CF	TokenNameIdentifier	 COUNTER  ID  CF
)	TokenNameRPAREN	
.	TokenNameDOT	
getColumnFamily	TokenNameIdentifier	 get Column Family
(	TokenNameLPAREN	
filter	TokenNameIdentifier	 filter
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
cf	TokenNameIdentifier	 cf
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
&&	TokenNameAND_AND	
cf	TokenNameIdentifier	 cf
.	TokenNameDOT	
getColumnCount	TokenNameIdentifier	 get Column Count
(	TokenNameLPAREN	
)	TokenNameRPAREN	
!=	TokenNameNOT_EQUAL	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
return	TokenNamereturn	
CounterId	TokenNameIdentifier	 Counter Id
.	TokenNameDOT	
wrap	TokenNameIdentifier	 wrap
(	TokenNameLPAREN	
cf	TokenNameIdentifier	 cf
.	TokenNameDOT	
iterator	TokenNameIdentifier	 iterator
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
next	TokenNameIdentifier	 next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
name	TokenNameIdentifier	 name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
else	TokenNameelse	
return	TokenNamereturn	
null	TokenNamenull	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Write a new current local node id to the system table. * * @param oldCounterId the previous local node id (that {@code newCounterId} * replace) or null if no such node id exists (new node or removed system * table) * @param newCounterId the new current local node id to record * @param now microsecond time stamp. */	TokenNameCOMMENT_JAVADOC	 Write a new current local node id to the system table. * @param oldCounterId the previous local node id (that {@code newCounterId} replace) or null if no such node id exists (new node or removed system table) @param newCounterId the new current local node id to record @param now microsecond time stamp. 
public	TokenNamepublic	
static	TokenNamestatic	
void	TokenNamevoid	
writeCurrentLocalCounterId	TokenNameIdentifier	 write Current Local Counter Id
(	TokenNameLPAREN	
CounterId	TokenNameIdentifier	 Counter Id
oldCounterId	TokenNameIdentifier	 old Counter Id
,	TokenNameCOMMA	
CounterId	TokenNameIdentifier	 Counter Id
newCounterId	TokenNameIdentifier	 new Counter Id
,	TokenNameCOMMA	
long	TokenNamelong	
now	TokenNameIdentifier	 now
)	TokenNameRPAREN	
{	TokenNameLBRACE	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
ip	TokenNameIdentifier	 ip
=	TokenNameEQUAL	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
.	TokenNameDOT	
wrap	TokenNameIdentifier	 wrap
(	TokenNameLPAREN	
FBUtilities	TokenNameIdentifier	 FB Utilities
.	TokenNameDOT	
getBroadcastAddress	TokenNameIdentifier	 get Broadcast Address
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getAddress	TokenNameIdentifier	 get Address
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ColumnFamily	TokenNameIdentifier	 Column Family
cf	TokenNameIdentifier	 cf
=	TokenNameEQUAL	
ColumnFamily	TokenNameIdentifier	 Column Family
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
SYSTEM_KS	TokenNameIdentifier	 SYSTEM  KS
,	TokenNameCOMMA	
COUNTER_ID_CF	TokenNameIdentifier	 COUNTER  ID  CF
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
cf	TokenNameIdentifier	 cf
.	TokenNameDOT	
addColumn	TokenNameIdentifier	 add Column
(	TokenNameLPAREN	
new	TokenNamenew	
Column	TokenNameIdentifier	 Column
(	TokenNameLPAREN	
newCounterId	TokenNameIdentifier	 new Counter Id
.	TokenNameDOT	
bytes	TokenNameIdentifier	 bytes
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
ip	TokenNameIdentifier	 ip
,	TokenNameCOMMA	
now	TokenNameIdentifier	 now
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
RowMutation	TokenNameIdentifier	 Row Mutation
rm	TokenNameIdentifier	 rm
=	TokenNameEQUAL	
new	TokenNamenew	
RowMutation	TokenNameIdentifier	 Row Mutation
(	TokenNameLPAREN	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
SYSTEM_KS	TokenNameIdentifier	 SYSTEM  KS
,	TokenNameCOMMA	
ALL_LOCAL_NODE_ID_KEY	TokenNameIdentifier	 ALL  LOCAL  NODE  ID  KEY
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
rm	TokenNameIdentifier	 rm
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
cf	TokenNameIdentifier	 cf
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
rm	TokenNameIdentifier	 rm
.	TokenNameDOT	
apply	TokenNameIdentifier	 apply
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
forceBlockingFlush	TokenNameIdentifier	 force Blocking Flush
(	TokenNameLPAREN	
COUNTER_ID_CF	TokenNameIdentifier	 COUNTER  ID  CF
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
CounterId	TokenNameIdentifier	 Counter Id
.	TokenNameDOT	
CounterIdRecord	TokenNameIdentifier	 Counter Id Record
>	TokenNameGREATER	
getOldLocalCounterIds	TokenNameIdentifier	 get Old Local Counter Ids
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
CounterId	TokenNameIdentifier	 Counter Id
.	TokenNameDOT	
CounterIdRecord	TokenNameIdentifier	 Counter Id Record
>	TokenNameGREATER	
l	TokenNameIdentifier	 l
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
CounterId	TokenNameIdentifier	 Counter Id
.	TokenNameDOT	
CounterIdRecord	TokenNameIdentifier	 Counter Id Record
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Table	TokenNameIdentifier	 Table
table	TokenNameIdentifier	 table
=	TokenNameEQUAL	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
SYSTEM_KS	TokenNameIdentifier	 SYSTEM  KS
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
QueryFilter	TokenNameIdentifier	 Query Filter
filter	TokenNameIdentifier	 filter
=	TokenNameEQUAL	
QueryFilter	TokenNameIdentifier	 Query Filter
.	TokenNameDOT	
getIdentityFilter	TokenNameIdentifier	 get Identity Filter
(	TokenNameLPAREN	
decorate	TokenNameIdentifier	 decorate
(	TokenNameLPAREN	
ALL_LOCAL_NODE_ID_KEY	TokenNameIdentifier	 ALL  LOCAL  NODE  ID  KEY
)	TokenNameRPAREN	
,	TokenNameCOMMA	
new	TokenNamenew	
QueryPath	TokenNameIdentifier	 Query Path
(	TokenNameLPAREN	
COUNTER_ID_CF	TokenNameIdentifier	 COUNTER  ID  CF
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ColumnFamily	TokenNameIdentifier	 Column Family
cf	TokenNameIdentifier	 cf
=	TokenNameEQUAL	
table	TokenNameIdentifier	 table
.	TokenNameDOT	
getColumnFamilyStore	TokenNameIdentifier	 get Column Family Store
(	TokenNameLPAREN	
COUNTER_ID_CF	TokenNameIdentifier	 COUNTER  ID  CF
)	TokenNameRPAREN	
.	TokenNameDOT	
getColumnFamily	TokenNameIdentifier	 get Column Family
(	TokenNameLPAREN	
filter	TokenNameIdentifier	 filter
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
CounterId	TokenNameIdentifier	 Counter Id
previous	TokenNameIdentifier	 previous
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
IColumn	TokenNameIdentifier	 I Column
c	TokenNameIdentifier	 c
:	TokenNameCOLON	
cf	TokenNameIdentifier	 cf
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
previous	TokenNameIdentifier	 previous
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
l	TokenNameIdentifier	 l
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
CounterId	TokenNameIdentifier	 Counter Id
.	TokenNameDOT	
CounterIdRecord	TokenNameIdentifier	 Counter Id Record
(	TokenNameLPAREN	
previous	TokenNameIdentifier	 previous
,	TokenNameCOMMA	
c	TokenNameIdentifier	 c
.	TokenNameDOT	
timestamp	TokenNameIdentifier	 timestamp
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// this will ignore the last column on purpose since it is the 	TokenNameCOMMENT_LINE	this will ignore the last column on purpose since it is the 
// current local node id 	TokenNameCOMMENT_LINE	current local node id 
previous	TokenNameIdentifier	 previous
=	TokenNameEQUAL	
CounterId	TokenNameIdentifier	 Counter Id
.	TokenNameDOT	
wrap	TokenNameIdentifier	 wrap
(	TokenNameLPAREN	
c	TokenNameIdentifier	 c
.	TokenNameDOT	
name	TokenNameIdentifier	 name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
l	TokenNameIdentifier	 l
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * @param cfName The name of the ColumnFamily responsible for part of the schema (keyspace, ColumnFamily, columns) * @return CFS responsible to hold low-level serialized schema */	TokenNameCOMMENT_JAVADOC	 @param cfName The name of the ColumnFamily responsible for part of the schema (keyspace, ColumnFamily, columns) @return CFS responsible to hold low-level serialized schema 
public	TokenNamepublic	
static	TokenNamestatic	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
schemaCFS	TokenNameIdentifier	 schema CFS
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
cfName	TokenNameIdentifier	 cf Name
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
SYSTEM_KS	TokenNameIdentifier	 SYSTEM  KS
)	TokenNameRPAREN	
.	TokenNameDOT	
getColumnFamilyStore	TokenNameIdentifier	 get Column Family Store
(	TokenNameLPAREN	
cfName	TokenNameIdentifier	 cf Name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Row	TokenNameIdentifier	 Row
>	TokenNameGREATER	
serializedSchema	TokenNameIdentifier	 serialized Schema
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Row	TokenNameIdentifier	 Row
>	TokenNameGREATER	
schema	TokenNameIdentifier	 schema
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
Row	TokenNameIdentifier	 Row
>	TokenNameGREATER	
(	TokenNameLPAREN	
3	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
schema	TokenNameIdentifier	 schema
.	TokenNameDOT	
addAll	TokenNameIdentifier	 add All
(	TokenNameLPAREN	
serializedSchema	TokenNameIdentifier	 serialized Schema
(	TokenNameLPAREN	
SCHEMA_KEYSPACES_CF	TokenNameIdentifier	 SCHEMA  KEYSPACES  CF
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
schema	TokenNameIdentifier	 schema
.	TokenNameDOT	
addAll	TokenNameIdentifier	 add All
(	TokenNameLPAREN	
serializedSchema	TokenNameIdentifier	 serialized Schema
(	TokenNameLPAREN	
SCHEMA_COLUMNFAMILIES_CF	TokenNameIdentifier	 SCHEMA  COLUMNFAMILIES  CF
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
schema	TokenNameIdentifier	 schema
.	TokenNameDOT	
addAll	TokenNameIdentifier	 add All
(	TokenNameLPAREN	
serializedSchema	TokenNameIdentifier	 serialized Schema
(	TokenNameLPAREN	
SCHEMA_COLUMNS_CF	TokenNameIdentifier	 SCHEMA  COLUMNS  CF
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
schema	TokenNameIdentifier	 schema
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * @param schemaCfName The name of the ColumnFamily responsible for part of the schema (keyspace, ColumnFamily, columns) * @return low-level schema representation (each row represents individual Keyspace or ColumnFamily) */	TokenNameCOMMENT_JAVADOC	 @param schemaCfName The name of the ColumnFamily responsible for part of the schema (keyspace, ColumnFamily, columns) @return low-level schema representation (each row represents individual Keyspace or ColumnFamily) 
public	TokenNamepublic	
static	TokenNamestatic	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Row	TokenNameIdentifier	 Row
>	TokenNameGREATER	
serializedSchema	TokenNameIdentifier	 serialized Schema
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
schemaCfName	TokenNameIdentifier	 schema Cf Name
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Token	TokenNameIdentifier	 Token
minToken	TokenNameIdentifier	 min Token
=	TokenNameEQUAL	
StorageService	TokenNameIdentifier	 Storage Service
.	TokenNameDOT	
getPartitioner	TokenNameIdentifier	 get Partitioner
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getMinimumToken	TokenNameIdentifier	 get Minimum Token
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
schemaCFS	TokenNameIdentifier	 schema CFS
(	TokenNameLPAREN	
schemaCfName	TokenNameIdentifier	 schema Cf Name
)	TokenNameRPAREN	
.	TokenNameDOT	
getRangeSlice	TokenNameIdentifier	 get Range Slice
(	TokenNameLPAREN	
null	TokenNamenull	
,	TokenNameCOMMA	
new	TokenNamenew	
Range	TokenNameIdentifier	 Range
<	TokenNameLESS	
RowPosition	TokenNameIdentifier	 Row Position
>	TokenNameGREATER	
(	TokenNameLPAREN	
minToken	TokenNameIdentifier	 min Token
.	TokenNameDOT	
minKeyBound	TokenNameIdentifier	 min Key Bound
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
minToken	TokenNameIdentifier	 min Token
.	TokenNameDOT	
maxKeyBound	TokenNameIdentifier	 max Key Bound
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Integer	TokenNameIdentifier	 Integer
.	TokenNameDOT	
MAX_VALUE	TokenNameIdentifier	 MAX  VALUE
,	TokenNameCOMMA	
new	TokenNamenew	
IdentityQueryFilter	TokenNameIdentifier	 Identity Query Filter
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
RowMutation	TokenNameIdentifier	 Row Mutation
>	TokenNameGREATER	
serializeSchema	TokenNameIdentifier	 serialize Schema
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
DecoratedKey	TokenNameIdentifier	 Decorated Key
,	TokenNameCOMMA	
RowMutation	TokenNameIdentifier	 Row Mutation
>	TokenNameGREATER	
mutationMap	TokenNameIdentifier	 mutation Map
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
DecoratedKey	TokenNameIdentifier	 Decorated Key
,	TokenNameCOMMA	
RowMutation	TokenNameIdentifier	 Row Mutation
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
serializeSchema	TokenNameIdentifier	 serialize Schema
(	TokenNameLPAREN	
mutationMap	TokenNameIdentifier	 mutation Map
,	TokenNameCOMMA	
SCHEMA_KEYSPACES_CF	TokenNameIdentifier	 SCHEMA  KEYSPACES  CF
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
serializeSchema	TokenNameIdentifier	 serialize Schema
(	TokenNameLPAREN	
mutationMap	TokenNameIdentifier	 mutation Map
,	TokenNameCOMMA	
SCHEMA_COLUMNFAMILIES_CF	TokenNameIdentifier	 SCHEMA  COLUMNFAMILIES  CF
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
serializeSchema	TokenNameIdentifier	 serialize Schema
(	TokenNameLPAREN	
mutationMap	TokenNameIdentifier	 mutation Map
,	TokenNameCOMMA	
SCHEMA_COLUMNS_CF	TokenNameIdentifier	 SCHEMA  COLUMNS  CF
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
mutationMap	TokenNameIdentifier	 mutation Map
.	TokenNameDOT	
values	TokenNameIdentifier	 values
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
void	TokenNamevoid	
serializeSchema	TokenNameIdentifier	 serialize Schema
(	TokenNameLPAREN	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
DecoratedKey	TokenNameIdentifier	 Decorated Key
,	TokenNameCOMMA	
RowMutation	TokenNameIdentifier	 Row Mutation
>	TokenNameGREATER	
mutationMap	TokenNameIdentifier	 mutation Map
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
schemaCfName	TokenNameIdentifier	 schema Cf Name
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
Row	TokenNameIdentifier	 Row
schemaRow	TokenNameIdentifier	 schema Row
:	TokenNameCOLON	
serializedSchema	TokenNameIdentifier	 serialized Schema
(	TokenNameLPAREN	
schemaCfName	TokenNameIdentifier	 schema Cf Name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
Schema	TokenNameIdentifier	 Schema
.	TokenNameDOT	
ignoredSchemaRow	TokenNameIdentifier	 ignored Schema Row
(	TokenNameLPAREN	
schemaRow	TokenNameIdentifier	 schema Row
)	TokenNameRPAREN	
)	TokenNameRPAREN	
continue	TokenNamecontinue	
;	TokenNameSEMICOLON	
RowMutation	TokenNameIdentifier	 Row Mutation
mutation	TokenNameIdentifier	 mutation
=	TokenNameEQUAL	
mutationMap	TokenNameIdentifier	 mutation Map
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
schemaRow	TokenNameIdentifier	 schema Row
.	TokenNameDOT	
key	TokenNameIdentifier	 key
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
mutation	TokenNameIdentifier	 mutation
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
mutationMap	TokenNameIdentifier	 mutation Map
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
schemaRow	TokenNameIdentifier	 schema Row
.	TokenNameDOT	
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
new	TokenNamenew	
RowMutation	TokenNameIdentifier	 Row Mutation
(	TokenNameLPAREN	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
SYSTEM_KS	TokenNameIdentifier	 SYSTEM  KS
,	TokenNameCOMMA	
schemaRow	TokenNameIdentifier	 schema Row
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
continue	TokenNamecontinue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
mutation	TokenNameIdentifier	 mutation
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
schemaRow	TokenNameIdentifier	 schema Row
.	TokenNameDOT	
cf	TokenNameIdentifier	 cf
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
DecoratedKey	TokenNameIdentifier	 Decorated Key
,	TokenNameCOMMA	
ColumnFamily	TokenNameIdentifier	 Column Family
>	TokenNameGREATER	
getSchema	TokenNameIdentifier	 get Schema
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
cfName	TokenNameIdentifier	 cf Name
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
DecoratedKey	TokenNameIdentifier	 Decorated Key
,	TokenNameCOMMA	
ColumnFamily	TokenNameIdentifier	 Column Family
>	TokenNameGREATER	
schema	TokenNameIdentifier	 schema
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
DecoratedKey	TokenNameIdentifier	 Decorated Key
,	TokenNameCOMMA	
ColumnFamily	TokenNameIdentifier	 Column Family
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
Row	TokenNameIdentifier	 Row
schemaEntity	TokenNameIdentifier	 schema Entity
:	TokenNameCOLON	
SystemTable	TokenNameIdentifier	 System Table
.	TokenNameDOT	
serializedSchema	TokenNameIdentifier	 serialized Schema
(	TokenNameLPAREN	
cfName	TokenNameIdentifier	 cf Name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
schema	TokenNameIdentifier	 schema
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
schemaEntity	TokenNameIdentifier	 schema Entity
.	TokenNameDOT	
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
schemaEntity	TokenNameIdentifier	 schema Entity
.	TokenNameDOT	
cf	TokenNameIdentifier	 cf
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
schema	TokenNameIdentifier	 schema
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
getSchemaKSKey	TokenNameIdentifier	 get Schema KS Key
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
ksName	TokenNameIdentifier	 ks Name
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
AsciiType	TokenNameIdentifier	 Ascii Type
.	TokenNameDOT	
instance	TokenNameIdentifier	 instance
.	TokenNameDOT	
fromString	TokenNameIdentifier	 from String
(	TokenNameLPAREN	
ksName	TokenNameIdentifier	 ks Name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
Row	TokenNameIdentifier	 Row
readSchemaRow	TokenNameIdentifier	 read Schema Row
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
ksName	TokenNameIdentifier	 ks Name
)	TokenNameRPAREN	
{	TokenNameLBRACE	
DecoratedKey	TokenNameIdentifier	 Decorated Key
key	TokenNameIdentifier	 key
=	TokenNameEQUAL	
StorageService	TokenNameIdentifier	 Storage Service
.	TokenNameDOT	
getPartitioner	TokenNameIdentifier	 get Partitioner
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
decorateKey	TokenNameIdentifier	 decorate Key
(	TokenNameLPAREN	
getSchemaKSKey	TokenNameIdentifier	 get Schema KS Key
(	TokenNameLPAREN	
ksName	TokenNameIdentifier	 ks Name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
schemaCFS	TokenNameIdentifier	 schema CFS
=	TokenNameEQUAL	
SystemTable	TokenNameIdentifier	 System Table
.	TokenNameDOT	
schemaCFS	TokenNameIdentifier	 schema CFS
(	TokenNameLPAREN	
SCHEMA_KEYSPACES_CF	TokenNameIdentifier	 SCHEMA  KEYSPACES  CF
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ColumnFamily	TokenNameIdentifier	 Column Family
result	TokenNameIdentifier	 result
=	TokenNameEQUAL	
schemaCFS	TokenNameIdentifier	 schema CFS
.	TokenNameDOT	
getColumnFamily	TokenNameIdentifier	 get Column Family
(	TokenNameLPAREN	
QueryFilter	TokenNameIdentifier	 Query Filter
.	TokenNameDOT	
getIdentityFilter	TokenNameIdentifier	 get Identity Filter
(	TokenNameLPAREN	
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
new	TokenNamenew	
QueryPath	TokenNameIdentifier	 Query Path
(	TokenNameLPAREN	
SCHEMA_KEYSPACES_CF	TokenNameIdentifier	 SCHEMA  KEYSPACES  CF
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
new	TokenNamenew	
Row	TokenNameIdentifier	 Row
(	TokenNameLPAREN	
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
result	TokenNameIdentifier	 result
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
Row	TokenNameIdentifier	 Row
readSchemaRow	TokenNameIdentifier	 read Schema Row
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
ksName	TokenNameIdentifier	 ks Name
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
cfName	TokenNameIdentifier	 cf Name
)	TokenNameRPAREN	
{	TokenNameLBRACE	
DecoratedKey	TokenNameIdentifier	 Decorated Key
key	TokenNameIdentifier	 key
=	TokenNameEQUAL	
StorageService	TokenNameIdentifier	 Storage Service
.	TokenNameDOT	
getPartitioner	TokenNameIdentifier	 get Partitioner
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
decorateKey	TokenNameIdentifier	 decorate Key
(	TokenNameLPAREN	
getSchemaKSKey	TokenNameIdentifier	 get Schema KS Key
(	TokenNameLPAREN	
ksName	TokenNameIdentifier	 ks Name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
schemaCFS	TokenNameIdentifier	 schema CFS
=	TokenNameEQUAL	
SystemTable	TokenNameIdentifier	 System Table
.	TokenNameDOT	
schemaCFS	TokenNameIdentifier	 schema CFS
(	TokenNameLPAREN	
SCHEMA_COLUMNFAMILIES_CF	TokenNameIdentifier	 SCHEMA  COLUMNFAMILIES  CF
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ColumnFamily	TokenNameIdentifier	 Column Family
result	TokenNameIdentifier	 result
=	TokenNameEQUAL	
schemaCFS	TokenNameIdentifier	 schema CFS
.	TokenNameDOT	
getColumnFamily	TokenNameIdentifier	 get Column Family
(	TokenNameLPAREN	
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
new	TokenNamenew	
QueryPath	TokenNameIdentifier	 Query Path
(	TokenNameLPAREN	
SCHEMA_COLUMNFAMILIES_CF	TokenNameIdentifier	 SCHEMA  COLUMNFAMILIES  CF
)	TokenNameRPAREN	
,	TokenNameCOMMA	
DefsTable	TokenNameIdentifier	 Defs Table
.	TokenNameDOT	
searchComposite	TokenNameIdentifier	 search Composite
(	TokenNameLPAREN	
cfName	TokenNameIdentifier	 cf Name
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
DefsTable	TokenNameIdentifier	 Defs Table
.	TokenNameDOT	
searchComposite	TokenNameIdentifier	 search Composite
(	TokenNameLPAREN	
cfName	TokenNameIdentifier	 cf Name
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
false	TokenNamefalse	
,	TokenNameCOMMA	
Integer	TokenNameIdentifier	 Integer
.	TokenNameDOT	
MAX_VALUE	TokenNameIdentifier	 MAX  VALUE
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
new	TokenNamenew	
Row	TokenNameIdentifier	 Row
(	TokenNameLPAREN	
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
result	TokenNameIdentifier	 result
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
