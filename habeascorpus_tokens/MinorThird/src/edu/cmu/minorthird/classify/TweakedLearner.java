package	TokenNamepackage	
edu	TokenNameIdentifier	 edu
.	TokenNameDOT	
cmu	TokenNameIdentifier	 cmu
.	TokenNameDOT	
minorthird	TokenNameIdentifier	 minorthird
.	TokenNameDOT	
classify	TokenNameIdentifier	 classify
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
awt	TokenNameIdentifier	 awt
.	TokenNameDOT	
BorderLayout	TokenNameIdentifier	 Border Layout
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
Serializable	TokenNameIdentifier	 Serializable
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
ArrayList	TokenNameIdentifier	 Array List
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
Collections	TokenNameIdentifier	 Collections
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
Comparator	TokenNameIdentifier	 Comparator
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
Iterator	TokenNameIdentifier	 Iterator
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
List	TokenNameIdentifier	 List
;	TokenNameSEMICOLON	
import	TokenNameimport	
javax	TokenNameIdentifier	 javax
.	TokenNameDOT	
swing	TokenNameIdentifier	 swing
.	TokenNameDOT	
JComponent	TokenNameIdentifier	 J Component
;	TokenNameSEMICOLON	
import	TokenNameimport	
javax	TokenNameIdentifier	 javax
.	TokenNameDOT	
swing	TokenNameIdentifier	 swing
.	TokenNameDOT	
JLabel	TokenNameIdentifier	 J Label
;	TokenNameSEMICOLON	
import	TokenNameimport	
javax	TokenNameIdentifier	 javax
.	TokenNameDOT	
swing	TokenNameIdentifier	 swing
.	TokenNameDOT	
JPanel	TokenNameIdentifier	 J Panel
;	TokenNameSEMICOLON	
import	TokenNameimport	
javax	TokenNameIdentifier	 javax
.	TokenNameDOT	
swing	TokenNameIdentifier	 swing
.	TokenNameDOT	
JScrollPane	TokenNameIdentifier	 J Scroll Pane
;	TokenNameSEMICOLON	
import	TokenNameimport	
javax	TokenNameIdentifier	 javax
.	TokenNameDOT	
swing	TokenNameIdentifier	 swing
.	TokenNameDOT	
border	TokenNameIdentifier	 border
.	TokenNameDOT	
TitledBorder	TokenNameIdentifier	 Titled Border
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
log4j	TokenNameIdentifier	 log4j
.	TokenNameDOT	
Logger	TokenNameIdentifier	 Logger
;	TokenNameSEMICOLON	
import	TokenNameimport	
edu	TokenNameIdentifier	 edu
.	TokenNameDOT	
cmu	TokenNameIdentifier	 cmu
.	TokenNameDOT	
minorthird	TokenNameIdentifier	 minorthird
.	TokenNameDOT	
classify	TokenNameIdentifier	 classify
.	TokenNameDOT	
algorithms	TokenNameIdentifier	 algorithms
.	TokenNameDOT	
linear	TokenNameIdentifier	 linear
.	TokenNameDOT	
NaiveBayes	TokenNameIdentifier	 Naive Bayes
;	TokenNameSEMICOLON	
import	TokenNameimport	
edu	TokenNameIdentifier	 edu
.	TokenNameDOT	
cmu	TokenNameIdentifier	 cmu
.	TokenNameDOT	
minorthird	TokenNameIdentifier	 minorthird
.	TokenNameDOT	
classify	TokenNameIdentifier	 classify
.	TokenNameDOT	
experiments	TokenNameIdentifier	 experiments
.	TokenNameDOT	
Evaluation	TokenNameIdentifier	 Evaluation
.	TokenNameDOT	
Matrix	TokenNameIdentifier	 Matrix
;	TokenNameSEMICOLON	
import	TokenNameimport	
edu	TokenNameIdentifier	 edu
.	TokenNameDOT	
cmu	TokenNameIdentifier	 cmu
.	TokenNameDOT	
minorthird	TokenNameIdentifier	 minorthird
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
MathUtil	TokenNameIdentifier	 Math Util
;	TokenNameSEMICOLON	
import	TokenNameimport	
edu	TokenNameIdentifier	 edu
.	TokenNameDOT	
cmu	TokenNameIdentifier	 cmu
.	TokenNameDOT	
minorthird	TokenNameIdentifier	 minorthird
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
gui	TokenNameIdentifier	 gui
.	TokenNameDOT	
ComponentViewer	TokenNameIdentifier	 Component Viewer
;	TokenNameSEMICOLON	
import	TokenNameimport	
edu	TokenNameIdentifier	 edu
.	TokenNameDOT	
cmu	TokenNameIdentifier	 cmu
.	TokenNameDOT	
minorthird	TokenNameIdentifier	 minorthird
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
gui	TokenNameIdentifier	 gui
.	TokenNameDOT	
SmartVanillaViewer	TokenNameIdentifier	 Smart Vanilla Viewer
;	TokenNameSEMICOLON	
import	TokenNameimport	
edu	TokenNameIdentifier	 edu
.	TokenNameDOT	
cmu	TokenNameIdentifier	 cmu
.	TokenNameDOT	
minorthird	TokenNameIdentifier	 minorthird
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
gui	TokenNameIdentifier	 gui
.	TokenNameDOT	
Viewer	TokenNameIdentifier	 Viewer
;	TokenNameSEMICOLON	
import	TokenNameimport	
edu	TokenNameIdentifier	 edu
.	TokenNameDOT	
cmu	TokenNameIdentifier	 cmu
.	TokenNameDOT	
minorthird	TokenNameIdentifier	 minorthird
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
gui	TokenNameIdentifier	 gui
.	TokenNameDOT	
Visible	TokenNameIdentifier	 Visible
;	TokenNameSEMICOLON	
/** * A Tweaked Learner, with an optimization of the precision vs. recall * * @author Giora Unger * Created on May 19, 2005 * * A learner whose score was optimized according to an F_beta() function, * for a given beta. This optimization is used to fine-tune the precision * vs. recall for the underlying classification algorithm. * Values of beta<1.0 favor precision over recall, while values of * beta>1.0 favor recall over precision. beta=1.0 grants equal weight * to both precision and recall. * * <p>Reference: Jason D. M. Rennie, * <i>Derivation of the F-Measure</i>, * http://people.csail.mit.edu/jrennie/writing/fmeasure.pdf */	TokenNameCOMMENT_JAVADOC	 A Tweaked Learner, with an optimization of the precision vs. recall * @author Giora Unger Created on May 19, 2005 * A learner whose score was optimized according to an F_beta() function, for a given beta. This optimization is used to fine-tune the precision vs. recall for the underlying classification algorithm. Values of beta<1.0 favor precision over recall, while values of beta>1.0 favor recall over precision. beta=1.0 grants equal weight to both precision and recall. * <p>Reference: Jason D. M. Rennie, <i>Derivation of the F-Measure</i>, http://people.csail.mit.edu/jrennie/writing/fmeasure.pdf 
public	TokenNamepublic	
class	TokenNameclass	
TweakedLearner	TokenNameIdentifier	 Tweaked Learner
extends	TokenNameextends	
BatchBinaryClassifierLearner	TokenNameIdentifier	 Batch Binary Classifier Learner
{	TokenNameLBRACE	
// inner learner given to this class during construction 	TokenNameCOMMENT_LINE	inner learner given to this class during construction 
private	TokenNameprivate	
BinaryClassifierLearner	TokenNameIdentifier	 Binary Classifier Learner
innerLearner	TokenNameIdentifier	 inner Learner
;	TokenNameSEMICOLON	
// the beta according to which F_beta is to be maximized 	TokenNameCOMMENT_LINE	the beta according to which F_beta is to be maximized 
private	TokenNameprivate	
double	TokenNamedouble	
beta	TokenNameIdentifier	 beta
;	TokenNameSEMICOLON	
// dataset given 	TokenNameCOMMENT_LINE	dataset given 
private	TokenNameprivate	
Dataset	TokenNameIdentifier	 Dataset
m_dataset	TokenNameIdentifier	 m dataset
;	TokenNameSEMICOLON	
// dataset schema 	TokenNameCOMMENT_LINE	dataset schema 
private	TokenNameprivate	
ExampleSchema	TokenNameIdentifier	 Example Schema
schema	TokenNameIdentifier	 schema
;	TokenNameSEMICOLON	
// flag indicating whether the given dataset is binary or not 	TokenNameCOMMENT_LINE	flag indicating whether the given dataset is binary or not 
private	TokenNameprivate	
boolean	TokenNameboolean	
isBinary	TokenNameIdentifier	 is Binary
=	TokenNameEQUAL	
true	TokenNametrue	
;	TokenNameSEMICOLON	
// value to be returned if a non-binary dataset is given to 	TokenNameCOMMENT_LINE	value to be returned if a non-binary dataset is given to 
// precision() or recall() methods 	TokenNameCOMMENT_LINE	precision() or recall() methods 
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
int	TokenNameint	
ILLEGAL_VALUE	TokenNameIdentifier	 ILLEGAL  VALUE
=	TokenNameEQUAL	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
double	TokenNamedouble	
UNINITIALIZED	TokenNameIdentifier	 UNINITIALIZED
=	TokenNameEQUAL	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
// actual data structure in which the examples are stored, along with 	TokenNameCOMMENT_LINE	actual data structure in which the examples are stored, along with 
// additional fields required for executing the tweaking 	TokenNameCOMMENT_LINE	additional fields required for executing the tweaking 
private	TokenNameprivate	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Row	TokenNameIdentifier	 Row
>	TokenNameGREATER	
tweakingTable	TokenNameIdentifier	 tweaking Table
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
Row	TokenNameIdentifier	 Row
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// confusion matrix used for efficiently perform the tweaking 	TokenNameCOMMENT_LINE	confusion matrix used for efficiently perform the tweaking 
Matrix	TokenNameIdentifier	 Matrix
cm	TokenNameIdentifier	 cm
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
// logger for this class 	TokenNameCOMMENT_LINE	logger for this class 
private	TokenNameprivate	
static	TokenNamestatic	
Logger	TokenNameIdentifier	 Logger
log	TokenNameIdentifier	 log
=	TokenNameEQUAL	
Logger	TokenNameIdentifier	 Logger
.	TokenNameDOT	
getLogger	TokenNameIdentifier	 get Logger
(	TokenNameLPAREN	
TweakedLearner	TokenNameIdentifier	 Tweaked Learner
.	TokenNameDOT	
class	TokenNameclass	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
/** ******************************************************************** * Public methods ******************************************************************** */	TokenNameCOMMENT_JAVADOC	 ******************************************************************** Public methods ******************************************************************** 
// TweakedLearner constructor 	TokenNameCOMMENT_LINE	TweakedLearner constructor 
public	TokenNamepublic	
TweakedLearner	TokenNameIdentifier	 Tweaked Learner
(	TokenNameLPAREN	
BinaryClassifierLearner	TokenNameIdentifier	 Binary Classifier Learner
innerLearner	TokenNameIdentifier	 inner Learner
,	TokenNameCOMMA	
double	TokenNamedouble	
beta	TokenNameIdentifier	 beta
)	TokenNameRPAREN	
{	TokenNameLBRACE	
this	TokenNamethis	
.	TokenNameDOT	
beta	TokenNameIdentifier	 beta
=	TokenNameEQUAL	
beta	TokenNameIdentifier	 beta
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
innerLearner	TokenNameIdentifier	 inner Learner
=	TokenNameEQUAL	
innerLearner	TokenNameIdentifier	 inner Learner
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/* * main method of the TweakedLearner class. Recieves a binary * training dataset and then: * 1. Trains on it, based on the innerLearner, namely its inherent * binary classifier. * 2. Tweaks the classifier (or, more precisely, the model this * classifier came up with), so that F_beta is maximized. This is * done by finding a threshold, see details below. * 3. Creates and returns a new TweakedClassifier, with the original * (inner) classifier and the threshold that was found. */	TokenNameCOMMENT_BLOCK	 main method of the TweakedLearner class. Recieves a binary training dataset and then: 1. Trains on it, based on the innerLearner, namely its inherent binary classifier. 2. Tweaks the classifier (or, more precisely, the model this classifier came up with), so that F_beta is maximized. This is done by finding a threshold, see details below. 3. Creates and returns a new TweakedClassifier, with the original (inner) classifier and the threshold that was found. 
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
Classifier	TokenNameIdentifier	 Classifier
batchTrain	TokenNameIdentifier	 batch Train
(	TokenNameLPAREN	
Dataset	TokenNameIdentifier	 Dataset
dataset	TokenNameIdentifier	 dataset
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// make sure the dataset given is indeed binary 	TokenNameCOMMENT_LINE	make sure the dataset given is indeed binary 
this	TokenNamethis	
.	TokenNameDOT	
schema	TokenNameIdentifier	 schema
=	TokenNameEQUAL	
dataset	TokenNameIdentifier	 dataset
.	TokenNameDOT	
getSchema	TokenNameIdentifier	 get Schema
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
isBinary	TokenNameIdentifier	 is Binary
=	TokenNameEQUAL	
schema	TokenNameIdentifier	 schema
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
ExampleSchema	TokenNameIdentifier	 Example Schema
.	TokenNameDOT	
BINARY_EXAMPLE_SCHEMA	TokenNameIdentifier	 BINARY  EXAMPLE  SCHEMA
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
isBinary	TokenNameIdentifier	 is Binary
)	TokenNameRPAREN	
// make sure dataset is binary 	TokenNameCOMMENT_LINE	make sure dataset is binary 
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
IllegalArgumentException	TokenNameIdentifier	 Illegal Argument Exception
(	TokenNameLPAREN	
"Dataset given to TweakedLearner::batchTrain must be a binary dataset"	TokenNameStringLiteral	Dataset given to TweakedLearner::batchTrain must be a binary dataset
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
dataset	TokenNameIdentifier	 dataset
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
// make sure dataset is not empty 	TokenNameCOMMENT_LINE	make sure dataset is not empty 
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
IllegalArgumentException	TokenNameIdentifier	 Illegal Argument Exception
(	TokenNameLPAREN	
"Dataset given to TweakedLearner::batchTrain is empty"	TokenNameStringLiteral	Dataset given to TweakedLearner::batchTrain is empty
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
this	TokenNamethis	
.	TokenNameDOT	
m_dataset	TokenNameIdentifier	 m dataset
=	TokenNameEQUAL	
dataset	TokenNameIdentifier	 dataset
;	TokenNameSEMICOLON	
// get the classifier resulting from training on the given dataset 	TokenNameCOMMENT_LINE	get the classifier resulting from training on the given dataset 
BinaryClassifier	TokenNameIdentifier	 Binary Classifier
bc	TokenNameIdentifier	 bc
=	TokenNameEQUAL	
(	TokenNameLPAREN	
BinaryClassifier	TokenNameIdentifier	 Binary Classifier
)	TokenNameRPAREN	
new	TokenNamenew	
DatasetClassifierTeacher	TokenNameIdentifier	 Dataset Classifier Teacher
(	TokenNameLPAREN	
m_dataset	TokenNameIdentifier	 m dataset
)	TokenNameRPAREN	
.	TokenNameDOT	
train	TokenNameIdentifier	 train
(	TokenNameLPAREN	
innerLearner	TokenNameIdentifier	 inner Learner
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Initialize the data structure required for the tweaking. Please note 	TokenNameCOMMENT_LINE	Initialize the data structure required for the tweaking. Please note 
// that the ExecuteTweaking() method assumes that the rows in this table 	TokenNameCOMMENT_LINE	that the ExecuteTweaking() method assumes that the rows in this table 
// are sorted by descending score 	TokenNameCOMMENT_LINE	are sorted by descending score 
initializeTable	TokenNameIdentifier	 initialize Table
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Execute actual tweaking - figure out what threshold works best on the 	TokenNameCOMMENT_LINE	Execute actual tweaking - figure out what threshold works best on the 
// given dataset w.r.t. F_beta 	TokenNameCOMMENT_LINE	given dataset w.r.t. F_beta 
double	TokenNamedouble	
threshold	TokenNameIdentifier	 threshold
=	TokenNameEQUAL	
executeTweaking	TokenNameIdentifier	 execute Tweaking
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
new	TokenNamenew	
TweakedClassifier	TokenNameIdentifier	 Tweaked Classifier
(	TokenNameLPAREN	
bc	TokenNameIdentifier	 bc
,	TokenNameCOMMA	
threshold	TokenNameIdentifier	 threshold
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** ******************************************************************** * Getters & Setters ******************************************************************** */	TokenNameCOMMENT_JAVADOC	 ******************************************************************** Getters & Setters ******************************************************************** 
/** * @return Returns the beta. */	TokenNameCOMMENT_JAVADOC	 @return Returns the beta. 
public	TokenNamepublic	
double	TokenNamedouble	
getBeta	TokenNameIdentifier	 get Beta
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
beta	TokenNameIdentifier	 beta
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * @param beta The beta to set. */	TokenNameCOMMENT_JAVADOC	 @param beta The beta to set. 
public	TokenNamepublic	
void	TokenNamevoid	
setBeta	TokenNameIdentifier	 set Beta
(	TokenNameLPAREN	
double	TokenNamedouble	
beta	TokenNameIdentifier	 beta
)	TokenNameRPAREN	
{	TokenNameLBRACE	
this	TokenNamethis	
.	TokenNameDOT	
beta	TokenNameIdentifier	 beta
=	TokenNameEQUAL	
beta	TokenNameIdentifier	 beta
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * @return Returns the innerLearner. */	TokenNameCOMMENT_JAVADOC	 @return Returns the innerLearner. 
public	TokenNamepublic	
BinaryClassifierLearner	TokenNameIdentifier	 Binary Classifier Learner
getInnerLearner	TokenNameIdentifier	 get Inner Learner
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
innerLearner	TokenNameIdentifier	 inner Learner
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * @param learner The innerLearner to set. */	TokenNameCOMMENT_JAVADOC	 @param learner The innerLearner to set. 
public	TokenNamepublic	
void	TokenNamevoid	
setInnerLearner	TokenNameIdentifier	 set Inner Learner
(	TokenNameLPAREN	
BinaryClassifierLearner	TokenNameIdentifier	 Binary Classifier Learner
learner	TokenNameIdentifier	 learner
)	TokenNameRPAREN	
{	TokenNameLBRACE	
this	TokenNamethis	
.	TokenNameDOT	
innerLearner	TokenNameIdentifier	 inner Learner
=	TokenNameEQUAL	
learner	TokenNameIdentifier	 learner
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** ******************************************************************** * Private methods ******************************************************************** */	TokenNameCOMMENT_JAVADOC	 ******************************************************************** Private methods ******************************************************************** 
// This method initializes tweakingTable, which the data structure used for tweaking 	TokenNameCOMMENT_LINE	This method initializes tweakingTable, which the data structure used for tweaking 
// It loops over the examples in the given dataset, and insert them into the 	TokenNameCOMMENT_LINE	It loops over the examples in the given dataset, and insert them into the 
// the table. According to the needs of the tweaking process, the rows are then 	TokenNameCOMMENT_LINE	the table. According to the needs of the tweaking process, the rows are then 
// sorted by descending score (also called posWeight). 	TokenNameCOMMENT_LINE	sorted by descending score (also called posWeight). 
private	TokenNameprivate	
void	TokenNamevoid	
initializeTable	TokenNameIdentifier	 initialize Table
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
int	TokenNameint	
counter	TokenNameIdentifier	 counter
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
Iterator	TokenNameIdentifier	 Iterator
<	TokenNameLESS	
Example	TokenNameIdentifier	 Example
>	TokenNameGREATER	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
m_dataset	TokenNameIdentifier	 m dataset
.	TokenNameDOT	
iterator	TokenNameIdentifier	 iterator
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
.	TokenNameDOT	
hasNext	TokenNameIdentifier	 has Next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
counter	TokenNameIdentifier	 counter
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Example	TokenNameIdentifier	 Example
ex	TokenNameIdentifier	 ex
=	TokenNameEQUAL	
i	TokenNameIdentifier	 i
.	TokenNameDOT	
next	TokenNameIdentifier	 next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ClassLabel	TokenNameIdentifier	 Class Label
predicted	TokenNameIdentifier	 predicted
=	TokenNameEQUAL	
innerLearner	TokenNameIdentifier	 inner Learner
.	TokenNameDOT	
getBinaryClassifier	TokenNameIdentifier	 get Binary Classifier
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
classification	TokenNameIdentifier	 classification
(	TokenNameLPAREN	
ex	TokenNameIdentifier	 ex
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// add example into the tweaking data structure. note that the tweaked 	TokenNameCOMMENT_LINE	add example into the tweaking data structure. note that the tweaked 
// prediction given during initialization is NEG for all examples ! 	TokenNameCOMMENT_LINE	prediction given during initialization is NEG for all examples ! 
tweakingTable	TokenNameIdentifier	 tweaking Table
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Row	TokenNameIdentifier	 Row
(	TokenNameLPAREN	
ex	TokenNameIdentifier	 ex
.	TokenNameDOT	
asInstance	TokenNameIdentifier	 as Instance
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
ex	TokenNameIdentifier	 ex
.	TokenNameDOT	
getLabel	TokenNameIdentifier	 get Label
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
predicted	TokenNameIdentifier	 predicted
,	TokenNameCOMMA	
ClassLabel	TokenNameIdentifier	 Class Label
.	TokenNameDOT	
negativeLabel	TokenNameIdentifier	 negative Label
(	TokenNameLPAREN	
-	TokenNameMINUS	
1.0	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// debug code 	TokenNameCOMMENT_LINE	debug code 
//double score = innerLearner.getBinaryClassifier().score(ex); 	TokenNameCOMMENT_LINE	double score = innerLearner.getBinaryClassifier().score(ex); 
/* log.debug("Example number: "+ counter + ", posWeight: " + predicted.posWeight() + ", Score: " + score + ", Label: " + ex.getLabel()); */	TokenNameCOMMENT_BLOCK	 log.debug("Example number: "+ counter + ", posWeight: " + predicted.posWeight() + ", Score: " + score + ", Label: " + ex.getLabel()); 
}	TokenNameRBRACE	
// sort the table, after it was filled, by descending score 	TokenNameCOMMENT_LINE	sort the table, after it was filled, by descending score 
sortByScore	TokenNameIdentifier	 sort By Score
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/* * This method is the very heart of the tweaking process. It assumes that * the tweakingTable data structure was initilized and filled, with a row * for every example. It further assumes that all the examples were given an * initial tweak_prediction of NEG and that they were sorted by descending score * The method then: * 1. Initialize a confusion matrix, based on a NEG prediction to all examples. * 2. For every example, starting with the on ewith highest positive score: * a. set the tweak_prediction to POS * b. update the confusion matrix accordingly * c. calculate precision, recall and F_beta with the new confusion matrix * and fill these values in the tweakingtable data structure * Please note, that in any such iteration, all the examples/rows above * the current example (including itself) have a POS prediction, while all the * examples/rows below the current example have a NEG prediction. * That is, we prectically evaluate the F_beta when the "dividing line" is on * the current example * 3. After all the rows/exmaples are handled, choose the row with the maximal F_beta * 4. Select the score of this row, or more precisely the average between this score * and the next row's score, to be the threshold. * 5. Return this number as the threshold constituting the new TweakedClassifier. * */	TokenNameCOMMENT_BLOCK	 This method is the very heart of the tweaking process. It assumes that the tweakingTable data structure was initilized and filled, with a row for every example. It further assumes that all the examples were given an initial tweak_prediction of NEG and that they were sorted by descending score The method then: 1. Initialize a confusion matrix, based on a NEG prediction to all examples. 2. For every example, starting with the on ewith highest positive score: a. set the tweak_prediction to POS b. update the confusion matrix accordingly c. calculate precision, recall and F_beta with the new confusion matrix and fill these values in the tweakingtable data structure Please note, that in any such iteration, all the examples/rows above the current example (including itself) have a POS prediction, while all the examples/rows below the current example have a NEG prediction. That is, we prectically evaluate the F_beta when the "dividing line" is on the current example 3. After all the rows/exmaples are handled, choose the row with the maximal F_beta 4. Select the score of this row, or more precisely the average between this score and the next row's score, to be the threshold. 5. Return this number as the threshold constituting the new TweakedClassifier. 
private	TokenNameprivate	
double	TokenNamedouble	
executeTweaking	TokenNameIdentifier	 execute Tweaking
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
double	TokenNamedouble	
threshold	TokenNameIdentifier	 threshold
=	TokenNameEQUAL	
UNINITIALIZED	TokenNameIdentifier	 UNINITIALIZED
;	TokenNameSEMICOLON	
initConfusionMatrix	TokenNameIdentifier	 init Confusion Matrix
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// for every row, find and fill the precision, recall and F_beta 	TokenNameCOMMENT_LINE	for every row, find and fill the precision, recall and F_beta 
// Note, that each row examined is first set to POS 	TokenNameCOMMENT_LINE	Note, that each row examined is first set to POS 
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
tweakingTable	TokenNameIdentifier	 tweaking Table
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
++	TokenNamePLUS_PLUS	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// set dummy prediction of current example to POS 	TokenNameCOMMENT_LINE	set dummy prediction of current example to POS 
getRow	TokenNameIdentifier	 get Row
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
.	TokenNameDOT	
tweak_predicted	TokenNameIdentifier	 tweak predicted
=	TokenNameEQUAL	
ClassLabel	TokenNameIdentifier	 Class Label
.	TokenNameDOT	
positiveLabel	TokenNameIdentifier	 positive Label
(	TokenNameLPAREN	
1.0	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// update the confusion matrix based on this prediction change 	TokenNameCOMMENT_LINE	update the confusion matrix based on this prediction change 
updateConfusionMatrix	TokenNameIdentifier	 update Confusion Matrix
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// calculate the precision, recall and F_beta with the updated confusion matrix 	TokenNameCOMMENT_LINE	calculate the precision, recall and F_beta with the updated confusion matrix 
getRow	TokenNameIdentifier	 get Row
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
.	TokenNameDOT	
precision	TokenNameIdentifier	 precision
=	TokenNameEQUAL	
getCurrentPrecision	TokenNameIdentifier	 get Current Precision
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
getRow	TokenNameIdentifier	 get Row
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
.	TokenNameDOT	
recall	TokenNameIdentifier	 recall
=	TokenNameEQUAL	
getCurrentRecall	TokenNameIdentifier	 get Current Recall
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
getRow	TokenNameIdentifier	 get Row
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
.	TokenNameDOT	
F_beta	TokenNameIdentifier	 F beta
=	TokenNameEQUAL	
calculateFBeta	TokenNameIdentifier	 calculate F Beta
(	TokenNameLPAREN	
getRow	TokenNameIdentifier	 get Row
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
.	TokenNameDOT	
precision	TokenNameIdentifier	 precision
,	TokenNameCOMMA	
getRow	TokenNameIdentifier	 get Row
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
.	TokenNameDOT	
recall	TokenNameIdentifier	 recall
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
/* log.debug("row " + i + ", precision: " + getRow(i).precision + ", recall: " + getRow(i).recall + ", F_beta: " + getRow(i).F_beta + ", score: " + getRow(i).orig_predicted.posWeight()); */	TokenNameCOMMENT_BLOCK	 log.debug("row " + i + ", precision: " + getRow(i).precision + ", recall: " + getRow(i).recall + ", F_beta: " + getRow(i).F_beta + ", score: " + getRow(i).orig_predicted.posWeight()); 
}	TokenNameRBRACE	
// choose the threshold row, that is with maximal F_beta 	TokenNameCOMMENT_LINE	choose the threshold row, that is with maximal F_beta 
// translate its score into the returned threshold 	TokenNameCOMMENT_LINE	translate its score into the returned threshold 
int	TokenNameint	
index	TokenNameIdentifier	 index
=	TokenNameEQUAL	
maxFBetaEntry	TokenNameIdentifier	 max F Beta Entry
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// if the row that was found is the last row in the table (VERY unlikely), 	TokenNameCOMMENT_LINE	if the row that was found is the last row in the table (VERY unlikely), 
// set the threshold to be its score 	TokenNameCOMMENT_LINE	set the threshold to be its score 
if	TokenNameif	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
index	TokenNameIdentifier	 index
+	TokenNamePLUS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
tweakingTable	TokenNameIdentifier	 tweaking Table
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
threshold	TokenNameIdentifier	 threshold
=	TokenNameEQUAL	
getRow	TokenNameIdentifier	 get Row
(	TokenNameLPAREN	
index	TokenNameIdentifier	 index
)	TokenNameRPAREN	
.	TokenNameDOT	
orig_predicted	TokenNameIdentifier	 orig predicted
.	TokenNameDOT	
posWeight	TokenNameIdentifier	 pos Weight
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
// otherwise, set it to be the average between this row's score and 	TokenNameCOMMENT_LINE	otherwise, set it to be the average between this row's score and 
{	TokenNameLBRACE	
// the next row's score 	TokenNameCOMMENT_LINE	the next row's score 
double	TokenNamedouble	
maxRowScore	TokenNameIdentifier	 max Row Score
=	TokenNameEQUAL	
getRow	TokenNameIdentifier	 get Row
(	TokenNameLPAREN	
index	TokenNameIdentifier	 index
)	TokenNameRPAREN	
.	TokenNameDOT	
orig_predicted	TokenNameIdentifier	 orig predicted
.	TokenNameDOT	
posWeight	TokenNameIdentifier	 pos Weight
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
nextRowScore	TokenNameIdentifier	 next Row Score
=	TokenNameEQUAL	
getRow	TokenNameIdentifier	 get Row
(	TokenNameLPAREN	
index	TokenNameIdentifier	 index
+	TokenNamePLUS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
.	TokenNameDOT	
orig_predicted	TokenNameIdentifier	 orig predicted
.	TokenNameDOT	
posWeight	TokenNameIdentifier	 pos Weight
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
threshold	TokenNameIdentifier	 threshold
=	TokenNameEQUAL	
(	TokenNameLPAREN	
maxRowScore	TokenNameIdentifier	 max Row Score
+	TokenNamePLUS	
nextRowScore	TokenNameIdentifier	 next Row Score
)	TokenNameRPAREN	
/	TokenNameDIVIDE	
2	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
log	TokenNameIdentifier	 log
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"Threshold found: "	TokenNameStringLiteral	Threshold found: 
+	TokenNamePLUS	
threshold	TokenNameIdentifier	 threshold
+	TokenNamePLUS	
" (in row "	TokenNameStringLiteral	 (in row 
+	TokenNamePLUS	
index	TokenNameIdentifier	 index
+	TokenNamePLUS	
")"	TokenNameStringLiteral	)
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
threshold	TokenNameIdentifier	 threshold
;	TokenNameSEMICOLON	
// return the threshold that was found 	TokenNameCOMMENT_LINE	return the threshold that was found 
}	TokenNameRBRACE	
/** * Initializes the confusion matrix. This method is called in the first step * of the tweaking process. Please note that at this step, all the examples * are set to have a tweak_predited field of NEG class. */	TokenNameCOMMENT_JAVADOC	 Initializes the confusion matrix. This method is called in the first step of the tweaking process. Please note that at this step, all the examples are set to have a tweak_predited field of NEG class. 
private	TokenNameprivate	
void	TokenNamevoid	
initConfusionMatrix	TokenNameIdentifier	 init Confusion Matrix
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
classes	TokenNameIdentifier	 classes
=	TokenNameEQUAL	
getClasses	TokenNameIdentifier	 get Classes
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// count up the errors 	TokenNameCOMMENT_LINE	count up the errors 
double	TokenNamedouble	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
confused	TokenNameIdentifier	 confused
=	TokenNameEQUAL	
new	TokenNamenew	
double	TokenNamedouble	
[	TokenNameLBRACKET	
classes	TokenNameIdentifier	 classes
.	TokenNameDOT	
length	TokenNameIdentifier	 length
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
classes	TokenNameIdentifier	 classes
.	TokenNameDOT	
length	TokenNameIdentifier	 length
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
tweakingTable	TokenNameIdentifier	 tweaking Table
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Row	TokenNameIdentifier	 Row
row	TokenNameIdentifier	 row
=	TokenNameEQUAL	
getRow	TokenNameIdentifier	 get Row
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
confused	TokenNameIdentifier	 confused
[	TokenNameLBRACKET	
classIndexOf	TokenNameIdentifier	 class Index Of
(	TokenNameLPAREN	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
actual	TokenNameIdentifier	 actual
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
classIndexOf	TokenNameIdentifier	 class Index Of
(	TokenNameLPAREN	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
tweak_predicted	TokenNameIdentifier	 tweak predicted
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
++	TokenNamePLUS_PLUS	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
cm	TokenNameIdentifier	 cm
=	TokenNameEQUAL	
new	TokenNamenew	
Matrix	TokenNameIdentifier	 Matrix
(	TokenNameLPAREN	
confused	TokenNameIdentifier	 confused
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/* * During the tweaking process, in each iteration a single example * is handled, so that its tweaked_prediction is changed from NEG to POS * This method receives the index (in th etweakingTable) of the current example * and updates the confusion matrix accordingly */	TokenNameCOMMENT_BLOCK	 During the tweaking process, in each iteration a single example is handled, so that its tweaked_prediction is changed from NEG to POS This method receives the index (in th etweakingTable) of the current example and updates the confusion matrix accordingly 
private	TokenNameprivate	
void	TokenNamevoid	
updateConfusionMatrix	TokenNameIdentifier	 update Confusion Matrix
(	TokenNameLPAREN	
int	TokenNameint	
index	TokenNameIdentifier	 index
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Row	TokenNameIdentifier	 Row
row	TokenNameIdentifier	 row
=	TokenNameEQUAL	
getRow	TokenNameIdentifier	 get Row
(	TokenNameLPAREN	
index	TokenNameIdentifier	 index
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
int	TokenNameint	
actual	TokenNameIdentifier	 actual
=	TokenNameEQUAL	
classIndexOf	TokenNameIdentifier	 class Index Of
(	TokenNameLPAREN	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
actual	TokenNameIdentifier	 actual
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
int	TokenNameint	
p	TokenNameIdentifier	 p
=	TokenNameEQUAL	
classIndexOf	TokenNameIdentifier	 class Index Of
(	TokenNameLPAREN	
ExampleSchema	TokenNameIdentifier	 Example Schema
.	TokenNameDOT	
POS_CLASS_NAME	TokenNameIdentifier	 POS  CLASS  NAME
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
int	TokenNameint	
n	TokenNameIdentifier	 n
=	TokenNameEQUAL	
classIndexOf	TokenNameIdentifier	 class Index Of
(	TokenNameLPAREN	
ExampleSchema	TokenNameIdentifier	 Example Schema
.	TokenNameDOT	
NEG_CLASS_NAME	TokenNameIdentifier	 NEG  CLASS  NAME
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// the confusion matrix (cm) is built as [actual][predicted] 	TokenNameCOMMENT_LINE	the confusion matrix (cm) is built as [actual][predicted] 
cm	TokenNameIdentifier	 cm
.	TokenNameDOT	
values	TokenNameIdentifier	 values
[	TokenNameLBRACKET	
actual	TokenNameIdentifier	 actual
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
p	TokenNameIdentifier	 p
]	TokenNameRBRACKET	
++	TokenNamePLUS_PLUS	
;	TokenNameSEMICOLON	
cm	TokenNameIdentifier	 cm
.	TokenNameDOT	
values	TokenNameIdentifier	 values
[	TokenNameLBRACKET	
actual	TokenNameIdentifier	 actual
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
n	TokenNameIdentifier	 n
]	TokenNameRBRACKET	
--	TokenNameMINUS_MINUS	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// This method simply returns, given precision and recall, the value 	TokenNameCOMMENT_LINE	This method simply returns, given precision and recall, the value 
// of F_beta. It uses the "beta" data member of this class, to decide 	TokenNameCOMMENT_LINE	of F_beta. It uses the "beta" data member of this class, to decide 
// which function is to be calculated 	TokenNameCOMMENT_LINE	which function is to be calculated 
// The formula used is: 	TokenNameCOMMENT_LINE	The formula used is: 
// F_beta = (beta+1) * precision * recall / 	TokenNameCOMMENT_LINE	F_beta = (beta+1) * precision * recall / 
// (beta * precision) + recall 	TokenNameCOMMENT_LINE	(beta * precision) + recall 
// 	TokenNameCOMMENT_LINE	 
// See also: 	TokenNameCOMMENT_LINE	See also: 
// <p>Reference: Jason D. M. Rennie, 	TokenNameCOMMENT_LINE	<p>Reference: Jason D. M. Rennie, 
// <i>Derivation of the F-Measure</i>, 	TokenNameCOMMENT_LINE	<i>Derivation of the F-Measure</i>, 
// http://people.csail.mit.edu/jrennie/writing/fmeasure.pdf 	TokenNameCOMMENT_LINE	http://people.csail.mit.edu/jrennie/writing/fmeasure.pdf 
private	TokenNameprivate	
double	TokenNamedouble	
calculateFBeta	TokenNameIdentifier	 calculate F Beta
(	TokenNameLPAREN	
double	TokenNamedouble	
precision	TokenNameIdentifier	 precision
,	TokenNameCOMMA	
double	TokenNamedouble	
recall	TokenNameIdentifier	 recall
)	TokenNameRPAREN	
{	TokenNameLBRACE	
double	TokenNamedouble	
divisor	TokenNameIdentifier	 divisor
=	TokenNameEQUAL	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
beta	TokenNameIdentifier	 beta
*	TokenNameMULTIPLY	
precision	TokenNameIdentifier	 precision
)	TokenNameRPAREN	
+	TokenNamePLUS	
recall	TokenNameIdentifier	 recall
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// in case a division by zero will occur, return F_beta=0.0 (instead of NaN) 	TokenNameCOMMENT_LINE	in case a division by zero will occur, return F_beta=0.0 (instead of NaN) 
if	TokenNameif	
(	TokenNameLPAREN	
divisor	TokenNameIdentifier	 divisor
==	TokenNameEQUAL_EQUAL	
0.0	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
log	TokenNameIdentifier	 log
.	TokenNameDOT	
warn	TokenNameIdentifier	 warn
(	TokenNameLPAREN	
"TweakedLearner::calculateFBeta, divisor of F_beta is zero !!!"	TokenNameStringLiteral	TweakedLearner::calculateFBeta, divisor of F_beta is zero !!!
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
0.0	TokenNameDoubleLiteral	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// in case a division by NaN, return F_beta=0.0 (instead of NaN) 	TokenNameCOMMENT_LINE	in case a division by NaN, return F_beta=0.0 (instead of NaN) 
if	TokenNameif	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
new	TokenNamenew	
Double	TokenNameIdentifier	 Double
(	TokenNameLPAREN	
divisor	TokenNameIdentifier	 divisor
)	TokenNameRPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
isNaN	TokenNameIdentifier	 is Na N
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
log	TokenNameIdentifier	 log
.	TokenNameDOT	
warn	TokenNameIdentifier	 warn
(	TokenNameLPAREN	
"TweakedLearner::calculateFBeta, divisor of F_beta is a NaN !!!"	TokenNameStringLiteral	TweakedLearner::calculateFBeta, divisor of F_beta is a NaN !!!
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
0.0	TokenNameDoubleLiteral	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
beta	TokenNameIdentifier	 beta
+	TokenNamePLUS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
*	TokenNameMULTIPLY	
precision	TokenNameIdentifier	 precision
*	TokenNameMULTIPLY	
recall	TokenNameIdentifier	 recall
)	TokenNameRPAREN	
/	TokenNameDIVIDE	
divisor	TokenNameIdentifier	 divisor
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// This method returns the precision based on the current confusion matrix. 	TokenNameCOMMENT_LINE	This method returns the precision based on the current confusion matrix. 
// Note that during the tweaking process the confusion matrix is iteratively updated 	TokenNameCOMMENT_LINE	Note that during the tweaking process the confusion matrix is iteratively updated 
// Precision is defined as: 	TokenNameCOMMENT_LINE	Precision is defined as: 
// true_positive / (true_positive + false_positive) 	TokenNameCOMMENT_LINE	true_positive / (true_positive + false_positive) 
private	TokenNameprivate	
double	TokenNamedouble	
getCurrentPrecision	TokenNameIdentifier	 get Current Precision
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
isBinary	TokenNameIdentifier	 is Binary
)	TokenNameRPAREN	
return	TokenNamereturn	
ILLEGAL_VALUE	TokenNameIdentifier	 ILLEGAL  VALUE
;	TokenNameSEMICOLON	
// to be on the safe side 	TokenNameCOMMENT_LINE	to be on the safe side 
int	TokenNameint	
p	TokenNameIdentifier	 p
=	TokenNameEQUAL	
classIndexOf	TokenNameIdentifier	 class Index Of
(	TokenNameLPAREN	
ExampleSchema	TokenNameIdentifier	 Example Schema
.	TokenNameDOT	
POS_CLASS_NAME	TokenNameIdentifier	 POS  CLASS  NAME
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
int	TokenNameint	
n	TokenNameIdentifier	 n
=	TokenNameEQUAL	
classIndexOf	TokenNameIdentifier	 class Index Of
(	TokenNameLPAREN	
ExampleSchema	TokenNameIdentifier	 Example Schema
.	TokenNameDOT	
NEG_CLASS_NAME	TokenNameIdentifier	 NEG  CLASS  NAME
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// the confusion matrix (cm) is built as [actual][predicted] 	TokenNameCOMMENT_LINE	the confusion matrix (cm) is built as [actual][predicted] 
return	TokenNamereturn	
cm	TokenNameIdentifier	 cm
.	TokenNameDOT	
values	TokenNameIdentifier	 values
[	TokenNameLBRACKET	
p	TokenNameIdentifier	 p
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
p	TokenNameIdentifier	 p
]	TokenNameRBRACKET	
/	TokenNameDIVIDE	
(	TokenNameLPAREN	
cm	TokenNameIdentifier	 cm
.	TokenNameDOT	
values	TokenNameIdentifier	 values
[	TokenNameLBRACKET	
p	TokenNameIdentifier	 p
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
p	TokenNameIdentifier	 p
]	TokenNameRBRACKET	
+	TokenNamePLUS	
cm	TokenNameIdentifier	 cm
.	TokenNameDOT	
values	TokenNameIdentifier	 values
[	TokenNameLBRACKET	
n	TokenNameIdentifier	 n
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
p	TokenNameIdentifier	 p
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// This method returns the recall based on the current confusion matrix. 	TokenNameCOMMENT_LINE	This method returns the recall based on the current confusion matrix. 
// Note that during the tweaking process the confusion matrix is iteratively updated 	TokenNameCOMMENT_LINE	Note that during the tweaking process the confusion matrix is iteratively updated 
// Recall is defined as: 	TokenNameCOMMENT_LINE	Recall is defined as: 
// true_positive / (true_positive + false_negative) 	TokenNameCOMMENT_LINE	true_positive / (true_positive + false_negative) 
private	TokenNameprivate	
double	TokenNamedouble	
getCurrentRecall	TokenNameIdentifier	 get Current Recall
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
isBinary	TokenNameIdentifier	 is Binary
)	TokenNameRPAREN	
return	TokenNamereturn	
ILLEGAL_VALUE	TokenNameIdentifier	 ILLEGAL  VALUE
;	TokenNameSEMICOLON	
// to be on the safe side 	TokenNameCOMMENT_LINE	to be on the safe side 
int	TokenNameint	
p	TokenNameIdentifier	 p
=	TokenNameEQUAL	
classIndexOf	TokenNameIdentifier	 class Index Of
(	TokenNameLPAREN	
ExampleSchema	TokenNameIdentifier	 Example Schema
.	TokenNameDOT	
POS_CLASS_NAME	TokenNameIdentifier	 POS  CLASS  NAME
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
int	TokenNameint	
n	TokenNameIdentifier	 n
=	TokenNameEQUAL	
classIndexOf	TokenNameIdentifier	 class Index Of
(	TokenNameLPAREN	
ExampleSchema	TokenNameIdentifier	 Example Schema
.	TokenNameDOT	
NEG_CLASS_NAME	TokenNameIdentifier	 NEG  CLASS  NAME
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// the confusion matrix (cm) is built as [actual][predicted] 	TokenNameCOMMENT_LINE	the confusion matrix (cm) is built as [actual][predicted] 
return	TokenNamereturn	
cm	TokenNameIdentifier	 cm
.	TokenNameDOT	
values	TokenNameIdentifier	 values
[	TokenNameLBRACKET	
p	TokenNameIdentifier	 p
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
p	TokenNameIdentifier	 p
]	TokenNameRBRACKET	
/	TokenNameDIVIDE	
(	TokenNameLPAREN	
cm	TokenNameIdentifier	 cm
.	TokenNameDOT	
values	TokenNameIdentifier	 values
[	TokenNameLBRACKET	
p	TokenNameIdentifier	 p
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
p	TokenNameIdentifier	 p
]	TokenNameRBRACKET	
+	TokenNamePLUS	
cm	TokenNameIdentifier	 cm
.	TokenNameDOT	
values	TokenNameIdentifier	 values
[	TokenNameLBRACKET	
p	TokenNameIdentifier	 p
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
n	TokenNameIdentifier	 n
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** ******************************************************************** * Private convenience methods ******************************************************************** */	TokenNameCOMMENT_JAVADOC	 ******************************************************************** Private convenience methods ******************************************************************** 
// sort the tweakingTable, after it was filled, by descending score 	TokenNameCOMMENT_LINE	sort the tweakingTable, after it was filled, by descending score 
private	TokenNameprivate	
void	TokenNamevoid	
sortByScore	TokenNameIdentifier	 sort By Score
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
sort	TokenNameIdentifier	 sort
(	TokenNameLPAREN	
tweakingTable	TokenNameIdentifier	 tweaking Table
,	TokenNameCOMMA	
new	TokenNamenew	
Comparator	TokenNameIdentifier	 Comparator
<	TokenNameLESS	
Row	TokenNameIdentifier	 Row
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
int	TokenNameint	
compare	TokenNameIdentifier	 compare
(	TokenNameLPAREN	
Row	TokenNameIdentifier	 Row
a	TokenNameIdentifier	 a
,	TokenNameCOMMA	
Row	TokenNameIdentifier	 Row
b	TokenNameIdentifier	 b
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
MathUtil	TokenNameIdentifier	 Math Util
.	TokenNameDOT	
sign	TokenNameIdentifier	 sign
(	TokenNameLPAREN	
b	TokenNameIdentifier	 b
.	TokenNameDOT	
orig_predicted	TokenNameIdentifier	 orig predicted
.	TokenNameDOT	
posWeight	TokenNameIdentifier	 pos Weight
(	TokenNameLPAREN	
)	TokenNameRPAREN	
-	TokenNameMINUS	
a	TokenNameIdentifier	 a
.	TokenNameDOT	
orig_predicted	TokenNameIdentifier	 orig predicted
.	TokenNameDOT	
posWeight	TokenNameIdentifier	 pos Weight
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/* * Returns the index (in tweakingTable) of the Row with maximal F_beta value */	TokenNameCOMMENT_BLOCK	 Returns the index (in tweakingTable) of the Row with maximal F_beta value 
private	TokenNameprivate	
int	TokenNameint	
maxFBetaEntry	TokenNameIdentifier	 max F Beta Entry
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
double	TokenNamedouble	
maxFBeta	TokenNameIdentifier	 max F Beta
=	TokenNameEQUAL	
ILLEGAL_VALUE	TokenNameIdentifier	 ILLEGAL  VALUE
;	TokenNameSEMICOLON	
// initialize 	TokenNameCOMMENT_LINE	initialize 
int	TokenNameint	
maxIndex	TokenNameIdentifier	 max Index
=	TokenNameEQUAL	
(	TokenNameLPAREN	
int	TokenNameint	
)	TokenNameRPAREN	
UNINITIALIZED	TokenNameIdentifier	 UNINITIALIZED
;	TokenNameSEMICOLON	
// index of the row with maximal F_beta 	TokenNameCOMMENT_LINE	index of the row with maximal F_beta 
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
tweakingTable	TokenNameIdentifier	 tweaking Table
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
++	TokenNamePLUS_PLUS	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
getRow	TokenNameIdentifier	 get Row
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
.	TokenNameDOT	
F_beta	TokenNameIdentifier	 F beta
>	TokenNameGREATER	
maxFBeta	TokenNameIdentifier	 max F Beta
)	TokenNameRPAREN	
{	TokenNameLBRACE	
maxFBeta	TokenNameIdentifier	 max F Beta
=	TokenNameEQUAL	
getRow	TokenNameIdentifier	 get Row
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
.	TokenNameDOT	
F_beta	TokenNameIdentifier	 F beta
;	TokenNameSEMICOLON	
maxIndex	TokenNameIdentifier	 max Index
=	TokenNameEQUAL	
i	TokenNameIdentifier	 i
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
maxFBeta	TokenNameIdentifier	 max F Beta
==	TokenNameEQUAL_EQUAL	
ILLEGAL_VALUE	TokenNameIdentifier	 ILLEGAL  VALUE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
log	TokenNameIdentifier	 log
.	TokenNameDOT	
error	TokenNameIdentifier	 error
(	TokenNameLPAREN	
"In TweakedLearner::maxFBetaEntry, maxFBeta has an illegal value"	TokenNameStringLiteral	In TweakedLearner::maxFBetaEntry, maxFBeta has an illegal value
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
maxIndex	TokenNameIdentifier	 max Index
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
Row	TokenNameIdentifier	 Row
getRow	TokenNameIdentifier	 get Row
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
tweakingTable	TokenNameIdentifier	 tweaking Table
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
getClasses	TokenNameIdentifier	 get Classes
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
schema	TokenNameIdentifier	 schema
.	TokenNameDOT	
validClassNames	TokenNameIdentifier	 valid Class Names
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
int	TokenNameint	
classIndexOf	TokenNameIdentifier	 class Index Of
(	TokenNameLPAREN	
ClassLabel	TokenNameIdentifier	 Class Label
classLabel	TokenNameIdentifier	 class Label
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
classIndexOf	TokenNameIdentifier	 class Index Of
(	TokenNameLPAREN	
classLabel	TokenNameIdentifier	 class Label
.	TokenNameDOT	
bestClassName	TokenNameIdentifier	 best Class Name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
int	TokenNameint	
classIndexOf	TokenNameIdentifier	 class Index Of
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
classLabelName	TokenNameIdentifier	 class Label Name
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
schema	TokenNameIdentifier	 schema
.	TokenNameDOT	
getClassIndex	TokenNameIdentifier	 get Class Index
(	TokenNameLPAREN	
classLabelName	TokenNameIdentifier	 class Label Name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// debug method - simply dumps the tweakingTable data structure to stdout 	TokenNameCOMMENT_LINE	debug method - simply dumps the tweakingTable data structure to stdout 
// private void printTable(){ 	TokenNameCOMMENT_LINE	private void printTable(){ 
// for(int i=0;i<tweakingTable.size();++i){ 	TokenNameCOMMENT_LINE	for(int i=0;i<tweakingTable.size();++i){ 
// System.out.println("Row number "+i+": "+getRow(i)); 	TokenNameCOMMENT_LINE	System.out.println("Row number "+i+": "+getRow(i)); 
// } 	TokenNameCOMMENT_LINE	} 
// } 	TokenNameCOMMENT_LINE	} 
/** ******************************************************************** ******************************************************************** * This class represents the information, about a single example, * needed for executing the tweaking: * 1. The example itself * 2. Its true label/class. Indeed this field can be accessed every time * by using example.getLabel(), but for convenience it is stored in the table * 3. The predicted class (orig_predicted), as given by the original * (untweaked) classifier. * 4. A dummy prediction (tweak_predicted), which is used in the actual * tweaking process. During construction, all rows are initialized as NEG examples, * commensurate with the way the tweaking process is executed. * * Please note that during the tweaking process, examples that were predicted * by the original (untweaked) classifier as POS can have a prediction of NEG, * and vice versa. * * Note also, that the actual score for an example is given using * predicted.posWeight(), where posWeight>0 means the original prediction * of the untweaked classifier was that this example is of a POSITIVE class, * and posWeight<0 means NEGATIVE class. * * In addition, for the actual tweaking process, 3 fields are * maintained for each example/row: * 5. Precision * 6. Recall * 7. F_beta value * * See the documentation of the actual tweaking method, ExecuteTweaking(), * for further details ******************************************************************** ******************************************************************** */	TokenNameCOMMENT_JAVADOC	 ******************************************************************** ******************************************************************** This class represents the information, about a single example, needed for executing the tweaking: 1. The example itself 2. Its true label/class. Indeed this field can be accessed every time by using example.getLabel(), but for convenience it is stored in the table 3. The predicted class (orig_predicted), as given by the original (untweaked) classifier. 4. A dummy prediction (tweak_predicted), which is used in the actual tweaking process. During construction, all rows are initialized as NEG examples, commensurate with the way the tweaking process is executed. * Please note that during the tweaking process, examples that were predicted by the original (untweaked) classifier as POS can have a prediction of NEG, and vice versa. * Note also, that the actual score for an example is given using predicted.posWeight(), where posWeight>0 means the original prediction of the untweaked classifier was that this example is of a POSITIVE class, and posWeight<0 means NEGATIVE class. * In addition, for the actual tweaking process, 3 fields are maintained for each example/row: 5. Precision 6. Recall 7. F_beta value * See the documentation of the actual tweaking method, ExecuteTweaking(), for further details ******************************************************************** ******************************************************************** 
private	TokenNameprivate	
static	TokenNamestatic	
class	TokenNameclass	
Row	TokenNameIdentifier	 Row
implements	TokenNameimplements	
Serializable	TokenNameIdentifier	 Serializable
{	TokenNameLBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
long	TokenNamelong	
serialVersionUID	TokenNameIdentifier	 serial Version UID
=	TokenNameEQUAL	
-	TokenNameMINUS	
4069980043842319180L	TokenNameLongLiteral	
;	TokenNameSEMICOLON	
transient	TokenNametransient	
public	TokenNamepublic	
Instance	TokenNameIdentifier	 Instance
instance	TokenNameIdentifier	 instance
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
// the example 	TokenNameCOMMENT_LINE	the example 
public	TokenNamepublic	
ClassLabel	TokenNameIdentifier	 Class Label
actual	TokenNameIdentifier	 actual
;	TokenNameSEMICOLON	
// true label 	TokenNameCOMMENT_LINE	true label 
public	TokenNamepublic	
ClassLabel	TokenNameIdentifier	 Class Label
orig_predicted	TokenNameIdentifier	 orig predicted
;	TokenNameSEMICOLON	
// predicted label - see documentation above 	TokenNameCOMMENT_LINE	predicted label - see documentation above 
public	TokenNamepublic	
ClassLabel	TokenNameIdentifier	 Class Label
tweak_predicted	TokenNameIdentifier	 tweak predicted
;	TokenNameSEMICOLON	
// temporary prediction, for tweaking process 	TokenNameCOMMENT_LINE	temporary prediction, for tweaking process 
public	TokenNamepublic	
double	TokenNamedouble	
precision	TokenNameIdentifier	 precision
=	TokenNameEQUAL	
UNINITIALIZED	TokenNameIdentifier	 UNINITIALIZED
;	TokenNameSEMICOLON	
public	TokenNamepublic	
double	TokenNamedouble	
recall	TokenNameIdentifier	 recall
=	TokenNameEQUAL	
UNINITIALIZED	TokenNameIdentifier	 UNINITIALIZED
;	TokenNameSEMICOLON	
public	TokenNamepublic	
double	TokenNamedouble	
F_beta	TokenNameIdentifier	 F beta
=	TokenNameEQUAL	
UNINITIALIZED	TokenNameIdentifier	 UNINITIALIZED
;	TokenNameSEMICOLON	
public	TokenNamepublic	
Row	TokenNameIdentifier	 Row
(	TokenNameLPAREN	
Instance	TokenNameIdentifier	 Instance
i	TokenNameIdentifier	 i
,	TokenNameCOMMA	
ClassLabel	TokenNameIdentifier	 Class Label
a	TokenNameIdentifier	 a
,	TokenNameCOMMA	
ClassLabel	TokenNameIdentifier	 Class Label
orig_p	TokenNameIdentifier	 orig p
,	TokenNameCOMMA	
ClassLabel	TokenNameIdentifier	 Class Label
tweak_p	TokenNameIdentifier	 tweak p
)	TokenNameRPAREN	
{	TokenNameLBRACE	
instance	TokenNameIdentifier	 instance
=	TokenNameEQUAL	
i	TokenNameIdentifier	 i
;	TokenNameSEMICOLON	
actual	TokenNameIdentifier	 actual
=	TokenNameEQUAL	
a	TokenNameIdentifier	 a
;	TokenNameSEMICOLON	
orig_predicted	TokenNameIdentifier	 orig predicted
=	TokenNameEQUAL	
orig_p	TokenNameIdentifier	 orig p
;	TokenNameSEMICOLON	
tweak_predicted	TokenNameIdentifier	 tweak predicted
=	TokenNameEQUAL	
tweak_p	TokenNameIdentifier	 tweak p
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
String	TokenNameIdentifier	 String
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
orig_predicted	TokenNameIdentifier	 orig predicted
+	TokenNamePLUS	
" "	TokenNameStringLiteral	 
+	TokenNamePLUS	
actual	TokenNameIdentifier	 actual
+	TokenNamePLUS	
" "	TokenNameStringLiteral	 
+	TokenNamePLUS	
instance	TokenNameIdentifier	 instance
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** ******************************************************************** ******************************************************************** * A Tweaked Classifier, with an optimization of the precision vs. recall * Please note that this is an internal class of the TweakedLearner class. * It is constructed and returned by the TweakedLearner, based on * an original untweaked binary clasifer, and a threshold which was found * to optimized precision vs. recall * * @author Giora Unger * Created on May 19, 2005 ******************************************************************** ******************************************************************** */	TokenNameCOMMENT_JAVADOC	 ******************************************************************** ******************************************************************** A Tweaked Classifier, with an optimization of the precision vs. recall Please note that this is an internal class of the TweakedLearner class. It is constructed and returned by the TweakedLearner, based on an original untweaked binary clasifer, and a threshold which was found to optimized precision vs. recall * @author Giora Unger Created on May 19, 2005 ******************************************************************** ******************************************************************** 
public	TokenNamepublic	
static	TokenNamestatic	
class	TokenNameclass	
TweakedClassifier	TokenNameIdentifier	 Tweaked Classifier
extends	TokenNameextends	
BinaryClassifier	TokenNameIdentifier	 Binary Classifier
implements	TokenNameimplements	
Serializable	TokenNameIdentifier	 Serializable
,	TokenNameCOMMA	
Visible	TokenNameIdentifier	 Visible
{	TokenNameLBRACE	
static	TokenNamestatic	
private	TokenNameprivate	
final	TokenNamefinal	
long	TokenNamelong	
serialVersionUID	TokenNameIdentifier	 serial Version UID
=	TokenNameEQUAL	
20080128L	TokenNameLongLiteral	
;	TokenNameSEMICOLON	
private	TokenNameprivate	
double	TokenNamedouble	
m_threshold	TokenNameIdentifier	 m threshold
;	TokenNameSEMICOLON	
private	TokenNameprivate	
BinaryClassifier	TokenNameIdentifier	 Binary Classifier
m_classifier	TokenNameIdentifier	 m classifier
;	TokenNameSEMICOLON	
public	TokenNamepublic	
TweakedClassifier	TokenNameIdentifier	 Tweaked Classifier
(	TokenNameLPAREN	
BinaryClassifier	TokenNameIdentifier	 Binary Classifier
classifier	TokenNameIdentifier	 classifier
,	TokenNameCOMMA	
double	TokenNamedouble	
threshold	TokenNameIdentifier	 threshold
)	TokenNameRPAREN	
{	TokenNameLBRACE	
m_classifier	TokenNameIdentifier	 m classifier
=	TokenNameEQUAL	
classifier	TokenNameIdentifier	 classifier
;	TokenNameSEMICOLON	
m_threshold	TokenNameIdentifier	 m threshold
=	TokenNameEQUAL	
threshold	TokenNameIdentifier	 threshold
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
double	TokenNamedouble	
score	TokenNameIdentifier	 score
(	TokenNameLPAREN	
Instance	TokenNameIdentifier	 Instance
instance	TokenNameIdentifier	 instance
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
m_classifier	TokenNameIdentifier	 m classifier
.	TokenNameDOT	
score	TokenNameIdentifier	 score
(	TokenNameLPAREN	
instance	TokenNameIdentifier	 instance
)	TokenNameRPAREN	
-	TokenNameMINUS	
m_threshold	TokenNameIdentifier	 m threshold
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/* (non-Javadoc) * @see edu.cmu.minorthird.util.gui.Visible#toGUI() * * Shows the original (untweaked) classifier, and the threshold * that was found * Code was copied from file CMM.java and adjusted */	TokenNameCOMMENT_BLOCK	 (non-Javadoc) @see edu.cmu.minorthird.util.gui.Visible#toGUI() * Shows the original (untweaked) classifier, and the threshold that was found Code was copied from file CMM.java and adjusted 
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
Viewer	TokenNameIdentifier	 Viewer
toGUI	TokenNameIdentifier	 to GUI
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
Viewer	TokenNameIdentifier	 Viewer
v	TokenNameIdentifier	 v
=	TokenNameEQUAL	
new	TokenNamenew	
ComponentViewer	TokenNameIdentifier	 Component Viewer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
static	TokenNamestatic	
final	TokenNamefinal	
long	TokenNamelong	
serialVersionUID	TokenNameIdentifier	 serial Version UID
=	TokenNameEQUAL	
20080128L	TokenNameLongLiteral	
;	TokenNameSEMICOLON	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
JComponent	TokenNameIdentifier	 J Component
componentFor	TokenNameIdentifier	 component For
(	TokenNameLPAREN	
Object	TokenNameIdentifier	 Object
o	TokenNameIdentifier	 o
)	TokenNameRPAREN	
{	TokenNameLBRACE	
TweakedClassifier	TokenNameIdentifier	 Tweaked Classifier
c	TokenNameIdentifier	 c
=	TokenNameEQUAL	
(	TokenNameLPAREN	
TweakedClassifier	TokenNameIdentifier	 Tweaked Classifier
)	TokenNameRPAREN	
o	TokenNameIdentifier	 o
;	TokenNameSEMICOLON	
JPanel	TokenNameIdentifier	 J Panel
mainPanel	TokenNameIdentifier	 main Panel
=	TokenNameEQUAL	
new	TokenNamenew	
JPanel	TokenNameIdentifier	 J Panel
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
mainPanel	TokenNameIdentifier	 main Panel
.	TokenNameDOT	
setLayout	TokenNameIdentifier	 set Layout
(	TokenNameLPAREN	
new	TokenNamenew	
BorderLayout	TokenNameIdentifier	 Border Layout
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
mainPanel	TokenNameIdentifier	 main Panel
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
JLabel	TokenNameIdentifier	 J Label
(	TokenNameLPAREN	
"Optimal threshold for TweakedClassifier="	TokenNameStringLiteral	Optimal threshold for TweakedClassifier=
+	TokenNamePLUS	
c	TokenNameIdentifier	 c
.	TokenNameDOT	
m_threshold	TokenNameIdentifier	 m threshold
)	TokenNameRPAREN	
,	TokenNameCOMMA	
BorderLayout	TokenNameIdentifier	 Border Layout
.	TokenNameDOT	
NORTH	TokenNameIdentifier	 NORTH
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
mainPanel	TokenNameIdentifier	 main Panel
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
JLabel	TokenNameIdentifier	 J Label
(	TokenNameLPAREN	
"Original classifier before tweaking:"	TokenNameStringLiteral	Original classifier before tweaking:
)	TokenNameRPAREN	
,	TokenNameCOMMA	
BorderLayout	TokenNameIdentifier	 Border Layout
.	TokenNameDOT	
CENTER	TokenNameIdentifier	 CENTER
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Viewer	TokenNameIdentifier	 Viewer
subView	TokenNameIdentifier	 sub View
=	TokenNameEQUAL	
new	TokenNamenew	
SmartVanillaViewer	TokenNameIdentifier	 Smart Vanilla Viewer
(	TokenNameLPAREN	
c	TokenNameIdentifier	 c
.	TokenNameDOT	
m_classifier	TokenNameIdentifier	 m classifier
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
subView	TokenNameIdentifier	 sub View
.	TokenNameDOT	
setSuperView	TokenNameIdentifier	 set Super View
(	TokenNameLPAREN	
this	TokenNamethis	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
mainPanel	TokenNameIdentifier	 main Panel
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
subView	TokenNameIdentifier	 sub View
,	TokenNameCOMMA	
BorderLayout	TokenNameIdentifier	 Border Layout
.	TokenNameDOT	
SOUTH	TokenNameIdentifier	 SOUTH
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
mainPanel	TokenNameIdentifier	 main Panel
.	TokenNameDOT	
setBorder	TokenNameIdentifier	 set Border
(	TokenNameLPAREN	
new	TokenNamenew	
TitledBorder	TokenNameIdentifier	 Titled Border
(	TokenNameLPAREN	
"TweakedClassifier class"	TokenNameStringLiteral	TweakedClassifier class
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
new	TokenNamenew	
JScrollPane	TokenNameIdentifier	 J Scroll Pane
(	TokenNameLPAREN	
mainPanel	TokenNameIdentifier	 main Panel
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
v	TokenNameIdentifier	 v
.	TokenNameDOT	
setContent	TokenNameIdentifier	 set Content
(	TokenNameLPAREN	
this	TokenNamethis	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
v	TokenNameIdentifier	 v
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/* (non-Javadoc) * @see edu.cmu.minorthird.classify.Classifier#explain(edu.cmu.minorthird.classify.Instance) */	TokenNameCOMMENT_BLOCK	 (non-Javadoc) @see edu.cmu.minorthird.classify.Classifier#explain(edu.cmu.minorthird.classify.Instance) 
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
String	TokenNameIdentifier	 String
explain	TokenNameIdentifier	 explain
(	TokenNameLPAREN	
Instance	TokenNameIdentifier	 Instance
instance	TokenNameIdentifier	 instance
)	TokenNameRPAREN	
{	TokenNameLBRACE	
StringBuffer	TokenNameIdentifier	 String Buffer
buf	TokenNameIdentifier	 buf
=	TokenNameEQUAL	
new	TokenNamenew	
StringBuffer	TokenNameIdentifier	 String Buffer
(	TokenNameLPAREN	
""	TokenNameStringLiteral	 
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
buf	TokenNameIdentifier	 buf
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
"Explanation of original untweaked classifier: "	TokenNameStringLiteral	Explanation of original untweaked classifier: 
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
buf	TokenNameIdentifier	 buf
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
m_classifier	TokenNameIdentifier	 m classifier
.	TokenNameDOT	
explain	TokenNameIdentifier	 explain
(	TokenNameLPAREN	
instance	TokenNameIdentifier	 instance
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
buf	TokenNameIdentifier	 buf
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
" Adjusted score after tweaking = "	TokenNameStringLiteral	 Adjusted score after tweaking = 
+	TokenNamePLUS	
score	TokenNameIdentifier	 score
(	TokenNameLPAREN	
instance	TokenNameIdentifier	 instance
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
buf	TokenNameIdentifier	 buf
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
Explanation	TokenNameIdentifier	 Explanation
getExplanation	TokenNameIdentifier	 get Explanation
(	TokenNameLPAREN	
Instance	TokenNameIdentifier	 Instance
instance	TokenNameIdentifier	 instance
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Explanation	TokenNameIdentifier	 Explanation
.	TokenNameDOT	
Node	TokenNameIdentifier	 Node
top	TokenNameIdentifier	 top
=	TokenNameEQUAL	
new	TokenNamenew	
Explanation	TokenNameIdentifier	 Explanation
.	TokenNameDOT	
Node	TokenNameIdentifier	 Node
(	TokenNameLPAREN	
"TweakedLearner Explanation"	TokenNameStringLiteral	TweakedLearner Explanation
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Explanation	TokenNameIdentifier	 Explanation
.	TokenNameDOT	
Node	TokenNameIdentifier	 Node
orig	TokenNameIdentifier	 orig
=	TokenNameEQUAL	
new	TokenNamenew	
Explanation	TokenNameIdentifier	 Explanation
.	TokenNameDOT	
Node	TokenNameIdentifier	 Node
(	TokenNameLPAREN	
"Explanation of original untweaked classifier"	TokenNameStringLiteral	Explanation of original untweaked classifier
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Explanation	TokenNameIdentifier	 Explanation
.	TokenNameDOT	
Node	TokenNameIdentifier	 Node
origEx	TokenNameIdentifier	 orig Ex
=	TokenNameEQUAL	
m_classifier	TokenNameIdentifier	 m classifier
.	TokenNameDOT	
getExplanation	TokenNameIdentifier	 get Explanation
(	TokenNameLPAREN	
instance	TokenNameIdentifier	 instance
)	TokenNameRPAREN	
.	TokenNameDOT	
getTopNode	TokenNameIdentifier	 get Top Node
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
orig	TokenNameIdentifier	 orig
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
origEx	TokenNameIdentifier	 orig Ex
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
top	TokenNameIdentifier	 top
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
orig	TokenNameIdentifier	 orig
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Explanation	TokenNameIdentifier	 Explanation
.	TokenNameDOT	
Node	TokenNameIdentifier	 Node
adjusted	TokenNameIdentifier	 adjusted
=	TokenNameEQUAL	
new	TokenNamenew	
Explanation	TokenNameIdentifier	 Explanation
.	TokenNameDOT	
Node	TokenNameIdentifier	 Node
(	TokenNameLPAREN	
" Adjusted score after tweaking = "	TokenNameStringLiteral	 Adjusted score after tweaking = 
+	TokenNamePLUS	
score	TokenNameIdentifier	 score
(	TokenNameLPAREN	
instance	TokenNameIdentifier	 instance
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
top	TokenNameIdentifier	 top
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
adjusted	TokenNameIdentifier	 adjusted
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Explanation	TokenNameIdentifier	 Explanation
ex	TokenNameIdentifier	 ex
=	TokenNameEQUAL	
new	TokenNamenew	
Explanation	TokenNameIdentifier	 Explanation
(	TokenNameLPAREN	
top	TokenNameIdentifier	 top
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
ex	TokenNameIdentifier	 ex
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** ******************************************************************** ******************************************************************** * Main method for testing purposes ******************************************************************** ******************************************************************** */	TokenNameCOMMENT_JAVADOC	 ******************************************************************** ******************************************************************** Main method for testing purposes ******************************************************************** ******************************************************************** 
public	TokenNamepublic	
static	TokenNamestatic	
void	TokenNamevoid	
main	TokenNameIdentifier	 main
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
args	TokenNameIdentifier	 args
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Started the test program for TweakedLearner"	TokenNameStringLiteral	Started the test program for TweakedLearner
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
NaiveBayes	TokenNameIdentifier	 Naive Bayes
nb	TokenNameIdentifier	 nb
=	TokenNameEQUAL	
new	TokenNamenew	
NaiveBayes	TokenNameIdentifier	 Naive Bayes
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
new	TokenNamenew	
TweakedLearner	TokenNameIdentifier	 Tweaked Learner
(	TokenNameLPAREN	
nb	TokenNameIdentifier	 nb
,	TokenNameCOMMA	
3.0	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Created a TweakedLearner"	TokenNameStringLiteral	Created a TweakedLearner
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
