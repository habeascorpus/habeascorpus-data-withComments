/** * Licensed to the Apache Software Foundation (ASF) under one or more * contributor license agreements. See the NOTICE file distributed with * this work for additional information regarding copyright ownership. * The ASF licenses this file to You under the Apache License, Version 2.0 * (the "License"); you may not use this file except in compliance with * the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */	TokenNameCOMMENT_JAVADOC	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
grouping	TokenNameIdentifier	 grouping
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
IOException	TokenNameIdentifier	 IO Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
analysis	TokenNameIdentifier	 analysis
.	TokenNameDOT	
MockAnalyzer	TokenNameIdentifier	 Mock Analyzer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
document	TokenNameIdentifier	 document
.	TokenNameDOT	
Document	TokenNameIdentifier	 Document
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
document	TokenNameIdentifier	 document
.	TokenNameDOT	
Field	TokenNameIdentifier	 Field
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
document	TokenNameIdentifier	 document
.	TokenNameDOT	
NumericField	TokenNameIdentifier	 Numeric Field
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
FieldInfo	TokenNameIdentifier	 Field Info
.	TokenNameDOT	
IndexOptions	TokenNameIdentifier	 Index Options
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
IndexReader	TokenNameIdentifier	 Index Reader
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
Term	TokenNameIdentifier	 Term
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
store	TokenNameIdentifier	 store
.	TokenNameDOT	
Directory	TokenNameIdentifier	 Directory
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
LuceneTestCase	TokenNameIdentifier	 Lucene Test Case
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
ReaderUtil	TokenNameIdentifier	 Reader Util
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
_TestUtil	TokenNameIdentifier	 Test Util
;	TokenNameSEMICOLON	
// TODO 	TokenNameCOMMENT_LINE	TODO 
// - should test relevance sort too 	TokenNameCOMMENT_LINE	- should test relevance sort too 
// - test null 	TokenNameCOMMENT_LINE	- test null 
// - test ties 	TokenNameCOMMENT_LINE	- test ties 
// - test compound sort 	TokenNameCOMMENT_LINE	- test compound sort 
public	TokenNamepublic	
class	TokenNameclass	
TestGrouping	TokenNameIdentifier	 Test Grouping
extends	TokenNameextends	
LuceneTestCase	TokenNameIdentifier	 Lucene Test Case
{	TokenNameLBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
testBasic	TokenNameIdentifier	 test Basic
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
groupField	TokenNameIdentifier	 group Field
=	TokenNameEQUAL	
"author"	TokenNameStringLiteral	author
;	TokenNameSEMICOLON	
Directory	TokenNameIdentifier	 Directory
dir	TokenNameIdentifier	 dir
=	TokenNameEQUAL	
newDirectory	TokenNameIdentifier	 new Directory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
w	TokenNameIdentifier	 w
=	TokenNameEQUAL	
new	TokenNamenew	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
dir	TokenNameIdentifier	 dir
,	TokenNameCOMMA	
newIndexWriterConfig	TokenNameIdentifier	 new Index Writer Config
(	TokenNameLPAREN	
TEST_VERSION_CURRENT	TokenNameIdentifier	 TEST  VERSION  CURRENT
,	TokenNameCOMMA	
new	TokenNamenew	
MockAnalyzer	TokenNameIdentifier	 Mock Analyzer
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
)	TokenNameRPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
setMergePolicy	TokenNameIdentifier	 set Merge Policy
(	TokenNameLPAREN	
newLogMergePolicy	TokenNameIdentifier	 new Log Merge Policy
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// 0 	TokenNameCOMMENT_LINE	0 
Document	TokenNameIdentifier	 Document
doc	TokenNameIdentifier	 doc
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
groupField	TokenNameIdentifier	 group Field
,	TokenNameCOMMA	
"author1"	TokenNameStringLiteral	author1
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
ANALYZED	TokenNameIdentifier	 ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
"content"	TokenNameStringLiteral	content
,	TokenNameCOMMA	
"random text"	TokenNameStringLiteral	random text
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
ANALYZED	TokenNameIdentifier	 ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
"id"	TokenNameStringLiteral	id
,	TokenNameCOMMA	
"1"	TokenNameStringLiteral	1
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NO	TokenNameIdentifier	 NO
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
addDocument	TokenNameIdentifier	 add Document
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// 1 	TokenNameCOMMENT_LINE	1 
doc	TokenNameIdentifier	 doc
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
groupField	TokenNameIdentifier	 group Field
,	TokenNameCOMMA	
"author1"	TokenNameStringLiteral	author1
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
ANALYZED	TokenNameIdentifier	 ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
"content"	TokenNameStringLiteral	content
,	TokenNameCOMMA	
"some more random text"	TokenNameStringLiteral	some more random text
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
ANALYZED	TokenNameIdentifier	 ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
"id"	TokenNameStringLiteral	id
,	TokenNameCOMMA	
"2"	TokenNameStringLiteral	2
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NO	TokenNameIdentifier	 NO
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
addDocument	TokenNameIdentifier	 add Document
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// 2 	TokenNameCOMMENT_LINE	2 
doc	TokenNameIdentifier	 doc
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
groupField	TokenNameIdentifier	 group Field
,	TokenNameCOMMA	
"author1"	TokenNameStringLiteral	author1
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
ANALYZED	TokenNameIdentifier	 ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
"content"	TokenNameStringLiteral	content
,	TokenNameCOMMA	
"some more random textual data"	TokenNameStringLiteral	some more random textual data
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
ANALYZED	TokenNameIdentifier	 ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
"id"	TokenNameStringLiteral	id
,	TokenNameCOMMA	
"3"	TokenNameStringLiteral	3
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NO	TokenNameIdentifier	 NO
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
addDocument	TokenNameIdentifier	 add Document
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// 3 	TokenNameCOMMENT_LINE	3 
doc	TokenNameIdentifier	 doc
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
groupField	TokenNameIdentifier	 group Field
,	TokenNameCOMMA	
"author2"	TokenNameStringLiteral	author2
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
ANALYZED	TokenNameIdentifier	 ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
"content"	TokenNameStringLiteral	content
,	TokenNameCOMMA	
"some random text"	TokenNameStringLiteral	some random text
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
ANALYZED	TokenNameIdentifier	 ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
"id"	TokenNameStringLiteral	id
,	TokenNameCOMMA	
"4"	TokenNameStringLiteral	4
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NO	TokenNameIdentifier	 NO
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
addDocument	TokenNameIdentifier	 add Document
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// 4 	TokenNameCOMMENT_LINE	4 
doc	TokenNameIdentifier	 doc
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
groupField	TokenNameIdentifier	 group Field
,	TokenNameCOMMA	
"author3"	TokenNameStringLiteral	author3
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
ANALYZED	TokenNameIdentifier	 ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
"content"	TokenNameStringLiteral	content
,	TokenNameCOMMA	
"some more random text"	TokenNameStringLiteral	some more random text
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
ANALYZED	TokenNameIdentifier	 ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
"id"	TokenNameStringLiteral	id
,	TokenNameCOMMA	
"5"	TokenNameStringLiteral	5
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NO	TokenNameIdentifier	 NO
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
addDocument	TokenNameIdentifier	 add Document
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// 5 	TokenNameCOMMENT_LINE	5 
doc	TokenNameIdentifier	 doc
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
groupField	TokenNameIdentifier	 group Field
,	TokenNameCOMMA	
"author3"	TokenNameStringLiteral	author3
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
ANALYZED	TokenNameIdentifier	 ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
"content"	TokenNameStringLiteral	content
,	TokenNameCOMMA	
"random"	TokenNameStringLiteral	random
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
ANALYZED	TokenNameIdentifier	 ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
"id"	TokenNameStringLiteral	id
,	TokenNameCOMMA	
"6"	TokenNameStringLiteral	6
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NO	TokenNameIdentifier	 NO
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
addDocument	TokenNameIdentifier	 add Document
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// 6 -- no author field 	TokenNameCOMMENT_LINE	6 -- no author field 
doc	TokenNameIdentifier	 doc
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
"content"	TokenNameStringLiteral	content
,	TokenNameCOMMA	
"random word stuck in alot of other text"	TokenNameStringLiteral	random word stuck in alot of other text
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
ANALYZED	TokenNameIdentifier	 ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
Field	TokenNameIdentifier	 Field
(	TokenNameLPAREN	
"id"	TokenNameStringLiteral	id
,	TokenNameCOMMA	
"6"	TokenNameStringLiteral	6
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NO	TokenNameIdentifier	 NO
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
addDocument	TokenNameIdentifier	 add Document
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IndexSearcher	TokenNameIdentifier	 Index Searcher
indexSearcher	TokenNameIdentifier	 index Searcher
=	TokenNameEQUAL	
new	TokenNamenew	
IndexSearcher	TokenNameIdentifier	 Index Searcher
(	TokenNameLPAREN	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
getReader	TokenNameIdentifier	 get Reader
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Sort	TokenNameIdentifier	 Sort
groupSort	TokenNameIdentifier	 group Sort
=	TokenNameEQUAL	
Sort	TokenNameIdentifier	 Sort
.	TokenNameDOT	
RELEVANCE	TokenNameIdentifier	 RELEVANCE
;	TokenNameSEMICOLON	
final	TokenNamefinal	
TermFirstPassGroupingCollector	TokenNameIdentifier	 Term First Pass Grouping Collector
c1	TokenNameIdentifier	 c1
=	TokenNameEQUAL	
new	TokenNamenew	
TermFirstPassGroupingCollector	TokenNameIdentifier	 Term First Pass Grouping Collector
(	TokenNameLPAREN	
groupField	TokenNameIdentifier	 group Field
,	TokenNameCOMMA	
groupSort	TokenNameIdentifier	 group Sort
,	TokenNameCOMMA	
10	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
indexSearcher	TokenNameIdentifier	 index Searcher
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"content"	TokenNameStringLiteral	content
,	TokenNameCOMMA	
"random"	TokenNameStringLiteral	random
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
c1	TokenNameIdentifier	 c1
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
TermSecondPassGroupingCollector	TokenNameIdentifier	 Term Second Pass Grouping Collector
c2	TokenNameIdentifier	 c2
=	TokenNameEQUAL	
new	TokenNamenew	
TermSecondPassGroupingCollector	TokenNameIdentifier	 Term Second Pass Grouping Collector
(	TokenNameLPAREN	
groupField	TokenNameIdentifier	 group Field
,	TokenNameCOMMA	
c1	TokenNameIdentifier	 c1
.	TokenNameDOT	
getTopGroups	TokenNameIdentifier	 get Top Groups
(	TokenNameLPAREN	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
groupSort	TokenNameIdentifier	 group Sort
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
5	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
false	TokenNamefalse	
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
indexSearcher	TokenNameIdentifier	 index Searcher
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"content"	TokenNameStringLiteral	content
,	TokenNameCOMMA	
"random"	TokenNameStringLiteral	random
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
c2	TokenNameIdentifier	 c2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
TopGroups	TokenNameIdentifier	 Top Groups
groups	TokenNameIdentifier	 groups
=	TokenNameEQUAL	
c2	TokenNameIdentifier	 c2
.	TokenNameDOT	
getTopGroups	TokenNameIdentifier	 get Top Groups
(	TokenNameLPAREN	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
7	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
totalHitCount	TokenNameIdentifier	 total Hit Count
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
7	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
totalGroupedHitCount	TokenNameIdentifier	 total Grouped Hit Count
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
4	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// relevance order: 5, 0, 3, 4, 1, 2, 6 	TokenNameCOMMENT_LINE	relevance order: 5, 0, 3, 4, 1, 2, 6 
// the later a document is added the higher this docId 	TokenNameCOMMENT_LINE	the later a document is added the higher this docId 
// value 	TokenNameCOMMENT_LINE	value 
GroupDocs	TokenNameIdentifier	 Group Docs
group	TokenNameIdentifier	 group
=	TokenNameEQUAL	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"author3"	TokenNameStringLiteral	author3
,	TokenNameCOMMA	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
2	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
5	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
4	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
score	TokenNameIdentifier	 score
>	TokenNameGREATER	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
score	TokenNameIdentifier	 score
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
group	TokenNameIdentifier	 group
=	TokenNameEQUAL	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"author1"	TokenNameStringLiteral	author1
,	TokenNameCOMMA	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
3	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
2	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
2	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
score	TokenNameIdentifier	 score
>	TokenNameGREATER	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
score	TokenNameIdentifier	 score
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
score	TokenNameIdentifier	 score
>	TokenNameGREATER	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
2	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
score	TokenNameIdentifier	 score
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
group	TokenNameIdentifier	 group
=	TokenNameEQUAL	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
[	TokenNameLBRACKET	
2	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"author2"	TokenNameStringLiteral	author2
,	TokenNameCOMMA	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
3	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
group	TokenNameIdentifier	 group
=	TokenNameEQUAL	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
[	TokenNameLBRACKET	
3	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
assertNull	TokenNameIdentifier	 assert Null
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
6	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
indexSearcher	TokenNameIdentifier	 index Searcher
.	TokenNameDOT	
getIndexReader	TokenNameIdentifier	 get Index Reader
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
dir	TokenNameIdentifier	 dir
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
class	TokenNameclass	
GroupDoc	TokenNameIdentifier	 Group Doc
{	TokenNameLBRACE	
final	TokenNamefinal	
int	TokenNameint	
id	TokenNameIdentifier	 id
;	TokenNameSEMICOLON	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
group	TokenNameIdentifier	 group
;	TokenNameSEMICOLON	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
sort1	TokenNameIdentifier	 sort1
;	TokenNameSEMICOLON	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
sort2	TokenNameIdentifier	 sort2
;	TokenNameSEMICOLON	
// content must be "realN ..." 	TokenNameCOMMENT_LINE	content must be "realN ..." 
final	TokenNamefinal	
String	TokenNameIdentifier	 String
content	TokenNameIdentifier	 content
;	TokenNameSEMICOLON	
float	TokenNamefloat	
score	TokenNameIdentifier	 score
;	TokenNameSEMICOLON	
float	TokenNamefloat	
score2	TokenNameIdentifier	 score2
;	TokenNameSEMICOLON	
public	TokenNamepublic	
GroupDoc	TokenNameIdentifier	 Group Doc
(	TokenNameLPAREN	
int	TokenNameint	
id	TokenNameIdentifier	 id
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
group	TokenNameIdentifier	 group
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
sort1	TokenNameIdentifier	 sort1
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
sort2	TokenNameIdentifier	 sort2
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
content	TokenNameIdentifier	 content
)	TokenNameRPAREN	
{	TokenNameLBRACE	
this	TokenNamethis	
.	TokenNameDOT	
id	TokenNameIdentifier	 id
=	TokenNameEQUAL	
id	TokenNameIdentifier	 id
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
group	TokenNameIdentifier	 group
=	TokenNameEQUAL	
group	TokenNameIdentifier	 group
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
sort1	TokenNameIdentifier	 sort1
=	TokenNameEQUAL	
sort1	TokenNameIdentifier	 sort1
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
sort2	TokenNameIdentifier	 sort2
=	TokenNameEQUAL	
sort2	TokenNameIdentifier	 sort2
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
content	TokenNameIdentifier	 content
=	TokenNameEQUAL	
content	TokenNameIdentifier	 content
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
Sort	TokenNameIdentifier	 Sort
getRandomSort	TokenNameIdentifier	 get Random Sort
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
SortField	TokenNameIdentifier	 Sort Field
>	TokenNameGREATER	
sortFields	TokenNameIdentifier	 sort Fields
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
SortField	TokenNameIdentifier	 Sort Field
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
7	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
2	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
sortFields	TokenNameIdentifier	 sort Fields
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
SortField	TokenNameIdentifier	 Sort Field
.	TokenNameDOT	
FIELD_SCORE	TokenNameIdentifier	 FIELD  SCORE
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
sortFields	TokenNameIdentifier	 sort Fields
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
SortField	TokenNameIdentifier	 Sort Field
(	TokenNameLPAREN	
"sort1"	TokenNameStringLiteral	sort1
,	TokenNameCOMMA	
SortField	TokenNameIdentifier	 Sort Field
.	TokenNameDOT	
STRING	TokenNameIdentifier	 STRING
,	TokenNameCOMMA	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
sortFields	TokenNameIdentifier	 sort Fields
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
SortField	TokenNameIdentifier	 Sort Field
(	TokenNameLPAREN	
"sort2"	TokenNameStringLiteral	sort2
,	TokenNameCOMMA	
SortField	TokenNameIdentifier	 Sort Field
.	TokenNameDOT	
STRING	TokenNameIdentifier	 STRING
,	TokenNameCOMMA	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
sortFields	TokenNameIdentifier	 sort Fields
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
SortField	TokenNameIdentifier	 Sort Field
(	TokenNameLPAREN	
"sort1"	TokenNameStringLiteral	sort1
,	TokenNameCOMMA	
SortField	TokenNameIdentifier	 Sort Field
.	TokenNameDOT	
STRING	TokenNameIdentifier	 STRING
,	TokenNameCOMMA	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sortFields	TokenNameIdentifier	 sort Fields
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
SortField	TokenNameIdentifier	 Sort Field
(	TokenNameLPAREN	
"sort2"	TokenNameStringLiteral	sort2
,	TokenNameCOMMA	
SortField	TokenNameIdentifier	 Sort Field
.	TokenNameDOT	
STRING	TokenNameIdentifier	 STRING
,	TokenNameCOMMA	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
// Break ties: 	TokenNameCOMMENT_LINE	Break ties: 
sortFields	TokenNameIdentifier	 sort Fields
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
SortField	TokenNameIdentifier	 Sort Field
(	TokenNameLPAREN	
"id"	TokenNameStringLiteral	id
,	TokenNameCOMMA	
SortField	TokenNameIdentifier	 Sort Field
.	TokenNameDOT	
INT	TokenNameIdentifier	 INT
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
new	TokenNamenew	
Sort	TokenNameIdentifier	 Sort
(	TokenNameLPAREN	
sortFields	TokenNameIdentifier	 sort Fields
.	TokenNameDOT	
toArray	TokenNameIdentifier	 to Array
(	TokenNameLPAREN	
new	TokenNamenew	
SortField	TokenNameIdentifier	 Sort Field
[	TokenNameLBRACKET	
sortFields	TokenNameIdentifier	 sort Fields
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
Comparator	TokenNameIdentifier	 Comparator
<	TokenNameLESS	
GroupDoc	TokenNameIdentifier	 Group Doc
>	TokenNameGREATER	
getComparator	TokenNameIdentifier	 get Comparator
(	TokenNameLPAREN	
Sort	TokenNameIdentifier	 Sort
sort	TokenNameIdentifier	 sort
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
SortField	TokenNameIdentifier	 Sort Field
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
sortFields	TokenNameIdentifier	 sort Fields
=	TokenNameEQUAL	
sort	TokenNameIdentifier	 sort
.	TokenNameDOT	
getSort	TokenNameIdentifier	 get Sort
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
new	TokenNamenew	
Comparator	TokenNameIdentifier	 Comparator
<	TokenNameLESS	
GroupDoc	TokenNameIdentifier	 Group Doc
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// @Override -- Not until Java 1.6 	TokenNameCOMMENT_LINE	@Override -- Not until Java 1.6 
public	TokenNamepublic	
int	TokenNameint	
compare	TokenNameIdentifier	 compare
(	TokenNameLPAREN	
GroupDoc	TokenNameIdentifier	 Group Doc
d1	TokenNameIdentifier	 d1
,	TokenNameCOMMA	
GroupDoc	TokenNameIdentifier	 Group Doc
d2	TokenNameIdentifier	 d2
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
SortField	TokenNameIdentifier	 Sort Field
sf	TokenNameIdentifier	 sf
:	TokenNameCOLON	
sortFields	TokenNameIdentifier	 sort Fields
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
int	TokenNameint	
cmp	TokenNameIdentifier	 cmp
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
sf	TokenNameIdentifier	 sf
.	TokenNameDOT	
getType	TokenNameIdentifier	 get Type
(	TokenNameLPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
SortField	TokenNameIdentifier	 Sort Field
.	TokenNameDOT	
SCORE	TokenNameIdentifier	 SCORE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
d1	TokenNameIdentifier	 d1
.	TokenNameDOT	
score	TokenNameIdentifier	 score
>	TokenNameGREATER	
d2	TokenNameIdentifier	 d2
.	TokenNameDOT	
score	TokenNameIdentifier	 score
)	TokenNameRPAREN	
{	TokenNameLBRACE	
cmp	TokenNameIdentifier	 cmp
=	TokenNameEQUAL	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
d1	TokenNameIdentifier	 d1
.	TokenNameDOT	
score	TokenNameIdentifier	 score
<	TokenNameLESS	
d2	TokenNameIdentifier	 d2
.	TokenNameDOT	
score	TokenNameIdentifier	 score
)	TokenNameRPAREN	
{	TokenNameLBRACE	
cmp	TokenNameIdentifier	 cmp
=	TokenNameEQUAL	
1	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
cmp	TokenNameIdentifier	 cmp
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
sf	TokenNameIdentifier	 sf
.	TokenNameDOT	
getField	TokenNameIdentifier	 get Field
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
"sort1"	TokenNameStringLiteral	sort1
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
cmp	TokenNameIdentifier	 cmp
=	TokenNameEQUAL	
d1	TokenNameIdentifier	 d1
.	TokenNameDOT	
sort1	TokenNameIdentifier	 sort1
.	TokenNameDOT	
compareTo	TokenNameIdentifier	 compare To
(	TokenNameLPAREN	
d2	TokenNameIdentifier	 d2
.	TokenNameDOT	
sort1	TokenNameIdentifier	 sort1
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
sf	TokenNameIdentifier	 sf
.	TokenNameDOT	
getField	TokenNameIdentifier	 get Field
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
"sort2"	TokenNameStringLiteral	sort2
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
cmp	TokenNameIdentifier	 cmp
=	TokenNameEQUAL	
d1	TokenNameIdentifier	 d1
.	TokenNameDOT	
sort2	TokenNameIdentifier	 sort2
.	TokenNameDOT	
compareTo	TokenNameIdentifier	 compare To
(	TokenNameLPAREN	
d2	TokenNameIdentifier	 d2
.	TokenNameDOT	
sort2	TokenNameIdentifier	 sort2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
sf	TokenNameIdentifier	 sf
.	TokenNameDOT	
getField	TokenNameIdentifier	 get Field
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
"id"	TokenNameStringLiteral	id
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
cmp	TokenNameIdentifier	 cmp
=	TokenNameEQUAL	
d1	TokenNameIdentifier	 d1
.	TokenNameDOT	
id	TokenNameIdentifier	 id
-	TokenNameMINUS	
d2	TokenNameIdentifier	 d2
.	TokenNameDOT	
id	TokenNameIdentifier	 id
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
cmp	TokenNameIdentifier	 cmp
!=	TokenNameNOT_EQUAL	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
sf	TokenNameIdentifier	 sf
.	TokenNameDOT	
getReverse	TokenNameIdentifier	 get Reverse
(	TokenNameLPAREN	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
-	TokenNameMINUS	
cmp	TokenNameIdentifier	 cmp
:	TokenNameCOLON	
cmp	TokenNameIdentifier	 cmp
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
// Our sort always fully tie breaks: 	TokenNameCOMMENT_LINE	Our sort always fully tie breaks: 
fail	TokenNameIdentifier	 fail
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
Comparable	TokenNameIdentifier	 Comparable
<	TokenNameLESS	
?	TokenNameQUESTION	
>	TokenNameGREATER	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
fillFields	TokenNameIdentifier	 fill Fields
(	TokenNameLPAREN	
GroupDoc	TokenNameIdentifier	 Group Doc
d	TokenNameIdentifier	 d
,	TokenNameCOMMA	
Sort	TokenNameIdentifier	 Sort
sort	TokenNameIdentifier	 sort
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
SortField	TokenNameIdentifier	 Sort Field
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
sortFields	TokenNameIdentifier	 sort Fields
=	TokenNameEQUAL	
sort	TokenNameIdentifier	 sort
.	TokenNameDOT	
getSort	TokenNameIdentifier	 get Sort
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Comparable	TokenNameIdentifier	 Comparable
<	TokenNameLESS	
?	TokenNameQUESTION	
>	TokenNameGREATER	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
fields	TokenNameIdentifier	 fields
=	TokenNameEQUAL	
new	TokenNamenew	
Comparable	TokenNameIdentifier	 Comparable
[	TokenNameLBRACKET	
sortFields	TokenNameIdentifier	 sort Fields
.	TokenNameDOT	
length	TokenNameIdentifier	 length
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
fieldIDX	TokenNameIdentifier	 field IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
fieldIDX	TokenNameIdentifier	 field IDX
<	TokenNameLESS	
sortFields	TokenNameIdentifier	 sort Fields
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
fieldIDX	TokenNameIdentifier	 field IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
Comparable	TokenNameIdentifier	 Comparable
<	TokenNameLESS	
?	TokenNameQUESTION	
>	TokenNameGREATER	
c	TokenNameIdentifier	 c
;	TokenNameSEMICOLON	
final	TokenNamefinal	
SortField	TokenNameIdentifier	 Sort Field
sf	TokenNameIdentifier	 sf
=	TokenNameEQUAL	
sortFields	TokenNameIdentifier	 sort Fields
[	TokenNameLBRACKET	
fieldIDX	TokenNameIdentifier	 field IDX
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
sf	TokenNameIdentifier	 sf
.	TokenNameDOT	
getType	TokenNameIdentifier	 get Type
(	TokenNameLPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
SortField	TokenNameIdentifier	 Sort Field
.	TokenNameDOT	
SCORE	TokenNameIdentifier	 SCORE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
c	TokenNameIdentifier	 c
=	TokenNameEQUAL	
new	TokenNamenew	
Float	TokenNameIdentifier	 Float
(	TokenNameLPAREN	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
score	TokenNameIdentifier	 score
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
sf	TokenNameIdentifier	 sf
.	TokenNameDOT	
getField	TokenNameIdentifier	 get Field
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
"sort1"	TokenNameStringLiteral	sort1
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
c	TokenNameIdentifier	 c
=	TokenNameEQUAL	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
sort1	TokenNameIdentifier	 sort1
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
sf	TokenNameIdentifier	 sf
.	TokenNameDOT	
getField	TokenNameIdentifier	 get Field
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
"sort2"	TokenNameStringLiteral	sort2
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
c	TokenNameIdentifier	 c
=	TokenNameEQUAL	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
sort2	TokenNameIdentifier	 sort2
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"id"	TokenNameStringLiteral	id
,	TokenNameCOMMA	
sf	TokenNameIdentifier	 sf
.	TokenNameDOT	
getField	TokenNameIdentifier	 get Field
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
c	TokenNameIdentifier	 c
=	TokenNameEQUAL	
new	TokenNamenew	
Integer	TokenNameIdentifier	 Integer
(	TokenNameLPAREN	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
id	TokenNameIdentifier	 id
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
fields	TokenNameIdentifier	 fields
[	TokenNameLBRACKET	
fieldIDX	TokenNameIdentifier	 field IDX
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
c	TokenNameIdentifier	 c
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
fields	TokenNameIdentifier	 fields
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
String	TokenNameIdentifier	 String
groupToString	TokenNameIdentifier	 group To String
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
b	TokenNameIdentifier	 b
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
b	TokenNameIdentifier	 b
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
"null"	TokenNameStringLiteral	null
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
return	TokenNamereturn	
b	TokenNameIdentifier	 b
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
slowGrouping	TokenNameIdentifier	 slow Grouping
(	TokenNameLPAREN	
GroupDoc	TokenNameIdentifier	 Group Doc
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
groupDocs	TokenNameIdentifier	 group Docs
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
searchTerm	TokenNameIdentifier	 search Term
,	TokenNameCOMMA	
boolean	TokenNameboolean	
fillFields	TokenNameIdentifier	 fill Fields
,	TokenNameCOMMA	
boolean	TokenNameboolean	
getScores	TokenNameIdentifier	 get Scores
,	TokenNameCOMMA	
boolean	TokenNameboolean	
getMaxScores	TokenNameIdentifier	 get Max Scores
,	TokenNameCOMMA	
boolean	TokenNameboolean	
doAllGroups	TokenNameIdentifier	 do All Groups
,	TokenNameCOMMA	
Sort	TokenNameIdentifier	 Sort
groupSort	TokenNameIdentifier	 group Sort
,	TokenNameCOMMA	
Sort	TokenNameIdentifier	 Sort
docSort	TokenNameIdentifier	 doc Sort
,	TokenNameCOMMA	
int	TokenNameint	
topNGroups	TokenNameIdentifier	 top N Groups
,	TokenNameCOMMA	
int	TokenNameint	
docsPerGroup	TokenNameIdentifier	 docs Per Group
,	TokenNameCOMMA	
int	TokenNameint	
groupOffset	TokenNameIdentifier	 group Offset
,	TokenNameCOMMA	
int	TokenNameint	
docOffset	TokenNameIdentifier	 doc Offset
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
Comparator	TokenNameIdentifier	 Comparator
<	TokenNameLESS	
GroupDoc	TokenNameIdentifier	 Group Doc
>	TokenNameGREATER	
groupSortComp	TokenNameIdentifier	 group Sort Comp
=	TokenNameEQUAL	
getComparator	TokenNameIdentifier	 get Comparator
(	TokenNameLPAREN	
groupSort	TokenNameIdentifier	 group Sort
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Arrays	TokenNameIdentifier	 Arrays
.	TokenNameDOT	
sort	TokenNameIdentifier	 sort
(	TokenNameLPAREN	
groupDocs	TokenNameIdentifier	 group Docs
,	TokenNameCOMMA	
groupSortComp	TokenNameIdentifier	 group Sort Comp
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
GroupDoc	TokenNameIdentifier	 Group Doc
>>	TokenNameRIGHT_SHIFT	
groups	TokenNameIdentifier	 groups
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
GroupDoc	TokenNameIdentifier	 Group Doc
>>	TokenNameRIGHT_SHIFT	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
sortedGroups	TokenNameIdentifier	 sorted Groups
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Comparable	TokenNameIdentifier	 Comparable
<	TokenNameLESS	
?	TokenNameQUESTION	
>	TokenNameGREATER	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
>	TokenNameGREATER	
sortedGroupFields	TokenNameIdentifier	 sorted Group Fields
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
Comparable	TokenNameIdentifier	 Comparable
<	TokenNameLESS	
?	TokenNameQUESTION	
>	TokenNameGREATER	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
int	TokenNameint	
totalHitCount	TokenNameIdentifier	 total Hit Count
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
knownGroups	TokenNameIdentifier	 known Groups
=	TokenNameEQUAL	
new	TokenNamenew	
HashSet	TokenNameIdentifier	 Hash Set
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//System.out.println("TEST: slowGrouping"); 	TokenNameCOMMENT_LINE	System.out.println("TEST: slowGrouping"); 
for	TokenNamefor	
(	TokenNameLPAREN	
GroupDoc	TokenNameIdentifier	 Group Doc
d	TokenNameIdentifier	 d
:	TokenNameCOLON	
groupDocs	TokenNameIdentifier	 group Docs
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// TODO: would be better to filter by searchTerm before sorting! 	TokenNameCOMMENT_LINE	TODO: would be better to filter by searchTerm before sorting! 
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
content	TokenNameIdentifier	 content
.	TokenNameDOT	
startsWith	TokenNameIdentifier	 starts With
(	TokenNameLPAREN	
searchTerm	TokenNameIdentifier	 search Term
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
continue	TokenNamecontinue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
totalHitCount	TokenNameIdentifier	 total Hit Count
++	TokenNamePLUS_PLUS	
;	TokenNameSEMICOLON	
//System.out.println(" match id=" + d.id + " score=" + d.score); 	TokenNameCOMMENT_LINE	System.out.println(" match id=" + d.id + " score=" + d.score); 
if	TokenNameif	
(	TokenNameLPAREN	
doAllGroups	TokenNameIdentifier	 do All Groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
knownGroups	TokenNameIdentifier	 known Groups
.	TokenNameDOT	
contains	TokenNameIdentifier	 contains
(	TokenNameLPAREN	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
group	TokenNameIdentifier	 group
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
knownGroups	TokenNameIdentifier	 known Groups
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
group	TokenNameIdentifier	 group
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//System.out.println(" add group=" + groupToString(d.group)); 	TokenNameCOMMENT_LINE	System.out.println(" add group=" + groupToString(d.group)); 
}	TokenNameRBRACE	
}	TokenNameRBRACE	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
GroupDoc	TokenNameIdentifier	 Group Doc
>	TokenNameGREATER	
l	TokenNameIdentifier	 l
=	TokenNameEQUAL	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
group	TokenNameIdentifier	 group
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
l	TokenNameIdentifier	 l
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
//System.out.println(" add sortedGroup=" + groupToString(d.group)); 	TokenNameCOMMENT_LINE	System.out.println(" add sortedGroup=" + groupToString(d.group)); 
sortedGroups	TokenNameIdentifier	 sorted Groups
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
group	TokenNameIdentifier	 group
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
fillFields	TokenNameIdentifier	 fill Fields
)	TokenNameRPAREN	
{	TokenNameLBRACE	
sortedGroupFields	TokenNameIdentifier	 sorted Group Fields
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
fillFields	TokenNameIdentifier	 fill Fields
(	TokenNameLPAREN	
d	TokenNameIdentifier	 d
,	TokenNameCOMMA	
groupSort	TokenNameIdentifier	 group Sort
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
l	TokenNameIdentifier	 l
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
GroupDoc	TokenNameIdentifier	 Group Doc
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
group	TokenNameIdentifier	 group
,	TokenNameCOMMA	
l	TokenNameIdentifier	 l
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
l	TokenNameIdentifier	 l
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
d	TokenNameIdentifier	 d
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
groupOffset	TokenNameIdentifier	 group Offset
>=	TokenNameGREATER_EQUAL	
sortedGroups	TokenNameIdentifier	 sorted Groups
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// slice is out of bounds 	TokenNameCOMMENT_LINE	slice is out of bounds 
return	TokenNamereturn	
null	TokenNamenull	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
final	TokenNamefinal	
int	TokenNameint	
limit	TokenNameIdentifier	 limit
=	TokenNameEQUAL	
Math	TokenNameIdentifier	 Math
.	TokenNameDOT	
min	TokenNameIdentifier	 min
(	TokenNameLPAREN	
groupOffset	TokenNameIdentifier	 group Offset
+	TokenNamePLUS	
topNGroups	TokenNameIdentifier	 top N Groups
,	TokenNameCOMMA	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Comparator	TokenNameIdentifier	 Comparator
<	TokenNameLESS	
GroupDoc	TokenNameIdentifier	 Group Doc
>	TokenNameGREATER	
docSortComp	TokenNameIdentifier	 doc Sort Comp
=	TokenNameEQUAL	
getComparator	TokenNameIdentifier	 get Comparator
(	TokenNameLPAREN	
docSort	TokenNameIdentifier	 doc Sort
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
@	TokenNameAT	
SuppressWarnings	TokenNameIdentifier	 Suppress Warnings
(	TokenNameLPAREN	
"unchecked"	TokenNameStringLiteral	unchecked
)	TokenNameRPAREN	
final	TokenNamefinal	
GroupDocs	TokenNameIdentifier	 Group Docs
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
result	TokenNameIdentifier	 result
=	TokenNameEQUAL	
new	TokenNamenew	
GroupDocs	TokenNameIdentifier	 Group Docs
[	TokenNameLBRACKET	
limit	TokenNameIdentifier	 limit
-	TokenNameMINUS	
groupOffset	TokenNameIdentifier	 group Offset
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
int	TokenNameint	
totalGroupedHitCount	TokenNameIdentifier	 total Grouped Hit Count
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
idx	TokenNameIdentifier	 idx
=	TokenNameEQUAL	
groupOffset	TokenNameIdentifier	 group Offset
;	TokenNameSEMICOLON	
idx	TokenNameIdentifier	 idx
<	TokenNameLESS	
limit	TokenNameIdentifier	 limit
;	TokenNameSEMICOLON	
idx	TokenNameIdentifier	 idx
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
group	TokenNameIdentifier	 group
=	TokenNameEQUAL	
sortedGroups	TokenNameIdentifier	 sorted Groups
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
idx	TokenNameIdentifier	 idx
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
GroupDoc	TokenNameIdentifier	 Group Doc
>	TokenNameGREATER	
docs	TokenNameIdentifier	 docs
=	TokenNameEQUAL	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
totalGroupedHitCount	TokenNameIdentifier	 total Grouped Hit Count
+=	TokenNamePLUS_EQUAL	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
sort	TokenNameIdentifier	 sort
(	TokenNameLPAREN	
docs	TokenNameIdentifier	 docs
,	TokenNameCOMMA	
docSortComp	TokenNameIdentifier	 doc Sort Comp
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
ScoreDoc	TokenNameIdentifier	 Score Doc
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
hits	TokenNameIdentifier	 hits
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
>	TokenNameGREATER	
docOffset	TokenNameIdentifier	 doc Offset
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
int	TokenNameint	
docIDXLimit	TokenNameIdentifier	 doc IDX Limit
=	TokenNameEQUAL	
Math	TokenNameIdentifier	 Math
.	TokenNameDOT	
min	TokenNameIdentifier	 min
(	TokenNameLPAREN	
docOffset	TokenNameIdentifier	 doc Offset
+	TokenNamePLUS	
docsPerGroup	TokenNameIdentifier	 docs Per Group
,	TokenNameCOMMA	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
hits	TokenNameIdentifier	 hits
=	TokenNameEQUAL	
new	TokenNamenew	
ScoreDoc	TokenNameIdentifier	 Score Doc
[	TokenNameLBRACKET	
docIDXLimit	TokenNameIdentifier	 doc IDX Limit
-	TokenNameMINUS	
docOffset	TokenNameIdentifier	 doc Offset
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
docIDX	TokenNameIdentifier	 doc IDX
=	TokenNameEQUAL	
docOffset	TokenNameIdentifier	 doc Offset
;	TokenNameSEMICOLON	
docIDX	TokenNameIdentifier	 doc IDX
<	TokenNameLESS	
docIDXLimit	TokenNameIdentifier	 doc IDX Limit
;	TokenNameSEMICOLON	
docIDX	TokenNameIdentifier	 doc IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
GroupDoc	TokenNameIdentifier	 Group Doc
d	TokenNameIdentifier	 d
=	TokenNameEQUAL	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
docIDX	TokenNameIdentifier	 doc IDX
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
FieldDoc	TokenNameIdentifier	 Field Doc
fd	TokenNameIdentifier	 fd
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
fillFields	TokenNameIdentifier	 fill Fields
)	TokenNameRPAREN	
{	TokenNameLBRACE	
fd	TokenNameIdentifier	 fd
=	TokenNameEQUAL	
new	TokenNamenew	
FieldDoc	TokenNameIdentifier	 Field Doc
(	TokenNameLPAREN	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
id	TokenNameIdentifier	 id
,	TokenNameCOMMA	
getScores	TokenNameIdentifier	 get Scores
?	TokenNameQUESTION	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
score	TokenNameIdentifier	 score
:	TokenNameCOLON	
Float	TokenNameIdentifier	 Float
.	TokenNameDOT	
NaN	TokenNameIdentifier	 Na N
,	TokenNameCOMMA	
fillFields	TokenNameIdentifier	 fill Fields
(	TokenNameLPAREN	
d	TokenNameIdentifier	 d
,	TokenNameCOMMA	
docSort	TokenNameIdentifier	 doc Sort
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
fd	TokenNameIdentifier	 fd
=	TokenNameEQUAL	
new	TokenNamenew	
FieldDoc	TokenNameIdentifier	 Field Doc
(	TokenNameLPAREN	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
id	TokenNameIdentifier	 id
,	TokenNameCOMMA	
getScores	TokenNameIdentifier	 get Scores
?	TokenNameQUESTION	
d	TokenNameIdentifier	 d
.	TokenNameDOT	
score	TokenNameIdentifier	 score
:	TokenNameCOLON	
Float	TokenNameIdentifier	 Float
.	TokenNameDOT	
NaN	TokenNameIdentifier	 Na N
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
hits	TokenNameIdentifier	 hits
[	TokenNameLBRACKET	
docIDX	TokenNameIdentifier	 doc IDX
-	TokenNameMINUS	
docOffset	TokenNameIdentifier	 doc Offset
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
fd	TokenNameIdentifier	 fd
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
hits	TokenNameIdentifier	 hits
=	TokenNameEQUAL	
new	TokenNamenew	
ScoreDoc	TokenNameIdentifier	 Score Doc
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
result	TokenNameIdentifier	 result
[	TokenNameLBRACKET	
idx	TokenNameIdentifier	 idx
-	TokenNameMINUS	
groupOffset	TokenNameIdentifier	 group Offset
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
new	TokenNamenew	
GroupDocs	TokenNameIdentifier	 Group Docs
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
(	TokenNameLPAREN	
0.0f	TokenNameFloatingPointLiteral	
,	TokenNameCOMMA	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
hits	TokenNameIdentifier	 hits
,	TokenNameCOMMA	
group	TokenNameIdentifier	 group
,	TokenNameCOMMA	
fillFields	TokenNameIdentifier	 fill Fields
?	TokenNameQUESTION	
sortedGroupFields	TokenNameIdentifier	 sorted Group Fields
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
idx	TokenNameIdentifier	 idx
)	TokenNameRPAREN	
:	TokenNameCOLON	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
doAllGroups	TokenNameIdentifier	 do All Groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
new	TokenNamenew	
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
(	TokenNameLPAREN	
new	TokenNamenew	
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
(	TokenNameLPAREN	
groupSort	TokenNameIdentifier	 group Sort
.	TokenNameDOT	
getSort	TokenNameIdentifier	 get Sort
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
docSort	TokenNameIdentifier	 doc Sort
.	TokenNameDOT	
getSort	TokenNameIdentifier	 get Sort
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
totalHitCount	TokenNameIdentifier	 total Hit Count
,	TokenNameCOMMA	
totalGroupedHitCount	TokenNameIdentifier	 total Grouped Hit Count
,	TokenNameCOMMA	
result	TokenNameIdentifier	 result
)	TokenNameRPAREN	
,	TokenNameCOMMA	
knownGroups	TokenNameIdentifier	 known Groups
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
return	TokenNamereturn	
new	TokenNamenew	
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
(	TokenNameLPAREN	
groupSort	TokenNameIdentifier	 group Sort
.	TokenNameDOT	
getSort	TokenNameIdentifier	 get Sort
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
docSort	TokenNameIdentifier	 doc Sort
.	TokenNameDOT	
getSort	TokenNameIdentifier	 get Sort
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
totalHitCount	TokenNameIdentifier	 total Hit Count
,	TokenNameCOMMA	
totalGroupedHitCount	TokenNameIdentifier	 total Grouped Hit Count
,	TokenNameCOMMA	
result	TokenNameIdentifier	 result
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
IndexReader	TokenNameIdentifier	 Index Reader
getDocBlockReader	TokenNameIdentifier	 get Doc Block Reader
(	TokenNameLPAREN	
Directory	TokenNameIdentifier	 Directory
dir	TokenNameIdentifier	 dir
,	TokenNameCOMMA	
GroupDoc	TokenNameIdentifier	 Group Doc
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
groupDocs	TokenNameIdentifier	 group Docs
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
// Coalesce by group, but in random order: 	TokenNameCOMMENT_LINE	Coalesce by group, but in random order: 
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
shuffle	TokenNameIdentifier	 shuffle
(	TokenNameLPAREN	
Arrays	TokenNameIdentifier	 Arrays
.	TokenNameDOT	
asList	TokenNameIdentifier	 as List
(	TokenNameLPAREN	
groupDocs	TokenNameIdentifier	 group Docs
)	TokenNameRPAREN	
,	TokenNameCOMMA	
random	TokenNameIdentifier	 random
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
GroupDoc	TokenNameIdentifier	 Group Doc
>>	TokenNameRIGHT_SHIFT	
groupMap	TokenNameIdentifier	 group Map
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
GroupDoc	TokenNameIdentifier	 Group Doc
>>	TokenNameRIGHT_SHIFT	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
groupValues	TokenNameIdentifier	 group Values
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
GroupDoc	TokenNameIdentifier	 Group Doc
groupDoc	TokenNameIdentifier	 group Doc
:	TokenNameCOLON	
groupDocs	TokenNameIdentifier	 group Docs
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
groupMap	TokenNameIdentifier	 group Map
.	TokenNameDOT	
containsKey	TokenNameIdentifier	 contains Key
(	TokenNameLPAREN	
groupDoc	TokenNameIdentifier	 group Doc
.	TokenNameDOT	
group	TokenNameIdentifier	 group
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
groupValues	TokenNameIdentifier	 group Values
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
groupDoc	TokenNameIdentifier	 group Doc
.	TokenNameDOT	
group	TokenNameIdentifier	 group
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
groupMap	TokenNameIdentifier	 group Map
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
groupDoc	TokenNameIdentifier	 group Doc
.	TokenNameDOT	
group	TokenNameIdentifier	 group
,	TokenNameCOMMA	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
GroupDoc	TokenNameIdentifier	 Group Doc
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
groupMap	TokenNameIdentifier	 group Map
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
groupDoc	TokenNameIdentifier	 group Doc
.	TokenNameDOT	
group	TokenNameIdentifier	 group
)	TokenNameRPAREN	
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
groupDoc	TokenNameIdentifier	 group Doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
w	TokenNameIdentifier	 w
=	TokenNameEQUAL	
new	TokenNamenew	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
dir	TokenNameIdentifier	 dir
,	TokenNameCOMMA	
newIndexWriterConfig	TokenNameIdentifier	 new Index Writer Config
(	TokenNameLPAREN	
TEST_VERSION_CURRENT	TokenNameIdentifier	 TEST  VERSION  CURRENT
,	TokenNameCOMMA	
new	TokenNamenew	
MockAnalyzer	TokenNameIdentifier	 Mock Analyzer
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Document	TokenNameIdentifier	 Document
>>	TokenNameRIGHT_SHIFT	
updateDocs	TokenNameIdentifier	 update Docs
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Document	TokenNameIdentifier	 Document
>>	TokenNameRIGHT_SHIFT	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//System.out.println("TEST: index groups"); 	TokenNameCOMMENT_LINE	System.out.println("TEST: index groups"); 
for	TokenNamefor	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
group	TokenNameIdentifier	 group
:	TokenNameCOLON	
groupValues	TokenNameIdentifier	 group Values
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Document	TokenNameIdentifier	 Document
>	TokenNameGREATER	
docs	TokenNameIdentifier	 docs
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
Document	TokenNameIdentifier	 Document
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//System.out.println("TEST: group=" + (group == null ? "null" : group.utf8ToString())); 	TokenNameCOMMENT_LINE	System.out.println("TEST: group=" + (group == null ? "null" : group.utf8ToString())); 
for	TokenNamefor	
(	TokenNameLPAREN	
GroupDoc	TokenNameIdentifier	 Group Doc
groupValue	TokenNameIdentifier	 group Value
:	TokenNameCOLON	
groupMap	TokenNameIdentifier	 group Map
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Document	TokenNameIdentifier	 Document
doc	TokenNameIdentifier	 doc
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
groupValue	TokenNameIdentifier	 group Value
.	TokenNameDOT	
group	TokenNameIdentifier	 group
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"group"	TokenNameStringLiteral	group
,	TokenNameCOMMA	
groupValue	TokenNameIdentifier	 group Value
.	TokenNameDOT	
group	TokenNameIdentifier	 group
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"sort1"	TokenNameStringLiteral	sort1
,	TokenNameCOMMA	
groupValue	TokenNameIdentifier	 group Value
.	TokenNameDOT	
sort1	TokenNameIdentifier	 sort1
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"sort2"	TokenNameStringLiteral	sort2
,	TokenNameCOMMA	
groupValue	TokenNameIdentifier	 group Value
.	TokenNameDOT	
sort2	TokenNameIdentifier	 sort2
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
NumericField	TokenNameIdentifier	 Numeric Field
(	TokenNameLPAREN	
"id"	TokenNameStringLiteral	id
)	TokenNameRPAREN	
.	TokenNameDOT	
setIntValue	TokenNameIdentifier	 set Int Value
(	TokenNameLPAREN	
groupValue	TokenNameIdentifier	 group Value
.	TokenNameDOT	
id	TokenNameIdentifier	 id
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"content"	TokenNameStringLiteral	content
,	TokenNameCOMMA	
groupValue	TokenNameIdentifier	 group Value
.	TokenNameDOT	
content	TokenNameIdentifier	 content
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
ANALYZED	TokenNameIdentifier	 ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//System.out.println("TEST: doc content=" + groupValue.content + " group=" + (groupValue.group == null ? "null" : groupValue.group.utf8ToString()) + " sort1=" + groupValue.sort1.utf8ToString() + " id=" + groupValue.id); 	TokenNameCOMMENT_LINE	System.out.println("TEST: doc content=" + groupValue.content + " group=" + (groupValue.group == null ? "null" : groupValue.group.utf8ToString()) + " sort1=" + groupValue.sort1.utf8ToString() + " id=" + groupValue.id); 
}	TokenNameRBRACE	
// So we can pull filter marking last doc in block: 	TokenNameCOMMENT_LINE	So we can pull filter marking last doc in block: 
final	TokenNamefinal	
Field	TokenNameIdentifier	 Field
groupEnd	TokenNameIdentifier	 group End
=	TokenNameEQUAL	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"groupend"	TokenNameStringLiteral	groupend
,	TokenNameCOMMA	
"x"	TokenNameStringLiteral	x
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
groupEnd	TokenNameIdentifier	 group End
.	TokenNameDOT	
setIndexOptions	TokenNameIdentifier	 set Index Options
(	TokenNameLPAREN	
IndexOptions	TokenNameIdentifier	 Index Options
.	TokenNameDOT	
DOCS_ONLY	TokenNameIdentifier	 DOCS  ONLY
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
groupEnd	TokenNameIdentifier	 group End
.	TokenNameDOT	
setOmitNorms	TokenNameIdentifier	 set Omit Norms
(	TokenNameLPAREN	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
groupEnd	TokenNameIdentifier	 group End
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Add as a doc block: 	TokenNameCOMMENT_LINE	Add as a doc block: 
w	TokenNameIdentifier	 w
.	TokenNameDOT	
addDocuments	TokenNameIdentifier	 add Documents
(	TokenNameLPAREN	
docs	TokenNameIdentifier	 docs
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
&&	TokenNameAND_AND	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
7	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
4	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
updateDocs	TokenNameIdentifier	 update Docs
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
docs	TokenNameIdentifier	 docs
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Document	TokenNameIdentifier	 Document
>	TokenNameGREATER	
docs	TokenNameIdentifier	 docs
:	TokenNameCOLON	
updateDocs	TokenNameIdentifier	 update Docs
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// Just replaces docs w/ same docs: 	TokenNameCOMMENT_LINE	Just replaces docs w/ same docs: 
w	TokenNameIdentifier	 w
.	TokenNameDOT	
updateDocuments	TokenNameIdentifier	 update Documents
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"group"	TokenNameStringLiteral	group
,	TokenNameCOMMA	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"group"	TokenNameStringLiteral	group
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
docs	TokenNameIdentifier	 docs
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
final	TokenNamefinal	
IndexReader	TokenNameIdentifier	 Index Reader
r	TokenNameIdentifier	 r
=	TokenNameEQUAL	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
getReader	TokenNameIdentifier	 get Reader
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
r	TokenNameIdentifier	 r
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
class	TokenNameclass	
ShardState	TokenNameIdentifier	 Shard State
{	TokenNameLBRACE	
public	TokenNamepublic	
final	TokenNamefinal	
ShardSearcher	TokenNameIdentifier	 Shard Searcher
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
subSearchers	TokenNameIdentifier	 sub Searchers
;	TokenNameSEMICOLON	
public	TokenNamepublic	
final	TokenNamefinal	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
docStarts	TokenNameIdentifier	 doc Starts
;	TokenNameSEMICOLON	
public	TokenNamepublic	
ShardState	TokenNameIdentifier	 Shard State
(	TokenNameLPAREN	
IndexSearcher	TokenNameIdentifier	 Index Searcher
s	TokenNameIdentifier	 s
)	TokenNameRPAREN	
{	TokenNameLBRACE	
IndexReader	TokenNameIdentifier	 Index Reader
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
subReaders	TokenNameIdentifier	 sub Readers
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
getIndexReader	TokenNameIdentifier	 get Index Reader
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getSequentialSubReaders	TokenNameIdentifier	 get Sequential Sub Readers
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
subReaders	TokenNameIdentifier	 sub Readers
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
subReaders	TokenNameIdentifier	 sub Readers
=	TokenNameEQUAL	
new	TokenNamenew	
IndexReader	TokenNameIdentifier	 Index Reader
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
{	TokenNameLBRACE	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
getIndexReader	TokenNameIdentifier	 get Index Reader
(	TokenNameLPAREN	
)	TokenNameRPAREN	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
subSearchers	TokenNameIdentifier	 sub Searchers
=	TokenNameEQUAL	
new	TokenNamenew	
ShardSearcher	TokenNameIdentifier	 Shard Searcher
[	TokenNameLBRACKET	
subReaders	TokenNameIdentifier	 sub Readers
.	TokenNameDOT	
length	TokenNameIdentifier	 length
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
searcherIDX	TokenNameIdentifier	 searcher IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
searcherIDX	TokenNameIdentifier	 searcher IDX
<	TokenNameLESS	
subSearchers	TokenNameIdentifier	 sub Searchers
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
searcherIDX	TokenNameIdentifier	 searcher IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
subSearchers	TokenNameIdentifier	 sub Searchers
[	TokenNameLBRACKET	
searcherIDX	TokenNameIdentifier	 searcher IDX
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
new	TokenNamenew	
ShardSearcher	TokenNameIdentifier	 Shard Searcher
(	TokenNameLPAREN	
subReaders	TokenNameIdentifier	 sub Readers
[	TokenNameLBRACKET	
searcherIDX	TokenNameIdentifier	 searcher IDX
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
docStarts	TokenNameIdentifier	 doc Starts
=	TokenNameEQUAL	
new	TokenNamenew	
int	TokenNameint	
[	TokenNameLBRACKET	
subSearchers	TokenNameIdentifier	 sub Searchers
.	TokenNameDOT	
length	TokenNameIdentifier	 length
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
int	TokenNameint	
docBase	TokenNameIdentifier	 doc Base
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
subIDX	TokenNameIdentifier	 sub IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
subIDX	TokenNameIdentifier	 sub IDX
<	TokenNameLESS	
docStarts	TokenNameIdentifier	 doc Starts
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
subIDX	TokenNameIdentifier	 sub IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
docStarts	TokenNameIdentifier	 doc Starts
[	TokenNameLBRACKET	
subIDX	TokenNameIdentifier	 sub IDX
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
docBase	TokenNameIdentifier	 doc Base
;	TokenNameSEMICOLON	
docBase	TokenNameIdentifier	 doc Base
+=	TokenNamePLUS_EQUAL	
subReaders	TokenNameIdentifier	 sub Readers
[	TokenNameLBRACKET	
subIDX	TokenNameIdentifier	 sub IDX
]	TokenNameRBRACKET	
.	TokenNameDOT	
maxDoc	TokenNameIdentifier	 max Doc
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//System.out.println("docStarts[" + subIDX + "]=" + docStarts[subIDX]); 	TokenNameCOMMENT_LINE	System.out.println("docStarts[" + subIDX + "]=" + docStarts[subIDX]); 
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
testRandom	TokenNameIdentifier	 test Random
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
iter	TokenNameIdentifier	 iter
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
iter	TokenNameIdentifier	 iter
<	TokenNameLESS	
3	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
iter	TokenNameIdentifier	 iter
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: iter="	TokenNameStringLiteral	TEST: iter=
+	TokenNamePLUS	
iter	TokenNameIdentifier	 iter
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
final	TokenNamefinal	
int	TokenNameint	
numDocs	TokenNameIdentifier	 num Docs
=	TokenNameEQUAL	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
100	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
1000	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
*	TokenNameMULTIPLY	
RANDOM_MULTIPLIER	TokenNameIdentifier	 RANDOM  MULTIPLIER
;	TokenNameSEMICOLON	
//final int numDocs = _TestUtil.nextInt(random, 5, 20); 	TokenNameCOMMENT_LINE	final int numDocs = _TestUtil.nextInt(random, 5, 20); 
final	TokenNamefinal	
int	TokenNameint	
numGroups	TokenNameIdentifier	 num Groups
=	TokenNameEQUAL	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
numDocs	TokenNameIdentifier	 num Docs
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: numDocs="	TokenNameStringLiteral	TEST: numDocs=
+	TokenNamePLUS	
numDocs	TokenNameIdentifier	 num Docs
+	TokenNamePLUS	
" numGroups="	TokenNameStringLiteral	 numGroups=
+	TokenNamePLUS	
numGroups	TokenNameIdentifier	 num Groups
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
final	TokenNamefinal	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
groups	TokenNameIdentifier	 groups
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
numGroups	TokenNameIdentifier	 num Groups
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
randomRealisticUnicodeString	TokenNameIdentifier	 random Realistic Unicode String
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//groups.add(_TestUtil.randomUnicodeString(random)); 	TokenNameCOMMENT_LINE	groups.add(_TestUtil.randomUnicodeString(random)); 
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
.	TokenNameDOT	
indexOf	TokenNameIdentifier	 index Of
(	TokenNameLPAREN	
0xffff	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//groups.add(new BytesRef(_TestUtil.randomSimpleString(random))); 	TokenNameCOMMENT_LINE	groups.add(new BytesRef(_TestUtil.randomSimpleString(random))); 
}	TokenNameRBRACE	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
contentStrings	TokenNameIdentifier	 content Strings
=	TokenNameEQUAL	
new	TokenNamenew	
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
2	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
20	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: create fake content"	TokenNameStringLiteral	TEST: create fake content
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
contentIDX	TokenNameIdentifier	 content IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
contentIDX	TokenNameIdentifier	 content IDX
<	TokenNameLESS	
contentStrings	TokenNameIdentifier	 content Strings
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
contentIDX	TokenNameIdentifier	 content IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
StringBuilder	TokenNameIdentifier	 String Builder
sb	TokenNameIdentifier	 sb
=	TokenNameEQUAL	
new	TokenNamenew	
StringBuilder	TokenNameIdentifier	 String Builder
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
"real"	TokenNameStringLiteral	real
+	TokenNamePLUS	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
3	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
' '	TokenNameCharacterLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
int	TokenNameint	
fakeCount	TokenNameIdentifier	 fake Count
=	TokenNameEQUAL	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
10	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
fakeIDX	TokenNameIdentifier	 fake IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
fakeIDX	TokenNameIdentifier	 fake IDX
<	TokenNameLESS	
fakeCount	TokenNameIdentifier	 fake Count
;	TokenNameSEMICOLON	
fakeIDX	TokenNameIdentifier	 fake IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
"fake "	TokenNameStringLiteral	fake 
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
contentStrings	TokenNameIdentifier	 content Strings
[	TokenNameLBRACKET	
contentIDX	TokenNameIdentifier	 content IDX
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" content="	TokenNameStringLiteral	 content=
+	TokenNamePLUS	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
Directory	TokenNameIdentifier	 Directory
dir	TokenNameIdentifier	 dir
=	TokenNameEQUAL	
newDirectory	TokenNameIdentifier	 new Directory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
w	TokenNameIdentifier	 w
=	TokenNameEQUAL	
new	TokenNamenew	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
dir	TokenNameIdentifier	 dir
,	TokenNameCOMMA	
newIndexWriterConfig	TokenNameIdentifier	 new Index Writer Config
(	TokenNameLPAREN	
TEST_VERSION_CURRENT	TokenNameIdentifier	 TEST  VERSION  CURRENT
,	TokenNameCOMMA	
new	TokenNamenew	
MockAnalyzer	TokenNameIdentifier	 Mock Analyzer
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Document	TokenNameIdentifier	 Document
doc	TokenNameIdentifier	 doc
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Document	TokenNameIdentifier	 Document
docNoGroup	TokenNameIdentifier	 doc No Group
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Field	TokenNameIdentifier	 Field
group	TokenNameIdentifier	 group
=	TokenNameEQUAL	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"group"	TokenNameStringLiteral	group
,	TokenNameCOMMA	
""	TokenNameStringLiteral	 
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Field	TokenNameIdentifier	 Field
sort1	TokenNameIdentifier	 sort1
=	TokenNameEQUAL	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"sort1"	TokenNameStringLiteral	sort1
,	TokenNameCOMMA	
""	TokenNameStringLiteral	 
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
sort1	TokenNameIdentifier	 sort1
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docNoGroup	TokenNameIdentifier	 doc No Group
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
sort1	TokenNameIdentifier	 sort1
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Field	TokenNameIdentifier	 Field
sort2	TokenNameIdentifier	 sort2
=	TokenNameEQUAL	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"sort2"	TokenNameStringLiteral	sort2
,	TokenNameCOMMA	
""	TokenNameStringLiteral	 
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
sort2	TokenNameIdentifier	 sort2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docNoGroup	TokenNameIdentifier	 doc No Group
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
sort2	TokenNameIdentifier	 sort2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Field	TokenNameIdentifier	 Field
content	TokenNameIdentifier	 content
=	TokenNameEQUAL	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"content"	TokenNameStringLiteral	content
,	TokenNameCOMMA	
""	TokenNameStringLiteral	 
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
ANALYZED	TokenNameIdentifier	 ANALYZED
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
content	TokenNameIdentifier	 content
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docNoGroup	TokenNameIdentifier	 doc No Group
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
content	TokenNameIdentifier	 content
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
NumericField	TokenNameIdentifier	 Numeric Field
id	TokenNameIdentifier	 id
=	TokenNameEQUAL	
new	TokenNamenew	
NumericField	TokenNameIdentifier	 Numeric Field
(	TokenNameLPAREN	
"id"	TokenNameStringLiteral	id
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
id	TokenNameIdentifier	 id
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docNoGroup	TokenNameIdentifier	 doc No Group
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
id	TokenNameIdentifier	 id
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
GroupDoc	TokenNameIdentifier	 Group Doc
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
groupDocs	TokenNameIdentifier	 group Docs
=	TokenNameEQUAL	
new	TokenNamenew	
GroupDoc	TokenNameIdentifier	 Group Doc
[	TokenNameLBRACKET	
numDocs	TokenNameIdentifier	 num Docs
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
numDocs	TokenNameIdentifier	 num Docs
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
groupValue	TokenNameIdentifier	 group Value
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
24	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
17	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// So we test the "doc doesn't have the group'd 	TokenNameCOMMENT_LINE	So we test the "doc doesn't have the group'd 
// field" case: 	TokenNameCOMMENT_LINE	field" case: 
groupValue	TokenNameIdentifier	 group Value
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
groupValue	TokenNameIdentifier	 group Value
=	TokenNameEQUAL	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
final	TokenNamefinal	
GroupDoc	TokenNameIdentifier	 Group Doc
groupDoc	TokenNameIdentifier	 group Doc
=	TokenNameEQUAL	
new	TokenNamenew	
GroupDoc	TokenNameIdentifier	 Group Doc
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
,	TokenNameCOMMA	
groupValue	TokenNameIdentifier	 group Value
,	TokenNameCOMMA	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
contentStrings	TokenNameIdentifier	 content Strings
[	TokenNameLBRACKET	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
contentStrings	TokenNameIdentifier	 content Strings
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" doc content="	TokenNameStringLiteral	 doc content=
+	TokenNamePLUS	
groupDoc	TokenNameIdentifier	 group Doc
.	TokenNameDOT	
content	TokenNameIdentifier	 content
+	TokenNamePLUS	
" id="	TokenNameStringLiteral	 id=
+	TokenNamePLUS	
i	TokenNameIdentifier	 i
+	TokenNamePLUS	
" group="	TokenNameStringLiteral	 group=
+	TokenNamePLUS	
(	TokenNameLPAREN	
groupDoc	TokenNameIdentifier	 group Doc
.	TokenNameDOT	
group	TokenNameIdentifier	 group
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
?	TokenNameQUESTION	
"null"	TokenNameStringLiteral	null
:	TokenNameCOLON	
groupDoc	TokenNameIdentifier	 group Doc
.	TokenNameDOT	
group	TokenNameIdentifier	 group
)	TokenNameRPAREN	
+	TokenNamePLUS	
" sort1="	TokenNameStringLiteral	 sort1=
+	TokenNamePLUS	
groupDoc	TokenNameIdentifier	 group Doc
.	TokenNameDOT	
sort1	TokenNameIdentifier	 sort1
+	TokenNamePLUS	
" sort2="	TokenNameStringLiteral	 sort2=
+	TokenNamePLUS	
groupDoc	TokenNameIdentifier	 group Doc
.	TokenNameDOT	
sort2	TokenNameIdentifier	 sort2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
groupDocs	TokenNameIdentifier	 group Docs
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
groupDoc	TokenNameIdentifier	 group Doc
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
groupDoc	TokenNameIdentifier	 group Doc
.	TokenNameDOT	
group	TokenNameIdentifier	 group
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
setValue	TokenNameIdentifier	 set Value
(	TokenNameLPAREN	
groupDoc	TokenNameIdentifier	 group Doc
.	TokenNameDOT	
group	TokenNameIdentifier	 group
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
sort1	TokenNameIdentifier	 sort1
.	TokenNameDOT	
setValue	TokenNameIdentifier	 set Value
(	TokenNameLPAREN	
groupDoc	TokenNameIdentifier	 group Doc
.	TokenNameDOT	
sort1	TokenNameIdentifier	 sort1
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sort2	TokenNameIdentifier	 sort2
.	TokenNameDOT	
setValue	TokenNameIdentifier	 set Value
(	TokenNameLPAREN	
groupDoc	TokenNameIdentifier	 group Doc
.	TokenNameDOT	
sort2	TokenNameIdentifier	 sort2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
content	TokenNameIdentifier	 content
.	TokenNameDOT	
setValue	TokenNameIdentifier	 set Value
(	TokenNameLPAREN	
groupDoc	TokenNameIdentifier	 group Doc
.	TokenNameDOT	
content	TokenNameIdentifier	 content
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
id	TokenNameIdentifier	 id
.	TokenNameDOT	
setIntValue	TokenNameIdentifier	 set Int Value
(	TokenNameLPAREN	
groupDoc	TokenNameIdentifier	 group Doc
.	TokenNameDOT	
id	TokenNameIdentifier	 id
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
groupDoc	TokenNameIdentifier	 group Doc
.	TokenNameDOT	
group	TokenNameIdentifier	 group
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
addDocument	TokenNameIdentifier	 add Document
(	TokenNameLPAREN	
docNoGroup	TokenNameIdentifier	 doc No Group
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
addDocument	TokenNameIdentifier	 add Document
(	TokenNameLPAREN	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
final	TokenNamefinal	
GroupDoc	TokenNameIdentifier	 Group Doc
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
groupDocsByID	TokenNameIdentifier	 group Docs By ID
=	TokenNameEQUAL	
new	TokenNamenew	
GroupDoc	TokenNameIdentifier	 Group Doc
[	TokenNameLBRACKET	
groupDocs	TokenNameIdentifier	 group Docs
.	TokenNameDOT	
length	TokenNameIdentifier	 length
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
arraycopy	TokenNameIdentifier	 arraycopy
(	TokenNameLPAREN	
groupDocs	TokenNameIdentifier	 group Docs
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
groupDocsByID	TokenNameIdentifier	 group Docs By ID
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
groupDocs	TokenNameIdentifier	 group Docs
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
IndexReader	TokenNameIdentifier	 Index Reader
r	TokenNameIdentifier	 r
=	TokenNameEQUAL	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
getReader	TokenNameIdentifier	 get Reader
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// NOTE: intentional but temporary field cache insanity! 	TokenNameCOMMENT_LINE	NOTE: intentional but temporary field cache insanity! 
final	TokenNamefinal	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
docIDToID	TokenNameIdentifier	 doc ID To ID
=	TokenNameEQUAL	
FieldCache	TokenNameIdentifier	 Field Cache
.	TokenNameDOT	
DEFAULT	TokenNameIdentifier	 DEFAULT
.	TokenNameDOT	
getInts	TokenNameIdentifier	 get Ints
(	TokenNameLPAREN	
r	TokenNameIdentifier	 r
,	TokenNameCOMMA	
"id"	TokenNameStringLiteral	id
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IndexReader	TokenNameIdentifier	 Index Reader
rBlocks	TokenNameIdentifier	 r Blocks
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
Directory	TokenNameIdentifier	 Directory
dirBlocks	TokenNameIdentifier	 dir Blocks
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
final	TokenNamefinal	
IndexSearcher	TokenNameIdentifier	 Index Searcher
s	TokenNameIdentifier	 s
=	TokenNameEQUAL	
newSearcher	TokenNameIdentifier	 new Searcher
(	TokenNameLPAREN	
r	TokenNameIdentifier	 r
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
ShardState	TokenNameIdentifier	 Shard State
shards	TokenNameIdentifier	 shards
=	TokenNameEQUAL	
new	TokenNamenew	
ShardState	TokenNameIdentifier	 Shard State
(	TokenNameLPAREN	
s	TokenNameIdentifier	 s
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
contentID	TokenNameIdentifier	 content ID
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
contentID	TokenNameIdentifier	 content ID
<	TokenNameLESS	
3	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
contentID	TokenNameIdentifier	 content ID
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
ScoreDoc	TokenNameIdentifier	 Score Doc
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
hits	TokenNameIdentifier	 hits
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"content"	TokenNameStringLiteral	content
,	TokenNameCOMMA	
"real"	TokenNameStringLiteral	real
+	TokenNamePLUS	
contentID	TokenNameIdentifier	 content ID
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
numDocs	TokenNameIdentifier	 num Docs
)	TokenNameRPAREN	
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
ScoreDoc	TokenNameIdentifier	 Score Doc
hit	TokenNameIdentifier	 hit
:	TokenNameCOLON	
hits	TokenNameIdentifier	 hits
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
GroupDoc	TokenNameIdentifier	 Group Doc
gd	TokenNameIdentifier	 gd
=	TokenNameEQUAL	
groupDocs	TokenNameIdentifier	 group Docs
[	TokenNameLBRACKET	
docIDToID	TokenNameIdentifier	 doc ID To ID
[	TokenNameLBRACKET	
hit	TokenNameIdentifier	 hit
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
]	TokenNameRBRACKET	
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
score	TokenNameIdentifier	 score
==	TokenNameEQUAL_EQUAL	
0.0	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
score	TokenNameIdentifier	 score
=	TokenNameEQUAL	
hit	TokenNameIdentifier	 hit
.	TokenNameDOT	
score	TokenNameIdentifier	 score
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
id	TokenNameIdentifier	 id
,	TokenNameCOMMA	
docIDToID	TokenNameIdentifier	 doc ID To ID
[	TokenNameLBRACKET	
hit	TokenNameIdentifier	 hit
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//System.out.println(" score=" + hit.score + " id=" + docIDToID[hit.doc]); 	TokenNameCOMMENT_LINE	System.out.println(" score=" + hit.score + " id=" + docIDToID[hit.doc]); 
}	TokenNameRBRACE	
}	TokenNameRBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
GroupDoc	TokenNameIdentifier	 Group Doc
gd	TokenNameIdentifier	 gd
:	TokenNameCOLON	
groupDocs	TokenNameIdentifier	 group Docs
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
score	TokenNameIdentifier	 score
!=	TokenNameNOT_EQUAL	
0.0	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Build 2nd index, where docs are added in blocks by 	TokenNameCOMMENT_LINE	Build 2nd index, where docs are added in blocks by 
// group, so we can use single pass collector 	TokenNameCOMMENT_LINE	group, so we can use single pass collector 
dirBlocks	TokenNameIdentifier	 dir Blocks
=	TokenNameEQUAL	
newDirectory	TokenNameIdentifier	 new Directory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
rBlocks	TokenNameIdentifier	 r Blocks
=	TokenNameEQUAL	
getDocBlockReader	TokenNameIdentifier	 get Doc Block Reader
(	TokenNameLPAREN	
dirBlocks	TokenNameIdentifier	 dir Blocks
,	TokenNameCOMMA	
groupDocs	TokenNameIdentifier	 group Docs
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Filter	TokenNameIdentifier	 Filter
lastDocInBlock	TokenNameIdentifier	 last Doc In Block
=	TokenNameEQUAL	
new	TokenNamenew	
CachingWrapperFilter	TokenNameIdentifier	 Caching Wrapper Filter
(	TokenNameLPAREN	
new	TokenNamenew	
QueryWrapperFilter	TokenNameIdentifier	 Query Wrapper Filter
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"groupend"	TokenNameStringLiteral	groupend
,	TokenNameCOMMA	
"x"	TokenNameStringLiteral	x
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
docIDToIDBlocks	TokenNameIdentifier	 doc ID To ID Blocks
=	TokenNameEQUAL	
FieldCache	TokenNameIdentifier	 Field Cache
.	TokenNameDOT	
DEFAULT	TokenNameIdentifier	 DEFAULT
.	TokenNameDOT	
getInts	TokenNameIdentifier	 get Ints
(	TokenNameLPAREN	
rBlocks	TokenNameIdentifier	 r Blocks
,	TokenNameCOMMA	
"id"	TokenNameStringLiteral	id
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
IndexSearcher	TokenNameIdentifier	 Index Searcher
sBlocks	TokenNameIdentifier	 s Blocks
=	TokenNameEQUAL	
newSearcher	TokenNameIdentifier	 new Searcher
(	TokenNameLPAREN	
rBlocks	TokenNameIdentifier	 r Blocks
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
ShardState	TokenNameIdentifier	 Shard State
shardsBlocks	TokenNameIdentifier	 shards Blocks
=	TokenNameEQUAL	
new	TokenNamenew	
ShardState	TokenNameIdentifier	 Shard State
(	TokenNameLPAREN	
sBlocks	TokenNameIdentifier	 s Blocks
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// ReaderBlocks only increases maxDoc() vs reader, which 	TokenNameCOMMENT_LINE	ReaderBlocks only increases maxDoc() vs reader, which 
// means a monotonic shift in scores, so we can 	TokenNameCOMMENT_LINE	means a monotonic shift in scores, so we can 
// reliably remap them w/ Map: 	TokenNameCOMMENT_LINE	reliably remap them w/ Map: 
final	TokenNamefinal	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
Float	TokenNameIdentifier	 Float
,	TokenNameCOMMA	
Float	TokenNameIdentifier	 Float
>>	TokenNameRIGHT_SHIFT	
scoreMap	TokenNameIdentifier	 score Map
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
Float	TokenNameIdentifier	 Float
,	TokenNameCOMMA	
Float	TokenNameIdentifier	 Float
>>	TokenNameRIGHT_SHIFT	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Tricky: must separately set .score2, because the doc 	TokenNameCOMMENT_LINE	Tricky: must separately set .score2, because the doc 
// block index was created with possible deletions! 	TokenNameCOMMENT_LINE	block index was created with possible deletions! 
//System.out.println("fixup score2"); 	TokenNameCOMMENT_LINE	System.out.println("fixup score2"); 
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
contentID	TokenNameIdentifier	 content ID
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
contentID	TokenNameIdentifier	 content ID
<	TokenNameLESS	
3	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
contentID	TokenNameIdentifier	 content ID
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
//System.out.println(" term=real" + contentID); 	TokenNameCOMMENT_LINE	System.out.println(" term=real" + contentID); 
final	TokenNamefinal	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
Float	TokenNameIdentifier	 Float
,	TokenNameCOMMA	
Float	TokenNameIdentifier	 Float
>	TokenNameGREATER	
termScoreMap	TokenNameIdentifier	 term Score Map
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
Float	TokenNameIdentifier	 Float
,	TokenNameCOMMA	
Float	TokenNameIdentifier	 Float
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
scoreMap	TokenNameIdentifier	 score Map
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
"real"	TokenNameStringLiteral	real
+	TokenNamePLUS	
contentID	TokenNameIdentifier	 content ID
,	TokenNameCOMMA	
termScoreMap	TokenNameIdentifier	 term Score Map
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//System.out.println("term=real" + contentID + " dfold=" + s.docFreq(new Term("content", "real"+contentID)) + 	TokenNameCOMMENT_LINE	System.out.println("term=real" + contentID + " dfold=" + s.docFreq(new Term("content", "real"+contentID)) + 
//" dfnew=" + sBlocks.docFreq(new Term("content", "real"+contentID))); 	TokenNameCOMMENT_LINE	" dfnew=" + sBlocks.docFreq(new Term("content", "real"+contentID))); 
final	TokenNamefinal	
ScoreDoc	TokenNameIdentifier	 Score Doc
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
hits	TokenNameIdentifier	 hits
=	TokenNameEQUAL	
sBlocks	TokenNameIdentifier	 s Blocks
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"content"	TokenNameStringLiteral	content
,	TokenNameCOMMA	
"real"	TokenNameStringLiteral	real
+	TokenNamePLUS	
contentID	TokenNameIdentifier	 content ID
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
numDocs	TokenNameIdentifier	 num Docs
)	TokenNameRPAREN	
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
ScoreDoc	TokenNameIdentifier	 Score Doc
hit	TokenNameIdentifier	 hit
:	TokenNameCOLON	
hits	TokenNameIdentifier	 hits
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
GroupDoc	TokenNameIdentifier	 Group Doc
gd	TokenNameIdentifier	 gd
=	TokenNameEQUAL	
groupDocsByID	TokenNameIdentifier	 group Docs By ID
[	TokenNameLBRACKET	
docIDToIDBlocks	TokenNameIdentifier	 doc ID To ID Blocks
[	TokenNameLBRACKET	
hit	TokenNameIdentifier	 hit
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
]	TokenNameRBRACKET	
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
score2	TokenNameIdentifier	 score2
==	TokenNameEQUAL_EQUAL	
0.0	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
score2	TokenNameIdentifier	 score2
=	TokenNameEQUAL	
hit	TokenNameIdentifier	 hit
.	TokenNameDOT	
score	TokenNameIdentifier	 score
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
id	TokenNameIdentifier	 id
,	TokenNameCOMMA	
docIDToIDBlocks	TokenNameIdentifier	 doc ID To ID Blocks
[	TokenNameLBRACKET	
hit	TokenNameIdentifier	 hit
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//System.out.println(" score=" + gd.score + " score2=" + hit.score + " id=" + docIDToIDBlocks[hit.doc]); 	TokenNameCOMMENT_LINE	System.out.println(" score=" + gd.score + " score2=" + hit.score + " id=" + docIDToIDBlocks[hit.doc]); 
termScoreMap	TokenNameIdentifier	 term Score Map
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
score	TokenNameIdentifier	 score
,	TokenNameCOMMA	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
score2	TokenNameIdentifier	 score2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
searchIter	TokenNameIdentifier	 search Iter
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
searchIter	TokenNameIdentifier	 search Iter
<	TokenNameLESS	
100	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
searchIter	TokenNameIdentifier	 search Iter
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" TEST: searchIter="	TokenNameStringLiteral	 TEST: searchIter=
+	TokenNamePLUS	
searchIter	TokenNameIdentifier	 search Iter
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
searchTerm	TokenNameIdentifier	 search Term
=	TokenNameEQUAL	
"real"	TokenNameStringLiteral	real
+	TokenNamePLUS	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
3	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
boolean	TokenNameboolean	
fillFields	TokenNameIdentifier	 fill Fields
=	TokenNameEQUAL	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
boolean	TokenNameboolean	
getScores	TokenNameIdentifier	 get Scores
=	TokenNameEQUAL	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
boolean	TokenNameboolean	
getMaxScores	TokenNameIdentifier	 get Max Scores
=	TokenNameEQUAL	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Sort	TokenNameIdentifier	 Sort
groupSort	TokenNameIdentifier	 group Sort
=	TokenNameEQUAL	
getRandomSort	TokenNameIdentifier	 get Random Sort
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//final Sort groupSort = new Sort(new SortField[] {new SortField("sort1", SortField.STRING), new SortField("id", SortField.INT)}); 	TokenNameCOMMENT_LINE	final Sort groupSort = new Sort(new SortField[] {new SortField("sort1", SortField.STRING), new SortField("id", SortField.INT)}); 
// TODO: also test null (= sort by relevance) 	TokenNameCOMMENT_LINE	TODO: also test null (= sort by relevance) 
final	TokenNamefinal	
Sort	TokenNameIdentifier	 Sort
docSort	TokenNameIdentifier	 doc Sort
=	TokenNameEQUAL	
getRandomSort	TokenNameIdentifier	 get Random Sort
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
SortField	TokenNameIdentifier	 Sort Field
sf	TokenNameIdentifier	 sf
:	TokenNameCOLON	
docSort	TokenNameIdentifier	 doc Sort
.	TokenNameDOT	
getSort	TokenNameIdentifier	 get Sort
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
sf	TokenNameIdentifier	 sf
.	TokenNameDOT	
getType	TokenNameIdentifier	 get Type
(	TokenNameLPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
SortField	TokenNameIdentifier	 Sort Field
.	TokenNameDOT	
SCORE	TokenNameIdentifier	 SCORE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
getScores	TokenNameIdentifier	 get Scores
=	TokenNameEQUAL	
true	TokenNametrue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
SortField	TokenNameIdentifier	 Sort Field
sf	TokenNameIdentifier	 sf
:	TokenNameCOLON	
groupSort	TokenNameIdentifier	 group Sort
.	TokenNameDOT	
getSort	TokenNameIdentifier	 get Sort
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
sf	TokenNameIdentifier	 sf
.	TokenNameDOT	
getType	TokenNameIdentifier	 get Type
(	TokenNameLPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
SortField	TokenNameIdentifier	 Sort Field
.	TokenNameDOT	
SCORE	TokenNameIdentifier	 SCORE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
getScores	TokenNameIdentifier	 get Scores
=	TokenNameEQUAL	
true	TokenNametrue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
final	TokenNamefinal	
int	TokenNameint	
topNGroups	TokenNameIdentifier	 top N Groups
=	TokenNameEQUAL	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
30	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//final int topNGroups = 10; 	TokenNameCOMMENT_LINE	final int topNGroups = 10; 
final	TokenNamefinal	
int	TokenNameint	
docsPerGroup	TokenNameIdentifier	 docs Per Group
=	TokenNameEQUAL	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
50	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
int	TokenNameint	
groupOffset	TokenNameIdentifier	 group Offset
=	TokenNameEQUAL	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
(	TokenNameLPAREN	
topNGroups	TokenNameIdentifier	 top N Groups
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
/	TokenNameDIVIDE	
2	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//final int groupOffset = 0; 	TokenNameCOMMENT_LINE	final int groupOffset = 0; 
final	TokenNamefinal	
int	TokenNameint	
docOffset	TokenNameIdentifier	 doc Offset
=	TokenNameEQUAL	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
docsPerGroup	TokenNameIdentifier	 docs Per Group
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//final int docOffset = 0; 	TokenNameCOMMENT_LINE	final int docOffset = 0; 
final	TokenNamefinal	
boolean	TokenNameboolean	
doCache	TokenNameIdentifier	 do Cache
=	TokenNameEQUAL	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
boolean	TokenNameboolean	
doAllGroups	TokenNameIdentifier	 do All Groups
=	TokenNameEQUAL	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: groupSort="	TokenNameStringLiteral	TEST: groupSort=
+	TokenNamePLUS	
groupSort	TokenNameIdentifier	 group Sort
+	TokenNamePLUS	
" docSort="	TokenNameStringLiteral	 docSort=
+	TokenNamePLUS	
docSort	TokenNameIdentifier	 doc Sort
+	TokenNamePLUS	
" searchTerm="	TokenNameStringLiteral	 searchTerm=
+	TokenNamePLUS	
searchTerm	TokenNameIdentifier	 search Term
+	TokenNamePLUS	
" dF="	TokenNameStringLiteral	 dF=
+	TokenNamePLUS	
r	TokenNameIdentifier	 r
.	TokenNameDOT	
docFreq	TokenNameIdentifier	 doc Freq
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"content"	TokenNameStringLiteral	content
,	TokenNameCOMMA	
searchTerm	TokenNameIdentifier	 search Term
)	TokenNameRPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
" dFBlock="	TokenNameStringLiteral	 dFBlock=
+	TokenNamePLUS	
rBlocks	TokenNameIdentifier	 r Blocks
.	TokenNameDOT	
docFreq	TokenNameIdentifier	 doc Freq
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"content"	TokenNameStringLiteral	content
,	TokenNameCOMMA	
searchTerm	TokenNameIdentifier	 search Term
)	TokenNameRPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
" topNGroups="	TokenNameStringLiteral	 topNGroups=
+	TokenNamePLUS	
topNGroups	TokenNameIdentifier	 top N Groups
+	TokenNamePLUS	
" groupOffset="	TokenNameStringLiteral	 groupOffset=
+	TokenNamePLUS	
groupOffset	TokenNameIdentifier	 group Offset
+	TokenNamePLUS	
" docOffset="	TokenNameStringLiteral	 docOffset=
+	TokenNamePLUS	
docOffset	TokenNameIdentifier	 doc Offset
+	TokenNamePLUS	
" doCache="	TokenNameStringLiteral	 doCache=
+	TokenNamePLUS	
doCache	TokenNameIdentifier	 do Cache
+	TokenNamePLUS	
" docsPerGroup="	TokenNameStringLiteral	 docsPerGroup=
+	TokenNamePLUS	
docsPerGroup	TokenNameIdentifier	 docs Per Group
+	TokenNamePLUS	
" doAllGroups="	TokenNameStringLiteral	 doAllGroups=
+	TokenNamePLUS	
doAllGroups	TokenNameIdentifier	 do All Groups
+	TokenNamePLUS	
" getScores="	TokenNameStringLiteral	 getScores=
+	TokenNamePLUS	
getScores	TokenNameIdentifier	 get Scores
+	TokenNamePLUS	
" getMaxScores="	TokenNameStringLiteral	 getMaxScores=
+	TokenNamePLUS	
getMaxScores	TokenNameIdentifier	 get Max Scores
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
final	TokenNamefinal	
TermAllGroupsCollector	TokenNameIdentifier	 Term All Groups Collector
allGroupsCollector	TokenNameIdentifier	 all Groups Collector
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
doAllGroups	TokenNameIdentifier	 do All Groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
allGroupsCollector	TokenNameIdentifier	 all Groups Collector
=	TokenNameEQUAL	
new	TokenNamenew	
TermAllGroupsCollector	TokenNameIdentifier	 Term All Groups Collector
(	TokenNameLPAREN	
"group"	TokenNameStringLiteral	group
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
allGroupsCollector	TokenNameIdentifier	 all Groups Collector
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
final	TokenNamefinal	
TermFirstPassGroupingCollector	TokenNameIdentifier	 Term First Pass Grouping Collector
c1	TokenNameIdentifier	 c1
=	TokenNameEQUAL	
new	TokenNamenew	
TermFirstPassGroupingCollector	TokenNameIdentifier	 Term First Pass Grouping Collector
(	TokenNameLPAREN	
"group"	TokenNameStringLiteral	group
,	TokenNameCOMMA	
groupSort	TokenNameIdentifier	 group Sort
,	TokenNameCOMMA	
groupOffset	TokenNameIdentifier	 group Offset
+	TokenNamePLUS	
topNGroups	TokenNameIdentifier	 top N Groups
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
CachingCollector	TokenNameIdentifier	 Caching Collector
cCache	TokenNameIdentifier	 c Cache
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Collector	TokenNameIdentifier	 Collector
c	TokenNameIdentifier	 c
;	TokenNameSEMICOLON	
final	TokenNamefinal	
boolean	TokenNameboolean	
useWrappingCollector	TokenNameIdentifier	 use Wrapping Collector
=	TokenNameEQUAL	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
doCache	TokenNameIdentifier	 do Cache
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
double	TokenNamedouble	
maxCacheMB	TokenNameIdentifier	 max Cache MB
=	TokenNameEQUAL	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextDouble	TokenNameIdentifier	 next Double
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: maxCacheMB="	TokenNameStringLiteral	TEST: maxCacheMB=
+	TokenNamePLUS	
maxCacheMB	TokenNameIdentifier	 max Cache MB
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
useWrappingCollector	TokenNameIdentifier	 use Wrapping Collector
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
doAllGroups	TokenNameIdentifier	 do All Groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
cCache	TokenNameIdentifier	 c Cache
=	TokenNameEQUAL	
CachingCollector	TokenNameIdentifier	 Caching Collector
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
c1	TokenNameIdentifier	 c1
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
maxCacheMB	TokenNameIdentifier	 max Cache MB
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
c	TokenNameIdentifier	 c
=	TokenNameEQUAL	
MultiCollector	TokenNameIdentifier	 Multi Collector
.	TokenNameDOT	
wrap	TokenNameIdentifier	 wrap
(	TokenNameLPAREN	
cCache	TokenNameIdentifier	 c Cache
,	TokenNameCOMMA	
allGroupsCollector	TokenNameIdentifier	 all Groups Collector
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
c	TokenNameIdentifier	 c
=	TokenNameEQUAL	
cCache	TokenNameIdentifier	 c Cache
=	TokenNameEQUAL	
CachingCollector	TokenNameIdentifier	 Caching Collector
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
c1	TokenNameIdentifier	 c1
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
maxCacheMB	TokenNameIdentifier	 max Cache MB
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
// Collect only into cache, then replay multiple times: 	TokenNameCOMMENT_LINE	Collect only into cache, then replay multiple times: 
c	TokenNameIdentifier	 c
=	TokenNameEQUAL	
cCache	TokenNameIdentifier	 c Cache
=	TokenNameEQUAL	
CachingCollector	TokenNameIdentifier	 Caching Collector
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
false	TokenNamefalse	
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
maxCacheMB	TokenNameIdentifier	 max Cache MB
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
cCache	TokenNameIdentifier	 c Cache
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
doAllGroups	TokenNameIdentifier	 do All Groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
c	TokenNameIdentifier	 c
=	TokenNameEQUAL	
MultiCollector	TokenNameIdentifier	 Multi Collector
.	TokenNameDOT	
wrap	TokenNameIdentifier	 wrap
(	TokenNameLPAREN	
c1	TokenNameIdentifier	 c1
,	TokenNameCOMMA	
allGroupsCollector	TokenNameIdentifier	 all Groups Collector
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
c	TokenNameIdentifier	 c
=	TokenNameEQUAL	
c1	TokenNameIdentifier	 c1
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
// Search top reader: 	TokenNameCOMMENT_LINE	Search top reader: 
final	TokenNamefinal	
Query	TokenNameIdentifier	 Query
query	TokenNameIdentifier	 query
=	TokenNameEQUAL	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"content"	TokenNameStringLiteral	content
,	TokenNameCOMMA	
searchTerm	TokenNameIdentifier	 search Term
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
query	TokenNameIdentifier	 query
,	TokenNameCOMMA	
c	TokenNameIdentifier	 c
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
doCache	TokenNameIdentifier	 do Cache
&&	TokenNameAND_AND	
!	TokenNameNOT	
useWrappingCollector	TokenNameIdentifier	 use Wrapping Collector
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
cCache	TokenNameIdentifier	 c Cache
.	TokenNameDOT	
isCached	TokenNameIdentifier	 is Cached
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// Replay for first-pass grouping 	TokenNameCOMMENT_LINE	Replay for first-pass grouping 
cCache	TokenNameIdentifier	 c Cache
.	TokenNameDOT	
replay	TokenNameIdentifier	 replay
(	TokenNameLPAREN	
c1	TokenNameIdentifier	 c1
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
doAllGroups	TokenNameIdentifier	 do All Groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// Replay for all groups: 	TokenNameCOMMENT_LINE	Replay for all groups: 
cCache	TokenNameIdentifier	 c Cache
.	TokenNameDOT	
replay	TokenNameIdentifier	 replay
(	TokenNameLPAREN	
allGroupsCollector	TokenNameIdentifier	 all Groups Collector
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
// Replay by re-running search: 	TokenNameCOMMENT_LINE	Replay by re-running search: 
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
query	TokenNameIdentifier	 query
,	TokenNameCOMMA	
c1	TokenNameIdentifier	 c1
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
doAllGroups	TokenNameIdentifier	 do All Groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
query	TokenNameIdentifier	 query
,	TokenNameCOMMA	
allGroupsCollector	TokenNameIdentifier	 all Groups Collector
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
// Get 1st pass top groups 	TokenNameCOMMENT_LINE	Get 1st pass top groups 
final	TokenNamefinal	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SearchGroup	TokenNameIdentifier	 Search Group
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>>	TokenNameRIGHT_SHIFT	
topGroups	TokenNameIdentifier	 top Groups
=	TokenNameEQUAL	
c1	TokenNameIdentifier	 c1
.	TokenNameDOT	
getTopGroups	TokenNameIdentifier	 get Top Groups
(	TokenNameLPAREN	
groupOffset	TokenNameIdentifier	 group Offset
,	TokenNameCOMMA	
fillFields	TokenNameIdentifier	 fill Fields
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: first pass topGroups"	TokenNameStringLiteral	TEST: first pass topGroups
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
topGroups	TokenNameIdentifier	 top Groups
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" null"	TokenNameStringLiteral	 null
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
SearchGroup	TokenNameIdentifier	 Search Group
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
searchGroup	TokenNameIdentifier	 search Group
:	TokenNameCOLON	
topGroups	TokenNameIdentifier	 top Groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" "	TokenNameStringLiteral	 
+	TokenNamePLUS	
(	TokenNameLPAREN	
searchGroup	TokenNameIdentifier	 search Group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
?	TokenNameQUESTION	
"null"	TokenNameStringLiteral	null
:	TokenNameCOLON	
searchGroup	TokenNameIdentifier	 search Group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
+	TokenNamePLUS	
": "	TokenNameStringLiteral	: 
+	TokenNamePLUS	
Arrays	TokenNameIdentifier	 Arrays
.	TokenNameDOT	
deepToString	TokenNameIdentifier	 deep To String
(	TokenNameLPAREN	
searchGroup	TokenNameIdentifier	 search Group
.	TokenNameDOT	
sortValues	TokenNameIdentifier	 sort Values
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
// Get 1st pass top groups using shards 	TokenNameCOMMENT_LINE	Get 1st pass top groups using shards 
final	TokenNamefinal	
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
topGroupsShards	TokenNameIdentifier	 top Groups Shards
=	TokenNameEQUAL	
searchShards	TokenNameIdentifier	 search Shards
(	TokenNameLPAREN	
s	TokenNameIdentifier	 s
,	TokenNameCOMMA	
shards	TokenNameIdentifier	 shards
,	TokenNameCOMMA	
query	TokenNameIdentifier	 query
,	TokenNameCOMMA	
groupSort	TokenNameIdentifier	 group Sort
,	TokenNameCOMMA	
docSort	TokenNameIdentifier	 doc Sort
,	TokenNameCOMMA	
groupOffset	TokenNameIdentifier	 group Offset
,	TokenNameCOMMA	
topNGroups	TokenNameIdentifier	 top N Groups
,	TokenNameCOMMA	
docOffset	TokenNameIdentifier	 doc Offset
,	TokenNameCOMMA	
docsPerGroup	TokenNameIdentifier	 docs Per Group
,	TokenNameCOMMA	
getScores	TokenNameIdentifier	 get Scores
,	TokenNameCOMMA	
getMaxScores	TokenNameIdentifier	 get Max Scores
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
groupsResult	TokenNameIdentifier	 groups Result
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
topGroups	TokenNameIdentifier	 top Groups
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: topGroups"	TokenNameStringLiteral	TEST: topGroups
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
SearchGroup	TokenNameIdentifier	 Search Group
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
searchGroup	TokenNameIdentifier	 search Group
:	TokenNameCOLON	
topGroups	TokenNameIdentifier	 top Groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" "	TokenNameStringLiteral	 
+	TokenNamePLUS	
(	TokenNameLPAREN	
searchGroup	TokenNameIdentifier	 search Group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
?	TokenNameQUESTION	
"null"	TokenNameStringLiteral	null
:	TokenNameCOLON	
searchGroup	TokenNameIdentifier	 search Group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
+	TokenNamePLUS	
": "	TokenNameStringLiteral	: 
+	TokenNamePLUS	
Arrays	TokenNameIdentifier	 Arrays
.	TokenNameDOT	
deepToString	TokenNameIdentifier	 deep To String
(	TokenNameLPAREN	
searchGroup	TokenNameIdentifier	 search Group
.	TokenNameDOT	
sortValues	TokenNameIdentifier	 sort Values
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
// Get 2nd pass grouped result: 	TokenNameCOMMENT_LINE	Get 2nd pass grouped result: 
final	TokenNamefinal	
TermSecondPassGroupingCollector	TokenNameIdentifier	 Term Second Pass Grouping Collector
c2	TokenNameIdentifier	 c2
=	TokenNameEQUAL	
new	TokenNamenew	
TermSecondPassGroupingCollector	TokenNameIdentifier	 Term Second Pass Grouping Collector
(	TokenNameLPAREN	
"group"	TokenNameStringLiteral	group
,	TokenNameCOMMA	
topGroups	TokenNameIdentifier	 top Groups
,	TokenNameCOMMA	
groupSort	TokenNameIdentifier	 group Sort
,	TokenNameCOMMA	
docSort	TokenNameIdentifier	 doc Sort
,	TokenNameCOMMA	
docOffset	TokenNameIdentifier	 doc Offset
+	TokenNamePLUS	
docsPerGroup	TokenNameIdentifier	 docs Per Group
,	TokenNameCOMMA	
getScores	TokenNameIdentifier	 get Scores
,	TokenNameCOMMA	
getMaxScores	TokenNameIdentifier	 get Max Scores
,	TokenNameCOMMA	
fillFields	TokenNameIdentifier	 fill Fields
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
doCache	TokenNameIdentifier	 do Cache
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
cCache	TokenNameIdentifier	 c Cache
.	TokenNameDOT	
isCached	TokenNameIdentifier	 is Cached
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: cache is intact"	TokenNameStringLiteral	TEST: cache is intact
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
cCache	TokenNameIdentifier	 c Cache
.	TokenNameDOT	
replay	TokenNameIdentifier	 replay
(	TokenNameLPAREN	
c2	TokenNameIdentifier	 c2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: cache was too large"	TokenNameStringLiteral	TEST: cache was too large
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
query	TokenNameIdentifier	 query
,	TokenNameCOMMA	
c2	TokenNameIdentifier	 c2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
query	TokenNameIdentifier	 query
,	TokenNameCOMMA	
c2	TokenNameIdentifier	 c2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
doAllGroups	TokenNameIdentifier	 do All Groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
tempTopGroups	TokenNameIdentifier	 temp Top Groups
=	TokenNameEQUAL	
c2	TokenNameIdentifier	 c2
.	TokenNameDOT	
getTopGroups	TokenNameIdentifier	 get Top Groups
(	TokenNameLPAREN	
docOffset	TokenNameIdentifier	 doc Offset
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
groupsResult	TokenNameIdentifier	 groups Result
=	TokenNameEQUAL	
new	TokenNamenew	
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
(	TokenNameLPAREN	
tempTopGroups	TokenNameIdentifier	 temp Top Groups
,	TokenNameCOMMA	
allGroupsCollector	TokenNameIdentifier	 all Groups Collector
.	TokenNameDOT	
getGroupCount	TokenNameIdentifier	 get Group Count
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
groupsResult	TokenNameIdentifier	 groups Result
=	TokenNameEQUAL	
c2	TokenNameIdentifier	 c2
.	TokenNameDOT	
getTopGroups	TokenNameIdentifier	 get Top Groups
(	TokenNameLPAREN	
docOffset	TokenNameIdentifier	 doc Offset
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
groupsResult	TokenNameIdentifier	 groups Result
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: no results"	TokenNameStringLiteral	TEST: no results
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
final	TokenNamefinal	
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
expectedGroups	TokenNameIdentifier	 expected Groups
=	TokenNameEQUAL	
slowGrouping	TokenNameIdentifier	 slow Grouping
(	TokenNameLPAREN	
groupDocs	TokenNameIdentifier	 group Docs
,	TokenNameCOMMA	
searchTerm	TokenNameIdentifier	 search Term
,	TokenNameCOMMA	
fillFields	TokenNameIdentifier	 fill Fields
,	TokenNameCOMMA	
getScores	TokenNameIdentifier	 get Scores
,	TokenNameCOMMA	
getMaxScores	TokenNameIdentifier	 get Max Scores
,	TokenNameCOMMA	
doAllGroups	TokenNameIdentifier	 do All Groups
,	TokenNameCOMMA	
groupSort	TokenNameIdentifier	 group Sort
,	TokenNameCOMMA	
docSort	TokenNameIdentifier	 doc Sort
,	TokenNameCOMMA	
topNGroups	TokenNameIdentifier	 top N Groups
,	TokenNameCOMMA	
docsPerGroup	TokenNameIdentifier	 docs Per Group
,	TokenNameCOMMA	
groupOffset	TokenNameIdentifier	 group Offset
,	TokenNameCOMMA	
docOffset	TokenNameIdentifier	 doc Offset
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
expectedGroups	TokenNameIdentifier	 expected Groups
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: no expected groups"	TokenNameStringLiteral	TEST: no expected groups
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: expected groups totalGroupedHitCount="	TokenNameStringLiteral	TEST: expected groups totalGroupedHitCount=
+	TokenNamePLUS	
expectedGroups	TokenNameIdentifier	 expected Groups
.	TokenNameDOT	
totalGroupedHitCount	TokenNameIdentifier	 total Grouped Hit Count
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
GroupDocs	TokenNameIdentifier	 Group Docs
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
gd	TokenNameIdentifier	 gd
:	TokenNameCOLON	
expectedGroups	TokenNameIdentifier	 expected Groups
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" group="	TokenNameStringLiteral	 group=
+	TokenNamePLUS	
(	TokenNameLPAREN	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
?	TokenNameQUESTION	
"null"	TokenNameStringLiteral	null
:	TokenNameCOLON	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
+	TokenNamePLUS	
" totalHits="	TokenNameStringLiteral	 totalHits=
+	TokenNamePLUS	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
ScoreDoc	TokenNameIdentifier	 Score Doc
sd	TokenNameIdentifier	 sd
:	TokenNameCOLON	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" id="	TokenNameStringLiteral	 id=
+	TokenNamePLUS	
sd	TokenNameIdentifier	 sd
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
+	TokenNamePLUS	
" score="	TokenNameStringLiteral	 score=
+	TokenNamePLUS	
sd	TokenNameIdentifier	 sd
.	TokenNameDOT	
score	TokenNameIdentifier	 score
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
groupsResult	TokenNameIdentifier	 groups Result
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: no matched groups"	TokenNameStringLiteral	TEST: no matched groups
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: matched groups totalGroupedHitCount="	TokenNameStringLiteral	TEST: matched groups totalGroupedHitCount=
+	TokenNamePLUS	
groupsResult	TokenNameIdentifier	 groups Result
.	TokenNameDOT	
totalGroupedHitCount	TokenNameIdentifier	 total Grouped Hit Count
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
GroupDocs	TokenNameIdentifier	 Group Docs
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
gd	TokenNameIdentifier	 gd
:	TokenNameCOLON	
groupsResult	TokenNameIdentifier	 groups Result
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" group="	TokenNameStringLiteral	 group=
+	TokenNamePLUS	
(	TokenNameLPAREN	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
?	TokenNameQUESTION	
"null"	TokenNameStringLiteral	null
:	TokenNameCOLON	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
+	TokenNamePLUS	
" totalHits="	TokenNameStringLiteral	 totalHits=
+	TokenNamePLUS	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
ScoreDoc	TokenNameIdentifier	 Score Doc
sd	TokenNameIdentifier	 sd
:	TokenNameCOLON	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" id="	TokenNameStringLiteral	 id=
+	TokenNamePLUS	
docIDToID	TokenNameIdentifier	 doc ID To ID
[	TokenNameLBRACKET	
sd	TokenNameIdentifier	 sd
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
]	TokenNameRBRACKET	
+	TokenNamePLUS	
" score="	TokenNameStringLiteral	 score=
+	TokenNamePLUS	
sd	TokenNameIdentifier	 sd
.	TokenNameDOT	
score	TokenNameIdentifier	 score
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
searchIter	TokenNameIdentifier	 search Iter
==	TokenNameEQUAL_EQUAL	
14	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
docIDX	TokenNameIdentifier	 doc IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
docIDX	TokenNameIdentifier	 doc IDX
<	TokenNameLESS	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
maxDoc	TokenNameIdentifier	 max Doc
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docIDX	TokenNameIdentifier	 doc IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"ID="	TokenNameStringLiteral	ID=
+	TokenNamePLUS	
docIDToID	TokenNameIdentifier	 doc ID To ID
[	TokenNameLBRACKET	
docIDX	TokenNameIdentifier	 doc IDX
]	TokenNameRBRACKET	
+	TokenNamePLUS	
" explain="	TokenNameStringLiteral	 explain=
+	TokenNamePLUS	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
explain	TokenNameIdentifier	 explain
(	TokenNameLPAREN	
query	TokenNameIdentifier	 query
,	TokenNameCOMMA	
docIDX	TokenNameIdentifier	 doc IDX
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
docIDToID	TokenNameIdentifier	 doc ID To ID
,	TokenNameCOMMA	
expectedGroups	TokenNameIdentifier	 expected Groups
,	TokenNameCOMMA	
groupsResult	TokenNameIdentifier	 groups Result
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
getScores	TokenNameIdentifier	 get Scores
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Confirm merged shards match: 	TokenNameCOMMENT_LINE	Confirm merged shards match: 
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
docIDToID	TokenNameIdentifier	 doc ID To ID
,	TokenNameCOMMA	
expectedGroups	TokenNameIdentifier	 expected Groups
,	TokenNameCOMMA	
topGroupsShards	TokenNameIdentifier	 top Groups Shards
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
false	TokenNamefalse	
,	TokenNameCOMMA	
fillFields	TokenNameIdentifier	 fill Fields
,	TokenNameCOMMA	
getScores	TokenNameIdentifier	 get Scores
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
topGroupsShards	TokenNameIdentifier	 top Groups Shards
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
verifyShards	TokenNameIdentifier	 verify Shards
(	TokenNameLPAREN	
shards	TokenNameIdentifier	 shards
.	TokenNameDOT	
docStarts	TokenNameIdentifier	 doc Starts
,	TokenNameCOMMA	
topGroupsShards	TokenNameIdentifier	 top Groups Shards
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
final	TokenNamefinal	
boolean	TokenNameboolean	
needsScores	TokenNameIdentifier	 needs Scores
=	TokenNameEQUAL	
getScores	TokenNameIdentifier	 get Scores
||	TokenNameOR_OR	
getMaxScores	TokenNameIdentifier	 get Max Scores
||	TokenNameOR_OR	
docSort	TokenNameIdentifier	 doc Sort
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
BlockGroupingCollector	TokenNameIdentifier	 Block Grouping Collector
c3	TokenNameIdentifier	 c3
=	TokenNameEQUAL	
new	TokenNamenew	
BlockGroupingCollector	TokenNameIdentifier	 Block Grouping Collector
(	TokenNameLPAREN	
groupSort	TokenNameIdentifier	 group Sort
,	TokenNameCOMMA	
groupOffset	TokenNameIdentifier	 group Offset
+	TokenNamePLUS	
topNGroups	TokenNameIdentifier	 top N Groups
,	TokenNameCOMMA	
needsScores	TokenNameIdentifier	 needs Scores
,	TokenNameCOMMA	
lastDocInBlock	TokenNameIdentifier	 last Doc In Block
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
TermAllGroupsCollector	TokenNameIdentifier	 Term All Groups Collector
allGroupsCollector2	TokenNameIdentifier	 all Groups Collector2
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Collector	TokenNameIdentifier	 Collector
c4	TokenNameIdentifier	 c4
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
doAllGroups	TokenNameIdentifier	 do All Groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
allGroupsCollector2	TokenNameIdentifier	 all Groups Collector2
=	TokenNameEQUAL	
new	TokenNamenew	
TermAllGroupsCollector	TokenNameIdentifier	 Term All Groups Collector
(	TokenNameLPAREN	
"group"	TokenNameStringLiteral	group
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
c4	TokenNameIdentifier	 c4
=	TokenNameEQUAL	
MultiCollector	TokenNameIdentifier	 Multi Collector
.	TokenNameDOT	
wrap	TokenNameIdentifier	 wrap
(	TokenNameLPAREN	
c3	TokenNameIdentifier	 c3
,	TokenNameCOMMA	
allGroupsCollector2	TokenNameIdentifier	 all Groups Collector2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
allGroupsCollector2	TokenNameIdentifier	 all Groups Collector2
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
c4	TokenNameIdentifier	 c4
=	TokenNameEQUAL	
c3	TokenNameIdentifier	 c3
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Get block grouping result: 	TokenNameCOMMENT_LINE	Get block grouping result: 
sBlocks	TokenNameIdentifier	 s Blocks
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
query	TokenNameIdentifier	 query
,	TokenNameCOMMA	
c4	TokenNameIdentifier	 c4
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
@	TokenNameAT	
SuppressWarnings	TokenNameIdentifier	 Suppress Warnings
(	TokenNameLPAREN	
"unchecked"	TokenNameStringLiteral	unchecked
)	TokenNameRPAREN	
final	TokenNamefinal	
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
tempTopGroupsBlocks	TokenNameIdentifier	 temp Top Groups Blocks
=	TokenNameEQUAL	
c3	TokenNameIdentifier	 c3
.	TokenNameDOT	
getTopGroups	TokenNameIdentifier	 get Top Groups
(	TokenNameLPAREN	
docSort	TokenNameIdentifier	 doc Sort
,	TokenNameCOMMA	
groupOffset	TokenNameIdentifier	 group Offset
,	TokenNameCOMMA	
docOffset	TokenNameIdentifier	 doc Offset
,	TokenNameCOMMA	
docOffset	TokenNameIdentifier	 doc Offset
+	TokenNamePLUS	
docsPerGroup	TokenNameIdentifier	 docs Per Group
,	TokenNameCOMMA	
fillFields	TokenNameIdentifier	 fill Fields
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
groupsResultBlocks	TokenNameIdentifier	 groups Result Blocks
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
doAllGroups	TokenNameIdentifier	 do All Groups
&&	TokenNameAND_AND	
tempTopGroupsBlocks	TokenNameIdentifier	 temp Top Groups Blocks
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
(	TokenNameLPAREN	
int	TokenNameint	
)	TokenNameRPAREN	
tempTopGroupsBlocks	TokenNameIdentifier	 temp Top Groups Blocks
.	TokenNameDOT	
totalGroupCount	TokenNameIdentifier	 total Group Count
,	TokenNameCOMMA	
allGroupsCollector2	TokenNameIdentifier	 all Groups Collector2
.	TokenNameDOT	
getGroupCount	TokenNameIdentifier	 get Group Count
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
groupsResultBlocks	TokenNameIdentifier	 groups Result Blocks
=	TokenNameEQUAL	
new	TokenNamenew	
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
(	TokenNameLPAREN	
tempTopGroupsBlocks	TokenNameIdentifier	 temp Top Groups Blocks
,	TokenNameCOMMA	
allGroupsCollector2	TokenNameIdentifier	 all Groups Collector2
.	TokenNameDOT	
getGroupCount	TokenNameIdentifier	 get Group Count
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
groupsResultBlocks	TokenNameIdentifier	 groups Result Blocks
=	TokenNameEQUAL	
tempTopGroupsBlocks	TokenNameIdentifier	 temp Top Groups Blocks
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Get shard'd block grouping result: 	TokenNameCOMMENT_LINE	Get shard'd block grouping result: 
final	TokenNamefinal	
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
topGroupsBlockShards	TokenNameIdentifier	 top Groups Block Shards
=	TokenNameEQUAL	
searchShards	TokenNameIdentifier	 search Shards
(	TokenNameLPAREN	
sBlocks	TokenNameIdentifier	 s Blocks
,	TokenNameCOMMA	
shardsBlocks	TokenNameIdentifier	 shards Blocks
,	TokenNameCOMMA	
query	TokenNameIdentifier	 query
,	TokenNameCOMMA	
groupSort	TokenNameIdentifier	 group Sort
,	TokenNameCOMMA	
docSort	TokenNameIdentifier	 doc Sort
,	TokenNameCOMMA	
groupOffset	TokenNameIdentifier	 group Offset
,	TokenNameCOMMA	
topNGroups	TokenNameIdentifier	 top N Groups
,	TokenNameCOMMA	
docOffset	TokenNameIdentifier	 doc Offset
,	TokenNameCOMMA	
docsPerGroup	TokenNameIdentifier	 docs Per Group
,	TokenNameCOMMA	
getScores	TokenNameIdentifier	 get Scores
,	TokenNameCOMMA	
getMaxScores	TokenNameIdentifier	 get Max Scores
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
groupsResultBlocks	TokenNameIdentifier	 groups Result Blocks
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: no block groups"	TokenNameStringLiteral	TEST: no block groups
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: block groups totalGroupedHitCount="	TokenNameStringLiteral	TEST: block groups totalGroupedHitCount=
+	TokenNamePLUS	
groupsResultBlocks	TokenNameIdentifier	 groups Result Blocks
.	TokenNameDOT	
totalGroupedHitCount	TokenNameIdentifier	 total Grouped Hit Count
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
boolean	TokenNameboolean	
first	TokenNameIdentifier	 first
=	TokenNameEQUAL	
true	TokenNametrue	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
GroupDocs	TokenNameIdentifier	 Group Docs
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
gd	TokenNameIdentifier	 gd
:	TokenNameCOLON	
groupsResultBlocks	TokenNameIdentifier	 groups Result Blocks
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" group="	TokenNameStringLiteral	 group=
+	TokenNamePLUS	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
+	TokenNamePLUS	
" totalHits="	TokenNameStringLiteral	 totalHits=
+	TokenNamePLUS	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
ScoreDoc	TokenNameIdentifier	 Score Doc
sd	TokenNameIdentifier	 sd
:	TokenNameCOLON	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" id="	TokenNameStringLiteral	 id=
+	TokenNamePLUS	
docIDToIDBlocks	TokenNameIdentifier	 doc ID To ID Blocks
[	TokenNameLBRACKET	
sd	TokenNameIdentifier	 sd
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
]	TokenNameRBRACKET	
+	TokenNamePLUS	
" score="	TokenNameStringLiteral	 score=
+	TokenNamePLUS	
sd	TokenNameIdentifier	 sd
.	TokenNameDOT	
score	TokenNameIdentifier	 score
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
first	TokenNameIdentifier	 first
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"explain: "	TokenNameStringLiteral	explain: 
+	TokenNamePLUS	
sBlocks	TokenNameIdentifier	 s Blocks
.	TokenNameDOT	
explain	TokenNameIdentifier	 explain
(	TokenNameLPAREN	
query	TokenNameIdentifier	 query
,	TokenNameCOMMA	
sd	TokenNameIdentifier	 sd
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
first	TokenNameIdentifier	 first
=	TokenNameEQUAL	
false	TokenNamefalse	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
expectedGroups	TokenNameIdentifier	 expected Groups
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// Fixup scores for reader2 	TokenNameCOMMENT_LINE	Fixup scores for reader2 
for	TokenNamefor	
(	TokenNameLPAREN	
GroupDocs	TokenNameIdentifier	 Group Docs
groupDocsHits	TokenNameIdentifier	 group Docs Hits
:	TokenNameCOLON	
expectedGroups	TokenNameIdentifier	 expected Groups
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
ScoreDoc	TokenNameIdentifier	 Score Doc
hit	TokenNameIdentifier	 hit
:	TokenNameCOLON	
groupDocsHits	TokenNameIdentifier	 group Docs Hits
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
GroupDoc	TokenNameIdentifier	 Group Doc
gd	TokenNameIdentifier	 gd
=	TokenNameEQUAL	
groupDocsByID	TokenNameIdentifier	 group Docs By ID
[	TokenNameLBRACKET	
hit	TokenNameIdentifier	 hit
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
id	TokenNameIdentifier	 id
,	TokenNameCOMMA	
hit	TokenNameIdentifier	 hit
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//System.out.println("fixup score " + hit.score + " to " + gd.score2 + " vs " + gd.score); 	TokenNameCOMMENT_LINE	System.out.println("fixup score " + hit.score + " to " + gd.score2 + " vs " + gd.score); 
hit	TokenNameIdentifier	 hit
.	TokenNameDOT	
score	TokenNameIdentifier	 score
=	TokenNameEQUAL	
gd	TokenNameIdentifier	 gd
.	TokenNameDOT	
score2	TokenNameIdentifier	 score2
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
final	TokenNamefinal	
SortField	TokenNameIdentifier	 Sort Field
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
sortFields	TokenNameIdentifier	 sort Fields
=	TokenNameEQUAL	
groupSort	TokenNameIdentifier	 group Sort
.	TokenNameDOT	
getSort	TokenNameIdentifier	 get Sort
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
Float	TokenNameIdentifier	 Float
,	TokenNameCOMMA	
Float	TokenNameIdentifier	 Float
>	TokenNameGREATER	
termScoreMap	TokenNameIdentifier	 term Score Map
=	TokenNameEQUAL	
scoreMap	TokenNameIdentifier	 score Map
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
searchTerm	TokenNameIdentifier	 search Term
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
groupSortIDX	TokenNameIdentifier	 group Sort IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
groupSortIDX	TokenNameIdentifier	 group Sort IDX
<	TokenNameLESS	
sortFields	TokenNameIdentifier	 sort Fields
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
groupSortIDX	TokenNameIdentifier	 group Sort IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
sortFields	TokenNameIdentifier	 sort Fields
[	TokenNameLBRACKET	
groupSortIDX	TokenNameIdentifier	 group Sort IDX
]	TokenNameRBRACKET	
.	TokenNameDOT	
getType	TokenNameIdentifier	 get Type
(	TokenNameLPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
SortField	TokenNameIdentifier	 Sort Field
.	TokenNameDOT	
SCORE	TokenNameIdentifier	 SCORE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
GroupDocs	TokenNameIdentifier	 Group Docs
groupDocsHits	TokenNameIdentifier	 group Docs Hits
:	TokenNameCOLON	
expectedGroups	TokenNameIdentifier	 expected Groups
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
groupDocsHits	TokenNameIdentifier	 group Docs Hits
.	TokenNameDOT	
groupSortValues	TokenNameIdentifier	 group Sort Values
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
//System.out.println("remap " + groupDocsHits.groupSortValues[groupSortIDX] + " to " + termScoreMap.get(groupDocsHits.groupSortValues[groupSortIDX])); 	TokenNameCOMMENT_LINE	System.out.println("remap " + groupDocsHits.groupSortValues[groupSortIDX] + " to " + termScoreMap.get(groupDocsHits.groupSortValues[groupSortIDX])); 
groupDocsHits	TokenNameIdentifier	 group Docs Hits
.	TokenNameDOT	
groupSortValues	TokenNameIdentifier	 group Sort Values
[	TokenNameLBRACKET	
groupSortIDX	TokenNameIdentifier	 group Sort IDX
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
termScoreMap	TokenNameIdentifier	 term Score Map
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
groupDocsHits	TokenNameIdentifier	 group Docs Hits
.	TokenNameDOT	
groupSortValues	TokenNameIdentifier	 group Sort Values
[	TokenNameLBRACKET	
groupSortIDX	TokenNameIdentifier	 group Sort IDX
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertNotNull	TokenNameIdentifier	 assert Not Null
(	TokenNameLPAREN	
groupDocsHits	TokenNameIdentifier	 group Docs Hits
.	TokenNameDOT	
groupSortValues	TokenNameIdentifier	 group Sort Values
[	TokenNameLBRACKET	
groupSortIDX	TokenNameIdentifier	 group Sort IDX
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
final	TokenNamefinal	
SortField	TokenNameIdentifier	 Sort Field
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
docSortFields	TokenNameIdentifier	 doc Sort Fields
=	TokenNameEQUAL	
docSort	TokenNameIdentifier	 doc Sort
.	TokenNameDOT	
getSort	TokenNameIdentifier	 get Sort
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
docSortIDX	TokenNameIdentifier	 doc Sort IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
docSortIDX	TokenNameIdentifier	 doc Sort IDX
<	TokenNameLESS	
docSortFields	TokenNameIdentifier	 doc Sort Fields
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
docSortIDX	TokenNameIdentifier	 doc Sort IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
docSortFields	TokenNameIdentifier	 doc Sort Fields
[	TokenNameLBRACKET	
docSortIDX	TokenNameIdentifier	 doc Sort IDX
]	TokenNameRBRACKET	
.	TokenNameDOT	
getType	TokenNameIdentifier	 get Type
(	TokenNameLPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
SortField	TokenNameIdentifier	 Sort Field
.	TokenNameDOT	
SCORE	TokenNameIdentifier	 SCORE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
GroupDocs	TokenNameIdentifier	 Group Docs
groupDocsHits	TokenNameIdentifier	 group Docs Hits
:	TokenNameCOLON	
expectedGroups	TokenNameIdentifier	 expected Groups
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
ScoreDoc	TokenNameIdentifier	 Score Doc
_hit	TokenNameIdentifier	 hit
:	TokenNameCOLON	
groupDocsHits	TokenNameIdentifier	 group Docs Hits
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
)	TokenNameRPAREN	
{	TokenNameLBRACE	
FieldDoc	TokenNameIdentifier	 Field Doc
hit	TokenNameIdentifier	 hit
=	TokenNameEQUAL	
(	TokenNameLPAREN	
FieldDoc	TokenNameIdentifier	 Field Doc
)	TokenNameRPAREN	
_hit	TokenNameIdentifier	 hit
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
hit	TokenNameIdentifier	 hit
.	TokenNameDOT	
fields	TokenNameIdentifier	 fields
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
hit	TokenNameIdentifier	 hit
.	TokenNameDOT	
fields	TokenNameIdentifier	 fields
[	TokenNameLBRACKET	
docSortIDX	TokenNameIdentifier	 doc Sort IDX
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
termScoreMap	TokenNameIdentifier	 term Score Map
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
hit	TokenNameIdentifier	 hit
.	TokenNameDOT	
fields	TokenNameIdentifier	 fields
[	TokenNameLBRACKET	
docSortIDX	TokenNameIdentifier	 doc Sort IDX
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertNotNull	TokenNameIdentifier	 assert Not Null
(	TokenNameLPAREN	
hit	TokenNameIdentifier	 hit
.	TokenNameDOT	
fields	TokenNameIdentifier	 fields
[	TokenNameLBRACKET	
docSortIDX	TokenNameIdentifier	 doc Sort IDX
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
docIDToIDBlocks	TokenNameIdentifier	 doc ID To ID Blocks
,	TokenNameCOMMA	
expectedGroups	TokenNameIdentifier	 expected Groups
,	TokenNameCOMMA	
groupsResultBlocks	TokenNameIdentifier	 groups Result Blocks
,	TokenNameCOMMA	
false	TokenNamefalse	
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
getScores	TokenNameIdentifier	 get Scores
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
docIDToIDBlocks	TokenNameIdentifier	 doc ID To ID Blocks
,	TokenNameCOMMA	
expectedGroups	TokenNameIdentifier	 expected Groups
,	TokenNameCOMMA	
topGroupsBlockShards	TokenNameIdentifier	 top Groups Block Shards
,	TokenNameCOMMA	
false	TokenNamefalse	
,	TokenNameCOMMA	
false	TokenNamefalse	
,	TokenNameCOMMA	
fillFields	TokenNameIdentifier	 fill Fields
,	TokenNameCOMMA	
getScores	TokenNameIdentifier	 get Scores
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sBlocks	TokenNameIdentifier	 s Blocks
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
finally	TokenNamefinally	
{	TokenNameLBRACE	
FieldCache	TokenNameIdentifier	 Field Cache
.	TokenNameDOT	
DEFAULT	TokenNameIdentifier	 DEFAULT
.	TokenNameDOT	
purge	TokenNameIdentifier	 purge
(	TokenNameLPAREN	
r	TokenNameIdentifier	 r
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
rBlocks	TokenNameIdentifier	 r Blocks
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
FieldCache	TokenNameIdentifier	 Field Cache
.	TokenNameDOT	
DEFAULT	TokenNameIdentifier	 DEFAULT
.	TokenNameDOT	
purge	TokenNameIdentifier	 purge
(	TokenNameLPAREN	
rBlocks	TokenNameIdentifier	 r Blocks
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
r	TokenNameIdentifier	 r
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
dir	TokenNameIdentifier	 dir
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
rBlocks	TokenNameIdentifier	 r Blocks
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
dirBlocks	TokenNameIdentifier	 dir Blocks
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
verifyShards	TokenNameIdentifier	 verify Shards
(	TokenNameLPAREN	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
docStarts	TokenNameIdentifier	 doc Starts
,	TokenNameCOMMA	
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
topGroups	TokenNameIdentifier	 top Groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
GroupDocs	TokenNameIdentifier	 Group Docs
group	TokenNameIdentifier	 group
:	TokenNameCOLON	
topGroups	TokenNameIdentifier	 top Groups
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
hitIDX	TokenNameIdentifier	 hit IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
hitIDX	TokenNameIdentifier	 hit IDX
<	TokenNameLESS	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
hitIDX	TokenNameIdentifier	 hit IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
ScoreDoc	TokenNameIdentifier	 Score Doc
sd	TokenNameIdentifier	 sd
=	TokenNameEQUAL	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
hitIDX	TokenNameIdentifier	 hit IDX
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"doc="	TokenNameStringLiteral	doc=
+	TokenNamePLUS	
sd	TokenNameIdentifier	 sd
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
+	TokenNamePLUS	
" wrong shard"	TokenNameStringLiteral	 wrong shard
,	TokenNameCOMMA	
ReaderUtil	TokenNameIdentifier	 Reader Util
.	TokenNameDOT	
subIndex	TokenNameIdentifier	 sub Index
(	TokenNameLPAREN	
sd	TokenNameIdentifier	 sd
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
,	TokenNameCOMMA	
docStarts	TokenNameIdentifier	 doc Starts
)	TokenNameRPAREN	
,	TokenNameCOMMA	
sd	TokenNameIdentifier	 sd
.	TokenNameDOT	
shardIndex	TokenNameIdentifier	 shard Index
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SearchGroup	TokenNameIdentifier	 Search Group
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>>	TokenNameRIGHT_SHIFT	
groups1	TokenNameIdentifier	 groups1
,	TokenNameCOMMA	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SearchGroup	TokenNameIdentifier	 Search Group
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>>	TokenNameRIGHT_SHIFT	
groups2	TokenNameIdentifier	 groups2
,	TokenNameCOMMA	
boolean	TokenNameboolean	
doSortValues	TokenNameIdentifier	 do Sort Values
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
groups1	TokenNameIdentifier	 groups1
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
groups2	TokenNameIdentifier	 groups2
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Iterator	TokenNameIdentifier	 Iterator
<	TokenNameLESS	
SearchGroup	TokenNameIdentifier	 Search Group
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>>	TokenNameRIGHT_SHIFT	
iter1	TokenNameIdentifier	 iter1
=	TokenNameEQUAL	
groups1	TokenNameIdentifier	 groups1
.	TokenNameDOT	
iterator	TokenNameIdentifier	 iterator
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Iterator	TokenNameIdentifier	 Iterator
<	TokenNameLESS	
SearchGroup	TokenNameIdentifier	 Search Group
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>>	TokenNameRIGHT_SHIFT	
iter2	TokenNameIdentifier	 iter2
=	TokenNameEQUAL	
groups2	TokenNameIdentifier	 groups2
.	TokenNameDOT	
iterator	TokenNameIdentifier	 iterator
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
while	TokenNamewhile	
(	TokenNameLPAREN	
iter1	TokenNameIdentifier	 iter1
.	TokenNameDOT	
hasNext	TokenNameIdentifier	 has Next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
iter2	TokenNameIdentifier	 iter2
.	TokenNameDOT	
hasNext	TokenNameIdentifier	 has Next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
SearchGroup	TokenNameIdentifier	 Search Group
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
group1	TokenNameIdentifier	 group1
=	TokenNameEQUAL	
iter1	TokenNameIdentifier	 iter1
.	TokenNameDOT	
next	TokenNameIdentifier	 next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
SearchGroup	TokenNameIdentifier	 Search Group
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
group2	TokenNameIdentifier	 group2
=	TokenNameEQUAL	
iter2	TokenNameIdentifier	 iter2
.	TokenNameDOT	
next	TokenNameIdentifier	 next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
group1	TokenNameIdentifier	 group1
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
,	TokenNameCOMMA	
group2	TokenNameIdentifier	 group2
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
doSortValues	TokenNameIdentifier	 do Sort Values
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assertArrayEquals	TokenNameIdentifier	 assert Array Equals
(	TokenNameLPAREN	
group1	TokenNameIdentifier	 group1
.	TokenNameDOT	
sortValues	TokenNameIdentifier	 sort Values
,	TokenNameCOMMA	
group2	TokenNameIdentifier	 group2
.	TokenNameDOT	
sortValues	TokenNameIdentifier	 sort Values
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
assertFalse	TokenNameIdentifier	 assert False
(	TokenNameLPAREN	
iter2	TokenNameIdentifier	 iter2
.	TokenNameDOT	
hasNext	TokenNameIdentifier	 has Next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
searchShards	TokenNameIdentifier	 search Shards
(	TokenNameLPAREN	
IndexSearcher	TokenNameIdentifier	 Index Searcher
topSearcher	TokenNameIdentifier	 top Searcher
,	TokenNameCOMMA	
ShardState	TokenNameIdentifier	 Shard State
shardState	TokenNameIdentifier	 shard State
,	TokenNameCOMMA	
Query	TokenNameIdentifier	 Query
query	TokenNameIdentifier	 query
,	TokenNameCOMMA	
Sort	TokenNameIdentifier	 Sort
groupSort	TokenNameIdentifier	 group Sort
,	TokenNameCOMMA	
Sort	TokenNameIdentifier	 Sort
docSort	TokenNameIdentifier	 doc Sort
,	TokenNameCOMMA	
int	TokenNameint	
groupOffset	TokenNameIdentifier	 group Offset
,	TokenNameCOMMA	
int	TokenNameint	
topNGroups	TokenNameIdentifier	 top N Groups
,	TokenNameCOMMA	
int	TokenNameint	
docOffset	TokenNameIdentifier	 doc Offset
,	TokenNameCOMMA	
int	TokenNameint	
topNDocs	TokenNameIdentifier	 top N Docs
,	TokenNameCOMMA	
boolean	TokenNameboolean	
getScores	TokenNameIdentifier	 get Scores
,	TokenNameCOMMA	
boolean	TokenNameboolean	
getMaxScores	TokenNameIdentifier	 get Max Scores
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
// TODO: swap in caching, all groups collector here 	TokenNameCOMMENT_LINE	TODO: swap in caching, all groups collector here 
// too... 	TokenNameCOMMENT_LINE	too... 
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: "	TokenNameStringLiteral	TEST: 
+	TokenNamePLUS	
shardState	TokenNameIdentifier	 shard State
.	TokenNameDOT	
subSearchers	TokenNameIdentifier	 sub Searchers
.	TokenNameDOT	
length	TokenNameIdentifier	 length
+	TokenNamePLUS	
" shards: "	TokenNameStringLiteral	 shards: 
+	TokenNamePLUS	
Arrays	TokenNameIdentifier	 Arrays
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
shardState	TokenNameIdentifier	 shard State
.	TokenNameDOT	
subSearchers	TokenNameIdentifier	 sub Searchers
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Run 1st pass collector to get top groups per shard 	TokenNameCOMMENT_LINE	Run 1st pass collector to get top groups per shard 
final	TokenNamefinal	
Weight	TokenNameIdentifier	 Weight
w	TokenNameIdentifier	 w
=	TokenNameEQUAL	
topSearcher	TokenNameIdentifier	 top Searcher
.	TokenNameDOT	
createNormalizedWeight	TokenNameIdentifier	 create Normalized Weight
(	TokenNameLPAREN	
query	TokenNameIdentifier	 query
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SearchGroup	TokenNameIdentifier	 Search Group
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>>>	TokenNameUNSIGNED_RIGHT_SHIFT	
shardGroups	TokenNameIdentifier	 shard Groups
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SearchGroup	TokenNameIdentifier	 Search Group
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>>>	TokenNameUNSIGNED_RIGHT_SHIFT	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
shardIDX	TokenNameIdentifier	 shard IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
shardIDX	TokenNameIdentifier	 shard IDX
<	TokenNameLESS	
shardState	TokenNameIdentifier	 shard State
.	TokenNameDOT	
subSearchers	TokenNameIdentifier	 sub Searchers
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
shardIDX	TokenNameIdentifier	 shard IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
TermFirstPassGroupingCollector	TokenNameIdentifier	 Term First Pass Grouping Collector
c	TokenNameIdentifier	 c
=	TokenNameEQUAL	
new	TokenNamenew	
TermFirstPassGroupingCollector	TokenNameIdentifier	 Term First Pass Grouping Collector
(	TokenNameLPAREN	
"group"	TokenNameStringLiteral	group
,	TokenNameCOMMA	
groupSort	TokenNameIdentifier	 group Sort
,	TokenNameCOMMA	
groupOffset	TokenNameIdentifier	 group Offset
+	TokenNamePLUS	
topNGroups	TokenNameIdentifier	 top N Groups
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
shardState	TokenNameIdentifier	 shard State
.	TokenNameDOT	
subSearchers	TokenNameIdentifier	 sub Searchers
[	TokenNameLBRACKET	
shardIDX	TokenNameIdentifier	 shard IDX
]	TokenNameRBRACKET	
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
w	TokenNameIdentifier	 w
,	TokenNameCOMMA	
c	TokenNameIdentifier	 c
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SearchGroup	TokenNameIdentifier	 Search Group
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>>	TokenNameRIGHT_SHIFT	
topGroups	TokenNameIdentifier	 top Groups
=	TokenNameEQUAL	
c	TokenNameIdentifier	 c
.	TokenNameDOT	
getTopGroups	TokenNameIdentifier	 get Top Groups
(	TokenNameLPAREN	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
topGroups	TokenNameIdentifier	 top Groups
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" shard "	TokenNameStringLiteral	 shard 
+	TokenNamePLUS	
shardIDX	TokenNameIdentifier	 shard IDX
+	TokenNamePLUS	
" s="	TokenNameStringLiteral	 s=
+	TokenNamePLUS	
shardState	TokenNameIdentifier	 shard State
.	TokenNameDOT	
subSearchers	TokenNameIdentifier	 sub Searchers
[	TokenNameLBRACKET	
shardIDX	TokenNameIdentifier	 shard IDX
]	TokenNameRBRACKET	
+	TokenNamePLUS	
" "	TokenNameStringLiteral	 
+	TokenNamePLUS	
topGroups	TokenNameIdentifier	 top Groups
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
" groups:"	TokenNameStringLiteral	 groups:
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
SearchGroup	TokenNameIdentifier	 Search Group
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
group	TokenNameIdentifier	 group
:	TokenNameCOLON	
topGroups	TokenNameIdentifier	 top Groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" "	TokenNameStringLiteral	 
+	TokenNamePLUS	
groupToString	TokenNameIdentifier	 group To String
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
+	TokenNamePLUS	
" groupSort="	TokenNameStringLiteral	 groupSort=
+	TokenNamePLUS	
Arrays	TokenNameIdentifier	 Arrays
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
sortValues	TokenNameIdentifier	 sort Values
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
shardGroups	TokenNameIdentifier	 shard Groups
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
topGroups	TokenNameIdentifier	 top Groups
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
final	TokenNamefinal	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SearchGroup	TokenNameIdentifier	 Search Group
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>>	TokenNameRIGHT_SHIFT	
mergedTopGroups	TokenNameIdentifier	 merged Top Groups
=	TokenNameEQUAL	
SearchGroup	TokenNameIdentifier	 Search Group
.	TokenNameDOT	
merge	TokenNameIdentifier	 merge
(	TokenNameLPAREN	
shardGroups	TokenNameIdentifier	 shard Groups
,	TokenNameCOMMA	
groupOffset	TokenNameIdentifier	 group Offset
,	TokenNameCOMMA	
topNGroups	TokenNameIdentifier	 top N Groups
,	TokenNameCOMMA	
groupSort	TokenNameIdentifier	 group Sort
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" merged:"	TokenNameStringLiteral	 merged:
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
mergedTopGroups	TokenNameIdentifier	 merged Top Groups
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" null"	TokenNameStringLiteral	 null
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
SearchGroup	TokenNameIdentifier	 Search Group
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
group	TokenNameIdentifier	 group
:	TokenNameCOLON	
mergedTopGroups	TokenNameIdentifier	 merged Top Groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" "	TokenNameStringLiteral	 
+	TokenNamePLUS	
groupToString	TokenNameIdentifier	 group To String
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
+	TokenNamePLUS	
" groupSort="	TokenNameStringLiteral	 groupSort=
+	TokenNamePLUS	
Arrays	TokenNameIdentifier	 Arrays
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
sortValues	TokenNameIdentifier	 sort Values
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
mergedTopGroups	TokenNameIdentifier	 merged Top Groups
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// Now 2nd pass: 	TokenNameCOMMENT_LINE	Now 2nd pass: 
@	TokenNameAT	
SuppressWarnings	TokenNameIdentifier	 Suppress Warnings
(	TokenNameLPAREN	
"unchecked"	TokenNameStringLiteral	unchecked
)	TokenNameRPAREN	
final	TokenNamefinal	
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
shardTopGroups	TokenNameIdentifier	 shard Top Groups
=	TokenNameEQUAL	
new	TokenNamenew	
TopGroups	TokenNameIdentifier	 Top Groups
[	TokenNameLBRACKET	
shardState	TokenNameIdentifier	 shard State
.	TokenNameDOT	
subSearchers	TokenNameIdentifier	 sub Searchers
.	TokenNameDOT	
length	TokenNameIdentifier	 length
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
shardIDX	TokenNameIdentifier	 shard IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
shardIDX	TokenNameIdentifier	 shard IDX
<	TokenNameLESS	
shardState	TokenNameIdentifier	 shard State
.	TokenNameDOT	
subSearchers	TokenNameIdentifier	 sub Searchers
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
shardIDX	TokenNameIdentifier	 shard IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
TermSecondPassGroupingCollector	TokenNameIdentifier	 Term Second Pass Grouping Collector
c	TokenNameIdentifier	 c
=	TokenNameEQUAL	
new	TokenNamenew	
TermSecondPassGroupingCollector	TokenNameIdentifier	 Term Second Pass Grouping Collector
(	TokenNameLPAREN	
"group"	TokenNameStringLiteral	group
,	TokenNameCOMMA	
mergedTopGroups	TokenNameIdentifier	 merged Top Groups
,	TokenNameCOMMA	
groupSort	TokenNameIdentifier	 group Sort
,	TokenNameCOMMA	
docSort	TokenNameIdentifier	 doc Sort
,	TokenNameCOMMA	
docOffset	TokenNameIdentifier	 doc Offset
+	TokenNamePLUS	
topNDocs	TokenNameIdentifier	 top N Docs
,	TokenNameCOMMA	
getScores	TokenNameIdentifier	 get Scores
,	TokenNameCOMMA	
getMaxScores	TokenNameIdentifier	 get Max Scores
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
shardState	TokenNameIdentifier	 shard State
.	TokenNameDOT	
subSearchers	TokenNameIdentifier	 sub Searchers
[	TokenNameLBRACKET	
shardIDX	TokenNameIdentifier	 shard IDX
]	TokenNameRBRACKET	
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
w	TokenNameIdentifier	 w
,	TokenNameCOMMA	
c	TokenNameIdentifier	 c
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
shardTopGroups	TokenNameIdentifier	 shard Top Groups
[	TokenNameLBRACKET	
shardIDX	TokenNameIdentifier	 shard IDX
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
c	TokenNameIdentifier	 c
.	TokenNameDOT	
getTopGroups	TokenNameIdentifier	 get Top Groups
(	TokenNameLPAREN	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
rebaseDocIDs	TokenNameIdentifier	 rebase Doc I Ds
(	TokenNameLPAREN	
groupSort	TokenNameIdentifier	 group Sort
,	TokenNameCOMMA	
docSort	TokenNameIdentifier	 doc Sort
,	TokenNameCOMMA	
shardState	TokenNameIdentifier	 shard State
.	TokenNameDOT	
docStarts	TokenNameIdentifier	 doc Starts
[	TokenNameLBRACKET	
shardIDX	TokenNameIdentifier	 shard IDX
]	TokenNameRBRACKET	
,	TokenNameCOMMA	
shardTopGroups	TokenNameIdentifier	 shard Top Groups
[	TokenNameLBRACKET	
shardIDX	TokenNameIdentifier	 shard IDX
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
TopGroups	TokenNameIdentifier	 Top Groups
.	TokenNameDOT	
merge	TokenNameIdentifier	 merge
(	TokenNameLPAREN	
shardTopGroups	TokenNameIdentifier	 shard Top Groups
,	TokenNameCOMMA	
groupSort	TokenNameIdentifier	 group Sort
,	TokenNameCOMMA	
docSort	TokenNameIdentifier	 doc Sort
,	TokenNameCOMMA	
docOffset	TokenNameIdentifier	 doc Offset
,	TokenNameCOMMA	
topNDocs	TokenNameIdentifier	 top N Docs
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
return	TokenNamereturn	
null	TokenNamenull	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
>	TokenNameGREATER	
getDocIDSortLocs	TokenNameIdentifier	 get Doc ID Sort Locs
(	TokenNameLPAREN	
Sort	TokenNameIdentifier	 Sort
sort	TokenNameIdentifier	 sort
)	TokenNameRPAREN	
{	TokenNameLBRACE	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
>	TokenNameGREATER	
docFieldLocs	TokenNameIdentifier	 doc Field Locs
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
SortField	TokenNameIdentifier	 Sort Field
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
docFields	TokenNameIdentifier	 doc Fields
=	TokenNameEQUAL	
sort	TokenNameIdentifier	 sort
.	TokenNameDOT	
getSort	TokenNameIdentifier	 get Sort
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
fieldIDX	TokenNameIdentifier	 field IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
fieldIDX	TokenNameIdentifier	 field IDX
<	TokenNameLESS	
docFields	TokenNameIdentifier	 doc Fields
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
fieldIDX	TokenNameIdentifier	 field IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
docFields	TokenNameIdentifier	 doc Fields
[	TokenNameLBRACKET	
fieldIDX	TokenNameIdentifier	 field IDX
]	TokenNameRBRACKET	
.	TokenNameDOT	
getType	TokenNameIdentifier	 get Type
(	TokenNameLPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
SortField	TokenNameIdentifier	 Sort Field
.	TokenNameDOT	
DOC	TokenNameIdentifier	 DOC
)	TokenNameRPAREN	
{	TokenNameLBRACE	
docFieldLocs	TokenNameIdentifier	 doc Field Locs
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
fieldIDX	TokenNameIdentifier	 field IDX
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
return	TokenNamereturn	
docFieldLocs	TokenNameIdentifier	 doc Field Locs
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
rebaseDocIDs	TokenNameIdentifier	 rebase Doc I Ds
(	TokenNameLPAREN	
Sort	TokenNameIdentifier	 Sort
groupSort	TokenNameIdentifier	 group Sort
,	TokenNameCOMMA	
Sort	TokenNameIdentifier	 Sort
docSort	TokenNameIdentifier	 doc Sort
,	TokenNameCOMMA	
int	TokenNameint	
docBase	TokenNameIdentifier	 doc Base
,	TokenNameCOMMA	
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
groups	TokenNameIdentifier	 groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
>	TokenNameGREATER	
docFieldLocs	TokenNameIdentifier	 doc Field Locs
=	TokenNameEQUAL	
getDocIDSortLocs	TokenNameIdentifier	 get Doc ID Sort Locs
(	TokenNameLPAREN	
docSort	TokenNameIdentifier	 doc Sort
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
>	TokenNameGREATER	
docGroupFieldLocs	TokenNameIdentifier	 doc Group Field Locs
=	TokenNameEQUAL	
getDocIDSortLocs	TokenNameIdentifier	 get Doc ID Sort Locs
(	TokenNameLPAREN	
groupSort	TokenNameIdentifier	 group Sort
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
GroupDocs	TokenNameIdentifier	 Group Docs
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
group	TokenNameIdentifier	 group
:	TokenNameCOLON	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
groupSortValues	TokenNameIdentifier	 group Sort Values
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
idx	TokenNameIdentifier	 idx
:	TokenNameCOLON	
docGroupFieldLocs	TokenNameIdentifier	 doc Group Field Locs
)	TokenNameRPAREN	
{	TokenNameLBRACE	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
groupSortValues	TokenNameIdentifier	 group Sort Values
[	TokenNameLBRACKET	
idx	TokenNameIdentifier	 idx
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
Integer	TokenNameIdentifier	 Integer
.	TokenNameDOT	
valueOf	TokenNameIdentifier	 value Of
(	TokenNameLPAREN	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
Integer	TokenNameIdentifier	 Integer
)	TokenNameRPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
groupSortValues	TokenNameIdentifier	 group Sort Values
[	TokenNameLBRACKET	
idx	TokenNameIdentifier	 idx
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
.	TokenNameDOT	
intValue	TokenNameIdentifier	 int Value
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
docBase	TokenNameIdentifier	 doc Base
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
hitIDX	TokenNameIdentifier	 hit IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
hitIDX	TokenNameIdentifier	 hit IDX
<	TokenNameLESS	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
hitIDX	TokenNameIdentifier	 hit IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
ScoreDoc	TokenNameIdentifier	 Score Doc
sd	TokenNameIdentifier	 sd
=	TokenNameEQUAL	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
hitIDX	TokenNameIdentifier	 hit IDX
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
sd	TokenNameIdentifier	 sd
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
+=	TokenNamePLUS_EQUAL	
docBase	TokenNameIdentifier	 doc Base
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
sd	TokenNameIdentifier	 sd
instanceof	TokenNameinstanceof	
FieldDoc	TokenNameIdentifier	 Field Doc
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
FieldDoc	TokenNameIdentifier	 Field Doc
fd	TokenNameIdentifier	 fd
=	TokenNameEQUAL	
(	TokenNameLPAREN	
FieldDoc	TokenNameIdentifier	 Field Doc
)	TokenNameRPAREN	
sd	TokenNameIdentifier	 sd
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
fd	TokenNameIdentifier	 fd
.	TokenNameDOT	
fields	TokenNameIdentifier	 fields
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
idx	TokenNameIdentifier	 idx
:	TokenNameCOLON	
docFieldLocs	TokenNameIdentifier	 doc Field Locs
)	TokenNameRPAREN	
{	TokenNameLBRACE	
fd	TokenNameIdentifier	 fd
.	TokenNameDOT	
fields	TokenNameIdentifier	 fields
[	TokenNameLBRACKET	
idx	TokenNameIdentifier	 idx
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
Integer	TokenNameIdentifier	 Integer
.	TokenNameDOT	
valueOf	TokenNameIdentifier	 value Of
(	TokenNameLPAREN	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
Integer	TokenNameIdentifier	 Integer
)	TokenNameRPAREN	
fd	TokenNameIdentifier	 fd
.	TokenNameDOT	
fields	TokenNameIdentifier	 fields
[	TokenNameLBRACKET	
idx	TokenNameIdentifier	 idx
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
.	TokenNameDOT	
intValue	TokenNameIdentifier	 int Value
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
docBase	TokenNameIdentifier	 doc Base
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
docIDtoID	TokenNameIdentifier	 doc I Dto ID
,	TokenNameCOMMA	
TopGroups	TokenNameIdentifier	 Top Groups
expected	TokenNameIdentifier	 expected
,	TokenNameCOMMA	
TopGroups	TokenNameIdentifier	 Top Groups
actual	TokenNameIdentifier	 actual
,	TokenNameCOMMA	
boolean	TokenNameboolean	
verifyGroupValues	TokenNameIdentifier	 verify Group Values
,	TokenNameCOMMA	
boolean	TokenNameboolean	
verifyTotalGroupCount	TokenNameIdentifier	 verify Total Group Count
,	TokenNameCOMMA	
boolean	TokenNameboolean	
verifySortValues	TokenNameIdentifier	 verify Sort Values
,	TokenNameCOMMA	
boolean	TokenNameboolean	
testScores	TokenNameIdentifier	 test Scores
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
expected	TokenNameIdentifier	 expected
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assertNull	TokenNameIdentifier	 assert Null
(	TokenNameLPAREN	
actual	TokenNameIdentifier	 actual
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
assertNotNull	TokenNameIdentifier	 assert Not Null
(	TokenNameLPAREN	
actual	TokenNameIdentifier	 actual
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
expected	TokenNameIdentifier	 expected
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
length	TokenNameIdentifier	 length
,	TokenNameCOMMA	
actual	TokenNameIdentifier	 actual
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
expected	TokenNameIdentifier	 expected
.	TokenNameDOT	
totalHitCount	TokenNameIdentifier	 total Hit Count
,	TokenNameCOMMA	
actual	TokenNameIdentifier	 actual
.	TokenNameDOT	
totalHitCount	TokenNameIdentifier	 total Hit Count
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
expected	TokenNameIdentifier	 expected
.	TokenNameDOT	
totalGroupedHitCount	TokenNameIdentifier	 total Grouped Hit Count
,	TokenNameCOMMA	
actual	TokenNameIdentifier	 actual
.	TokenNameDOT	
totalGroupedHitCount	TokenNameIdentifier	 total Grouped Hit Count
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
expected	TokenNameIdentifier	 expected
.	TokenNameDOT	
totalGroupCount	TokenNameIdentifier	 total Group Count
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
&&	TokenNameAND_AND	
verifyTotalGroupCount	TokenNameIdentifier	 verify Total Group Count
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
expected	TokenNameIdentifier	 expected
.	TokenNameDOT	
totalGroupCount	TokenNameIdentifier	 total Group Count
,	TokenNameCOMMA	
actual	TokenNameIdentifier	 actual
.	TokenNameDOT	
totalGroupCount	TokenNameIdentifier	 total Group Count
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
groupIDX	TokenNameIdentifier	 group IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
groupIDX	TokenNameIdentifier	 group IDX
<	TokenNameLESS	
expected	TokenNameIdentifier	 expected
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
groupIDX	TokenNameIdentifier	 group IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" check groupIDX="	TokenNameStringLiteral	 check groupIDX=
+	TokenNamePLUS	
groupIDX	TokenNameIdentifier	 group IDX
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
final	TokenNamefinal	
GroupDocs	TokenNameIdentifier	 Group Docs
expectedGroup	TokenNameIdentifier	 expected Group
=	TokenNameEQUAL	
expected	TokenNameIdentifier	 expected
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
[	TokenNameLBRACKET	
groupIDX	TokenNameIdentifier	 group IDX
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
GroupDocs	TokenNameIdentifier	 Group Docs
actualGroup	TokenNameIdentifier	 actual Group
=	TokenNameEQUAL	
actual	TokenNameIdentifier	 actual
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
[	TokenNameLBRACKET	
groupIDX	TokenNameIdentifier	 group IDX
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
verifyGroupValues	TokenNameIdentifier	 verify Group Values
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
expectedGroup	TokenNameIdentifier	 expected Group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
,	TokenNameCOMMA	
actualGroup	TokenNameIdentifier	 actual Group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
verifySortValues	TokenNameIdentifier	 verify Sort Values
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assertArrayEquals	TokenNameIdentifier	 assert Array Equals
(	TokenNameLPAREN	
expectedGroup	TokenNameIdentifier	 expected Group
.	TokenNameDOT	
groupSortValues	TokenNameIdentifier	 group Sort Values
,	TokenNameCOMMA	
actualGroup	TokenNameIdentifier	 actual Group
.	TokenNameDOT	
groupSortValues	TokenNameIdentifier	 group Sort Values
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// TODO 	TokenNameCOMMENT_LINE	TODO 
// assertEquals(expectedGroup.maxScore, actualGroup.maxScore); 	TokenNameCOMMENT_LINE	assertEquals(expectedGroup.maxScore, actualGroup.maxScore); 
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
expectedGroup	TokenNameIdentifier	 expected Group
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
,	TokenNameCOMMA	
actualGroup	TokenNameIdentifier	 actual Group
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
ScoreDoc	TokenNameIdentifier	 Score Doc
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
expectedFDs	TokenNameIdentifier	 expected F Ds
=	TokenNameEQUAL	
expectedGroup	TokenNameIdentifier	 expected Group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
;	TokenNameSEMICOLON	
final	TokenNamefinal	
ScoreDoc	TokenNameIdentifier	 Score Doc
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
actualFDs	TokenNameIdentifier	 actual F Ds
=	TokenNameEQUAL	
actualGroup	TokenNameIdentifier	 actual Group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
expectedFDs	TokenNameIdentifier	 expected F Ds
.	TokenNameDOT	
length	TokenNameIdentifier	 length
,	TokenNameCOMMA	
actualFDs	TokenNameIdentifier	 actual F Ds
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
docIDX	TokenNameIdentifier	 doc IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
docIDX	TokenNameIdentifier	 doc IDX
<	TokenNameLESS	
expectedFDs	TokenNameIdentifier	 expected F Ds
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
docIDX	TokenNameIdentifier	 doc IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
FieldDoc	TokenNameIdentifier	 Field Doc
expectedFD	TokenNameIdentifier	 expected FD
=	TokenNameEQUAL	
(	TokenNameLPAREN	
FieldDoc	TokenNameIdentifier	 Field Doc
)	TokenNameRPAREN	
expectedFDs	TokenNameIdentifier	 expected F Ds
[	TokenNameLBRACKET	
docIDX	TokenNameIdentifier	 doc IDX
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
FieldDoc	TokenNameIdentifier	 Field Doc
actualFD	TokenNameIdentifier	 actual FD
=	TokenNameEQUAL	
(	TokenNameLPAREN	
FieldDoc	TokenNameIdentifier	 Field Doc
)	TokenNameRPAREN	
actualFDs	TokenNameIdentifier	 actual F Ds
[	TokenNameLBRACKET	
docIDX	TokenNameIdentifier	 doc IDX
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
//System.out.println(" actual doc=" + docIDtoID[actualFD.doc] + " score=" + actualFD.score); 	TokenNameCOMMENT_LINE	System.out.println(" actual doc=" + docIDtoID[actualFD.doc] + " score=" + actualFD.score); 
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
expectedFD	TokenNameIdentifier	 expected FD
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
,	TokenNameCOMMA	
docIDtoID	TokenNameIdentifier	 doc I Dto ID
[	TokenNameLBRACKET	
actualFD	TokenNameIdentifier	 actual FD
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
testScores	TokenNameIdentifier	 test Scores
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
expectedFD	TokenNameIdentifier	 expected FD
.	TokenNameDOT	
score	TokenNameIdentifier	 score
,	TokenNameCOMMA	
actualFD	TokenNameIdentifier	 actual FD
.	TokenNameDOT	
score	TokenNameIdentifier	 score
,	TokenNameCOMMA	
0.1	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
// TODO: too anal for now 	TokenNameCOMMENT_LINE	TODO: too anal for now 
//assertEquals(Float.NaN, actualFD.score); 	TokenNameCOMMENT_LINE	assertEquals(Float.NaN, actualFD.score); 
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
verifySortValues	TokenNameIdentifier	 verify Sort Values
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assertArrayEquals	TokenNameIdentifier	 assert Array Equals
(	TokenNameLPAREN	
expectedFD	TokenNameIdentifier	 expected FD
.	TokenNameDOT	
fields	TokenNameIdentifier	 fields
,	TokenNameCOMMA	
actualFD	TokenNameIdentifier	 actual FD
.	TokenNameDOT	
fields	TokenNameIdentifier	 fields
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
class	TokenNameclass	
ShardSearcher	TokenNameIdentifier	 Shard Searcher
{	TokenNameLBRACE	
private	TokenNameprivate	
final	TokenNamefinal	
IndexSearcher	TokenNameIdentifier	 Index Searcher
subSearcher	TokenNameIdentifier	 sub Searcher
;	TokenNameSEMICOLON	
public	TokenNamepublic	
ShardSearcher	TokenNameIdentifier	 Shard Searcher
(	TokenNameLPAREN	
IndexReader	TokenNameIdentifier	 Index Reader
subReader	TokenNameIdentifier	 sub Reader
)	TokenNameRPAREN	
{	TokenNameLBRACE	
this	TokenNamethis	
.	TokenNameDOT	
subSearcher	TokenNameIdentifier	 sub Searcher
=	TokenNameEQUAL	
new	TokenNamenew	
IndexSearcher	TokenNameIdentifier	 Index Searcher
(	TokenNameLPAREN	
subReader	TokenNameIdentifier	 sub Reader
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
Weight	TokenNameIdentifier	 Weight
weight	TokenNameIdentifier	 weight
,	TokenNameCOMMA	
Collector	TokenNameIdentifier	 Collector
collector	TokenNameIdentifier	 collector
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
subSearcher	TokenNameIdentifier	 sub Searcher
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
weight	TokenNameIdentifier	 weight
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
collector	TokenNameIdentifier	 collector
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
TopDocs	TokenNameIdentifier	 Top Docs
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
Weight	TokenNameIdentifier	 Weight
weight	TokenNameIdentifier	 weight
,	TokenNameCOMMA	
int	TokenNameint	
topN	TokenNameIdentifier	 top N
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
return	TokenNamereturn	
subSearcher	TokenNameIdentifier	 sub Searcher
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
weight	TokenNameIdentifier	 weight
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
topN	TokenNameIdentifier	 top N
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
String	TokenNameIdentifier	 String
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
"ShardSearcher("	TokenNameStringLiteral	ShardSearcher(
+	TokenNamePLUS	
subSearcher	TokenNameIdentifier	 sub Searcher
+	TokenNamePLUS	
")"	TokenNameStringLiteral	)
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
