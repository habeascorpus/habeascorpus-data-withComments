/* * Licensed to the Apache Software Foundation (ASF) under one * or more contributor license agreements. See the NOTICE file * distributed with this work for additional information * regarding copyright ownership. The ASF licenses this file * to you under the Apache License, Version 2.0 (the * "License"); you may not use this file except in compliance * with the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */	TokenNameCOMMENT_BLOCK	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
hadoop	TokenNameIdentifier	 hadoop
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
IOException	TokenNameIdentifier	 IO Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
net	TokenNameIdentifier	 net
.	TokenNameDOT	
InetAddress	TokenNameIdentifier	 Inet Address
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
nio	TokenNameIdentifier	 nio
.	TokenNameDOT	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
ArrayBlockingQueue	TokenNameIdentifier	 Array Blocking Queue
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
BlockingQueue	TokenNameIdentifier	 Blocking Queue
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
TimeUnit	TokenNameIdentifier	 Time Unit
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
client	TokenNameIdentifier	 client
.	TokenNameDOT	
RingCache	TokenNameIdentifier	 Ring Cache
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
dht	TokenNameIdentifier	 dht
.	TokenNameDOT	
Range	TokenNameIdentifier	 Range
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
dht	TokenNameIdentifier	 dht
.	TokenNameDOT	
Token	TokenNameIdentifier	 Token
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
FBUtilities	TokenNameIdentifier	 FB Utilities
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
Pair	TokenNameIdentifier	 Pair
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
hadoop	TokenNameIdentifier	 hadoop
.	TokenNameDOT	
conf	TokenNameIdentifier	 conf
.	TokenNameDOT	
Configuration	TokenNameIdentifier	 Configuration
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
hadoop	TokenNameIdentifier	 hadoop
.	TokenNameDOT	
mapreduce	TokenNameIdentifier	 mapreduce
.	TokenNameDOT	
RecordWriter	TokenNameIdentifier	 Record Writer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
hadoop	TokenNameIdentifier	 hadoop
.	TokenNameDOT	
mapreduce	TokenNameIdentifier	 mapreduce
.	TokenNameDOT	
TaskAttemptContext	TokenNameIdentifier	 Task Attempt Context
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
TException	TokenNameIdentifier	 T Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
transport	TokenNameIdentifier	 transport
.	TokenNameDOT	
TSocket	TokenNameIdentifier	 T Socket
;	TokenNameSEMICOLON	
/** * The <code>ColumnFamilyRecordWriter</code> maps the output &lt;key, value&gt; * pairs to a Cassandra column family. In particular, it applies all mutations * in the value, which it associates with the key, and in turn the responsible * endpoint. * * <p> * Furthermore, this writer groups the mutations by the endpoint responsible for * the rows being affected. This allows the mutations to be executed in parallel, * directly to a responsible endpoint. * </p> * * @see ColumnFamilyOutputFormat * @see OutputFormat * */	TokenNameCOMMENT_JAVADOC	 The <code>ColumnFamilyRecordWriter</code> maps the output &lt;key, value&gt; pairs to a Cassandra column family. In particular, it applies all mutations in the value, which it associates with the key, and in turn the responsible endpoint. * <p> Furthermore, this writer groups the mutations by the endpoint responsible for the rows being affected. This allows the mutations to be executed in parallel, directly to a responsible endpoint. </p> * @see ColumnFamilyOutputFormat @see OutputFormat 
final	TokenNamefinal	
class	TokenNameclass	
ColumnFamilyRecordWriter	TokenNameIdentifier	 Column Family Record Writer
extends	TokenNameextends	
RecordWriter	TokenNameIdentifier	 Record Writer
<	TokenNameLESS	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
,	TokenNameCOMMA	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Mutation	TokenNameIdentifier	 Mutation
>>	TokenNameRIGHT_SHIFT	
implements	TokenNameimplements	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
hadoop	TokenNameIdentifier	 hadoop
.	TokenNameDOT	
mapred	TokenNameIdentifier	 mapred
.	TokenNameDOT	
RecordWriter	TokenNameIdentifier	 Record Writer
<	TokenNameLESS	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
,	TokenNameCOMMA	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Mutation	TokenNameIdentifier	 Mutation
>>	TokenNameRIGHT_SHIFT	
{	TokenNameLBRACE	
// The configuration this writer is associated with. 	TokenNameCOMMENT_LINE	The configuration this writer is associated with. 
private	TokenNameprivate	
final	TokenNamefinal	
Configuration	TokenNameIdentifier	 Configuration
conf	TokenNameIdentifier	 conf
;	TokenNameSEMICOLON	
// The ring cache that describes the token ranges each node in the ring is 	TokenNameCOMMENT_LINE	The ring cache that describes the token ranges each node in the ring is 
// responsible for. This is what allows us to group the mutations by 	TokenNameCOMMENT_LINE	responsible for. This is what allows us to group the mutations by 
// the endpoints they should be targeted at. The targeted endpoint 	TokenNameCOMMENT_LINE	the endpoints they should be targeted at. The targeted endpoint 
// essentially 	TokenNameCOMMENT_LINE	essentially 
// acts as the primary replica for the rows being affected by the mutations. 	TokenNameCOMMENT_LINE	acts as the primary replica for the rows being affected by the mutations. 
private	TokenNameprivate	
final	TokenNamefinal	
RingCache	TokenNameIdentifier	 Ring Cache
ringCache	TokenNameIdentifier	 ring Cache
;	TokenNameSEMICOLON	
// The number of mutations to buffer per endpoint 	TokenNameCOMMENT_LINE	The number of mutations to buffer per endpoint 
private	TokenNameprivate	
final	TokenNamefinal	
int	TokenNameint	
queueSize	TokenNameIdentifier	 queue Size
;	TokenNameSEMICOLON	
// handles for clients for each range running in the threadpool 	TokenNameCOMMENT_LINE	handles for clients for each range running in the threadpool 
private	TokenNameprivate	
final	TokenNamefinal	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
Range	TokenNameIdentifier	 Range
,	TokenNameCOMMA	
RangeClient	TokenNameIdentifier	 Range Client
>	TokenNameGREATER	
clients	TokenNameIdentifier	 clients
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
long	TokenNamelong	
batchThreshold	TokenNameIdentifier	 batch Threshold
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
ConsistencyLevel	TokenNameIdentifier	 Consistency Level
consistencyLevel	TokenNameIdentifier	 consistency Level
;	TokenNameSEMICOLON	
private	TokenNameprivate	
Progressable	TokenNameIdentifier	 Progressable
progressable	TokenNameIdentifier	 progressable
;	TokenNameSEMICOLON	
/** * Upon construction, obtain the map that this writer will use to collect * mutations, and the ring cache for the given keyspace. * * @param context the task attempt context * @throws IOException */	TokenNameCOMMENT_JAVADOC	 Upon construction, obtain the map that this writer will use to collect mutations, and the ring cache for the given keyspace. * @param context the task attempt context @throws IOException 
ColumnFamilyRecordWriter	TokenNameIdentifier	 Column Family Record Writer
(	TokenNameLPAREN	
TaskAttemptContext	TokenNameIdentifier	 Task Attempt Context
context	TokenNameIdentifier	 context
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
this	TokenNamethis	
(	TokenNameLPAREN	
context	TokenNameIdentifier	 context
.	TokenNameDOT	
getConfiguration	TokenNameIdentifier	 get Configuration
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
progressable	TokenNameIdentifier	 progressable
=	TokenNameEQUAL	
new	TokenNamenew	
Progressable	TokenNameIdentifier	 Progressable
(	TokenNameLPAREN	
context	TokenNameIdentifier	 context
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
ColumnFamilyRecordWriter	TokenNameIdentifier	 Column Family Record Writer
(	TokenNameLPAREN	
Configuration	TokenNameIdentifier	 Configuration
conf	TokenNameIdentifier	 conf
,	TokenNameCOMMA	
Progressable	TokenNameIdentifier	 Progressable
progressable	TokenNameIdentifier	 progressable
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
this	TokenNamethis	
(	TokenNameLPAREN	
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
progressable	TokenNameIdentifier	 progressable
=	TokenNameEQUAL	
progressable	TokenNameIdentifier	 progressable
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
ColumnFamilyRecordWriter	TokenNameIdentifier	 Column Family Record Writer
(	TokenNameLPAREN	
Configuration	TokenNameIdentifier	 Configuration
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
this	TokenNamethis	
.	TokenNameDOT	
conf	TokenNameIdentifier	 conf
=	TokenNameEQUAL	
conf	TokenNameIdentifier	 conf
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
ringCache	TokenNameIdentifier	 ring Cache
=	TokenNameEQUAL	
new	TokenNamenew	
RingCache	TokenNameIdentifier	 Ring Cache
(	TokenNameLPAREN	
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
queueSize	TokenNameIdentifier	 queue Size
=	TokenNameEQUAL	
conf	TokenNameIdentifier	 conf
.	TokenNameDOT	
getInt	TokenNameIdentifier	 get Int
(	TokenNameLPAREN	
ColumnFamilyOutputFormat	TokenNameIdentifier	 Column Family Output Format
.	TokenNameDOT	
QUEUE_SIZE	TokenNameIdentifier	 QUEUE  SIZE
,	TokenNameCOMMA	
32	TokenNameIntegerLiteral	
*	TokenNameMULTIPLY	
FBUtilities	TokenNameIdentifier	 FB Utilities
.	TokenNameDOT	
getAvailableProcessors	TokenNameIdentifier	 get Available Processors
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
clients	TokenNameIdentifier	 clients
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
Range	TokenNameIdentifier	 Range
,	TokenNameCOMMA	
RangeClient	TokenNameIdentifier	 Range Client
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
batchThreshold	TokenNameIdentifier	 batch Threshold
=	TokenNameEQUAL	
conf	TokenNameIdentifier	 conf
.	TokenNameDOT	
getLong	TokenNameIdentifier	 get Long
(	TokenNameLPAREN	
ColumnFamilyOutputFormat	TokenNameIdentifier	 Column Family Output Format
.	TokenNameDOT	
BATCH_THRESHOLD	TokenNameIdentifier	 BATCH  THRESHOLD
,	TokenNameCOMMA	
32	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
consistencyLevel	TokenNameIdentifier	 consistency Level
=	TokenNameEQUAL	
ConsistencyLevel	TokenNameIdentifier	 Consistency Level
.	TokenNameDOT	
valueOf	TokenNameIdentifier	 value Of
(	TokenNameLPAREN	
ConfigHelper	TokenNameIdentifier	 Config Helper
.	TokenNameDOT	
getWriteConsistencyLevel	TokenNameIdentifier	 get Write Consistency Level
(	TokenNameLPAREN	
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * If the key is to be associated with a valid value, a mutation is created * for it with the given column family and columns. In the event the value * in the column is missing (i.e., null), then it is marked for * {@link Deletion}. Similarly, if the entire value for a key is missing * (i.e., null), then the entire key is marked for {@link Deletion}. * </p> * * @param keybuff * the key to write. * @param value * the value to write. * @throws IOException */	TokenNameCOMMENT_JAVADOC	 If the key is to be associated with a valid value, a mutation is created for it with the given column family and columns. In the event the value in the column is missing (i.e., null), then it is marked for {@link Deletion}. Similarly, if the entire value for a key is missing (i.e., null), then the entire key is marked for {@link Deletion}. </p> * @param keybuff the key to write. @param value the value to write. @throws IOException 
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
void	TokenNamevoid	
write	TokenNameIdentifier	 write
(	TokenNameLPAREN	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
keybuff	TokenNameIdentifier	 keybuff
,	TokenNameCOMMA	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Mutation	TokenNameIdentifier	 Mutation
>	TokenNameGREATER	
value	TokenNameIdentifier	 value
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
Range	TokenNameIdentifier	 Range
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
range	TokenNameIdentifier	 range
=	TokenNameEQUAL	
ringCache	TokenNameIdentifier	 ring Cache
.	TokenNameDOT	
getRange	TokenNameIdentifier	 get Range
(	TokenNameLPAREN	
keybuff	TokenNameIdentifier	 keybuff
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// get the client for the given range, or create a new one 	TokenNameCOMMENT_LINE	get the client for the given range, or create a new one 
RangeClient	TokenNameIdentifier	 Range Client
client	TokenNameIdentifier	 client
=	TokenNameEQUAL	
clients	TokenNameIdentifier	 clients
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
range	TokenNameIdentifier	 range
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
client	TokenNameIdentifier	 client
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// haven't seen keys for this range: create new client 	TokenNameCOMMENT_LINE	haven't seen keys for this range: create new client 
client	TokenNameIdentifier	 client
=	TokenNameEQUAL	
new	TokenNamenew	
RangeClient	TokenNameIdentifier	 Range Client
(	TokenNameLPAREN	
ringCache	TokenNameIdentifier	 ring Cache
.	TokenNameDOT	
getEndpoint	TokenNameIdentifier	 get Endpoint
(	TokenNameLPAREN	
range	TokenNameIdentifier	 range
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
client	TokenNameIdentifier	 client
.	TokenNameDOT	
start	TokenNameIdentifier	 start
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
clients	TokenNameIdentifier	 clients
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
range	TokenNameIdentifier	 range
,	TokenNameCOMMA	
client	TokenNameIdentifier	 client
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
Mutation	TokenNameIdentifier	 Mutation
amut	TokenNameIdentifier	 amut
:	TokenNameCOLON	
value	TokenNameIdentifier	 value
)	TokenNameRPAREN	
client	TokenNameIdentifier	 client
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
Pair	TokenNameIdentifier	 Pair
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
keybuff	TokenNameIdentifier	 keybuff
,	TokenNameCOMMA	
amut	TokenNameIdentifier	 amut
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
progressable	TokenNameIdentifier	 progressable
.	TokenNameDOT	
progress	TokenNameIdentifier	 progress
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Close this <code>RecordWriter</code> to future operations, but not before * flushing out the batched mutations. * * @param context the context of the task * @throws IOException */	TokenNameCOMMENT_JAVADOC	 Close this <code>RecordWriter</code> to future operations, but not before flushing out the batched mutations. * @param context the context of the task @throws IOException 
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
void	TokenNamevoid	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
TaskAttemptContext	TokenNameIdentifier	 Task Attempt Context
context	TokenNameIdentifier	 context
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
,	TokenNameCOMMA	
InterruptedException	TokenNameIdentifier	 Interrupted Exception
{	TokenNameLBRACE	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** Fills the deprecated RecordWriter interface for streaming. */	TokenNameCOMMENT_JAVADOC	 Fills the deprecated RecordWriter interface for streaming. 
@	TokenNameAT	
Deprecated	TokenNameIdentifier	 Deprecated
public	TokenNamepublic	
void	TokenNamevoid	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
hadoop	TokenNameIdentifier	 hadoop
.	TokenNameDOT	
mapred	TokenNameIdentifier	 mapred
.	TokenNameDOT	
Reporter	TokenNameIdentifier	 Reporter
reporter	TokenNameIdentifier	 reporter
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
// close all the clients before throwing anything 	TokenNameCOMMENT_LINE	close all the clients before throwing anything 
IOException	TokenNameIdentifier	 IO Exception
clientException	TokenNameIdentifier	 client Exception
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
RangeClient	TokenNameIdentifier	 Range Client
client	TokenNameIdentifier	 client
:	TokenNameCOLON	
clients	TokenNameIdentifier	 clients
.	TokenNameDOT	
values	TokenNameIdentifier	 values
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
client	TokenNameIdentifier	 client
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
IOException	TokenNameIdentifier	 IO Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
clientException	TokenNameIdentifier	 client Exception
=	TokenNameEQUAL	
e	TokenNameIdentifier	 e
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
clientException	TokenNameIdentifier	 client Exception
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
throw	TokenNamethrow	
clientException	TokenNameIdentifier	 client Exception
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * A client that runs in a threadpool and connects to the list of endpoints for a particular * range. Mutations for keys in that range are sent to this client via a queue. */	TokenNameCOMMENT_JAVADOC	 A client that runs in a threadpool and connects to the list of endpoints for a particular range. Mutations for keys in that range are sent to this client via a queue. 
public	TokenNamepublic	
class	TokenNameclass	
RangeClient	TokenNameIdentifier	 Range Client
extends	TokenNameextends	
Thread	TokenNameIdentifier	 Thread
{	TokenNameLBRACE	
// The list of endpoints for this range 	TokenNameCOMMENT_LINE	The list of endpoints for this range 
private	TokenNameprivate	
final	TokenNamefinal	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
InetAddress	TokenNameIdentifier	 Inet Address
>	TokenNameGREATER	
endpoints	TokenNameIdentifier	 endpoints
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
columnFamily	TokenNameIdentifier	 column Family
=	TokenNameEQUAL	
ConfigHelper	TokenNameIdentifier	 Config Helper
.	TokenNameDOT	
getOutputColumnFamily	TokenNameIdentifier	 get Output Column Family
(	TokenNameLPAREN	
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// A bounded queue of incoming mutations for this range 	TokenNameCOMMENT_LINE	A bounded queue of incoming mutations for this range 
private	TokenNameprivate	
final	TokenNamefinal	
BlockingQueue	TokenNameIdentifier	 Blocking Queue
<	TokenNameLESS	
Pair	TokenNameIdentifier	 Pair
<	TokenNameLESS	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
,	TokenNameCOMMA	
Mutation	TokenNameIdentifier	 Mutation
>>	TokenNameRIGHT_SHIFT	
queue	TokenNameIdentifier	 queue
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayBlockingQueue	TokenNameIdentifier	 Array Blocking Queue
<	TokenNameLESS	
Pair	TokenNameIdentifier	 Pair
<	TokenNameLESS	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
,	TokenNameCOMMA	
Mutation	TokenNameIdentifier	 Mutation
>>	TokenNameRIGHT_SHIFT	
(	TokenNameLPAREN	
queueSize	TokenNameIdentifier	 queue Size
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
private	TokenNameprivate	
volatile	TokenNamevolatile	
boolean	TokenNameboolean	
run	TokenNameIdentifier	 run
=	TokenNameEQUAL	
true	TokenNametrue	
;	TokenNameSEMICOLON	
// we want the caller to know if something went wrong, so we record any unrecoverable exception while writing 	TokenNameCOMMENT_LINE	we want the caller to know if something went wrong, so we record any unrecoverable exception while writing 
// so we can throw it on the caller's stack when he calls put() again, or if there are no more put calls, 	TokenNameCOMMENT_LINE	so we can throw it on the caller's stack when he calls put() again, or if there are no more put calls, 
// when the client is closed. 	TokenNameCOMMENT_LINE	when the client is closed. 
private	TokenNameprivate	
volatile	TokenNamevolatile	
IOException	TokenNameIdentifier	 IO Exception
lastException	TokenNameIdentifier	 last Exception
;	TokenNameSEMICOLON	
private	TokenNameprivate	
Cassandra	TokenNameIdentifier	 Cassandra
.	TokenNameDOT	
Client	TokenNameIdentifier	 Client
thriftClient	TokenNameIdentifier	 thrift Client
;	TokenNameSEMICOLON	
private	TokenNameprivate	
TSocket	TokenNameIdentifier	 T Socket
thriftSocket	TokenNameIdentifier	 thrift Socket
;	TokenNameSEMICOLON	
/** * Constructs an {@link RangeClient} for the given endpoints. * @param endpoints the possible endpoints to execute the mutations on */	TokenNameCOMMENT_JAVADOC	 Constructs an {@link RangeClient} for the given endpoints. @param endpoints the possible endpoints to execute the mutations on 
public	TokenNamepublic	
RangeClient	TokenNameIdentifier	 Range Client
(	TokenNameLPAREN	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
InetAddress	TokenNameIdentifier	 Inet Address
>	TokenNameGREATER	
endpoints	TokenNameIdentifier	 endpoints
)	TokenNameRPAREN	
{	TokenNameLBRACE	
super	TokenNamesuper	
(	TokenNameLPAREN	
"client-"	TokenNameStringLiteral	client-
+	TokenNamePLUS	
endpoints	TokenNameIdentifier	 endpoints
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
endpoints	TokenNameIdentifier	 endpoints
=	TokenNameEQUAL	
endpoints	TokenNameIdentifier	 endpoints
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * enqueues the given value to Cassandra */	TokenNameCOMMENT_JAVADOC	 enqueues the given value to Cassandra 
public	TokenNamepublic	
void	TokenNamevoid	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
Pair	TokenNameIdentifier	 Pair
<	TokenNameLESS	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
,	TokenNameCOMMA	
Mutation	TokenNameIdentifier	 Mutation
>	TokenNameGREATER	
value	TokenNameIdentifier	 value
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
while	TokenNamewhile	
(	TokenNameLPAREN	
true	TokenNametrue	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
lastException	TokenNameIdentifier	 last Exception
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
throw	TokenNamethrow	
lastException	TokenNameIdentifier	 last Exception
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
queue	TokenNameIdentifier	 queue
.	TokenNameDOT	
offer	TokenNameIdentifier	 offer
(	TokenNameLPAREN	
value	TokenNameIdentifier	 value
,	TokenNameCOMMA	
100	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
TimeUnit	TokenNameIdentifier	 Time Unit
.	TokenNameDOT	
MILLISECONDS	TokenNameIdentifier	 MILLISECONDS
)	TokenNameRPAREN	
)	TokenNameRPAREN	
break	TokenNamebreak	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
InterruptedException	TokenNameIdentifier	 Interrupted Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
AssertionError	TokenNameIdentifier	 Assertion Error
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
// stop the run loop. this will result in closeInternal being called by the time join() finishes. 	TokenNameCOMMENT_LINE	stop the run loop. this will result in closeInternal being called by the time join() finishes. 
run	TokenNameIdentifier	 run
=	TokenNameEQUAL	
false	TokenNamefalse	
;	TokenNameSEMICOLON	
interrupt	TokenNameIdentifier	 interrupt
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
this	TokenNamethis	
.	TokenNameDOT	
join	TokenNameIdentifier	 join
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
InterruptedException	TokenNameIdentifier	 Interrupted Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
AssertionError	TokenNameIdentifier	 Assertion Error
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
lastException	TokenNameIdentifier	 last Exception
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
throw	TokenNamethrow	
lastException	TokenNameIdentifier	 last Exception
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
closeInternal	TokenNameIdentifier	 close Internal
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
thriftSocket	TokenNameIdentifier	 thrift Socket
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
thriftSocket	TokenNameIdentifier	 thrift Socket
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
thriftSocket	TokenNameIdentifier	 thrift Socket
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
thriftClient	TokenNameIdentifier	 thrift Client
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** * Loops collecting mutations from the queue and sending to Cassandra */	TokenNameCOMMENT_JAVADOC	 Loops collecting mutations from the queue and sending to Cassandra 
public	TokenNamepublic	
void	TokenNamevoid	
run	TokenNameIdentifier	 run
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
outer	TokenNameIdentifier	 outer
:	TokenNameCOLON	
while	TokenNamewhile	
(	TokenNameLPAREN	
run	TokenNameIdentifier	 run
||	TokenNameOR_OR	
!	TokenNameNOT	
queue	TokenNameIdentifier	 queue
.	TokenNameDOT	
isEmpty	TokenNameIdentifier	 is Empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Pair	TokenNameIdentifier	 Pair
<	TokenNameLESS	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
,	TokenNameCOMMA	
Mutation	TokenNameIdentifier	 Mutation
>	TokenNameGREATER	
mutation	TokenNameIdentifier	 mutation
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
mutation	TokenNameIdentifier	 mutation
=	TokenNameEQUAL	
queue	TokenNameIdentifier	 queue
.	TokenNameDOT	
take	TokenNameIdentifier	 take
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
InterruptedException	TokenNameIdentifier	 Interrupted Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// re-check loop condition after interrupt 	TokenNameCOMMENT_LINE	re-check loop condition after interrupt 
continue	TokenNamecontinue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
,	TokenNameCOMMA	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Mutation	TokenNameIdentifier	 Mutation
>>>	TokenNameUNSIGNED_RIGHT_SHIFT	
batch	TokenNameIdentifier	 batch
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
,	TokenNameCOMMA	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Mutation	TokenNameIdentifier	 Mutation
>>>	TokenNameUNSIGNED_RIGHT_SHIFT	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
while	TokenNamewhile	
(	TokenNameLPAREN	
mutation	TokenNameIdentifier	 mutation
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Mutation	TokenNameIdentifier	 Mutation
>>	TokenNameRIGHT_SHIFT	
subBatch	TokenNameIdentifier	 sub Batch
=	TokenNameEQUAL	
batch	TokenNameIdentifier	 batch
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
mutation	TokenNameIdentifier	 mutation
.	TokenNameDOT	
left	TokenNameIdentifier	 left
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
subBatch	TokenNameIdentifier	 sub Batch
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
subBatch	TokenNameIdentifier	 sub Batch
=	TokenNameEQUAL	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
singletonMap	TokenNameIdentifier	 singleton Map
(	TokenNameLPAREN	
columnFamily	TokenNameIdentifier	 column Family
,	TokenNameCOMMA	
(	TokenNameLPAREN	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Mutation	TokenNameIdentifier	 Mutation
>	TokenNameGREATER	
)	TokenNameRPAREN	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
Mutation	TokenNameIdentifier	 Mutation
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
batch	TokenNameIdentifier	 batch
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
mutation	TokenNameIdentifier	 mutation
.	TokenNameDOT	
left	TokenNameIdentifier	 left
,	TokenNameCOMMA	
subBatch	TokenNameIdentifier	 sub Batch
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
subBatch	TokenNameIdentifier	 sub Batch
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
columnFamily	TokenNameIdentifier	 column Family
)	TokenNameRPAREN	
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
mutation	TokenNameIdentifier	 mutation
.	TokenNameDOT	
right	TokenNameIdentifier	 right
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
batch	TokenNameIdentifier	 batch
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
>=	TokenNameGREATER_EQUAL	
batchThreshold	TokenNameIdentifier	 batch Threshold
)	TokenNameRPAREN	
break	TokenNamebreak	
;	TokenNameSEMICOLON	
mutation	TokenNameIdentifier	 mutation
=	TokenNameEQUAL	
queue	TokenNameIdentifier	 queue
.	TokenNameDOT	
poll	TokenNameIdentifier	 poll
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
Iterator	TokenNameIdentifier	 Iterator
<	TokenNameLESS	
InetAddress	TokenNameIdentifier	 Inet Address
>	TokenNameGREATER	
iter	TokenNameIdentifier	 iter
=	TokenNameEQUAL	
endpoints	TokenNameIdentifier	 endpoints
.	TokenNameDOT	
iterator	TokenNameIdentifier	 iterator
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
while	TokenNamewhile	
(	TokenNameLPAREN	
true	TokenNametrue	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// send the mutation to the last-used endpoint. first time through, this will NPE harmlessly. 	TokenNameCOMMENT_LINE	send the mutation to the last-used endpoint. first time through, this will NPE harmlessly. 
try	TokenNametry	
{	TokenNameLBRACE	
thriftClient	TokenNameIdentifier	 thrift Client
.	TokenNameDOT	
batch_mutate	TokenNameIdentifier	 batch mutate
(	TokenNameLPAREN	
batch	TokenNameIdentifier	 batch
,	TokenNameCOMMA	
consistencyLevel	TokenNameIdentifier	 consistency Level
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
break	TokenNamebreak	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
Exception	TokenNameIdentifier	 Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
closeInternal	TokenNameIdentifier	 close Internal
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
iter	TokenNameIdentifier	 iter
.	TokenNameDOT	
hasNext	TokenNameIdentifier	 has Next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
lastException	TokenNameIdentifier	 last Exception
=	TokenNameEQUAL	
new	TokenNamenew	
IOException	TokenNameIdentifier	 IO Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
break	TokenNamebreak	
outer	TokenNameIdentifier	 outer
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
// attempt to connect to a different endpoint 	TokenNameCOMMENT_LINE	attempt to connect to a different endpoint 
try	TokenNametry	
{	TokenNameLBRACE	
InetAddress	TokenNameIdentifier	 Inet Address
address	TokenNameIdentifier	 address
=	TokenNameEQUAL	
iter	TokenNameIdentifier	 iter
.	TokenNameDOT	
next	TokenNameIdentifier	 next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
thriftSocket	TokenNameIdentifier	 thrift Socket
=	TokenNameEQUAL	
new	TokenNamenew	
TSocket	TokenNameIdentifier	 T Socket
(	TokenNameLPAREN	
address	TokenNameIdentifier	 address
.	TokenNameDOT	
getHostName	TokenNameIdentifier	 get Host Name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
ConfigHelper	TokenNameIdentifier	 Config Helper
.	TokenNameDOT	
getOutputRpcPort	TokenNameIdentifier	 get Output Rpc Port
(	TokenNameLPAREN	
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
thriftClient	TokenNameIdentifier	 thrift Client
=	TokenNameEQUAL	
ColumnFamilyOutputFormat	TokenNameIdentifier	 Column Family Output Format
.	TokenNameDOT	
createAuthenticatedClient	TokenNameIdentifier	 create Authenticated Client
(	TokenNameLPAREN	
thriftSocket	TokenNameIdentifier	 thrift Socket
,	TokenNameCOMMA	
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
Exception	TokenNameIdentifier	 Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
closeInternal	TokenNameIdentifier	 close Internal
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// TException means something unexpected went wrong to that endpoint, so 	TokenNameCOMMENT_LINE	TException means something unexpected went wrong to that endpoint, so 
// we should try again to another. Other exceptions (auth or invalid request) are fatal. 	TokenNameCOMMENT_LINE	we should try again to another. Other exceptions (auth or invalid request) are fatal. 
if	TokenNameif	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
!	TokenNameNOT	
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
instanceof	TokenNameinstanceof	
TException	TokenNameIdentifier	 T Exception
)	TokenNameRPAREN	
)	TokenNameRPAREN	
||	TokenNameOR_OR	
!	TokenNameNOT	
iter	TokenNameIdentifier	 iter
.	TokenNameDOT	
hasNext	TokenNameIdentifier	 has Next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
lastException	TokenNameIdentifier	 last Exception
=	TokenNameEQUAL	
new	TokenNamenew	
IOException	TokenNameIdentifier	 IO Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
break	TokenNamebreak	
outer	TokenNameIdentifier	 outer
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
String	TokenNameIdentifier	 String
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
"#<Client for "	TokenNameStringLiteral	#<Client for 
+	TokenNamePLUS	
endpoints	TokenNameIdentifier	 endpoints
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
">"	TokenNameStringLiteral	>
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
