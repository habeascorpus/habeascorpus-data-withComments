/* * Licensed to the Apache Software Foundation (ASF) under one * or more contributor license agreements. See the NOTICE file * distributed with this work for additional information * regarding copyright ownership. The ASF licenses this file * to you under the Apache License, Version 2.0 (the * "License"); you may not use this file except in compliance * with the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */	TokenNameCOMMENT_BLOCK	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
net	TokenNameIdentifier	 net
.	TokenNameDOT	
InetSocketAddress	TokenNameIdentifier	 Inet Socket Address
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
net	TokenNameIdentifier	 net
.	TokenNameDOT	
SocketAddress	TokenNameIdentifier	 Socket Address
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
net	TokenNameIdentifier	 net
.	TokenNameDOT	
SocketTimeoutException	TokenNameIdentifier	 Socket Timeout Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
ExecutorService	TokenNameIdentifier	 Executor Service
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
SynchronousQueue	TokenNameIdentifier	 Synchronous Queue
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
ThreadPoolExecutor	TokenNameIdentifier	 Thread Pool Executor
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
TimeUnit	TokenNameIdentifier	 Time Unit
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
atomic	TokenNameIdentifier	 atomic
.	TokenNameDOT	
AtomicInteger	TokenNameIdentifier	 Atomic Integer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
Logger	TokenNameIdentifier	 Logger
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
LoggerFactory	TokenNameIdentifier	 Logger Factory
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
NamedThreadFactory	TokenNameIdentifier	 Named Thread Factory
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
config	TokenNameIdentifier	 config
.	TokenNameDOT	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
config	TokenNameIdentifier	 config
.	TokenNameDOT	
EncryptionOptions	TokenNameIdentifier	 Encryption Options
.	TokenNameDOT	
ClientEncryptionOptions	TokenNameIdentifier	 Client Encryption Options
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
TException	TokenNameIdentifier	 T Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
TProcessor	TokenNameIdentifier	 T Processor
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
protocol	TokenNameIdentifier	 protocol
.	TokenNameDOT	
TProtocol	TokenNameIdentifier	 T Protocol
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
server	TokenNameIdentifier	 server
.	TokenNameDOT	
TServer	TokenNameIdentifier	 T Server
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
server	TokenNameIdentifier	 server
.	TokenNameDOT	
TThreadPoolServer	TokenNameIdentifier	 T Thread Pool Server
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
transport	TokenNameIdentifier	 transport
.	TokenNameDOT	
TSSLTransportFactory	TokenNameIdentifier	 TSSL Transport Factory
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
transport	TokenNameIdentifier	 transport
.	TokenNameDOT	
TServerSocket	TokenNameIdentifier	 T Server Socket
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
transport	TokenNameIdentifier	 transport
.	TokenNameDOT	
TServerTransport	TokenNameIdentifier	 T Server Transport
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
transport	TokenNameIdentifier	 transport
.	TokenNameDOT	
TTransport	TokenNameIdentifier	 T Transport
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
transport	TokenNameIdentifier	 transport
.	TokenNameDOT	
TTransportException	TokenNameIdentifier	 T Transport Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
transport	TokenNameIdentifier	 transport
.	TokenNameDOT	
TSSLTransportFactory	TokenNameIdentifier	 TSSL Transport Factory
.	TokenNameDOT	
TSSLTransportParameters	TokenNameIdentifier	 TSSL Transport Parameters
;	TokenNameSEMICOLON	
/** * Slightly modified version of the Apache Thrift TThreadPoolServer. * <p/> * This allows passing an executor so you have more control over the actual * behaviour of the tasks being run. * <p/> * Newer version of Thrift should make this obsolete. */	TokenNameCOMMENT_JAVADOC	 Slightly modified version of the Apache Thrift TThreadPoolServer. <p/> This allows passing an executor so you have more control over the actual behaviour of the tasks being run. <p/> Newer version of Thrift should make this obsolete. 
public	TokenNamepublic	
class	TokenNameclass	
CustomTThreadPoolServer	TokenNameIdentifier	 Custom T Thread Pool Server
extends	TokenNameextends	
TServer	TokenNameIdentifier	 T Server
{	TokenNameLBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
Logger	TokenNameIdentifier	 Logger
logger	TokenNameIdentifier	 logger
=	TokenNameEQUAL	
LoggerFactory	TokenNameIdentifier	 Logger Factory
.	TokenNameDOT	
getLogger	TokenNameIdentifier	 get Logger
(	TokenNameLPAREN	
CustomTThreadPoolServer	TokenNameIdentifier	 Custom T Thread Pool Server
.	TokenNameDOT	
class	TokenNameclass	
.	TokenNameDOT	
getName	TokenNameIdentifier	 get Name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Executor service for handling client connections 	TokenNameCOMMENT_LINE	Executor service for handling client connections 
private	TokenNameprivate	
final	TokenNamefinal	
ExecutorService	TokenNameIdentifier	 Executor Service
executorService	TokenNameIdentifier	 executor Service
;	TokenNameSEMICOLON	
// Flag for stopping the server 	TokenNameCOMMENT_LINE	Flag for stopping the server 
private	TokenNameprivate	
volatile	TokenNamevolatile	
boolean	TokenNameboolean	
stopped	TokenNameIdentifier	 stopped
;	TokenNameSEMICOLON	
// Server options 	TokenNameCOMMENT_LINE	Server options 
private	TokenNameprivate	
final	TokenNamefinal	
TThreadPoolServer	TokenNameIdentifier	 T Thread Pool Server
.	TokenNameDOT	
Args	TokenNameIdentifier	 Args
args	TokenNameIdentifier	 args
;	TokenNameSEMICOLON	
//Track and Limit the number of connected clients 	TokenNameCOMMENT_LINE	Track and Limit the number of connected clients 
private	TokenNameprivate	
final	TokenNamefinal	
AtomicInteger	TokenNameIdentifier	 Atomic Integer
activeClients	TokenNameIdentifier	 active Clients
=	TokenNameEQUAL	
new	TokenNamenew	
AtomicInteger	TokenNameIdentifier	 Atomic Integer
(	TokenNameLPAREN	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
public	TokenNamepublic	
CustomTThreadPoolServer	TokenNameIdentifier	 Custom T Thread Pool Server
(	TokenNameLPAREN	
TThreadPoolServer	TokenNameIdentifier	 T Thread Pool Server
.	TokenNameDOT	
Args	TokenNameIdentifier	 Args
args	TokenNameIdentifier	 args
,	TokenNameCOMMA	
ExecutorService	TokenNameIdentifier	 Executor Service
executorService	TokenNameIdentifier	 executor Service
)	TokenNameRPAREN	
{	TokenNameLBRACE	
super	TokenNamesuper	
(	TokenNameLPAREN	
args	TokenNameIdentifier	 args
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
executorService	TokenNameIdentifier	 executor Service
=	TokenNameEQUAL	
executorService	TokenNameIdentifier	 executor Service
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
args	TokenNameIdentifier	 args
=	TokenNameEQUAL	
args	TokenNameIdentifier	 args
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
serve	TokenNameIdentifier	 serve
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
serverTransport_	TokenNameIdentifier	 server Transport
.	TokenNameDOT	
listen	TokenNameIdentifier	 listen
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
TTransportException	TokenNameIdentifier	 T Transport Exception
ttx	TokenNameIdentifier	 ttx
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
error	TokenNameIdentifier	 error
(	TokenNameLPAREN	
"Error occurred during listening."	TokenNameStringLiteral	Error occurred during listening.
,	TokenNameCOMMA	
ttx	TokenNameIdentifier	 ttx
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
stopped	TokenNameIdentifier	 stopped
=	TokenNameEQUAL	
false	TokenNamefalse	
;	TokenNameSEMICOLON	
while	TokenNamewhile	
(	TokenNameLPAREN	
!	TokenNameNOT	
stopped	TokenNameIdentifier	 stopped
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// block until we are under max clients 	TokenNameCOMMENT_LINE	block until we are under max clients 
while	TokenNamewhile	
(	TokenNameLPAREN	
activeClients	TokenNameIdentifier	 active Clients
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
>=	TokenNameGREATER_EQUAL	
args	TokenNameIdentifier	 args
.	TokenNameDOT	
maxWorkerThreads	TokenNameIdentifier	 max Worker Threads
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
Thread	TokenNameIdentifier	 Thread
.	TokenNameDOT	
sleep	TokenNameIdentifier	 sleep
(	TokenNameLPAREN	
100	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
InterruptedException	TokenNameIdentifier	 Interrupted Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
AssertionError	TokenNameIdentifier	 Assertion Error
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
TTransport	TokenNameIdentifier	 T Transport
client	TokenNameIdentifier	 client
=	TokenNameEQUAL	
serverTransport_	TokenNameIdentifier	 server Transport
.	TokenNameDOT	
accept	TokenNameIdentifier	 accept
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
activeClients	TokenNameIdentifier	 active Clients
.	TokenNameDOT	
incrementAndGet	TokenNameIdentifier	 increment And Get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
WorkerProcess	TokenNameIdentifier	 Worker Process
wp	TokenNameIdentifier	 wp
=	TokenNameEQUAL	
new	TokenNamenew	
WorkerProcess	TokenNameIdentifier	 Worker Process
(	TokenNameLPAREN	
client	TokenNameIdentifier	 client
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
executorService	TokenNameIdentifier	 executor Service
.	TokenNameDOT	
execute	TokenNameIdentifier	 execute
(	TokenNameLPAREN	
wp	TokenNameIdentifier	 wp
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
TTransportException	TokenNameIdentifier	 T Transport Exception
ttx	TokenNameIdentifier	 ttx
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
ttx	TokenNameIdentifier	 ttx
.	TokenNameDOT	
getCause	TokenNameIdentifier	 get Cause
(	TokenNameLPAREN	
)	TokenNameRPAREN	
instanceof	TokenNameinstanceof	
SocketTimeoutException	TokenNameIdentifier	 Socket Timeout Exception
)	TokenNameRPAREN	
// thrift sucks 	TokenNameCOMMENT_LINE	thrift sucks 
continue	TokenNamecontinue	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
stopped	TokenNameIdentifier	 stopped
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
warn	TokenNameIdentifier	 warn
(	TokenNameLPAREN	
"Transport error occurred during acceptance of message."	TokenNameStringLiteral	Transport error occurred during acceptance of message.
,	TokenNameCOMMA	
ttx	TokenNameIdentifier	 ttx
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
activeClients	TokenNameIdentifier	 active Clients
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
>=	TokenNameGREATER_EQUAL	
args	TokenNameIdentifier	 args
.	TokenNameDOT	
maxWorkerThreads	TokenNameIdentifier	 max Worker Threads
)	TokenNameRPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
warn	TokenNameIdentifier	 warn
(	TokenNameLPAREN	
"Maximum number of clients "	TokenNameStringLiteral	Maximum number of clients 
+	TokenNamePLUS	
args	TokenNameIdentifier	 args
.	TokenNameDOT	
maxWorkerThreads	TokenNameIdentifier	 max Worker Threads
+	TokenNamePLUS	
" reached"	TokenNameStringLiteral	 reached
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
executorService	TokenNameIdentifier	 executor Service
.	TokenNameDOT	
shutdown	TokenNameIdentifier	 shutdown
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Thrift's default shutdown waits for the WorkerProcess threads to complete. We do not, 	TokenNameCOMMENT_LINE	Thrift's default shutdown waits for the WorkerProcess threads to complete. We do not, 
// because doing that allows a client to hold our shutdown "hostage" by simply not sending 	TokenNameCOMMENT_LINE	because doing that allows a client to hold our shutdown "hostage" by simply not sending 
// another message after stop is called (since process will block indefinitely trying to read 	TokenNameCOMMENT_LINE	another message after stop is called (since process will block indefinitely trying to read 
// the next meessage header). 	TokenNameCOMMENT_LINE	the next meessage header). 
// 	TokenNameCOMMENT_LINE	 
// The "right" fix would be to update thrift to set a socket timeout on client connections 	TokenNameCOMMENT_LINE	The "right" fix would be to update thrift to set a socket timeout on client connections 
// (and tolerate unintentional timeouts until stopped is set). But this requires deep 	TokenNameCOMMENT_LINE	(and tolerate unintentional timeouts until stopped is set). But this requires deep 
// changes to the code generator, so simply setting these threads to daemon (in our custom 	TokenNameCOMMENT_LINE	changes to the code generator, so simply setting these threads to daemon (in our custom 
// CleaningThreadPool) and ignoring them after shutdown is good enough. 	TokenNameCOMMENT_LINE	CleaningThreadPool) and ignoring them after shutdown is good enough. 
// 	TokenNameCOMMENT_LINE	 
// Remember, our goal on shutdown is not necessarily that each client request we receive 	TokenNameCOMMENT_LINE	Remember, our goal on shutdown is not necessarily that each client request we receive 
// gets answered first [to do that, you should redirect clients to a different coordinator 	TokenNameCOMMENT_LINE	gets answered first [to do that, you should redirect clients to a different coordinator 
// first], but rather (1) to make sure that for each update we ack as successful, we generate 	TokenNameCOMMENT_LINE	first], but rather (1) to make sure that for each update we ack as successful, we generate 
// hints for any non-responsive replicas, and (2) to make sure that we quickly stop 	TokenNameCOMMENT_LINE	hints for any non-responsive replicas, and (2) to make sure that we quickly stop 
// accepting client connections so shutdown can continue. Not waiting for the WorkerProcess 	TokenNameCOMMENT_LINE	accepting client connections so shutdown can continue. Not waiting for the WorkerProcess 
// threads here accomplishes (2); MessagingService's shutdown method takes care of (1). 	TokenNameCOMMENT_LINE	threads here accomplishes (2); MessagingService's shutdown method takes care of (1). 
// 	TokenNameCOMMENT_LINE	 
// See CASSANDRA-3335 and CASSANDRA-3727. 	TokenNameCOMMENT_LINE	See CASSANDRA-3335 and CASSANDRA-3727. 
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
stop	TokenNameIdentifier	 stop
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
stopped	TokenNameIdentifier	 stopped
=	TokenNameEQUAL	
true	TokenNametrue	
;	TokenNameSEMICOLON	
serverTransport_	TokenNameIdentifier	 server Transport
.	TokenNameDOT	
interrupt	TokenNameIdentifier	 interrupt
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
class	TokenNameclass	
WorkerProcess	TokenNameIdentifier	 Worker Process
implements	TokenNameimplements	
Runnable	TokenNameIdentifier	 Runnable
{	TokenNameLBRACE	
/** * Client that this services. */	TokenNameCOMMENT_JAVADOC	 Client that this services. 
private	TokenNameprivate	
TTransport	TokenNameIdentifier	 T Transport
client_	TokenNameIdentifier	 client
;	TokenNameSEMICOLON	
/** * Default constructor. * * @param client Transport to process */	TokenNameCOMMENT_JAVADOC	 Default constructor. * @param client Transport to process 
private	TokenNameprivate	
WorkerProcess	TokenNameIdentifier	 Worker Process
(	TokenNameLPAREN	
TTransport	TokenNameIdentifier	 T Transport
client	TokenNameIdentifier	 client
)	TokenNameRPAREN	
{	TokenNameLBRACE	
client_	TokenNameIdentifier	 client
=	TokenNameEQUAL	
client	TokenNameIdentifier	 client
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Loops on processing a client forever */	TokenNameCOMMENT_JAVADOC	 Loops on processing a client forever 
public	TokenNamepublic	
void	TokenNamevoid	
run	TokenNameIdentifier	 run
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
TProcessor	TokenNameIdentifier	 T Processor
processor	TokenNameIdentifier	 processor
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
TTransport	TokenNameIdentifier	 T Transport
inputTransport	TokenNameIdentifier	 input Transport
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
TTransport	TokenNameIdentifier	 T Transport
outputTransport	TokenNameIdentifier	 output Transport
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
TProtocol	TokenNameIdentifier	 T Protocol
inputProtocol	TokenNameIdentifier	 input Protocol
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
TProtocol	TokenNameIdentifier	 T Protocol
outputProtocol	TokenNameIdentifier	 output Protocol
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
SocketAddress	TokenNameIdentifier	 Socket Address
socket	TokenNameIdentifier	 socket
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
socket	TokenNameIdentifier	 socket
=	TokenNameEQUAL	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
TCustomSocket	TokenNameIdentifier	 T Custom Socket
)	TokenNameRPAREN	
client_	TokenNameIdentifier	 client
)	TokenNameRPAREN	
.	TokenNameDOT	
getSocket	TokenNameIdentifier	 get Socket
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getRemoteSocketAddress	TokenNameIdentifier	 get Remote Socket Address
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ThriftSessionManager	TokenNameIdentifier	 Thrift Session Manager
.	TokenNameDOT	
instance	TokenNameIdentifier	 instance
.	TokenNameDOT	
setCurrentSocket	TokenNameIdentifier	 set Current Socket
(	TokenNameLPAREN	
socket	TokenNameIdentifier	 socket
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
processor	TokenNameIdentifier	 processor
=	TokenNameEQUAL	
processorFactory_	TokenNameIdentifier	 processor Factory
.	TokenNameDOT	
getProcessor	TokenNameIdentifier	 get Processor
(	TokenNameLPAREN	
client_	TokenNameIdentifier	 client
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
inputTransport	TokenNameIdentifier	 input Transport
=	TokenNameEQUAL	
inputTransportFactory_	TokenNameIdentifier	 input Transport Factory
.	TokenNameDOT	
getTransport	TokenNameIdentifier	 get Transport
(	TokenNameLPAREN	
client_	TokenNameIdentifier	 client
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
outputTransport	TokenNameIdentifier	 output Transport
=	TokenNameEQUAL	
outputTransportFactory_	TokenNameIdentifier	 output Transport Factory
.	TokenNameDOT	
getTransport	TokenNameIdentifier	 get Transport
(	TokenNameLPAREN	
client_	TokenNameIdentifier	 client
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
inputProtocol	TokenNameIdentifier	 input Protocol
=	TokenNameEQUAL	
inputProtocolFactory_	TokenNameIdentifier	 input Protocol Factory
.	TokenNameDOT	
getProtocol	TokenNameIdentifier	 get Protocol
(	TokenNameLPAREN	
inputTransport	TokenNameIdentifier	 input Transport
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
outputProtocol	TokenNameIdentifier	 output Protocol
=	TokenNameEQUAL	
outputProtocolFactory_	TokenNameIdentifier	 output Protocol Factory
.	TokenNameDOT	
getProtocol	TokenNameIdentifier	 get Protocol
(	TokenNameLPAREN	
outputTransport	TokenNameIdentifier	 output Transport
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// we check stopped first to make sure we're not supposed to be shutting 	TokenNameCOMMENT_LINE	we check stopped first to make sure we're not supposed to be shutting 
// down. this is necessary for graceful shutdown. (but not sufficient, 	TokenNameCOMMENT_LINE	down. this is necessary for graceful shutdown. (but not sufficient, 
// since process() can take arbitrarily long waiting for client input. 	TokenNameCOMMENT_LINE	since process() can take arbitrarily long waiting for client input. 
// See comments at the end of serve().) 	TokenNameCOMMENT_LINE	See comments at the end of serve().) 
while	TokenNamewhile	
(	TokenNameLPAREN	
!	TokenNameNOT	
stopped	TokenNameIdentifier	 stopped
&&	TokenNameAND_AND	
processor	TokenNameIdentifier	 processor
.	TokenNameDOT	
process	TokenNameIdentifier	 process
(	TokenNameLPAREN	
inputProtocol	TokenNameIdentifier	 input Protocol
,	TokenNameCOMMA	
outputProtocol	TokenNameIdentifier	 output Protocol
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
inputProtocol	TokenNameIdentifier	 input Protocol
=	TokenNameEQUAL	
inputProtocolFactory_	TokenNameIdentifier	 input Protocol Factory
.	TokenNameDOT	
getProtocol	TokenNameIdentifier	 get Protocol
(	TokenNameLPAREN	
inputTransport	TokenNameIdentifier	 input Transport
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
outputProtocol	TokenNameIdentifier	 output Protocol
=	TokenNameEQUAL	
outputProtocolFactory_	TokenNameIdentifier	 output Protocol Factory
.	TokenNameDOT	
getProtocol	TokenNameIdentifier	 get Protocol
(	TokenNameLPAREN	
outputTransport	TokenNameIdentifier	 output Transport
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
TTransportException	TokenNameIdentifier	 T Transport Exception
ttx	TokenNameIdentifier	 ttx
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// Assume the client died and continue silently 	TokenNameCOMMENT_LINE	Assume the client died and continue silently 
// Log at debug to allow debugging of "frame too large" errors (see CASSANDRA-3142). 	TokenNameCOMMENT_LINE	Log at debug to allow debugging of "frame too large" errors (see CASSANDRA-3142). 
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"Thrift transport error occurred during processing of message."	TokenNameStringLiteral	Thrift transport error occurred during processing of message.
,	TokenNameCOMMA	
ttx	TokenNameIdentifier	 ttx
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
TException	TokenNameIdentifier	 T Exception
tx	TokenNameIdentifier	 tx
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
error	TokenNameIdentifier	 error
(	TokenNameLPAREN	
"Thrift error occurred during processing of message."	TokenNameStringLiteral	Thrift error occurred during processing of message.
,	TokenNameCOMMA	
tx	TokenNameIdentifier	 tx
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
Exception	TokenNameIdentifier	 Exception
x	TokenNameIdentifier	 x
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
error	TokenNameIdentifier	 error
(	TokenNameLPAREN	
"Error occurred during processing of message."	TokenNameStringLiteral	Error occurred during processing of message.
,	TokenNameCOMMA	
x	TokenNameIdentifier	 x
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
finally	TokenNamefinally	
{	TokenNameLBRACE	
activeClients	TokenNameIdentifier	 active Clients
.	TokenNameDOT	
decrementAndGet	TokenNameIdentifier	 decrement And Get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
socket	TokenNameIdentifier	 socket
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
ThriftSessionManager	TokenNameIdentifier	 Thrift Session Manager
.	TokenNameDOT	
instance	TokenNameIdentifier	 instance
.	TokenNameDOT	
connectionComplete	TokenNameIdentifier	 connection Complete
(	TokenNameLPAREN	
socket	TokenNameIdentifier	 socket
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
inputTransport	TokenNameIdentifier	 input Transport
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
inputTransport	TokenNameIdentifier	 input Transport
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
outputTransport	TokenNameIdentifier	 output Transport
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
outputTransport	TokenNameIdentifier	 output Transport
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
class	TokenNameclass	
Factory	TokenNameIdentifier	 Factory
implements	TokenNameimplements	
TServerFactory	TokenNameIdentifier	 T Server Factory
{	TokenNameLBRACE	
public	TokenNamepublic	
TServer	TokenNameIdentifier	 T Server
buildTServer	TokenNameIdentifier	 build T Server
(	TokenNameLPAREN	
Args	TokenNameIdentifier	 Args
args	TokenNameIdentifier	 args
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
InetSocketAddress	TokenNameIdentifier	 Inet Socket Address
addr	TokenNameIdentifier	 addr
=	TokenNameEQUAL	
args	TokenNameIdentifier	 args
.	TokenNameDOT	
addr	TokenNameIdentifier	 addr
;	TokenNameSEMICOLON	
TServerTransport	TokenNameIdentifier	 T Server Transport
serverTransport	TokenNameIdentifier	 server Transport
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
final	TokenNamefinal	
ClientEncryptionOptions	TokenNameIdentifier	 Client Encryption Options
clientEnc	TokenNameIdentifier	 client Enc
=	TokenNameEQUAL	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
.	TokenNameDOT	
getClientEncryptionOptions	TokenNameIdentifier	 get Client Encryption Options
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
clientEnc	TokenNameIdentifier	 client Enc
.	TokenNameDOT	
enabled	TokenNameIdentifier	 enabled
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
info	TokenNameIdentifier	 info
(	TokenNameLPAREN	
"enabling encrypted thrift connections between client and server"	TokenNameStringLiteral	enabling encrypted thrift connections between client and server
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
TSSLTransportParameters	TokenNameIdentifier	 TSSL Transport Parameters
params	TokenNameIdentifier	 params
=	TokenNameEQUAL	
new	TokenNamenew	
TSSLTransportParameters	TokenNameIdentifier	 TSSL Transport Parameters
(	TokenNameLPAREN	
clientEnc	TokenNameIdentifier	 client Enc
.	TokenNameDOT	
protocol	TokenNameIdentifier	 protocol
,	TokenNameCOMMA	
clientEnc	TokenNameIdentifier	 client Enc
.	TokenNameDOT	
cipher_suites	TokenNameIdentifier	 cipher suites
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
params	TokenNameIdentifier	 params
.	TokenNameDOT	
setKeyStore	TokenNameIdentifier	 set Key Store
(	TokenNameLPAREN	
clientEnc	TokenNameIdentifier	 client Enc
.	TokenNameDOT	
keystore	TokenNameIdentifier	 keystore
,	TokenNameCOMMA	
clientEnc	TokenNameIdentifier	 client Enc
.	TokenNameDOT	
keystore_password	TokenNameIdentifier	 keystore password
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
TServerSocket	TokenNameIdentifier	 T Server Socket
sslServer	TokenNameIdentifier	 ssl Server
=	TokenNameEQUAL	
TSSLTransportFactory	TokenNameIdentifier	 TSSL Transport Factory
.	TokenNameDOT	
getServerSocket	TokenNameIdentifier	 get Server Socket
(	TokenNameLPAREN	
addr	TokenNameIdentifier	 addr
.	TokenNameDOT	
getPort	TokenNameIdentifier	 get Port
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
addr	TokenNameIdentifier	 addr
.	TokenNameDOT	
getAddress	TokenNameIdentifier	 get Address
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
params	TokenNameIdentifier	 params
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
serverTransport	TokenNameIdentifier	 server Transport
=	TokenNameEQUAL	
new	TokenNamenew	
TCustomServerSocket	TokenNameIdentifier	 T Custom Server Socket
(	TokenNameLPAREN	
sslServer	TokenNameIdentifier	 ssl Server
.	TokenNameDOT	
getServerSocket	TokenNameIdentifier	 get Server Socket
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
args	TokenNameIdentifier	 args
.	TokenNameDOT	
keepAlive	TokenNameIdentifier	 keep Alive
,	TokenNameCOMMA	
args	TokenNameIdentifier	 args
.	TokenNameDOT	
sendBufferSize	TokenNameIdentifier	 send Buffer Size
,	TokenNameCOMMA	
args	TokenNameIdentifier	 args
.	TokenNameDOT	
recvBufferSize	TokenNameIdentifier	 recv Buffer Size
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
serverTransport	TokenNameIdentifier	 server Transport
=	TokenNameEQUAL	
new	TokenNamenew	
TCustomServerSocket	TokenNameIdentifier	 T Custom Server Socket
(	TokenNameLPAREN	
addr	TokenNameIdentifier	 addr
,	TokenNameCOMMA	
args	TokenNameIdentifier	 args
.	TokenNameDOT	
keepAlive	TokenNameIdentifier	 keep Alive
,	TokenNameCOMMA	
args	TokenNameIdentifier	 args
.	TokenNameDOT	
sendBufferSize	TokenNameIdentifier	 send Buffer Size
,	TokenNameCOMMA	
args	TokenNameIdentifier	 args
.	TokenNameDOT	
recvBufferSize	TokenNameIdentifier	 recv Buffer Size
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
TTransportException	TokenNameIdentifier	 T Transport Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"Unable to create thrift socket to %s:%s"	TokenNameStringLiteral	Unable to create thrift socket to %s:%s
,	TokenNameCOMMA	
addr	TokenNameIdentifier	 addr
.	TokenNameDOT	
getAddress	TokenNameIdentifier	 get Address
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
addr	TokenNameIdentifier	 addr
.	TokenNameDOT	
getPort	TokenNameIdentifier	 get Port
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// ThreadPool Server and will be invocation per connection basis... 	TokenNameCOMMENT_LINE	ThreadPool Server and will be invocation per connection basis... 
TThreadPoolServer	TokenNameIdentifier	 T Thread Pool Server
.	TokenNameDOT	
Args	TokenNameIdentifier	 Args
serverArgs	TokenNameIdentifier	 server Args
=	TokenNameEQUAL	
new	TokenNamenew	
TThreadPoolServer	TokenNameIdentifier	 T Thread Pool Server
.	TokenNameDOT	
Args	TokenNameIdentifier	 Args
(	TokenNameLPAREN	
serverTransport	TokenNameIdentifier	 server Transport
)	TokenNameRPAREN	
.	TokenNameDOT	
minWorkerThreads	TokenNameIdentifier	 min Worker Threads
(	TokenNameLPAREN	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
.	TokenNameDOT	
getRpcMinThreads	TokenNameIdentifier	 get Rpc Min Threads
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
maxWorkerThreads	TokenNameIdentifier	 max Worker Threads
(	TokenNameLPAREN	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
.	TokenNameDOT	
getRpcMaxThreads	TokenNameIdentifier	 get Rpc Max Threads
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
inputTransportFactory	TokenNameIdentifier	 input Transport Factory
(	TokenNameLPAREN	
args	TokenNameIdentifier	 args
.	TokenNameDOT	
inTransportFactory	TokenNameIdentifier	 in Transport Factory
)	TokenNameRPAREN	
.	TokenNameDOT	
outputTransportFactory	TokenNameIdentifier	 output Transport Factory
(	TokenNameLPAREN	
args	TokenNameIdentifier	 args
.	TokenNameDOT	
outTransportFactory	TokenNameIdentifier	 out Transport Factory
)	TokenNameRPAREN	
.	TokenNameDOT	
inputProtocolFactory	TokenNameIdentifier	 input Protocol Factory
(	TokenNameLPAREN	
args	TokenNameIdentifier	 args
.	TokenNameDOT	
tProtocolFactory	TokenNameIdentifier	 t Protocol Factory
)	TokenNameRPAREN	
.	TokenNameDOT	
outputProtocolFactory	TokenNameIdentifier	 output Protocol Factory
(	TokenNameLPAREN	
args	TokenNameIdentifier	 args
.	TokenNameDOT	
tProtocolFactory	TokenNameIdentifier	 t Protocol Factory
)	TokenNameRPAREN	
.	TokenNameDOT	
processor	TokenNameIdentifier	 processor
(	TokenNameLPAREN	
args	TokenNameIdentifier	 args
.	TokenNameDOT	
processor	TokenNameIdentifier	 processor
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ExecutorService	TokenNameIdentifier	 Executor Service
executorService	TokenNameIdentifier	 executor Service
=	TokenNameEQUAL	
new	TokenNamenew	
ThreadPoolExecutor	TokenNameIdentifier	 Thread Pool Executor
(	TokenNameLPAREN	
serverArgs	TokenNameIdentifier	 server Args
.	TokenNameDOT	
minWorkerThreads	TokenNameIdentifier	 min Worker Threads
,	TokenNameCOMMA	
serverArgs	TokenNameIdentifier	 server Args
.	TokenNameDOT	
maxWorkerThreads	TokenNameIdentifier	 max Worker Threads
,	TokenNameCOMMA	
60	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
TimeUnit	TokenNameIdentifier	 Time Unit
.	TokenNameDOT	
SECONDS	TokenNameIdentifier	 SECONDS
,	TokenNameCOMMA	
new	TokenNamenew	
SynchronousQueue	TokenNameIdentifier	 Synchronous Queue
<	TokenNameLESS	
Runnable	TokenNameIdentifier	 Runnable
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
new	TokenNamenew	
NamedThreadFactory	TokenNameIdentifier	 Named Thread Factory
(	TokenNameLPAREN	
"Thrift"	TokenNameStringLiteral	Thrift
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
new	TokenNamenew	
CustomTThreadPoolServer	TokenNameIdentifier	 Custom T Thread Pool Server
(	TokenNameLPAREN	
serverArgs	TokenNameIdentifier	 server Args
,	TokenNameCOMMA	
executorService	TokenNameIdentifier	 executor Service
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
