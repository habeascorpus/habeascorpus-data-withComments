/* * Licensed to the Apache Software Foundation (ASF) under one * or more contributor license agreements. See the NOTICE file * distributed with this work for additional information * regarding copyright ownership. The ASF licenses this file * to you under the Apache License, Version 2.0 (the * "License"); you may not use this file except in compliance * with the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */	TokenNameCOMMENT_BLOCK	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
sstable	TokenNameIdentifier	 sstable
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
nio	TokenNameIdentifier	 nio
.	TokenNameDOT	
channels	TokenNameIdentifier	 channels
.	TokenNameDOT	
ClosedChannelException	TokenNameIdentifier	 Closed Channel Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
regex	TokenNameIdentifier	 regex
.	TokenNameDOT	
Pattern	TokenNameIdentifier	 Pattern
;	TokenNameSEMICOLON	
import	TokenNameimport	
com	TokenNameIdentifier	 com
.	TokenNameDOT	
google	TokenNameIdentifier	 google
.	TokenNameDOT	
common	TokenNameIdentifier	 common
.	TokenNameDOT	
collect	TokenNameIdentifier	 collect
.	TokenNameDOT	
Sets	TokenNameIdentifier	 Sets
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
Logger	TokenNameIdentifier	 Logger
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
LoggerFactory	TokenNameIdentifier	 Logger Factory
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
config	TokenNameIdentifier	 config
.	TokenNameDOT	
CFMetaData	TokenNameIdentifier	 CF Meta Data
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
config	TokenNameIdentifier	 config
.	TokenNameDOT	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
config	TokenNameIdentifier	 config
.	TokenNameDOT	
Schema	TokenNameIdentifier	 Schema
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
compaction	TokenNameIdentifier	 compaction
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
dht	TokenNameIdentifier	 dht
.	TokenNameDOT	
IPartitioner	TokenNameIdentifier	 I Partitioner
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
FSWriteError	TokenNameIdentifier	 FS Write Error
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
IColumnSerializer	TokenNameIdentifier	 I Column Serializer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
compress	TokenNameIdentifier	 compress
.	TokenNameDOT	
CompressedSequentialWriter	TokenNameIdentifier	 Compressed Sequential Writer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
service	TokenNameIdentifier	 service
.	TokenNameDOT	
StorageService	TokenNameIdentifier	 Storage Service
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
public	TokenNamepublic	
class	TokenNameclass	
SSTableWriter	TokenNameIdentifier	 SS Table Writer
extends	TokenNameextends	
SSTable	TokenNameIdentifier	 SS Table
{	TokenNameLBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
Logger	TokenNameIdentifier	 Logger
logger	TokenNameIdentifier	 logger
=	TokenNameEQUAL	
LoggerFactory	TokenNameIdentifier	 Logger Factory
.	TokenNameDOT	
getLogger	TokenNameIdentifier	 get Logger
(	TokenNameLPAREN	
SSTableWriter	TokenNameIdentifier	 SS Table Writer
.	TokenNameDOT	
class	TokenNameclass	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
private	TokenNameprivate	
IndexWriter	TokenNameIdentifier	 Index Writer
iwriter	TokenNameIdentifier	 iwriter
;	TokenNameSEMICOLON	
private	TokenNameprivate	
SegmentedFile	TokenNameIdentifier	 Segmented File
.	TokenNameDOT	
Builder	TokenNameIdentifier	 Builder
dbuilder	TokenNameIdentifier	 dbuilder
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
SequentialWriter	TokenNameIdentifier	 Sequential Writer
dataFile	TokenNameIdentifier	 data File
;	TokenNameSEMICOLON	
private	TokenNameprivate	
DecoratedKey	TokenNameIdentifier	 Decorated Key
lastWrittenKey	TokenNameIdentifier	 last Written Key
;	TokenNameSEMICOLON	
private	TokenNameprivate	
FileMark	TokenNameIdentifier	 File Mark
dataMark	TokenNameIdentifier	 data Mark
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
SSTableMetadata	TokenNameIdentifier	 SS Table Metadata
.	TokenNameDOT	
Collector	TokenNameIdentifier	 Collector
sstableMetadataCollector	TokenNameIdentifier	 sstable Metadata Collector
;	TokenNameSEMICOLON	
public	TokenNamepublic	
SSTableWriter	TokenNameIdentifier	 SS Table Writer
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
filename	TokenNameIdentifier	 filename
,	TokenNameCOMMA	
long	TokenNamelong	
keyCount	TokenNameIdentifier	 key Count
)	TokenNameRPAREN	
{	TokenNameLBRACE	
this	TokenNamethis	
(	TokenNameLPAREN	
filename	TokenNameIdentifier	 filename
,	TokenNameCOMMA	
keyCount	TokenNameIdentifier	 key Count
,	TokenNameCOMMA	
Schema	TokenNameIdentifier	 Schema
.	TokenNameDOT	
instance	TokenNameIdentifier	 instance
.	TokenNameDOT	
getCFMetaData	TokenNameIdentifier	 get CF Meta Data
(	TokenNameLPAREN	
Descriptor	TokenNameIdentifier	 Descriptor
.	TokenNameDOT	
fromFilename	TokenNameIdentifier	 from Filename
(	TokenNameLPAREN	
filename	TokenNameIdentifier	 filename
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
StorageService	TokenNameIdentifier	 Storage Service
.	TokenNameDOT	
getPartitioner	TokenNameIdentifier	 get Partitioner
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
SSTableMetadata	TokenNameIdentifier	 SS Table Metadata
.	TokenNameDOT	
createCollector	TokenNameIdentifier	 create Collector
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
Component	TokenNameIdentifier	 Component
>	TokenNameGREATER	
components	TokenNameIdentifier	 components
(	TokenNameLPAREN	
CFMetaData	TokenNameIdentifier	 CF Meta Data
metadata	TokenNameIdentifier	 metadata
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
Component	TokenNameIdentifier	 Component
>	TokenNameGREATER	
components	TokenNameIdentifier	 components
=	TokenNameEQUAL	
new	TokenNamenew	
HashSet	TokenNameIdentifier	 Hash Set
<	TokenNameLESS	
Component	TokenNameIdentifier	 Component
>	TokenNameGREATER	
(	TokenNameLPAREN	
Arrays	TokenNameIdentifier	 Arrays
.	TokenNameDOT	
asList	TokenNameIdentifier	 as List
(	TokenNameLPAREN	
Component	TokenNameIdentifier	 Component
.	TokenNameDOT	
DATA	TokenNameIdentifier	 DATA
,	TokenNameCOMMA	
Component	TokenNameIdentifier	 Component
.	TokenNameDOT	
PRIMARY_INDEX	TokenNameIdentifier	 PRIMARY  INDEX
,	TokenNameCOMMA	
Component	TokenNameIdentifier	 Component
.	TokenNameDOT	
STATS	TokenNameIdentifier	 STATS
,	TokenNameCOMMA	
Component	TokenNameIdentifier	 Component
.	TokenNameDOT	
SUMMARY	TokenNameIdentifier	 SUMMARY
,	TokenNameCOMMA	
Component	TokenNameIdentifier	 Component
.	TokenNameDOT	
TOC	TokenNameIdentifier	 TOC
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
metadata	TokenNameIdentifier	 metadata
.	TokenNameDOT	
getBloomFilterFpChance	TokenNameIdentifier	 get Bloom Filter Fp Chance
(	TokenNameLPAREN	
)	TokenNameRPAREN	
<	TokenNameLESS	
1.0	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
components	TokenNameIdentifier	 components
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
Component	TokenNameIdentifier	 Component
.	TokenNameDOT	
FILTER	TokenNameIdentifier	 FILTER
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
metadata	TokenNameIdentifier	 metadata
.	TokenNameDOT	
compressionParameters	TokenNameIdentifier	 compression Parameters
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
sstableCompressor	TokenNameIdentifier	 sstable Compressor
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
components	TokenNameIdentifier	 components
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
Component	TokenNameIdentifier	 Component
.	TokenNameDOT	
COMPRESSION_INFO	TokenNameIdentifier	 COMPRESSION  INFO
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
else	TokenNameelse	
// it would feel safer to actually add this component later in maybeWriteDigest(), 	TokenNameCOMMENT_LINE	it would feel safer to actually add this component later in maybeWriteDigest(), 
// but the components are unmodifiable after construction 	TokenNameCOMMENT_LINE	but the components are unmodifiable after construction 
components	TokenNameIdentifier	 components
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
Component	TokenNameIdentifier	 Component
.	TokenNameDOT	
DIGEST	TokenNameIdentifier	 DIGEST
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
components	TokenNameIdentifier	 components
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
SSTableWriter	TokenNameIdentifier	 SS Table Writer
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
filename	TokenNameIdentifier	 filename
,	TokenNameCOMMA	
long	TokenNamelong	
keyCount	TokenNameIdentifier	 key Count
,	TokenNameCOMMA	
CFMetaData	TokenNameIdentifier	 CF Meta Data
metadata	TokenNameIdentifier	 metadata
,	TokenNameCOMMA	
IPartitioner	TokenNameIdentifier	 I Partitioner
<	TokenNameLESS	
?	TokenNameQUESTION	
>	TokenNameGREATER	
partitioner	TokenNameIdentifier	 partitioner
,	TokenNameCOMMA	
SSTableMetadata	TokenNameIdentifier	 SS Table Metadata
.	TokenNameDOT	
Collector	TokenNameIdentifier	 Collector
sstableMetadataCollector	TokenNameIdentifier	 sstable Metadata Collector
)	TokenNameRPAREN	
{	TokenNameLBRACE	
super	TokenNamesuper	
(	TokenNameLPAREN	
Descriptor	TokenNameIdentifier	 Descriptor
.	TokenNameDOT	
fromFilename	TokenNameIdentifier	 from Filename
(	TokenNameLPAREN	
filename	TokenNameIdentifier	 filename
)	TokenNameRPAREN	
,	TokenNameCOMMA	
components	TokenNameIdentifier	 components
(	TokenNameLPAREN	
metadata	TokenNameIdentifier	 metadata
)	TokenNameRPAREN	
,	TokenNameCOMMA	
metadata	TokenNameIdentifier	 metadata
,	TokenNameCOMMA	
partitioner	TokenNameIdentifier	 partitioner
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
iwriter	TokenNameIdentifier	 iwriter
=	TokenNameEQUAL	
new	TokenNamenew	
IndexWriter	TokenNameIdentifier	 Index Writer
(	TokenNameLPAREN	
keyCount	TokenNameIdentifier	 key Count
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
compression	TokenNameIdentifier	 compression
)	TokenNameRPAREN	
{	TokenNameLBRACE	
dbuilder	TokenNameIdentifier	 dbuilder
=	TokenNameEQUAL	
SegmentedFile	TokenNameIdentifier	 Segmented File
.	TokenNameDOT	
getCompressedBuilder	TokenNameIdentifier	 get Compressed Builder
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
dataFile	TokenNameIdentifier	 data File
=	TokenNameEQUAL	
CompressedSequentialWriter	TokenNameIdentifier	 Compressed Sequential Writer
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
getFilename	TokenNameIdentifier	 get Filename
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
descriptor	TokenNameIdentifier	 descriptor
.	TokenNameDOT	
filenameFor	TokenNameIdentifier	 filename For
(	TokenNameLPAREN	
Component	TokenNameIdentifier	 Component
.	TokenNameDOT	
COMPRESSION_INFO	TokenNameIdentifier	 COMPRESSION  INFO
)	TokenNameRPAREN	
,	TokenNameCOMMA	
!	TokenNameNOT	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
.	TokenNameDOT	
populateIOCacheOnFlush	TokenNameIdentifier	 populate IO Cache On Flush
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
metadata	TokenNameIdentifier	 metadata
.	TokenNameDOT	
compressionParameters	TokenNameIdentifier	 compression Parameters
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
sstableMetadataCollector	TokenNameIdentifier	 sstable Metadata Collector
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
dbuilder	TokenNameIdentifier	 dbuilder
=	TokenNameEQUAL	
SegmentedFile	TokenNameIdentifier	 Segmented File
.	TokenNameDOT	
getBuilder	TokenNameIdentifier	 get Builder
(	TokenNameLPAREN	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
.	TokenNameDOT	
getDiskAccessMode	TokenNameIdentifier	 get Disk Access Mode
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
dataFile	TokenNameIdentifier	 data File
=	TokenNameEQUAL	
SequentialWriter	TokenNameIdentifier	 Sequential Writer
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
new	TokenNamenew	
File	TokenNameIdentifier	 File
(	TokenNameLPAREN	
getFilename	TokenNameIdentifier	 get Filename
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
!	TokenNameNOT	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
.	TokenNameDOT	
populateIOCacheOnFlush	TokenNameIdentifier	 populate IO Cache On Flush
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
setComputeDigest	TokenNameIdentifier	 set Compute Digest
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
this	TokenNamethis	
.	TokenNameDOT	
sstableMetadataCollector	TokenNameIdentifier	 sstable Metadata Collector
=	TokenNameEQUAL	
sstableMetadataCollector	TokenNameIdentifier	 sstable Metadata Collector
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
mark	TokenNameIdentifier	 mark
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
dataMark	TokenNameIdentifier	 data Mark
=	TokenNameEQUAL	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
mark	TokenNameIdentifier	 mark
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
iwriter	TokenNameIdentifier	 iwriter
.	TokenNameDOT	
mark	TokenNameIdentifier	 mark
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
resetAndTruncate	TokenNameIdentifier	 reset And Truncate
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
resetAndTruncate	TokenNameIdentifier	 reset And Truncate
(	TokenNameLPAREN	
dataMark	TokenNameIdentifier	 data Mark
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
iwriter	TokenNameIdentifier	 iwriter
.	TokenNameDOT	
resetAndTruncate	TokenNameIdentifier	 reset And Truncate
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Perform sanity checks on @param decoratedKey and @return the position in the data file before any data is written */	TokenNameCOMMENT_JAVADOC	 Perform sanity checks on @param decoratedKey and @return the position in the data file before any data is written 
private	TokenNameprivate	
long	TokenNamelong	
beforeAppend	TokenNameIdentifier	 before Append
(	TokenNameLPAREN	
DecoratedKey	TokenNameIdentifier	 Decorated Key
decoratedKey	TokenNameIdentifier	 decorated Key
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assert	TokenNameassert	
decoratedKey	TokenNameIdentifier	 decorated Key
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
:	TokenNameCOLON	
"Keys must not be null"	TokenNameStringLiteral	Keys must not be null
;	TokenNameSEMICOLON	
// empty keys ARE allowed b/c of indexed column values 	TokenNameCOMMENT_LINE	empty keys ARE allowed b/c of indexed column values 
if	TokenNameif	
(	TokenNameLPAREN	
lastWrittenKey	TokenNameIdentifier	 last Written Key
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
&&	TokenNameAND_AND	
lastWrittenKey	TokenNameIdentifier	 last Written Key
.	TokenNameDOT	
compareTo	TokenNameIdentifier	 compare To
(	TokenNameLPAREN	
decoratedKey	TokenNameIdentifier	 decorated Key
)	TokenNameRPAREN	
>=	TokenNameGREATER_EQUAL	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
"Last written key "	TokenNameStringLiteral	Last written key 
+	TokenNamePLUS	
lastWrittenKey	TokenNameIdentifier	 last Written Key
+	TokenNamePLUS	
" >= current key "	TokenNameStringLiteral	 >= current key 
+	TokenNamePLUS	
decoratedKey	TokenNameIdentifier	 decorated Key
+	TokenNamePLUS	
" writing into "	TokenNameStringLiteral	 writing into 
+	TokenNamePLUS	
getFilename	TokenNameIdentifier	 get Filename
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
(	TokenNameLPAREN	
lastWrittenKey	TokenNameIdentifier	 last Written Key
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
0	TokenNameIntegerLiteral	
:	TokenNameCOLON	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
getFilePointer	TokenNameIdentifier	 get File Pointer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
RowIndexEntry	TokenNameIdentifier	 Row Index Entry
afterAppend	TokenNameIdentifier	 after Append
(	TokenNameLPAREN	
DecoratedKey	TokenNameIdentifier	 Decorated Key
decoratedKey	TokenNameIdentifier	 decorated Key
,	TokenNameCOMMA	
long	TokenNamelong	
dataPosition	TokenNameIdentifier	 data Position
,	TokenNameCOMMA	
DeletionInfo	TokenNameIdentifier	 Deletion Info
delInfo	TokenNameIdentifier	 del Info
,	TokenNameCOMMA	
ColumnIndex	TokenNameIdentifier	 Column Index
index	TokenNameIdentifier	 index
)	TokenNameRPAREN	
{	TokenNameLBRACE	
lastWrittenKey	TokenNameIdentifier	 last Written Key
=	TokenNameEQUAL	
decoratedKey	TokenNameIdentifier	 decorated Key
;	TokenNameSEMICOLON	
last	TokenNameIdentifier	 last
=	TokenNameEQUAL	
lastWrittenKey	TokenNameIdentifier	 last Written Key
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
first	TokenNameIdentifier	 first
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
first	TokenNameIdentifier	 first
=	TokenNameEQUAL	
lastWrittenKey	TokenNameIdentifier	 last Written Key
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
isTraceEnabled	TokenNameIdentifier	 is Trace Enabled
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
trace	TokenNameIdentifier	 trace
(	TokenNameLPAREN	
"wrote "	TokenNameStringLiteral	wrote 
+	TokenNamePLUS	
decoratedKey	TokenNameIdentifier	 decorated Key
+	TokenNamePLUS	
" at "	TokenNameStringLiteral	 at 
+	TokenNamePLUS	
dataPosition	TokenNameIdentifier	 data Position
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
RowIndexEntry	TokenNameIdentifier	 Row Index Entry
entry	TokenNameIdentifier	 entry
=	TokenNameEQUAL	
RowIndexEntry	TokenNameIdentifier	 Row Index Entry
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
dataPosition	TokenNameIdentifier	 data Position
,	TokenNameCOMMA	
delInfo	TokenNameIdentifier	 del Info
,	TokenNameCOMMA	
index	TokenNameIdentifier	 index
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
iwriter	TokenNameIdentifier	 iwriter
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
decoratedKey	TokenNameIdentifier	 decorated Key
,	TokenNameCOMMA	
entry	TokenNameIdentifier	 entry
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
dbuilder	TokenNameIdentifier	 dbuilder
.	TokenNameDOT	
addPotentialBoundary	TokenNameIdentifier	 add Potential Boundary
(	TokenNameLPAREN	
dataPosition	TokenNameIdentifier	 data Position
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
entry	TokenNameIdentifier	 entry
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
RowIndexEntry	TokenNameIdentifier	 Row Index Entry
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
AbstractCompactedRow	TokenNameIdentifier	 Abstract Compacted Row
row	TokenNameIdentifier	 row
)	TokenNameRPAREN	
{	TokenNameLBRACE	
long	TokenNamelong	
currentPosition	TokenNameIdentifier	 current Position
=	TokenNameEQUAL	
beforeAppend	TokenNameIdentifier	 before Append
(	TokenNameLPAREN	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
key	TokenNameIdentifier	 key
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
writeWithShortLength	TokenNameIdentifier	 write With Short Length
(	TokenNameLPAREN	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
key	TokenNameIdentifier	 key
.	TokenNameDOT	
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
stream	TokenNameIdentifier	 stream
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
long	TokenNamelong	
dataStart	TokenNameIdentifier	 data Start
=	TokenNameEQUAL	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
getFilePointer	TokenNameIdentifier	 get File Pointer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
long	TokenNamelong	
dataSize	TokenNameIdentifier	 data Size
=	TokenNameEQUAL	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
write	TokenNameIdentifier	 write
(	TokenNameLPAREN	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
stream	TokenNameIdentifier	 stream
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assert	TokenNameassert	
dataSize	TokenNameIdentifier	 data Size
==	TokenNameEQUAL_EQUAL	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
getFilePointer	TokenNameIdentifier	 get File Pointer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
-	TokenNameMINUS	
(	TokenNameLPAREN	
dataStart	TokenNameIdentifier	 data Start
+	TokenNamePLUS	
8	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
:	TokenNameCOLON	
"incorrect row data size "	TokenNameStringLiteral	incorrect row data size 
+	TokenNamePLUS	
dataSize	TokenNameIdentifier	 data Size
+	TokenNamePLUS	
" written to "	TokenNameStringLiteral	 written to 
+	TokenNamePLUS	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
getPath	TokenNameIdentifier	 get Path
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
"; correct is "	TokenNameStringLiteral	; correct is 
+	TokenNamePLUS	
(	TokenNameLPAREN	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
getFilePointer	TokenNameIdentifier	 get File Pointer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
-	TokenNameMINUS	
(	TokenNameLPAREN	
dataStart	TokenNameIdentifier	 data Start
+	TokenNamePLUS	
8	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
IOException	TokenNameIdentifier	 IO Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
FSWriteError	TokenNameIdentifier	 FS Write Error
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
,	TokenNameCOMMA	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
getPath	TokenNameIdentifier	 get Path
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
sstableMetadataCollector	TokenNameIdentifier	 sstable Metadata Collector
.	TokenNameDOT	
update	TokenNameIdentifier	 update
(	TokenNameLPAREN	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
getFilePointer	TokenNameIdentifier	 get File Pointer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
-	TokenNameMINUS	
currentPosition	TokenNameIdentifier	 current Position
,	TokenNameCOMMA	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
columnStats	TokenNameIdentifier	 column Stats
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
afterAppend	TokenNameIdentifier	 after Append
(	TokenNameLPAREN	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
currentPosition	TokenNameIdentifier	 current Position
,	TokenNameCOMMA	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
deletionInfo	TokenNameIdentifier	 deletion Info
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
index	TokenNameIdentifier	 index
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
DecoratedKey	TokenNameIdentifier	 Decorated Key
decoratedKey	TokenNameIdentifier	 decorated Key
,	TokenNameCOMMA	
ColumnFamily	TokenNameIdentifier	 Column Family
cf	TokenNameIdentifier	 cf
)	TokenNameRPAREN	
{	TokenNameLBRACE	
long	TokenNamelong	
startPosition	TokenNameIdentifier	 start Position
=	TokenNameEQUAL	
beforeAppend	TokenNameIdentifier	 before Append
(	TokenNameLPAREN	
decoratedKey	TokenNameIdentifier	 decorated Key
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
writeWithShortLength	TokenNameIdentifier	 write With Short Length
(	TokenNameLPAREN	
decoratedKey	TokenNameIdentifier	 decorated Key
.	TokenNameDOT	
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
stream	TokenNameIdentifier	 stream
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Since the columnIndex may insert RangeTombstone marker, computing 	TokenNameCOMMENT_LINE	Since the columnIndex may insert RangeTombstone marker, computing 
// the size of the data is tricky. 	TokenNameCOMMENT_LINE	the size of the data is tricky. 
DataOutputBuffer	TokenNameIdentifier	 Data Output Buffer
buffer	TokenNameIdentifier	 buffer
=	TokenNameEQUAL	
new	TokenNamenew	
DataOutputBuffer	TokenNameIdentifier	 Data Output Buffer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// build column index && write columns 	TokenNameCOMMENT_LINE	build column index && write columns 
ColumnIndex	TokenNameIdentifier	 Column Index
.	TokenNameDOT	
Builder	TokenNameIdentifier	 Builder
builder	TokenNameIdentifier	 builder
=	TokenNameEQUAL	
new	TokenNamenew	
ColumnIndex	TokenNameIdentifier	 Column Index
.	TokenNameDOT	
Builder	TokenNameIdentifier	 Builder
(	TokenNameLPAREN	
cf	TokenNameIdentifier	 cf
,	TokenNameCOMMA	
decoratedKey	TokenNameIdentifier	 decorated Key
.	TokenNameDOT	
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
cf	TokenNameIdentifier	 cf
.	TokenNameDOT	
getColumnCount	TokenNameIdentifier	 get Column Count
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
buffer	TokenNameIdentifier	 buffer
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ColumnIndex	TokenNameIdentifier	 Column Index
index	TokenNameIdentifier	 index
=	TokenNameEQUAL	
builder	TokenNameIdentifier	 builder
.	TokenNameDOT	
build	TokenNameIdentifier	 build
(	TokenNameLPAREN	
cf	TokenNameIdentifier	 cf
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
TypeSizes	TokenNameIdentifier	 Type Sizes
typeSizes	TokenNameIdentifier	 type Sizes
=	TokenNameEQUAL	
TypeSizes	TokenNameIdentifier	 Type Sizes
.	TokenNameDOT	
NATIVE	TokenNameIdentifier	 NATIVE
;	TokenNameSEMICOLON	
long	TokenNamelong	
delSize	TokenNameIdentifier	 del Size
=	TokenNameEQUAL	
DeletionTime	TokenNameIdentifier	 Deletion Time
.	TokenNameDOT	
serializer	TokenNameIdentifier	 serializer
.	TokenNameDOT	
serializedSize	TokenNameIdentifier	 serialized Size
(	TokenNameLPAREN	
cf	TokenNameIdentifier	 cf
.	TokenNameDOT	
deletionInfo	TokenNameIdentifier	 deletion Info
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getTopLevelDeletion	TokenNameIdentifier	 get Top Level Deletion
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
typeSizes	TokenNameIdentifier	 type Sizes
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
stream	TokenNameIdentifier	 stream
.	TokenNameDOT	
writeLong	TokenNameIdentifier	 write Long
(	TokenNameLPAREN	
buffer	TokenNameIdentifier	 buffer
.	TokenNameDOT	
getLength	TokenNameIdentifier	 get Length
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
delSize	TokenNameIdentifier	 del Size
+	TokenNamePLUS	
typeSizes	TokenNameIdentifier	 type Sizes
.	TokenNameDOT	
sizeof	TokenNameIdentifier	 sizeof
(	TokenNameLPAREN	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Write deletion infos + column count 	TokenNameCOMMENT_LINE	Write deletion infos + column count 
DeletionInfo	TokenNameIdentifier	 Deletion Info
.	TokenNameDOT	
serializer	TokenNameIdentifier	 serializer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
serializeForSSTable	TokenNameIdentifier	 serialize For SS Table
(	TokenNameLPAREN	
cf	TokenNameIdentifier	 cf
.	TokenNameDOT	
deletionInfo	TokenNameIdentifier	 deletion Info
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
stream	TokenNameIdentifier	 stream
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
stream	TokenNameIdentifier	 stream
.	TokenNameDOT	
writeInt	TokenNameIdentifier	 write Int
(	TokenNameLPAREN	
builder	TokenNameIdentifier	 builder
.	TokenNameDOT	
writtenAtomCount	TokenNameIdentifier	 written Atom Count
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
stream	TokenNameIdentifier	 stream
.	TokenNameDOT	
write	TokenNameIdentifier	 write
(	TokenNameLPAREN	
buffer	TokenNameIdentifier	 buffer
.	TokenNameDOT	
getData	TokenNameIdentifier	 get Data
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
buffer	TokenNameIdentifier	 buffer
.	TokenNameDOT	
getLength	TokenNameIdentifier	 get Length
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
afterAppend	TokenNameIdentifier	 after Append
(	TokenNameLPAREN	
decoratedKey	TokenNameIdentifier	 decorated Key
,	TokenNameCOMMA	
startPosition	TokenNameIdentifier	 start Position
,	TokenNameCOMMA	
cf	TokenNameIdentifier	 cf
.	TokenNameDOT	
deletionInfo	TokenNameIdentifier	 deletion Info
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
index	TokenNameIdentifier	 index
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
IOException	TokenNameIdentifier	 IO Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
FSWriteError	TokenNameIdentifier	 FS Write Error
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
,	TokenNameCOMMA	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
getPath	TokenNameIdentifier	 get Path
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
sstableMetadataCollector	TokenNameIdentifier	 sstable Metadata Collector
.	TokenNameDOT	
update	TokenNameIdentifier	 update
(	TokenNameLPAREN	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
getFilePointer	TokenNameIdentifier	 get File Pointer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
-	TokenNameMINUS	
startPosition	TokenNameIdentifier	 start Position
,	TokenNameCOMMA	
cf	TokenNameIdentifier	 cf
.	TokenNameDOT	
getColumnStats	TokenNameIdentifier	 get Column Stats
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * @throws IOException if a read from the DataInput fails * @throws FSWriteError if a write to the dataFile fails */	TokenNameCOMMENT_JAVADOC	 @throws IOException if a read from the DataInput fails @throws FSWriteError if a write to the dataFile fails 
public	TokenNamepublic	
long	TokenNamelong	
appendFromStream	TokenNameIdentifier	 append From Stream
(	TokenNameLPAREN	
DecoratedKey	TokenNameIdentifier	 Decorated Key
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
CFMetaData	TokenNameIdentifier	 CF Meta Data
metadata	TokenNameIdentifier	 metadata
,	TokenNameCOMMA	
long	TokenNamelong	
dataSize	TokenNameIdentifier	 data Size
,	TokenNameCOMMA	
DataInput	TokenNameIdentifier	 Data Input
in	TokenNameIdentifier	 in
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
long	TokenNamelong	
currentPosition	TokenNameIdentifier	 current Position
=	TokenNameEQUAL	
beforeAppend	TokenNameIdentifier	 before Append
(	TokenNameLPAREN	
key	TokenNameIdentifier	 key
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
long	TokenNamelong	
dataStart	TokenNameIdentifier	 data Start
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
writeWithShortLength	TokenNameIdentifier	 write With Short Length
(	TokenNameLPAREN	
key	TokenNameIdentifier	 key
.	TokenNameDOT	
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
stream	TokenNameIdentifier	 stream
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
dataStart	TokenNameIdentifier	 data Start
=	TokenNameEQUAL	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
getFilePointer	TokenNameIdentifier	 get File Pointer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// write row size 	TokenNameCOMMENT_LINE	write row size 
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
stream	TokenNameIdentifier	 stream
.	TokenNameDOT	
writeLong	TokenNameIdentifier	 write Long
(	TokenNameLPAREN	
dataSize	TokenNameIdentifier	 data Size
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
IOException	TokenNameIdentifier	 IO Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
FSWriteError	TokenNameIdentifier	 FS Write Error
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
,	TokenNameCOMMA	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
getPath	TokenNameIdentifier	 get Path
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
DeletionInfo	TokenNameIdentifier	 Deletion Info
deletionInfo	TokenNameIdentifier	 deletion Info
=	TokenNameEQUAL	
DeletionInfo	TokenNameIdentifier	 Deletion Info
.	TokenNameDOT	
serializer	TokenNameIdentifier	 serializer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
deserializeFromSSTable	TokenNameIdentifier	 deserialize From SS Table
(	TokenNameLPAREN	
in	TokenNameIdentifier	 in
,	TokenNameCOMMA	
descriptor	TokenNameIdentifier	 descriptor
.	TokenNameDOT	
version	TokenNameIdentifier	 version
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
int	TokenNameint	
columnCount	TokenNameIdentifier	 column Count
=	TokenNameEQUAL	
in	TokenNameIdentifier	 in
.	TokenNameDOT	
readInt	TokenNameIdentifier	 read Int
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
DeletionInfo	TokenNameIdentifier	 Deletion Info
.	TokenNameDOT	
serializer	TokenNameIdentifier	 serializer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
serializeForSSTable	TokenNameIdentifier	 serialize For SS Table
(	TokenNameLPAREN	
deletionInfo	TokenNameIdentifier	 deletion Info
,	TokenNameCOMMA	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
stream	TokenNameIdentifier	 stream
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
stream	TokenNameIdentifier	 stream
.	TokenNameDOT	
writeInt	TokenNameIdentifier	 write Int
(	TokenNameLPAREN	
columnCount	TokenNameIdentifier	 column Count
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
IOException	TokenNameIdentifier	 IO Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
FSWriteError	TokenNameIdentifier	 FS Write Error
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
,	TokenNameCOMMA	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
getPath	TokenNameIdentifier	 get Path
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// deserialize each column to obtain maxTimestamp and immediately serialize it. 	TokenNameCOMMENT_LINE	deserialize each column to obtain maxTimestamp and immediately serialize it. 
long	TokenNamelong	
maxTimestamp	TokenNameIdentifier	 max Timestamp
=	TokenNameEQUAL	
Long	TokenNameIdentifier	 Long
.	TokenNameDOT	
MIN_VALUE	TokenNameIdentifier	 MIN  VALUE
;	TokenNameSEMICOLON	
StreamingHistogram	TokenNameIdentifier	 Streaming Histogram
tombstones	TokenNameIdentifier	 tombstones
=	TokenNameEQUAL	
new	TokenNamenew	
StreamingHistogram	TokenNameIdentifier	 Streaming Histogram
(	TokenNameLPAREN	
TOMBSTONE_HISTOGRAM_BIN_SIZE	TokenNameIdentifier	 TOMBSTONE  HISTOGRAM  BIN  SIZE
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ColumnFamily	TokenNameIdentifier	 Column Family
cf	TokenNameIdentifier	 cf
=	TokenNameEQUAL	
ColumnFamily	TokenNameIdentifier	 Column Family
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
metadata	TokenNameIdentifier	 metadata
,	TokenNameCOMMA	
ArrayBackedSortedColumns	TokenNameIdentifier	 Array Backed Sorted Columns
.	TokenNameDOT	
factory	TokenNameIdentifier	 factory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
cf	TokenNameIdentifier	 cf
.	TokenNameDOT	
delete	TokenNameIdentifier	 delete
(	TokenNameLPAREN	
deletionInfo	TokenNameIdentifier	 deletion Info
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ColumnIndex	TokenNameIdentifier	 Column Index
.	TokenNameDOT	
Builder	TokenNameIdentifier	 Builder
columnIndexer	TokenNameIdentifier	 column Indexer
=	TokenNameEQUAL	
new	TokenNamenew	
ColumnIndex	TokenNameIdentifier	 Column Index
.	TokenNameDOT	
Builder	TokenNameIdentifier	 Builder
(	TokenNameLPAREN	
cf	TokenNameIdentifier	 cf
,	TokenNameCOMMA	
key	TokenNameIdentifier	 key
.	TokenNameDOT	
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
columnCount	TokenNameIdentifier	 column Count
,	TokenNameCOMMA	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
stream	TokenNameIdentifier	 stream
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
OnDiskAtom	TokenNameIdentifier	 On Disk Atom
.	TokenNameDOT	
Serializer	TokenNameIdentifier	 Serializer
atomSerializer	TokenNameIdentifier	 atom Serializer
=	TokenNameEQUAL	
cf	TokenNameIdentifier	 cf
.	TokenNameDOT	
getOnDiskSerializer	TokenNameIdentifier	 get On Disk Serializer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
columnCount	TokenNameIdentifier	 column Count
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// deserialize column with PRESERVE_SIZE because we've written the dataSize based on the 	TokenNameCOMMENT_LINE	deserialize column with PRESERVE_SIZE because we've written the dataSize based on the 
// data size received, so we must reserialize the exact same data 	TokenNameCOMMENT_LINE	data size received, so we must reserialize the exact same data 
OnDiskAtom	TokenNameIdentifier	 On Disk Atom
atom	TokenNameIdentifier	 atom
=	TokenNameEQUAL	
atomSerializer	TokenNameIdentifier	 atom Serializer
.	TokenNameDOT	
deserializeFromSSTable	TokenNameIdentifier	 deserialize From SS Table
(	TokenNameLPAREN	
in	TokenNameIdentifier	 in
,	TokenNameCOMMA	
IColumnSerializer	TokenNameIdentifier	 I Column Serializer
.	TokenNameDOT	
Flag	TokenNameIdentifier	 Flag
.	TokenNameDOT	
PRESERVE_SIZE	TokenNameIdentifier	 PRESERVE  SIZE
,	TokenNameCOMMA	
Integer	TokenNameIdentifier	 Integer
.	TokenNameDOT	
MIN_VALUE	TokenNameIdentifier	 MIN  VALUE
,	TokenNameCOMMA	
Descriptor	TokenNameIdentifier	 Descriptor
.	TokenNameDOT	
Version	TokenNameIdentifier	 Version
.	TokenNameDOT	
CURRENT	TokenNameIdentifier	 CURRENT
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
atom	TokenNameIdentifier	 atom
instanceof	TokenNameinstanceof	
CounterColumn	TokenNameIdentifier	 Counter Column
)	TokenNameRPAREN	
{	TokenNameLBRACE	
atom	TokenNameIdentifier	 atom
=	TokenNameEQUAL	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
CounterColumn	TokenNameIdentifier	 Counter Column
)	TokenNameRPAREN	
atom	TokenNameIdentifier	 atom
)	TokenNameRPAREN	
.	TokenNameDOT	
markDeltaToBeCleared	TokenNameIdentifier	 mark Delta To Be Cleared
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
atom	TokenNameIdentifier	 atom
instanceof	TokenNameinstanceof	
SuperColumn	TokenNameIdentifier	 Super Column
)	TokenNameRPAREN	
{	TokenNameLBRACE	
SuperColumn	TokenNameIdentifier	 Super Column
sc	TokenNameIdentifier	 sc
=	TokenNameEQUAL	
(	TokenNameLPAREN	
SuperColumn	TokenNameIdentifier	 Super Column
)	TokenNameRPAREN	
atom	TokenNameIdentifier	 atom
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
IColumn	TokenNameIdentifier	 I Column
subColumn	TokenNameIdentifier	 sub Column
:	TokenNameCOLON	
sc	TokenNameIdentifier	 sc
.	TokenNameDOT	
getSubColumns	TokenNameIdentifier	 get Sub Columns
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
subColumn	TokenNameIdentifier	 sub Column
instanceof	TokenNameinstanceof	
CounterColumn	TokenNameIdentifier	 Counter Column
)	TokenNameRPAREN	
{	TokenNameLBRACE	
IColumn	TokenNameIdentifier	 I Column
marked	TokenNameIdentifier	 marked
=	TokenNameEQUAL	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
CounterColumn	TokenNameIdentifier	 Counter Column
)	TokenNameRPAREN	
subColumn	TokenNameIdentifier	 sub Column
)	TokenNameRPAREN	
.	TokenNameDOT	
markDeltaToBeCleared	TokenNameIdentifier	 mark Delta To Be Cleared
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sc	TokenNameIdentifier	 sc
.	TokenNameDOT	
replace	TokenNameIdentifier	 replace
(	TokenNameLPAREN	
subColumn	TokenNameIdentifier	 sub Column
,	TokenNameCOMMA	
marked	TokenNameIdentifier	 marked
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
int	TokenNameint	
deletionTime	TokenNameIdentifier	 deletion Time
=	TokenNameEQUAL	
atom	TokenNameIdentifier	 atom
.	TokenNameDOT	
getLocalDeletionTime	TokenNameIdentifier	 get Local Deletion Time
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
deletionTime	TokenNameIdentifier	 deletion Time
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
.	TokenNameDOT	
MAX_VALUE	TokenNameIdentifier	 MAX  VALUE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
tombstones	TokenNameIdentifier	 tombstones
.	TokenNameDOT	
update	TokenNameIdentifier	 update
(	TokenNameLPAREN	
deletionTime	TokenNameIdentifier	 deletion Time
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
maxTimestamp	TokenNameIdentifier	 max Timestamp
=	TokenNameEQUAL	
Math	TokenNameIdentifier	 Math
.	TokenNameDOT	
max	TokenNameIdentifier	 max
(	TokenNameLPAREN	
maxTimestamp	TokenNameIdentifier	 max Timestamp
,	TokenNameCOMMA	
atom	TokenNameIdentifier	 atom
.	TokenNameDOT	
maxTimestamp	TokenNameIdentifier	 max Timestamp
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
columnIndexer	TokenNameIdentifier	 column Indexer
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
atom	TokenNameIdentifier	 atom
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// This write the atom on disk too 	TokenNameCOMMENT_LINE	This write the atom on disk too 
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
IOException	TokenNameIdentifier	 IO Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
FSWriteError	TokenNameIdentifier	 FS Write Error
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
,	TokenNameCOMMA	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
getPath	TokenNameIdentifier	 get Path
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
assert	TokenNameassert	
dataSize	TokenNameIdentifier	 data Size
==	TokenNameEQUAL_EQUAL	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
getFilePointer	TokenNameIdentifier	 get File Pointer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
-	TokenNameMINUS	
(	TokenNameLPAREN	
dataStart	TokenNameIdentifier	 data Start
+	TokenNamePLUS	
8	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
:	TokenNameCOLON	
"incorrect row data size "	TokenNameStringLiteral	incorrect row data size 
+	TokenNamePLUS	
dataSize	TokenNameIdentifier	 data Size
+	TokenNamePLUS	
" written to "	TokenNameStringLiteral	 written to 
+	TokenNamePLUS	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
getPath	TokenNameIdentifier	 get Path
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
"; correct is "	TokenNameStringLiteral	; correct is 
+	TokenNamePLUS	
(	TokenNameLPAREN	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
getFilePointer	TokenNameIdentifier	 get File Pointer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
-	TokenNameMINUS	
(	TokenNameLPAREN	
dataStart	TokenNameIdentifier	 data Start
+	TokenNamePLUS	
8	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sstableMetadataCollector	TokenNameIdentifier	 sstable Metadata Collector
.	TokenNameDOT	
updateMaxTimestamp	TokenNameIdentifier	 update Max Timestamp
(	TokenNameLPAREN	
maxTimestamp	TokenNameIdentifier	 max Timestamp
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sstableMetadataCollector	TokenNameIdentifier	 sstable Metadata Collector
.	TokenNameDOT	
addRowSize	TokenNameIdentifier	 add Row Size
(	TokenNameLPAREN	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
getFilePointer	TokenNameIdentifier	 get File Pointer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
-	TokenNameMINUS	
currentPosition	TokenNameIdentifier	 current Position
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sstableMetadataCollector	TokenNameIdentifier	 sstable Metadata Collector
.	TokenNameDOT	
addColumnCount	TokenNameIdentifier	 add Column Count
(	TokenNameLPAREN	
columnCount	TokenNameIdentifier	 column Count
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sstableMetadataCollector	TokenNameIdentifier	 sstable Metadata Collector
.	TokenNameDOT	
mergeTombstoneHistogram	TokenNameIdentifier	 merge Tombstone Histogram
(	TokenNameLPAREN	
tombstones	TokenNameIdentifier	 tombstones
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
afterAppend	TokenNameIdentifier	 after Append
(	TokenNameLPAREN	
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
currentPosition	TokenNameIdentifier	 current Position
,	TokenNameCOMMA	
deletionInfo	TokenNameIdentifier	 deletion Info
,	TokenNameCOMMA	
columnIndexer	TokenNameIdentifier	 column Indexer
.	TokenNameDOT	
build	TokenNameIdentifier	 build
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
currentPosition	TokenNameIdentifier	 current Position
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * After failure, attempt to close the index writer and data file before deleting all temp components for the sstable */	TokenNameCOMMENT_JAVADOC	 After failure, attempt to close the index writer and data file before deleting all temp components for the sstable 
public	TokenNamepublic	
void	TokenNamevoid	
abort	TokenNameIdentifier	 abort
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assert	TokenNameassert	
descriptor	TokenNameIdentifier	 descriptor
.	TokenNameDOT	
temporary	TokenNameIdentifier	 temporary
;	TokenNameSEMICOLON	
FileUtils	TokenNameIdentifier	 File Utils
.	TokenNameDOT	
closeQuietly	TokenNameIdentifier	 close Quietly
(	TokenNameLPAREN	
iwriter	TokenNameIdentifier	 iwriter
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
FileUtils	TokenNameIdentifier	 File Utils
.	TokenNameDOT	
closeQuietly	TokenNameIdentifier	 close Quietly
(	TokenNameLPAREN	
dataFile	TokenNameIdentifier	 data File
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
Component	TokenNameIdentifier	 Component
>	TokenNameGREATER	
components	TokenNameIdentifier	 components
=	TokenNameEQUAL	
SSTable	TokenNameIdentifier	 SS Table
.	TokenNameDOT	
componentsFor	TokenNameIdentifier	 components For
(	TokenNameLPAREN	
descriptor	TokenNameIdentifier	 descriptor
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
components	TokenNameIdentifier	 components
.	TokenNameDOT	
isEmpty	TokenNameIdentifier	 is Empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
SSTable	TokenNameIdentifier	 SS Table
.	TokenNameDOT	
delete	TokenNameIdentifier	 delete
(	TokenNameLPAREN	
descriptor	TokenNameIdentifier	 descriptor
,	TokenNameCOMMA	
components	TokenNameIdentifier	 components
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
FSWriteError	TokenNameIdentifier	 FS Write Error
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
error	TokenNameIdentifier	 error
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"Failed deleting temp components for %s"	TokenNameStringLiteral	Failed deleting temp components for %s
,	TokenNameCOMMA	
descriptor	TokenNameIdentifier	 descriptor
)	TokenNameRPAREN	
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
throw	TokenNamethrow	
e	TokenNameIdentifier	 e
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
public	TokenNamepublic	
SSTableReader	TokenNameIdentifier	 SS Table Reader
closeAndOpenReader	TokenNameIdentifier	 close And Open Reader
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
closeAndOpenReader	TokenNameIdentifier	 close And Open Reader
(	TokenNameLPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
currentTimeMillis	TokenNameIdentifier	 current Time Millis
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
SSTableReader	TokenNameIdentifier	 SS Table Reader
closeAndOpenReader	TokenNameIdentifier	 close And Open Reader
(	TokenNameLPAREN	
long	TokenNamelong	
maxDataAge	TokenNameIdentifier	 max Data Age
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// index and filter 	TokenNameCOMMENT_LINE	index and filter 
iwriter	TokenNameIdentifier	 iwriter
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// main data, close will truncate if necessary 	TokenNameCOMMENT_LINE	main data, close will truncate if necessary 
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// write sstable statistics 	TokenNameCOMMENT_LINE	write sstable statistics 
SSTableMetadata	TokenNameIdentifier	 SS Table Metadata
sstableMetadata	TokenNameIdentifier	 sstable Metadata
=	TokenNameEQUAL	
sstableMetadataCollector	TokenNameIdentifier	 sstable Metadata Collector
.	TokenNameDOT	
finalizeMetadata	TokenNameIdentifier	 finalize Metadata
(	TokenNameLPAREN	
partitioner	TokenNameIdentifier	 partitioner
.	TokenNameDOT	
getClass	TokenNameIdentifier	 get Class
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getCanonicalName	TokenNameIdentifier	 get Canonical Name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
writeMetadata	TokenNameIdentifier	 write Metadata
(	TokenNameLPAREN	
descriptor	TokenNameIdentifier	 descriptor
,	TokenNameCOMMA	
sstableMetadata	TokenNameIdentifier	 sstable Metadata
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
maybeWriteDigest	TokenNameIdentifier	 maybe Write Digest
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// save the table of components 	TokenNameCOMMENT_LINE	save the table of components 
SSTable	TokenNameIdentifier	 SS Table
.	TokenNameDOT	
appendTOC	TokenNameIdentifier	 append TOC
(	TokenNameLPAREN	
descriptor	TokenNameIdentifier	 descriptor
,	TokenNameCOMMA	
components	TokenNameIdentifier	 components
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// remove the 'tmp' marker from all components 	TokenNameCOMMENT_LINE	remove the 'tmp' marker from all components 
final	TokenNamefinal	
Descriptor	TokenNameIdentifier	 Descriptor
newdesc	TokenNameIdentifier	 newdesc
=	TokenNameEQUAL	
rename	TokenNameIdentifier	 rename
(	TokenNameLPAREN	
descriptor	TokenNameIdentifier	 descriptor
,	TokenNameCOMMA	
components	TokenNameIdentifier	 components
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// finalize in-memory state for the reader 	TokenNameCOMMENT_LINE	finalize in-memory state for the reader 
SegmentedFile	TokenNameIdentifier	 Segmented File
ifile	TokenNameIdentifier	 ifile
=	TokenNameEQUAL	
iwriter	TokenNameIdentifier	 iwriter
.	TokenNameDOT	
builder	TokenNameIdentifier	 builder
.	TokenNameDOT	
complete	TokenNameIdentifier	 complete
(	TokenNameLPAREN	
newdesc	TokenNameIdentifier	 newdesc
.	TokenNameDOT	
filenameFor	TokenNameIdentifier	 filename For
(	TokenNameLPAREN	
SSTable	TokenNameIdentifier	 SS Table
.	TokenNameDOT	
COMPONENT_INDEX	TokenNameIdentifier	 COMPONENT  INDEX
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
SegmentedFile	TokenNameIdentifier	 Segmented File
dfile	TokenNameIdentifier	 dfile
=	TokenNameEQUAL	
dbuilder	TokenNameIdentifier	 dbuilder
.	TokenNameDOT	
complete	TokenNameIdentifier	 complete
(	TokenNameLPAREN	
newdesc	TokenNameIdentifier	 newdesc
.	TokenNameDOT	
filenameFor	TokenNameIdentifier	 filename For
(	TokenNameLPAREN	
SSTable	TokenNameIdentifier	 SS Table
.	TokenNameDOT	
COMPONENT_DATA	TokenNameIdentifier	 COMPONENT  DATA
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
SSTableReader	TokenNameIdentifier	 SS Table Reader
sstable	TokenNameIdentifier	 sstable
=	TokenNameEQUAL	
SSTableReader	TokenNameIdentifier	 SS Table Reader
.	TokenNameDOT	
internalOpen	TokenNameIdentifier	 internal Open
(	TokenNameLPAREN	
newdesc	TokenNameIdentifier	 newdesc
,	TokenNameCOMMA	
components	TokenNameIdentifier	 components
,	TokenNameCOMMA	
metadata	TokenNameIdentifier	 metadata
,	TokenNameCOMMA	
partitioner	TokenNameIdentifier	 partitioner
,	TokenNameCOMMA	
ifile	TokenNameIdentifier	 ifile
,	TokenNameCOMMA	
dfile	TokenNameIdentifier	 dfile
,	TokenNameCOMMA	
iwriter	TokenNameIdentifier	 iwriter
.	TokenNameDOT	
summary	TokenNameIdentifier	 summary
,	TokenNameCOMMA	
iwriter	TokenNameIdentifier	 iwriter
.	TokenNameDOT	
bf	TokenNameIdentifier	 bf
,	TokenNameCOMMA	
maxDataAge	TokenNameIdentifier	 max Data Age
,	TokenNameCOMMA	
sstableMetadata	TokenNameIdentifier	 sstable Metadata
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
first	TokenNameIdentifier	 first
=	TokenNameEQUAL	
getMinimalKey	TokenNameIdentifier	 get Minimal Key
(	TokenNameLPAREN	
first	TokenNameIdentifier	 first
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
last	TokenNameIdentifier	 last
=	TokenNameEQUAL	
getMinimalKey	TokenNameIdentifier	 get Minimal Key
(	TokenNameLPAREN	
last	TokenNameIdentifier	 last
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// try to save the summaries to disk 	TokenNameCOMMENT_LINE	try to save the summaries to disk 
SSTableReader	TokenNameIdentifier	 SS Table Reader
.	TokenNameDOT	
saveSummary	TokenNameIdentifier	 save Summary
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
,	TokenNameCOMMA	
iwriter	TokenNameIdentifier	 iwriter
.	TokenNameDOT	
builder	TokenNameIdentifier	 builder
,	TokenNameCOMMA	
dbuilder	TokenNameIdentifier	 dbuilder
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
iwriter	TokenNameIdentifier	 iwriter
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
dbuilder	TokenNameIdentifier	 dbuilder
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
sstable	TokenNameIdentifier	 sstable
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
maybeWriteDigest	TokenNameIdentifier	 maybe Write Digest
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
byte	TokenNamebyte	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
digest	TokenNameIdentifier	 digest
=	TokenNameEQUAL	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
digest	TokenNameIdentifier	 digest
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
digest	TokenNameIdentifier	 digest
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
return	TokenNamereturn	
;	TokenNameSEMICOLON	
SequentialWriter	TokenNameIdentifier	 Sequential Writer
out	TokenNameIdentifier	 out
=	TokenNameEQUAL	
SequentialWriter	TokenNameIdentifier	 Sequential Writer
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
new	TokenNamenew	
File	TokenNameIdentifier	 File
(	TokenNameLPAREN	
descriptor	TokenNameIdentifier	 descriptor
.	TokenNameDOT	
filenameFor	TokenNameIdentifier	 filename For
(	TokenNameLPAREN	
SSTable	TokenNameIdentifier	 SS Table
.	TokenNameDOT	
COMPONENT_DIGEST	TokenNameIdentifier	 COMPONENT  DIGEST
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Writting output compatible with sha1sum 	TokenNameCOMMENT_LINE	Writting output compatible with sha1sum 
Descriptor	TokenNameIdentifier	 Descriptor
newdesc	TokenNameIdentifier	 newdesc
=	TokenNameEQUAL	
descriptor	TokenNameIdentifier	 descriptor
.	TokenNameDOT	
asTemporary	TokenNameIdentifier	 as Temporary
(	TokenNameLPAREN	
false	TokenNamefalse	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
tmp	TokenNameIdentifier	 tmp
=	TokenNameEQUAL	
newdesc	TokenNameIdentifier	 newdesc
.	TokenNameDOT	
filenameFor	TokenNameIdentifier	 filename For
(	TokenNameLPAREN	
SSTable	TokenNameIdentifier	 SS Table
.	TokenNameDOT	
COMPONENT_DATA	TokenNameIdentifier	 COMPONENT  DATA
)	TokenNameRPAREN	
.	TokenNameDOT	
split	TokenNameIdentifier	 split
(	TokenNameLPAREN	
Pattern	TokenNameIdentifier	 Pattern
.	TokenNameDOT	
quote	TokenNameIdentifier	 quote
(	TokenNameLPAREN	
File	TokenNameIdentifier	 File
.	TokenNameDOT	
separator	TokenNameIdentifier	 separator
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
dataFileName	TokenNameIdentifier	 data File Name
=	TokenNameEQUAL	
tmp	TokenNameIdentifier	 tmp
[	TokenNameLBRACKET	
tmp	TokenNameIdentifier	 tmp
.	TokenNameDOT	
length	TokenNameIdentifier	 length
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
write	TokenNameIdentifier	 write
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"%s %s"	TokenNameStringLiteral	%s %s
,	TokenNameCOMMA	
Hex	TokenNameIdentifier	 Hex
.	TokenNameDOT	
bytesToHex	TokenNameIdentifier	 bytes To Hex
(	TokenNameLPAREN	
digest	TokenNameIdentifier	 digest
)	TokenNameRPAREN	
,	TokenNameCOMMA	
dataFileName	TokenNameIdentifier	 data File Name
)	TokenNameRPAREN	
.	TokenNameDOT	
getBytes	TokenNameIdentifier	 get Bytes
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
ClosedChannelException	TokenNameIdentifier	 Closed Channel Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
AssertionError	TokenNameIdentifier	 Assertion Error
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// can't happen. 	TokenNameCOMMENT_LINE	can't happen. 
}	TokenNameRBRACE	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
void	TokenNamevoid	
writeMetadata	TokenNameIdentifier	 write Metadata
(	TokenNameLPAREN	
Descriptor	TokenNameIdentifier	 Descriptor
desc	TokenNameIdentifier	 desc
,	TokenNameCOMMA	
SSTableMetadata	TokenNameIdentifier	 SS Table Metadata
sstableMetadata	TokenNameIdentifier	 sstable Metadata
)	TokenNameRPAREN	
{	TokenNameLBRACE	
SequentialWriter	TokenNameIdentifier	 Sequential Writer
out	TokenNameIdentifier	 out
=	TokenNameEQUAL	
SequentialWriter	TokenNameIdentifier	 Sequential Writer
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
new	TokenNamenew	
File	TokenNameIdentifier	 File
(	TokenNameLPAREN	
desc	TokenNameIdentifier	 desc
.	TokenNameDOT	
filenameFor	TokenNameIdentifier	 filename For
(	TokenNameLPAREN	
SSTable	TokenNameIdentifier	 SS Table
.	TokenNameDOT	
COMPONENT_STATS	TokenNameIdentifier	 COMPONENT  STATS
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
SSTableMetadata	TokenNameIdentifier	 SS Table Metadata
.	TokenNameDOT	
serializer	TokenNameIdentifier	 serializer
.	TokenNameDOT	
serialize	TokenNameIdentifier	 serialize
(	TokenNameLPAREN	
sstableMetadata	TokenNameIdentifier	 sstable Metadata
,	TokenNameCOMMA	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
stream	TokenNameIdentifier	 stream
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
IOException	TokenNameIdentifier	 IO Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
FSWriteError	TokenNameIdentifier	 FS Write Error
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
,	TokenNameCOMMA	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
getPath	TokenNameIdentifier	 get Path
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
static	TokenNamestatic	
Descriptor	TokenNameIdentifier	 Descriptor
rename	TokenNameIdentifier	 rename
(	TokenNameLPAREN	
Descriptor	TokenNameIdentifier	 Descriptor
tmpdesc	TokenNameIdentifier	 tmpdesc
,	TokenNameCOMMA	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
Component	TokenNameIdentifier	 Component
>	TokenNameGREATER	
components	TokenNameIdentifier	 components
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Descriptor	TokenNameIdentifier	 Descriptor
newdesc	TokenNameIdentifier	 newdesc
=	TokenNameEQUAL	
tmpdesc	TokenNameIdentifier	 tmpdesc
.	TokenNameDOT	
asTemporary	TokenNameIdentifier	 as Temporary
(	TokenNameLPAREN	
false	TokenNamefalse	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
rename	TokenNameIdentifier	 rename
(	TokenNameLPAREN	
tmpdesc	TokenNameIdentifier	 tmpdesc
,	TokenNameCOMMA	
newdesc	TokenNameIdentifier	 newdesc
,	TokenNameCOMMA	
components	TokenNameIdentifier	 components
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
newdesc	TokenNameIdentifier	 newdesc
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
void	TokenNamevoid	
rename	TokenNameIdentifier	 rename
(	TokenNameLPAREN	
Descriptor	TokenNameIdentifier	 Descriptor
tmpdesc	TokenNameIdentifier	 tmpdesc
,	TokenNameCOMMA	
Descriptor	TokenNameIdentifier	 Descriptor
newdesc	TokenNameIdentifier	 newdesc
,	TokenNameCOMMA	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
Component	TokenNameIdentifier	 Component
>	TokenNameGREATER	
components	TokenNameIdentifier	 components
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
Component	TokenNameIdentifier	 Component
component	TokenNameIdentifier	 component
:	TokenNameCOLON	
Sets	TokenNameIdentifier	 Sets
.	TokenNameDOT	
difference	TokenNameIdentifier	 difference
(	TokenNameLPAREN	
components	TokenNameIdentifier	 components
,	TokenNameCOMMA	
Sets	TokenNameIdentifier	 Sets
.	TokenNameDOT	
newHashSet	TokenNameIdentifier	 new Hash Set
(	TokenNameLPAREN	
Component	TokenNameIdentifier	 Component
.	TokenNameDOT	
DATA	TokenNameIdentifier	 DATA
,	TokenNameCOMMA	
Component	TokenNameIdentifier	 Component
.	TokenNameDOT	
SUMMARY	TokenNameIdentifier	 SUMMARY
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
FileUtils	TokenNameIdentifier	 File Utils
.	TokenNameDOT	
renameWithConfirm	TokenNameIdentifier	 rename With Confirm
(	TokenNameLPAREN	
tmpdesc	TokenNameIdentifier	 tmpdesc
.	TokenNameDOT	
filenameFor	TokenNameIdentifier	 filename For
(	TokenNameLPAREN	
component	TokenNameIdentifier	 component
)	TokenNameRPAREN	
,	TokenNameCOMMA	
newdesc	TokenNameIdentifier	 newdesc
.	TokenNameDOT	
filenameFor	TokenNameIdentifier	 filename For
(	TokenNameLPAREN	
component	TokenNameIdentifier	 component
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// do -Data last because -Data present should mean the sstable was completely renamed before crash 	TokenNameCOMMENT_LINE	do -Data last because -Data present should mean the sstable was completely renamed before crash 
FileUtils	TokenNameIdentifier	 File Utils
.	TokenNameDOT	
renameWithConfirm	TokenNameIdentifier	 rename With Confirm
(	TokenNameLPAREN	
tmpdesc	TokenNameIdentifier	 tmpdesc
.	TokenNameDOT	
filenameFor	TokenNameIdentifier	 filename For
(	TokenNameLPAREN	
Component	TokenNameIdentifier	 Component
.	TokenNameDOT	
DATA	TokenNameIdentifier	 DATA
)	TokenNameRPAREN	
,	TokenNameCOMMA	
newdesc	TokenNameIdentifier	 newdesc
.	TokenNameDOT	
filenameFor	TokenNameIdentifier	 filename For
(	TokenNameLPAREN	
Component	TokenNameIdentifier	 Component
.	TokenNameDOT	
DATA	TokenNameIdentifier	 DATA
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// rename it without confirmation because summary can be available for loadNewSSTables but not for closeAndOpenReader 	TokenNameCOMMENT_LINE	rename it without confirmation because summary can be available for loadNewSSTables but not for closeAndOpenReader 
FileUtils	TokenNameIdentifier	 File Utils
.	TokenNameDOT	
renameWithOutConfirm	TokenNameIdentifier	 rename With Out Confirm
(	TokenNameLPAREN	
tmpdesc	TokenNameIdentifier	 tmpdesc
.	TokenNameDOT	
filenameFor	TokenNameIdentifier	 filename For
(	TokenNameLPAREN	
Component	TokenNameIdentifier	 Component
.	TokenNameDOT	
SUMMARY	TokenNameIdentifier	 SUMMARY
)	TokenNameRPAREN	
,	TokenNameCOMMA	
newdesc	TokenNameIdentifier	 newdesc
.	TokenNameDOT	
filenameFor	TokenNameIdentifier	 filename For
(	TokenNameLPAREN	
Component	TokenNameIdentifier	 Component
.	TokenNameDOT	
SUMMARY	TokenNameIdentifier	 SUMMARY
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
long	TokenNamelong	
getFilePointer	TokenNameIdentifier	 get File Pointer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
getFilePointer	TokenNameIdentifier	 get File Pointer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
long	TokenNamelong	
getOnDiskFilePointer	TokenNameIdentifier	 get On Disk File Pointer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
dataFile	TokenNameIdentifier	 data File
.	TokenNameDOT	
getOnDiskFilePointer	TokenNameIdentifier	 get On Disk File Pointer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Encapsulates writing the index and filter for an SSTable. The state of this object is not valid until it has been closed. */	TokenNameCOMMENT_JAVADOC	 Encapsulates writing the index and filter for an SSTable. The state of this object is not valid until it has been closed. 
class	TokenNameclass	
IndexWriter	TokenNameIdentifier	 Index Writer
implements	TokenNameimplements	
Closeable	TokenNameIdentifier	 Closeable
{	TokenNameLBRACE	
private	TokenNameprivate	
final	TokenNamefinal	
SequentialWriter	TokenNameIdentifier	 Sequential Writer
indexFile	TokenNameIdentifier	 index File
;	TokenNameSEMICOLON	
public	TokenNamepublic	
final	TokenNamefinal	
SegmentedFile	TokenNameIdentifier	 Segmented File
.	TokenNameDOT	
Builder	TokenNameIdentifier	 Builder
builder	TokenNameIdentifier	 builder
;	TokenNameSEMICOLON	
public	TokenNamepublic	
final	TokenNamefinal	
IndexSummary	TokenNameIdentifier	 Index Summary
summary	TokenNameIdentifier	 summary
;	TokenNameSEMICOLON	
public	TokenNamepublic	
final	TokenNamefinal	
IFilter	TokenNameIdentifier	 I Filter
bf	TokenNameIdentifier	 bf
;	TokenNameSEMICOLON	
private	TokenNameprivate	
FileMark	TokenNameIdentifier	 File Mark
mark	TokenNameIdentifier	 mark
;	TokenNameSEMICOLON	
IndexWriter	TokenNameIdentifier	 Index Writer
(	TokenNameLPAREN	
long	TokenNamelong	
keyCount	TokenNameIdentifier	 key Count
)	TokenNameRPAREN	
{	TokenNameLBRACE	
indexFile	TokenNameIdentifier	 index File
=	TokenNameEQUAL	
SequentialWriter	TokenNameIdentifier	 Sequential Writer
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
new	TokenNamenew	
File	TokenNameIdentifier	 File
(	TokenNameLPAREN	
descriptor	TokenNameIdentifier	 descriptor
.	TokenNameDOT	
filenameFor	TokenNameIdentifier	 filename For
(	TokenNameLPAREN	
SSTable	TokenNameIdentifier	 SS Table
.	TokenNameDOT	
COMPONENT_INDEX	TokenNameIdentifier	 COMPONENT  INDEX
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
!	TokenNameNOT	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
.	TokenNameDOT	
populateIOCacheOnFlush	TokenNameIdentifier	 populate IO Cache On Flush
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
builder	TokenNameIdentifier	 builder
=	TokenNameEQUAL	
SegmentedFile	TokenNameIdentifier	 Segmented File
.	TokenNameDOT	
getBuilder	TokenNameIdentifier	 get Builder
(	TokenNameLPAREN	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
.	TokenNameDOT	
getIndexAccessMode	TokenNameIdentifier	 get Index Access Mode
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
summary	TokenNameIdentifier	 summary
=	TokenNameEQUAL	
new	TokenNamenew	
IndexSummary	TokenNameIdentifier	 Index Summary
(	TokenNameLPAREN	
keyCount	TokenNameIdentifier	 key Count
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
fpChance	TokenNameIdentifier	 fp Chance
=	TokenNameEQUAL	
metadata	TokenNameIdentifier	 metadata
.	TokenNameDOT	
getBloomFilterFpChance	TokenNameIdentifier	 get Bloom Filter Fp Chance
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
fpChance	TokenNameIdentifier	 fp Chance
==	TokenNameEQUAL_EQUAL	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// paranoia -- we've had bugs in the thrift <-> avro <-> CfDef dance before, let's not let that break things 	TokenNameCOMMENT_LINE	paranoia -- we've had bugs in the thrift <-> avro <-> CfDef dance before, let's not let that break things 
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
error	TokenNameIdentifier	 error
(	TokenNameLPAREN	
"Bloom filter FP chance of zero isn't supposed to happen"	TokenNameStringLiteral	Bloom filter FP chance of zero isn't supposed to happen
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
fpChance	TokenNameIdentifier	 fp Chance
=	TokenNameEQUAL	
0.01	TokenNameDoubleLiteral	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
bf	TokenNameIdentifier	 bf
=	TokenNameEQUAL	
FilterFactory	TokenNameIdentifier	 Filter Factory
.	TokenNameDOT	
getFilter	TokenNameIdentifier	 get Filter
(	TokenNameLPAREN	
keyCount	TokenNameIdentifier	 key Count
,	TokenNameCOMMA	
fpChance	TokenNameIdentifier	 fp Chance
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
DecoratedKey	TokenNameIdentifier	 Decorated Key
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
RowIndexEntry	TokenNameIdentifier	 Row Index Entry
indexEntry	TokenNameIdentifier	 index Entry
)	TokenNameRPAREN	
{	TokenNameLBRACE	
bf	TokenNameIdentifier	 bf
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
key	TokenNameIdentifier	 key
.	TokenNameDOT	
key	TokenNameIdentifier	 key
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
long	TokenNamelong	
indexPosition	TokenNameIdentifier	 index Position
=	TokenNameEQUAL	
indexFile	TokenNameIdentifier	 index File
.	TokenNameDOT	
getFilePointer	TokenNameIdentifier	 get File Pointer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
writeWithShortLength	TokenNameIdentifier	 write With Short Length
(	TokenNameLPAREN	
key	TokenNameIdentifier	 key
.	TokenNameDOT	
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
indexFile	TokenNameIdentifier	 index File
.	TokenNameDOT	
stream	TokenNameIdentifier	 stream
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
RowIndexEntry	TokenNameIdentifier	 Row Index Entry
.	TokenNameDOT	
serializer	TokenNameIdentifier	 serializer
.	TokenNameDOT	
serialize	TokenNameIdentifier	 serialize
(	TokenNameLPAREN	
indexEntry	TokenNameIdentifier	 index Entry
,	TokenNameCOMMA	
indexFile	TokenNameIdentifier	 index File
.	TokenNameDOT	
stream	TokenNameIdentifier	 stream
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
IOException	TokenNameIdentifier	 IO Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
FSWriteError	TokenNameIdentifier	 FS Write Error
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
,	TokenNameCOMMA	
indexFile	TokenNameIdentifier	 index File
.	TokenNameDOT	
getPath	TokenNameIdentifier	 get Path
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
isTraceEnabled	TokenNameIdentifier	 is Trace Enabled
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
trace	TokenNameIdentifier	 trace
(	TokenNameLPAREN	
"wrote index entry: "	TokenNameStringLiteral	wrote index entry: 
+	TokenNamePLUS	
indexEntry	TokenNameIdentifier	 index Entry
+	TokenNamePLUS	
" at "	TokenNameStringLiteral	 at 
+	TokenNamePLUS	
indexPosition	TokenNameIdentifier	 index Position
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
summary	TokenNameIdentifier	 summary
.	TokenNameDOT	
maybeAddEntry	TokenNameIdentifier	 maybe Add Entry
(	TokenNameLPAREN	
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
indexPosition	TokenNameIdentifier	 index Position
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
builder	TokenNameIdentifier	 builder
.	TokenNameDOT	
addPotentialBoundary	TokenNameIdentifier	 add Potential Boundary
(	TokenNameLPAREN	
indexPosition	TokenNameIdentifier	 index Position
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Closes the index and bloomfilter, making the public state of this writer valid for consumption. */	TokenNameCOMMENT_JAVADOC	 Closes the index and bloomfilter, making the public state of this writer valid for consumption. 
public	TokenNamepublic	
void	TokenNamevoid	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
components	TokenNameIdentifier	 components
.	TokenNameDOT	
contains	TokenNameIdentifier	 contains
(	TokenNameLPAREN	
Component	TokenNameIdentifier	 Component
.	TokenNameDOT	
FILTER	TokenNameIdentifier	 FILTER
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
path	TokenNameIdentifier	 path
=	TokenNameEQUAL	
descriptor	TokenNameIdentifier	 descriptor
.	TokenNameDOT	
filenameFor	TokenNameIdentifier	 filename For
(	TokenNameLPAREN	
SSTable	TokenNameIdentifier	 SS Table
.	TokenNameDOT	
COMPONENT_FILTER	TokenNameIdentifier	 COMPONENT  FILTER
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
// bloom filter 	TokenNameCOMMENT_LINE	bloom filter 
FileOutputStream	TokenNameIdentifier	 File Output Stream
fos	TokenNameIdentifier	 fos
=	TokenNameEQUAL	
new	TokenNamenew	
FileOutputStream	TokenNameIdentifier	 File Output Stream
(	TokenNameLPAREN	
path	TokenNameIdentifier	 path
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
DataOutputStream	TokenNameIdentifier	 Data Output Stream
stream	TokenNameIdentifier	 stream
=	TokenNameEQUAL	
new	TokenNamenew	
DataOutputStream	TokenNameIdentifier	 Data Output Stream
(	TokenNameLPAREN	
fos	TokenNameIdentifier	 fos
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
FilterFactory	TokenNameIdentifier	 Filter Factory
.	TokenNameDOT	
serialize	TokenNameIdentifier	 serialize
(	TokenNameLPAREN	
bf	TokenNameIdentifier	 bf
,	TokenNameCOMMA	
stream	TokenNameIdentifier	 stream
,	TokenNameCOMMA	
descriptor	TokenNameIdentifier	 descriptor
.	TokenNameDOT	
version	TokenNameIdentifier	 version
.	TokenNameDOT	
filterType	TokenNameIdentifier	 filter Type
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
stream	TokenNameIdentifier	 stream
.	TokenNameDOT	
flush	TokenNameIdentifier	 flush
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
fos	TokenNameIdentifier	 fos
.	TokenNameDOT	
getFD	TokenNameIdentifier	 get FD
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
sync	TokenNameIdentifier	 sync
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
stream	TokenNameIdentifier	 stream
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
IOException	TokenNameIdentifier	 IO Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
FSWriteError	TokenNameIdentifier	 FS Write Error
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
,	TokenNameCOMMA	
path	TokenNameIdentifier	 path
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
// index 	TokenNameCOMMENT_LINE	index 
long	TokenNamelong	
position	TokenNameIdentifier	 position
=	TokenNameEQUAL	
indexFile	TokenNameIdentifier	 index File
.	TokenNameDOT	
getFilePointer	TokenNameIdentifier	 get File Pointer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
indexFile	TokenNameIdentifier	 index File
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// calls force 	TokenNameCOMMENT_LINE	calls force 
FileUtils	TokenNameIdentifier	 File Utils
.	TokenNameDOT	
truncate	TokenNameIdentifier	 truncate
(	TokenNameLPAREN	
indexFile	TokenNameIdentifier	 index File
.	TokenNameDOT	
getPath	TokenNameIdentifier	 get Path
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
position	TokenNameIdentifier	 position
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// finalize in-memory index state 	TokenNameCOMMENT_LINE	finalize in-memory index state 
summary	TokenNameIdentifier	 summary
.	TokenNameDOT	
complete	TokenNameIdentifier	 complete
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
mark	TokenNameIdentifier	 mark
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
mark	TokenNameIdentifier	 mark
=	TokenNameEQUAL	
indexFile	TokenNameIdentifier	 index File
.	TokenNameDOT	
mark	TokenNameIdentifier	 mark
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
resetAndTruncate	TokenNameIdentifier	 reset And Truncate
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// we can't un-set the bloom filter addition, but extra keys in there are harmless. 	TokenNameCOMMENT_LINE	we can't un-set the bloom filter addition, but extra keys in there are harmless. 
// we can't reset dbuilder either, but that is the last thing called in afterappend so 	TokenNameCOMMENT_LINE	we can't reset dbuilder either, but that is the last thing called in afterappend so 
// we assume that if that worked then we won't be trying to reset. 	TokenNameCOMMENT_LINE	we assume that if that worked then we won't be trying to reset. 
indexFile	TokenNameIdentifier	 index File
.	TokenNameDOT	
resetAndTruncate	TokenNameIdentifier	 reset And Truncate
(	TokenNameLPAREN	
mark	TokenNameIdentifier	 mark
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
String	TokenNameIdentifier	 String
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
"IndexWriter("	TokenNameStringLiteral	IndexWriter(
+	TokenNamePLUS	
descriptor	TokenNameIdentifier	 descriptor
+	TokenNamePLUS	
")"	TokenNameStringLiteral	)
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
