/* * Licensed to the Apache Software Foundation (ASF) under one * or more contributor license agreements. See the NOTICE file * distributed with this work for additional information * regarding copyright ownership. The ASF licenses this file * to you under the Apache License, Version 2.0 (the * "License"); you may not use this file except in compliance * with the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */	TokenNameCOMMENT_BLOCK	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
hadoop	TokenNameIdentifier	 hadoop
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
IOException	TokenNameIdentifier	 IO Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
net	TokenNameIdentifier	 net
.	TokenNameDOT	
InetAddress	TokenNameIdentifier	 Inet Address
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
nio	TokenNameIdentifier	 nio
.	TokenNameDOT	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
ArrayList	TokenNameIdentifier	 Array List
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
Collections	TokenNameIdentifier	 Collections
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
List	TokenNameIdentifier	 List
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
Random	TokenNameIdentifier	 Random
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
SortedMap	TokenNameIdentifier	 Sorted Map
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
Callable	TokenNameIdentifier	 Callable
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
ExecutorService	TokenNameIdentifier	 Executor Service
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
Executors	TokenNameIdentifier	 Executors
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
Future	TokenNameIdentifier	 Future
;	TokenNameSEMICOLON	
import	TokenNameimport	
com	TokenNameIdentifier	 com
.	TokenNameDOT	
google	TokenNameIdentifier	 google
.	TokenNameDOT	
common	TokenNameIdentifier	 common
.	TokenNameDOT	
collect	TokenNameIdentifier	 collect
.	TokenNameDOT	
ImmutableList	TokenNameIdentifier	 Immutable List
;	TokenNameSEMICOLON	
import	TokenNameimport	
com	TokenNameIdentifier	 com
.	TokenNameDOT	
google	TokenNameIdentifier	 google
.	TokenNameDOT	
common	TokenNameIdentifier	 common
.	TokenNameDOT	
collect	TokenNameIdentifier	 collect
.	TokenNameDOT	
Lists	TokenNameIdentifier	 Lists
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
commons	TokenNameIdentifier	 commons
.	TokenNameDOT	
lang	TokenNameIdentifier	 lang
.	TokenNameDOT	
StringUtils	TokenNameIdentifier	 String Utils
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
TApplicationException	TokenNameIdentifier	 T Application Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
Logger	TokenNameIdentifier	 Logger
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
LoggerFactory	TokenNameIdentifier	 Logger Factory
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
IColumn	TokenNameIdentifier	 I Column
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
dht	TokenNameIdentifier	 dht
.	TokenNameDOT	
IPartitioner	TokenNameIdentifier	 I Partitioner
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
dht	TokenNameIdentifier	 dht
.	TokenNameDOT	
Range	TokenNameIdentifier	 Range
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
dht	TokenNameIdentifier	 dht
.	TokenNameDOT	
Token	TokenNameIdentifier	 Token
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
hadoop	TokenNameIdentifier	 hadoop
.	TokenNameDOT	
conf	TokenNameIdentifier	 conf
.	TokenNameDOT	
Configuration	TokenNameIdentifier	 Configuration
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
hadoop	TokenNameIdentifier	 hadoop
.	TokenNameDOT	
mapred	TokenNameIdentifier	 mapred
.	TokenNameDOT	
JobConf	TokenNameIdentifier	 Job Conf
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
hadoop	TokenNameIdentifier	 hadoop
.	TokenNameDOT	
mapred	TokenNameIdentifier	 mapred
.	TokenNameDOT	
Reporter	TokenNameIdentifier	 Reporter
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
hadoop	TokenNameIdentifier	 hadoop
.	TokenNameDOT	
mapreduce	TokenNameIdentifier	 mapreduce
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
TException	TokenNameIdentifier	 T Exception
;	TokenNameSEMICOLON	
/** * Hadoop InputFormat allowing map/reduce against Cassandra rows within one ColumnFamily. * * At minimum, you need to set the CF and predicate (description of columns to extract from each row) * in your Hadoop job Configuration. The ConfigHelper class is provided to make this * simple: * ConfigHelper.setInputColumnFamily * ConfigHelper.setInputSlicePredicate * * You can also configure the number of rows per InputSplit with * ConfigHelper.setInputSplitSize * This should be "as big as possible, but no bigger." Each InputSplit is read from Cassandra * with multiple get_slice_range queries, and the per-call overhead of get_slice_range is high, * so larger split sizes are better -- but if it is too large, you will run out of memory. * * The default split size is 64k rows. */	TokenNameCOMMENT_JAVADOC	 Hadoop InputFormat allowing map/reduce against Cassandra rows within one ColumnFamily. * At minimum, you need to set the CF and predicate (description of columns to extract from each row) in your Hadoop job Configuration. The ConfigHelper class is provided to make this simple: ConfigHelper.setInputColumnFamily ConfigHelper.setInputSlicePredicate * You can also configure the number of rows per InputSplit with ConfigHelper.setInputSplitSize This should be "as big as possible, but no bigger." Each InputSplit is read from Cassandra with multiple get_slice_range queries, and the per-call overhead of get_slice_range is high, so larger split sizes are better -- but if it is too large, you will run out of memory. * The default split size is 64k rows. 
public	TokenNamepublic	
class	TokenNameclass	
ColumnFamilyInputFormat	TokenNameIdentifier	 Column Family Input Format
extends	TokenNameextends	
InputFormat	TokenNameIdentifier	 Input Format
<	TokenNameLESS	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
,	TokenNameCOMMA	
SortedMap	TokenNameIdentifier	 Sorted Map
<	TokenNameLESS	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
,	TokenNameCOMMA	
IColumn	TokenNameIdentifier	 I Column
>>	TokenNameRIGHT_SHIFT	
implements	TokenNameimplements	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
hadoop	TokenNameIdentifier	 hadoop
.	TokenNameDOT	
mapred	TokenNameIdentifier	 mapred
.	TokenNameDOT	
InputFormat	TokenNameIdentifier	 Input Format
<	TokenNameLESS	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
,	TokenNameCOMMA	
SortedMap	TokenNameIdentifier	 Sorted Map
<	TokenNameLESS	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
,	TokenNameCOMMA	
IColumn	TokenNameIdentifier	 I Column
>>	TokenNameRIGHT_SHIFT	
{	TokenNameLBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
Logger	TokenNameIdentifier	 Logger
logger	TokenNameIdentifier	 logger
=	TokenNameEQUAL	
LoggerFactory	TokenNameIdentifier	 Logger Factory
.	TokenNameDOT	
getLogger	TokenNameIdentifier	 get Logger
(	TokenNameLPAREN	
ColumnFamilyInputFormat	TokenNameIdentifier	 Column Family Input Format
.	TokenNameDOT	
class	TokenNameclass	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
public	TokenNamepublic	
static	TokenNamestatic	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
MAPRED_TASK_ID	TokenNameIdentifier	 MAPRED  TASK  ID
=	TokenNameEQUAL	
"mapred.task.id"	TokenNameStringLiteral	mapred.task.id
;	TokenNameSEMICOLON	
// The simple fact that we need this is because the old Hadoop API wants us to "write" 	TokenNameCOMMENT_LINE	The simple fact that we need this is because the old Hadoop API wants us to "write" 
// to the key and value whereas the new asks for it. 	TokenNameCOMMENT_LINE	to the key and value whereas the new asks for it. 
// I choose 8kb as the default max key size (instanciated only once), but you can 	TokenNameCOMMENT_LINE	I choose 8kb as the default max key size (instanciated only once), but you can 
// override it in your jobConf with this setting. 	TokenNameCOMMENT_LINE	override it in your jobConf with this setting. 
public	TokenNamepublic	
static	TokenNamestatic	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
CASSANDRA_HADOOP_MAX_KEY_SIZE	TokenNameIdentifier	 CASSANDRA  HADOOP  MAX  KEY  SIZE
=	TokenNameEQUAL	
"cassandra.hadoop.max_key_size"	TokenNameStringLiteral	cassandra.hadoop.max_key_size
;	TokenNameSEMICOLON	
public	TokenNamepublic	
static	TokenNamestatic	
final	TokenNamefinal	
int	TokenNameint	
CASSANDRA_HADOOP_MAX_KEY_SIZE_DEFAULT	TokenNameIdentifier	 CASSANDRA  HADOOP  MAX  KEY  SIZE  DEFAULT
=	TokenNameEQUAL	
8192	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
private	TokenNameprivate	
String	TokenNameIdentifier	 String
keyspace	TokenNameIdentifier	 keyspace
;	TokenNameSEMICOLON	
private	TokenNameprivate	
String	TokenNameIdentifier	 String
cfName	TokenNameIdentifier	 cf Name
;	TokenNameSEMICOLON	
private	TokenNameprivate	
IPartitioner	TokenNameIdentifier	 I Partitioner
partitioner	TokenNameIdentifier	 partitioner
;	TokenNameSEMICOLON	
private	TokenNameprivate	
static	TokenNamestatic	
void	TokenNamevoid	
validateConfiguration	TokenNameIdentifier	 validate Configuration
(	TokenNameLPAREN	
Configuration	TokenNameIdentifier	 Configuration
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
ConfigHelper	TokenNameIdentifier	 Config Helper
.	TokenNameDOT	
getInputKeyspace	TokenNameIdentifier	 get Input Keyspace
(	TokenNameLPAREN	
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
||	TokenNameOR_OR	
ConfigHelper	TokenNameIdentifier	 Config Helper
.	TokenNameDOT	
getInputColumnFamily	TokenNameIdentifier	 get Input Column Family
(	TokenNameLPAREN	
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
UnsupportedOperationException	TokenNameIdentifier	 Unsupported Operation Exception
(	TokenNameLPAREN	
"you must set the keyspace and columnfamily with setInputColumnFamily()"	TokenNameStringLiteral	you must set the keyspace and columnfamily with setInputColumnFamily()
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
ConfigHelper	TokenNameIdentifier	 Config Helper
.	TokenNameDOT	
getInputSlicePredicate	TokenNameIdentifier	 get Input Slice Predicate
(	TokenNameLPAREN	
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
UnsupportedOperationException	TokenNameIdentifier	 Unsupported Operation Exception
(	TokenNameLPAREN	
"you must set the predicate with setInputSlicePredicate"	TokenNameStringLiteral	you must set the predicate with setInputSlicePredicate
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
ConfigHelper	TokenNameIdentifier	 Config Helper
.	TokenNameDOT	
getInputInitialAddress	TokenNameIdentifier	 get Input Initial Address
(	TokenNameLPAREN	
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
throw	TokenNamethrow	
new	TokenNamenew	
UnsupportedOperationException	TokenNameIdentifier	 Unsupported Operation Exception
(	TokenNameLPAREN	
"You must set the initial output address to a Cassandra node with setInputInitialAddress"	TokenNameStringLiteral	You must set the initial output address to a Cassandra node with setInputInitialAddress
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
ConfigHelper	TokenNameIdentifier	 Config Helper
.	TokenNameDOT	
getInputPartitioner	TokenNameIdentifier	 get Input Partitioner
(	TokenNameLPAREN	
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
throw	TokenNamethrow	
new	TokenNamenew	
UnsupportedOperationException	TokenNameIdentifier	 Unsupported Operation Exception
(	TokenNameLPAREN	
"You must set the Cassandra partitioner class with setInputPartitioner"	TokenNameStringLiteral	You must set the Cassandra partitioner class with setInputPartitioner
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
InputSplit	TokenNameIdentifier	 Input Split
>	TokenNameGREATER	
getSplits	TokenNameIdentifier	 get Splits
(	TokenNameLPAREN	
JobContext	TokenNameIdentifier	 Job Context
context	TokenNameIdentifier	 context
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
Configuration	TokenNameIdentifier	 Configuration
conf	TokenNameIdentifier	 conf
=	TokenNameEQUAL	
context	TokenNameIdentifier	 context
.	TokenNameDOT	
getConfiguration	TokenNameIdentifier	 get Configuration
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
validateConfiguration	TokenNameIdentifier	 validate Configuration
(	TokenNameLPAREN	
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// cannonical ranges and nodes holding replicas 	TokenNameCOMMENT_LINE	cannonical ranges and nodes holding replicas 
List	TokenNameIdentifier	 List
<	TokenNameLESS	
TokenRange	TokenNameIdentifier	 Token Range
>	TokenNameGREATER	
masterRangeNodes	TokenNameIdentifier	 master Range Nodes
=	TokenNameEQUAL	
getRangeMap	TokenNameIdentifier	 get Range Map
(	TokenNameLPAREN	
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
keyspace	TokenNameIdentifier	 keyspace
=	TokenNameEQUAL	
ConfigHelper	TokenNameIdentifier	 Config Helper
.	TokenNameDOT	
getInputKeyspace	TokenNameIdentifier	 get Input Keyspace
(	TokenNameLPAREN	
context	TokenNameIdentifier	 context
.	TokenNameDOT	
getConfiguration	TokenNameIdentifier	 get Configuration
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
cfName	TokenNameIdentifier	 cf Name
=	TokenNameEQUAL	
ConfigHelper	TokenNameIdentifier	 Config Helper
.	TokenNameDOT	
getInputColumnFamily	TokenNameIdentifier	 get Input Column Family
(	TokenNameLPAREN	
context	TokenNameIdentifier	 context
.	TokenNameDOT	
getConfiguration	TokenNameIdentifier	 get Configuration
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
partitioner	TokenNameIdentifier	 partitioner
=	TokenNameEQUAL	
ConfigHelper	TokenNameIdentifier	 Config Helper
.	TokenNameDOT	
getInputPartitioner	TokenNameIdentifier	 get Input Partitioner
(	TokenNameLPAREN	
context	TokenNameIdentifier	 context
.	TokenNameDOT	
getConfiguration	TokenNameIdentifier	 get Configuration
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"partitioner is "	TokenNameStringLiteral	partitioner is 
+	TokenNamePLUS	
partitioner	TokenNameIdentifier	 partitioner
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// cannonical ranges, split into pieces, fetching the splits in parallel 	TokenNameCOMMENT_LINE	cannonical ranges, split into pieces, fetching the splits in parallel 
ExecutorService	TokenNameIdentifier	 Executor Service
executor	TokenNameIdentifier	 executor
=	TokenNameEQUAL	
Executors	TokenNameIdentifier	 Executors
.	TokenNameDOT	
newCachedThreadPool	TokenNameIdentifier	 new Cached Thread Pool
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
InputSplit	TokenNameIdentifier	 Input Split
>	TokenNameGREATER	
splits	TokenNameIdentifier	 splits
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
InputSplit	TokenNameIdentifier	 Input Split
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Future	TokenNameIdentifier	 Future
<	TokenNameLESS	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
InputSplit	TokenNameIdentifier	 Input Split
>>>	TokenNameUNSIGNED_RIGHT_SHIFT	
splitfutures	TokenNameIdentifier	 splitfutures
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
Future	TokenNameIdentifier	 Future
<	TokenNameLESS	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
InputSplit	TokenNameIdentifier	 Input Split
>>>	TokenNameUNSIGNED_RIGHT_SHIFT	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
KeyRange	TokenNameIdentifier	 Key Range
jobKeyRange	TokenNameIdentifier	 job Key Range
=	TokenNameEQUAL	
ConfigHelper	TokenNameIdentifier	 Config Helper
.	TokenNameDOT	
getInputKeyRange	TokenNameIdentifier	 get Input Key Range
(	TokenNameLPAREN	
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Range	TokenNameIdentifier	 Range
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
jobRange	TokenNameIdentifier	 job Range
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
jobKeyRange	TokenNameIdentifier	 job Key Range
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
&&	TokenNameAND_AND	
jobKeyRange	TokenNameIdentifier	 job Key Range
.	TokenNameDOT	
start_token	TokenNameIdentifier	 start token
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assert	TokenNameassert	
partitioner	TokenNameIdentifier	 partitioner
.	TokenNameDOT	
preservesOrder	TokenNameIdentifier	 preserves Order
(	TokenNameLPAREN	
)	TokenNameRPAREN	
:	TokenNameCOLON	
"ConfigHelper.setInputKeyRange(..) can only be used with a order preserving paritioner"	TokenNameStringLiteral	ConfigHelper.setInputKeyRange(..) can only be used with a order preserving paritioner
;	TokenNameSEMICOLON	
assert	TokenNameassert	
jobKeyRange	TokenNameIdentifier	 job Key Range
.	TokenNameDOT	
start_key	TokenNameIdentifier	 start key
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
:	TokenNameCOLON	
"only start_token supported"	TokenNameStringLiteral	only start_token supported
;	TokenNameSEMICOLON	
assert	TokenNameassert	
jobKeyRange	TokenNameIdentifier	 job Key Range
.	TokenNameDOT	
end_key	TokenNameIdentifier	 end key
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
:	TokenNameCOLON	
"only end_token supported"	TokenNameStringLiteral	only end_token supported
;	TokenNameSEMICOLON	
jobRange	TokenNameIdentifier	 job Range
=	TokenNameEQUAL	
new	TokenNamenew	
Range	TokenNameIdentifier	 Range
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
(	TokenNameLPAREN	
partitioner	TokenNameIdentifier	 partitioner
.	TokenNameDOT	
getTokenFactory	TokenNameIdentifier	 get Token Factory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
fromString	TokenNameIdentifier	 from String
(	TokenNameLPAREN	
jobKeyRange	TokenNameIdentifier	 job Key Range
.	TokenNameDOT	
start_token	TokenNameIdentifier	 start token
)	TokenNameRPAREN	
,	TokenNameCOMMA	
partitioner	TokenNameIdentifier	 partitioner
.	TokenNameDOT	
getTokenFactory	TokenNameIdentifier	 get Token Factory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
fromString	TokenNameIdentifier	 from String
(	TokenNameLPAREN	
jobKeyRange	TokenNameIdentifier	 job Key Range
.	TokenNameDOT	
end_token	TokenNameIdentifier	 end token
)	TokenNameRPAREN	
,	TokenNameCOMMA	
partitioner	TokenNameIdentifier	 partitioner
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
TokenRange	TokenNameIdentifier	 Token Range
range	TokenNameIdentifier	 range
:	TokenNameCOLON	
masterRangeNodes	TokenNameIdentifier	 master Range Nodes
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
jobRange	TokenNameIdentifier	 job Range
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// for each range, pick a live owner and ask it to compute bite-sized splits 	TokenNameCOMMENT_LINE	for each range, pick a live owner and ask it to compute bite-sized splits 
splitfutures	TokenNameIdentifier	 splitfutures
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
executor	TokenNameIdentifier	 executor
.	TokenNameDOT	
submit	TokenNameIdentifier	 submit
(	TokenNameLPAREN	
new	TokenNamenew	
SplitCallable	TokenNameIdentifier	 Split Callable
(	TokenNameLPAREN	
range	TokenNameIdentifier	 range
,	TokenNameCOMMA	
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
Range	TokenNameIdentifier	 Range
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
dhtRange	TokenNameIdentifier	 dht Range
=	TokenNameEQUAL	
new	TokenNamenew	
Range	TokenNameIdentifier	 Range
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
(	TokenNameLPAREN	
partitioner	TokenNameIdentifier	 partitioner
.	TokenNameDOT	
getTokenFactory	TokenNameIdentifier	 get Token Factory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
fromString	TokenNameIdentifier	 from String
(	TokenNameLPAREN	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
start_token	TokenNameIdentifier	 start token
)	TokenNameRPAREN	
,	TokenNameCOMMA	
partitioner	TokenNameIdentifier	 partitioner
.	TokenNameDOT	
getTokenFactory	TokenNameIdentifier	 get Token Factory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
fromString	TokenNameIdentifier	 from String
(	TokenNameLPAREN	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
end_token	TokenNameIdentifier	 end token
)	TokenNameRPAREN	
,	TokenNameCOMMA	
partitioner	TokenNameIdentifier	 partitioner
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
dhtRange	TokenNameIdentifier	 dht Range
.	TokenNameDOT	
intersects	TokenNameIdentifier	 intersects
(	TokenNameLPAREN	
jobRange	TokenNameIdentifier	 job Range
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
Range	TokenNameIdentifier	 Range
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
intersection	TokenNameIdentifier	 intersection
:	TokenNameCOLON	
dhtRange	TokenNameIdentifier	 dht Range
.	TokenNameDOT	
intersectionWith	TokenNameIdentifier	 intersection With
(	TokenNameLPAREN	
jobRange	TokenNameIdentifier	 job Range
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
start_token	TokenNameIdentifier	 start token
=	TokenNameEQUAL	
partitioner	TokenNameIdentifier	 partitioner
.	TokenNameDOT	
getTokenFactory	TokenNameIdentifier	 get Token Factory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
intersection	TokenNameIdentifier	 intersection
.	TokenNameDOT	
left	TokenNameIdentifier	 left
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
end_token	TokenNameIdentifier	 end token
=	TokenNameEQUAL	
partitioner	TokenNameIdentifier	 partitioner
.	TokenNameDOT	
getTokenFactory	TokenNameIdentifier	 get Token Factory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
intersection	TokenNameIdentifier	 intersection
.	TokenNameDOT	
right	TokenNameIdentifier	 right
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// for each range, pick a live owner and ask it to compute bite-sized splits 	TokenNameCOMMENT_LINE	for each range, pick a live owner and ask it to compute bite-sized splits 
splitfutures	TokenNameIdentifier	 splitfutures
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
executor	TokenNameIdentifier	 executor
.	TokenNameDOT	
submit	TokenNameIdentifier	 submit
(	TokenNameLPAREN	
new	TokenNamenew	
SplitCallable	TokenNameIdentifier	 Split Callable
(	TokenNameLPAREN	
range	TokenNameIdentifier	 range
,	TokenNameCOMMA	
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
// wait until we have all the results back 	TokenNameCOMMENT_LINE	wait until we have all the results back 
for	TokenNamefor	
(	TokenNameLPAREN	
Future	TokenNameIdentifier	 Future
<	TokenNameLESS	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
InputSplit	TokenNameIdentifier	 Input Split
>>	TokenNameRIGHT_SHIFT	
futureInputSplits	TokenNameIdentifier	 future Input Splits
:	TokenNameCOLON	
splitfutures	TokenNameIdentifier	 splitfutures
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
splits	TokenNameIdentifier	 splits
.	TokenNameDOT	
addAll	TokenNameIdentifier	 add All
(	TokenNameLPAREN	
futureInputSplits	TokenNameIdentifier	 future Input Splits
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
Exception	TokenNameIdentifier	 Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
IOException	TokenNameIdentifier	 IO Exception
(	TokenNameLPAREN	
"Could not get input splits"	TokenNameStringLiteral	Could not get input splits
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
finally	TokenNamefinally	
{	TokenNameLBRACE	
executor	TokenNameIdentifier	 executor
.	TokenNameDOT	
shutdownNow	TokenNameIdentifier	 shutdown Now
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
assert	TokenNameassert	
splits	TokenNameIdentifier	 splits
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
>	TokenNameGREATER	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
shuffle	TokenNameIdentifier	 shuffle
(	TokenNameLPAREN	
splits	TokenNameIdentifier	 splits
,	TokenNameCOMMA	
new	TokenNamenew	
Random	TokenNameIdentifier	 Random
(	TokenNameLPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
nanoTime	TokenNameIdentifier	 nano Time
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
splits	TokenNameIdentifier	 splits
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Gets a token range and splits it up according to the suggested * size into input splits that Hadoop can use. */	TokenNameCOMMENT_JAVADOC	 Gets a token range and splits it up according to the suggested size into input splits that Hadoop can use. 
class	TokenNameclass	
SplitCallable	TokenNameIdentifier	 Split Callable
implements	TokenNameimplements	
Callable	TokenNameIdentifier	 Callable
<	TokenNameLESS	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
InputSplit	TokenNameIdentifier	 Input Split
>>	TokenNameRIGHT_SHIFT	
{	TokenNameLBRACE	
private	TokenNameprivate	
final	TokenNamefinal	
TokenRange	TokenNameIdentifier	 Token Range
range	TokenNameIdentifier	 range
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
Configuration	TokenNameIdentifier	 Configuration
conf	TokenNameIdentifier	 conf
;	TokenNameSEMICOLON	
public	TokenNamepublic	
SplitCallable	TokenNameIdentifier	 Split Callable
(	TokenNameLPAREN	
TokenRange	TokenNameIdentifier	 Token Range
tr	TokenNameIdentifier	 tr
,	TokenNameCOMMA	
Configuration	TokenNameIdentifier	 Configuration
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
{	TokenNameLBRACE	
this	TokenNamethis	
.	TokenNameDOT	
range	TokenNameIdentifier	 range
=	TokenNameEQUAL	
tr	TokenNameIdentifier	 tr
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
conf	TokenNameIdentifier	 conf
=	TokenNameEQUAL	
conf	TokenNameIdentifier	 conf
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
InputSplit	TokenNameIdentifier	 Input Split
>	TokenNameGREATER	
call	TokenNameIdentifier	 call
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
InputSplit	TokenNameIdentifier	 Input Split
>	TokenNameGREATER	
splits	TokenNameIdentifier	 splits
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
InputSplit	TokenNameIdentifier	 Input Split
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
CfSplit	TokenNameIdentifier	 Cf Split
>	TokenNameGREATER	
subSplits	TokenNameIdentifier	 sub Splits
=	TokenNameEQUAL	
getSubSplits	TokenNameIdentifier	 get Sub Splits
(	TokenNameLPAREN	
keyspace	TokenNameIdentifier	 keyspace
,	TokenNameCOMMA	
cfName	TokenNameIdentifier	 cf Name
,	TokenNameCOMMA	
range	TokenNameIdentifier	 range
,	TokenNameCOMMA	
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assert	TokenNameassert	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
rpc_endpoints	TokenNameIdentifier	 rpc endpoints
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
endpoints	TokenNameIdentifier	 endpoints
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
:	TokenNameCOLON	
"rpc_endpoints size must match endpoints size"	TokenNameStringLiteral	rpc_endpoints size must match endpoints size
;	TokenNameSEMICOLON	
// turn the sub-ranges into InputSplits 	TokenNameCOMMENT_LINE	turn the sub-ranges into InputSplits 
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
endpoints	TokenNameIdentifier	 endpoints
=	TokenNameEQUAL	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
endpoints	TokenNameIdentifier	 endpoints
.	TokenNameDOT	
toArray	TokenNameIdentifier	 to Array
(	TokenNameLPAREN	
new	TokenNamenew	
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
endpoints	TokenNameIdentifier	 endpoints
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// hadoop needs hostname, not ip 	TokenNameCOMMENT_LINE	hadoop needs hostname, not ip 
int	TokenNameint	
endpointIndex	TokenNameIdentifier	 endpoint Index
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
endpoint	TokenNameIdentifier	 endpoint
:	TokenNameCOLON	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
rpc_endpoints	TokenNameIdentifier	 rpc endpoints
)	TokenNameRPAREN	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
endpoint_address	TokenNameIdentifier	 endpoint address
=	TokenNameEQUAL	
endpoint	TokenNameIdentifier	 endpoint
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
endpoint_address	TokenNameIdentifier	 endpoint address
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
||	TokenNameOR_OR	
endpoint_address	TokenNameIdentifier	 endpoint address
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
"0.0.0.0"	TokenNameStringLiteral	0.0.0.0
)	TokenNameRPAREN	
)	TokenNameRPAREN	
endpoint_address	TokenNameIdentifier	 endpoint address
=	TokenNameEQUAL	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
endpoints	TokenNameIdentifier	 endpoints
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
endpointIndex	TokenNameIdentifier	 endpoint Index
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
endpoints	TokenNameIdentifier	 endpoints
[	TokenNameLBRACKET	
endpointIndex	TokenNameIdentifier	 endpoint Index
++	TokenNamePLUS_PLUS	
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
InetAddress	TokenNameIdentifier	 Inet Address
.	TokenNameDOT	
getByName	TokenNameIdentifier	 get By Name
(	TokenNameLPAREN	
endpoint_address	TokenNameIdentifier	 endpoint address
)	TokenNameRPAREN	
.	TokenNameDOT	
getHostName	TokenNameIdentifier	 get Host Name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
Token	TokenNameIdentifier	 Token
.	TokenNameDOT	
TokenFactory	TokenNameIdentifier	 Token Factory
factory	TokenNameIdentifier	 factory
=	TokenNameEQUAL	
partitioner	TokenNameIdentifier	 partitioner
.	TokenNameDOT	
getTokenFactory	TokenNameIdentifier	 get Token Factory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
CfSplit	TokenNameIdentifier	 Cf Split
subSplit	TokenNameIdentifier	 sub Split
:	TokenNameCOLON	
subSplits	TokenNameIdentifier	 sub Splits
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Token	TokenNameIdentifier	 Token
left	TokenNameIdentifier	 left
=	TokenNameEQUAL	
factory	TokenNameIdentifier	 factory
.	TokenNameDOT	
fromString	TokenNameIdentifier	 from String
(	TokenNameLPAREN	
subSplit	TokenNameIdentifier	 sub Split
.	TokenNameDOT	
getStart_token	TokenNameIdentifier	 get Start token
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Token	TokenNameIdentifier	 Token
right	TokenNameIdentifier	 right
=	TokenNameEQUAL	
factory	TokenNameIdentifier	 factory
.	TokenNameDOT	
fromString	TokenNameIdentifier	 from String
(	TokenNameLPAREN	
subSplit	TokenNameIdentifier	 sub Split
.	TokenNameDOT	
getEnd_token	TokenNameIdentifier	 get End token
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Range	TokenNameIdentifier	 Range
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
range	TokenNameIdentifier	 range
=	TokenNameEQUAL	
new	TokenNamenew	
Range	TokenNameIdentifier	 Range
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
(	TokenNameLPAREN	
left	TokenNameIdentifier	 left
,	TokenNameCOMMA	
right	TokenNameIdentifier	 right
,	TokenNameCOMMA	
partitioner	TokenNameIdentifier	 partitioner
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Range	TokenNameIdentifier	 Range
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>>	TokenNameRIGHT_SHIFT	
ranges	TokenNameIdentifier	 ranges
=	TokenNameEQUAL	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
isWrapAround	TokenNameIdentifier	 is Wrap Around
(	TokenNameLPAREN	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
unwrap	TokenNameIdentifier	 unwrap
(	TokenNameLPAREN	
)	TokenNameRPAREN	
:	TokenNameCOLON	
ImmutableList	TokenNameIdentifier	 Immutable List
.	TokenNameDOT	
of	TokenNameIdentifier	 of
(	TokenNameLPAREN	
range	TokenNameIdentifier	 range
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
Range	TokenNameIdentifier	 Range
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
subrange	TokenNameIdentifier	 subrange
:	TokenNameCOLON	
ranges	TokenNameIdentifier	 ranges
)	TokenNameRPAREN	
{	TokenNameLBRACE	
ColumnFamilySplit	TokenNameIdentifier	 Column Family Split
split	TokenNameIdentifier	 split
=	TokenNameEQUAL	
new	TokenNamenew	
ColumnFamilySplit	TokenNameIdentifier	 Column Family Split
(	TokenNameLPAREN	
factory	TokenNameIdentifier	 factory
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
subrange	TokenNameIdentifier	 subrange
.	TokenNameDOT	
left	TokenNameIdentifier	 left
)	TokenNameRPAREN	
,	TokenNameCOMMA	
factory	TokenNameIdentifier	 factory
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
subrange	TokenNameIdentifier	 subrange
.	TokenNameDOT	
right	TokenNameIdentifier	 right
)	TokenNameRPAREN	
,	TokenNameCOMMA	
subSplit	TokenNameIdentifier	 sub Split
.	TokenNameDOT	
getRow_count	TokenNameIdentifier	 get Row count
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
endpoints	TokenNameIdentifier	 endpoints
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"adding "	TokenNameStringLiteral	adding 
+	TokenNamePLUS	
split	TokenNameIdentifier	 split
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
splits	TokenNameIdentifier	 splits
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
split	TokenNameIdentifier	 split
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
return	TokenNamereturn	
splits	TokenNameIdentifier	 splits
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
CfSplit	TokenNameIdentifier	 Cf Split
>	TokenNameGREATER	
getSubSplits	TokenNameIdentifier	 get Sub Splits
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
keyspace	TokenNameIdentifier	 keyspace
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
cfName	TokenNameIdentifier	 cf Name
,	TokenNameCOMMA	
TokenRange	TokenNameIdentifier	 Token Range
range	TokenNameIdentifier	 range
,	TokenNameCOMMA	
Configuration	TokenNameIdentifier	 Configuration
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
int	TokenNameint	
splitsize	TokenNameIdentifier	 splitsize
=	TokenNameEQUAL	
ConfigHelper	TokenNameIdentifier	 Config Helper
.	TokenNameDOT	
getInputSplitSize	TokenNameIdentifier	 get Input Split Size
(	TokenNameLPAREN	
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
rpc_endpoints	TokenNameIdentifier	 rpc endpoints
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
host	TokenNameIdentifier	 host
=	TokenNameEQUAL	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
rpc_endpoints	TokenNameIdentifier	 rpc endpoints
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
host	TokenNameIdentifier	 host
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
||	TokenNameOR_OR	
host	TokenNameIdentifier	 host
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
"0.0.0.0"	TokenNameStringLiteral	0.0.0.0
)	TokenNameRPAREN	
)	TokenNameRPAREN	
host	TokenNameIdentifier	 host
=	TokenNameEQUAL	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
endpoints	TokenNameIdentifier	 endpoints
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
Cassandra	TokenNameIdentifier	 Cassandra
.	TokenNameDOT	
Client	TokenNameIdentifier	 Client
client	TokenNameIdentifier	 client
=	TokenNameEQUAL	
ConfigHelper	TokenNameIdentifier	 Config Helper
.	TokenNameDOT	
createConnection	TokenNameIdentifier	 create Connection
(	TokenNameLPAREN	
conf	TokenNameIdentifier	 conf
,	TokenNameCOMMA	
host	TokenNameIdentifier	 host
,	TokenNameCOMMA	
ConfigHelper	TokenNameIdentifier	 Config Helper
.	TokenNameDOT	
getInputRpcPort	TokenNameIdentifier	 get Input Rpc Port
(	TokenNameLPAREN	
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
client	TokenNameIdentifier	 client
.	TokenNameDOT	
set_keyspace	TokenNameIdentifier	 set keyspace
(	TokenNameLPAREN	
keyspace	TokenNameIdentifier	 keyspace
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
return	TokenNamereturn	
client	TokenNameIdentifier	 client
.	TokenNameDOT	
describe_splits_ex	TokenNameIdentifier	 describe splits ex
(	TokenNameLPAREN	
cfName	TokenNameIdentifier	 cf Name
,	TokenNameCOMMA	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
start_token	TokenNameIdentifier	 start token
,	TokenNameCOMMA	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
end_token	TokenNameIdentifier	 end token
,	TokenNameCOMMA	
splitsize	TokenNameIdentifier	 splitsize
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
TApplicationException	TokenNameIdentifier	 T Application Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// fallback to guessing split size if talking to a server without describe_splits_ex method 	TokenNameCOMMENT_LINE	fallback to guessing split size if talking to a server without describe_splits_ex method 
if	TokenNameif	
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getType	TokenNameIdentifier	 get Type
(	TokenNameLPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
TApplicationException	TokenNameIdentifier	 T Application Exception
.	TokenNameDOT	
UNKNOWN_METHOD	TokenNameIdentifier	 UNKNOWN  METHOD
)	TokenNameRPAREN	
{	TokenNameLBRACE	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
splitPoints	TokenNameIdentifier	 split Points
=	TokenNameEQUAL	
client	TokenNameIdentifier	 client
.	TokenNameDOT	
describe_splits	TokenNameIdentifier	 describe splits
(	TokenNameLPAREN	
cfName	TokenNameIdentifier	 cf Name
,	TokenNameCOMMA	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
start_token	TokenNameIdentifier	 start token
,	TokenNameCOMMA	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
end_token	TokenNameIdentifier	 end token
,	TokenNameCOMMA	
splitsize	TokenNameIdentifier	 splitsize
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
tokenListToSplits	TokenNameIdentifier	 token List To Splits
(	TokenNameLPAREN	
splitPoints	TokenNameIdentifier	 split Points
,	TokenNameCOMMA	
splitsize	TokenNameIdentifier	 splitsize
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
throw	TokenNamethrow	
e	TokenNameIdentifier	 e
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
IOException	TokenNameIdentifier	 IO Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"failed connect to endpoint "	TokenNameStringLiteral	failed connect to endpoint 
+	TokenNamePLUS	
host	TokenNameIdentifier	 host
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
TException	TokenNameIdentifier	 T Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
InvalidRequestException	TokenNameIdentifier	 Invalid Request Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
IOException	TokenNameIdentifier	 IO Exception
(	TokenNameLPAREN	
"failed connecting to all endpoints "	TokenNameStringLiteral	failed connecting to all endpoints 
+	TokenNamePLUS	
StringUtils	TokenNameIdentifier	 String Utils
.	TokenNameDOT	
join	TokenNameIdentifier	 join
(	TokenNameLPAREN	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
endpoints	TokenNameIdentifier	 endpoints
,	TokenNameCOMMA	
","	TokenNameStringLiteral	,
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
CfSplit	TokenNameIdentifier	 Cf Split
>	TokenNameGREATER	
tokenListToSplits	TokenNameIdentifier	 token List To Splits
(	TokenNameLPAREN	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
splitTokens	TokenNameIdentifier	 split Tokens
,	TokenNameCOMMA	
int	TokenNameint	
splitsize	TokenNameIdentifier	 splitsize
)	TokenNameRPAREN	
{	TokenNameLBRACE	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
CfSplit	TokenNameIdentifier	 Cf Split
>	TokenNameGREATER	
splits	TokenNameIdentifier	 splits
=	TokenNameEQUAL	
Lists	TokenNameIdentifier	 Lists
.	TokenNameDOT	
newArrayListWithExpectedSize	TokenNameIdentifier	 new Array List With Expected Size
(	TokenNameLPAREN	
splitTokens	TokenNameIdentifier	 split Tokens
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
j	TokenNameIdentifier	 j
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
j	TokenNameIdentifier	 j
<	TokenNameLESS	
splitTokens	TokenNameIdentifier	 split Tokens
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
j	TokenNameIdentifier	 j
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
splits	TokenNameIdentifier	 splits
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
CfSplit	TokenNameIdentifier	 Cf Split
(	TokenNameLPAREN	
splitTokens	TokenNameIdentifier	 split Tokens
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
j	TokenNameIdentifier	 j
)	TokenNameRPAREN	
,	TokenNameCOMMA	
splitTokens	TokenNameIdentifier	 split Tokens
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
j	TokenNameIdentifier	 j
+	TokenNamePLUS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
splitsize	TokenNameIdentifier	 splitsize
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
splits	TokenNameIdentifier	 splits
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
TokenRange	TokenNameIdentifier	 Token Range
>	TokenNameGREATER	
getRangeMap	TokenNameIdentifier	 get Range Map
(	TokenNameLPAREN	
Configuration	TokenNameIdentifier	 Configuration
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
Cassandra	TokenNameIdentifier	 Cassandra
.	TokenNameDOT	
Client	TokenNameIdentifier	 Client
client	TokenNameIdentifier	 client
=	TokenNameEQUAL	
ConfigHelper	TokenNameIdentifier	 Config Helper
.	TokenNameDOT	
getClientFromInputAddressList	TokenNameIdentifier	 get Client From Input Address List
(	TokenNameLPAREN	
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
TokenRange	TokenNameIdentifier	 Token Range
>	TokenNameGREATER	
map	TokenNameIdentifier	 map
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
map	TokenNameIdentifier	 map
=	TokenNameEQUAL	
client	TokenNameIdentifier	 client
.	TokenNameDOT	
describe_ring	TokenNameIdentifier	 describe ring
(	TokenNameLPAREN	
ConfigHelper	TokenNameIdentifier	 Config Helper
.	TokenNameDOT	
getInputKeyspace	TokenNameIdentifier	 get Input Keyspace
(	TokenNameLPAREN	
conf	TokenNameIdentifier	 conf
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
TException	TokenNameIdentifier	 T Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
InvalidRequestException	TokenNameIdentifier	 Invalid Request Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
map	TokenNameIdentifier	 map
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
RecordReader	TokenNameIdentifier	 Record Reader
<	TokenNameLESS	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
,	TokenNameCOMMA	
SortedMap	TokenNameIdentifier	 Sorted Map
<	TokenNameLESS	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
,	TokenNameCOMMA	
IColumn	TokenNameIdentifier	 I Column
>>	TokenNameRIGHT_SHIFT	
createRecordReader	TokenNameIdentifier	 create Record Reader
(	TokenNameLPAREN	
InputSplit	TokenNameIdentifier	 Input Split
inputSplit	TokenNameIdentifier	 input Split
,	TokenNameCOMMA	
TaskAttemptContext	TokenNameIdentifier	 Task Attempt Context
taskAttemptContext	TokenNameIdentifier	 task Attempt Context
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
,	TokenNameCOMMA	
InterruptedException	TokenNameIdentifier	 Interrupted Exception
{	TokenNameLBRACE	
return	TokenNamereturn	
new	TokenNamenew	
ColumnFamilyRecordReader	TokenNameIdentifier	 Column Family Record Reader
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// 	TokenNameCOMMENT_LINE	 
// Old Hadoop API 	TokenNameCOMMENT_LINE	Old Hadoop API 
// 	TokenNameCOMMENT_LINE	 
public	TokenNamepublic	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
hadoop	TokenNameIdentifier	 hadoop
.	TokenNameDOT	
mapred	TokenNameIdentifier	 mapred
.	TokenNameDOT	
InputSplit	TokenNameIdentifier	 Input Split
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
getSplits	TokenNameIdentifier	 get Splits
(	TokenNameLPAREN	
JobConf	TokenNameIdentifier	 Job Conf
jobConf	TokenNameIdentifier	 job Conf
,	TokenNameCOMMA	
int	TokenNameint	
numSplits	TokenNameIdentifier	 num Splits
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
TaskAttemptContext	TokenNameIdentifier	 Task Attempt Context
tac	TokenNameIdentifier	 tac
=	TokenNameEQUAL	
new	TokenNamenew	
TaskAttemptContext	TokenNameIdentifier	 Task Attempt Context
(	TokenNameLPAREN	
jobConf	TokenNameIdentifier	 job Conf
,	TokenNameCOMMA	
new	TokenNamenew	
TaskAttemptID	TokenNameIdentifier	 Task Attempt ID
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
hadoop	TokenNameIdentifier	 hadoop
.	TokenNameDOT	
mapreduce	TokenNameIdentifier	 mapreduce
.	TokenNameDOT	
InputSplit	TokenNameIdentifier	 Input Split
>	TokenNameGREATER	
newInputSplits	TokenNameIdentifier	 new Input Splits
=	TokenNameEQUAL	
this	TokenNamethis	
.	TokenNameDOT	
getSplits	TokenNameIdentifier	 get Splits
(	TokenNameLPAREN	
tac	TokenNameIdentifier	 tac
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
hadoop	TokenNameIdentifier	 hadoop
.	TokenNameDOT	
mapred	TokenNameIdentifier	 mapred
.	TokenNameDOT	
InputSplit	TokenNameIdentifier	 Input Split
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
oldInputSplits	TokenNameIdentifier	 old Input Splits
=	TokenNameEQUAL	
new	TokenNamenew	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
hadoop	TokenNameIdentifier	 hadoop
.	TokenNameDOT	
mapred	TokenNameIdentifier	 mapred
.	TokenNameDOT	
InputSplit	TokenNameIdentifier	 Input Split
[	TokenNameLBRACKET	
newInputSplits	TokenNameIdentifier	 new Input Splits
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
newInputSplits	TokenNameIdentifier	 new Input Splits
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
oldInputSplits	TokenNameIdentifier	 old Input Splits
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
(	TokenNameLPAREN	
ColumnFamilySplit	TokenNameIdentifier	 Column Family Split
)	TokenNameRPAREN	
newInputSplits	TokenNameIdentifier	 new Input Splits
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
oldInputSplits	TokenNameIdentifier	 old Input Splits
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
hadoop	TokenNameIdentifier	 hadoop
.	TokenNameDOT	
mapred	TokenNameIdentifier	 mapred
.	TokenNameDOT	
RecordReader	TokenNameIdentifier	 Record Reader
<	TokenNameLESS	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
,	TokenNameCOMMA	
SortedMap	TokenNameIdentifier	 Sorted Map
<	TokenNameLESS	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
,	TokenNameCOMMA	
IColumn	TokenNameIdentifier	 I Column
>>	TokenNameRIGHT_SHIFT	
getRecordReader	TokenNameIdentifier	 get Record Reader
(	TokenNameLPAREN	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
hadoop	TokenNameIdentifier	 hadoop
.	TokenNameDOT	
mapred	TokenNameIdentifier	 mapred
.	TokenNameDOT	
InputSplit	TokenNameIdentifier	 Input Split
split	TokenNameIdentifier	 split
,	TokenNameCOMMA	
JobConf	TokenNameIdentifier	 Job Conf
jobConf	TokenNameIdentifier	 job Conf
,	TokenNameCOMMA	
final	TokenNamefinal	
Reporter	TokenNameIdentifier	 Reporter
reporter	TokenNameIdentifier	 reporter
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
TaskAttemptContext	TokenNameIdentifier	 Task Attempt Context
tac	TokenNameIdentifier	 tac
=	TokenNameEQUAL	
new	TokenNamenew	
TaskAttemptContext	TokenNameIdentifier	 Task Attempt Context
(	TokenNameLPAREN	
jobConf	TokenNameIdentifier	 job Conf
,	TokenNameCOMMA	
TaskAttemptID	TokenNameIdentifier	 Task Attempt ID
.	TokenNameDOT	
forName	TokenNameIdentifier	 for Name
(	TokenNameLPAREN	
jobConf	TokenNameIdentifier	 job Conf
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
MAPRED_TASK_ID	TokenNameIdentifier	 MAPRED  TASK  ID
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
void	TokenNamevoid	
progress	TokenNameIdentifier	 progress
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
reporter	TokenNameIdentifier	 reporter
.	TokenNameDOT	
progress	TokenNameIdentifier	 progress
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
ColumnFamilyRecordReader	TokenNameIdentifier	 Column Family Record Reader
recordReader	TokenNameIdentifier	 record Reader
=	TokenNameEQUAL	
new	TokenNamenew	
ColumnFamilyRecordReader	TokenNameIdentifier	 Column Family Record Reader
(	TokenNameLPAREN	
jobConf	TokenNameIdentifier	 job Conf
.	TokenNameDOT	
getInt	TokenNameIdentifier	 get Int
(	TokenNameLPAREN	
CASSANDRA_HADOOP_MAX_KEY_SIZE	TokenNameIdentifier	 CASSANDRA  HADOOP  MAX  KEY  SIZE
,	TokenNameCOMMA	
CASSANDRA_HADOOP_MAX_KEY_SIZE_DEFAULT	TokenNameIdentifier	 CASSANDRA  HADOOP  MAX  KEY  SIZE  DEFAULT
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
recordReader	TokenNameIdentifier	 record Reader
.	TokenNameDOT	
initialize	TokenNameIdentifier	 initialize
(	TokenNameLPAREN	
(	TokenNameLPAREN	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
hadoop	TokenNameIdentifier	 hadoop
.	TokenNameDOT	
mapreduce	TokenNameIdentifier	 mapreduce
.	TokenNameDOT	
InputSplit	TokenNameIdentifier	 Input Split
)	TokenNameRPAREN	
split	TokenNameIdentifier	 split
,	TokenNameCOMMA	
tac	TokenNameIdentifier	 tac
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
recordReader	TokenNameIdentifier	 record Reader
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
