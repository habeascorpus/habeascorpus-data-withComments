/* * Licensed to the Apache Software Foundation (ASF) under one * or more contributor license agreements. See the NOTICE file * distributed with this work for additional information * regarding copyright ownership. The ASF licenses this file * to you under the Apache License, Version 2.0 (the * "License"); you may not use this file except in compliance * with the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */	TokenNameCOMMENT_BLOCK	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
File	TokenNameIdentifier	 File
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
CopyOnWriteArrayList	TokenNameIdentifier	 Copy On Write Array List
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
atomic	TokenNameIdentifier	 atomic
.	TokenNameDOT	
AtomicReference	TokenNameIdentifier	 Atomic Reference
;	TokenNameSEMICOLON	
import	TokenNameimport	
com	TokenNameIdentifier	 com
.	TokenNameDOT	
google	TokenNameIdentifier	 google
.	TokenNameDOT	
common	TokenNameIdentifier	 common
.	TokenNameDOT	
collect	TokenNameIdentifier	 collect
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
Logger	TokenNameIdentifier	 Logger
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
LoggerFactory	TokenNameIdentifier	 Logger Factory
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
config	TokenNameIdentifier	 config
.	TokenNameDOT	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
compaction	TokenNameIdentifier	 compaction
.	TokenNameDOT	
OperationType	TokenNameIdentifier	 Operation Type
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
SSTableReader	TokenNameIdentifier	 SS Table Reader
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
FileUtils	TokenNameIdentifier	 File Utils
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
metrics	TokenNameIdentifier	 metrics
.	TokenNameDOT	
StorageMetrics	TokenNameIdentifier	 Storage Metrics
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
notifications	TokenNameIdentifier	 notifications
.	TokenNameDOT	
INotification	TokenNameIdentifier	 I Notification
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
notifications	TokenNameIdentifier	 notifications
.	TokenNameDOT	
INotificationConsumer	TokenNameIdentifier	 I Notification Consumer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
notifications	TokenNameIdentifier	 notifications
.	TokenNameDOT	
SSTableAddedNotification	TokenNameIdentifier	 SS Table Added Notification
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
notifications	TokenNameIdentifier	 notifications
.	TokenNameDOT	
SSTableListChangedNotification	TokenNameIdentifier	 SS Table List Changed Notification
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
service	TokenNameIdentifier	 service
.	TokenNameDOT	
StorageService	TokenNameIdentifier	 Storage Service
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
Interval	TokenNameIdentifier	 Interval
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
IntervalTree	TokenNameIdentifier	 Interval Tree
;	TokenNameSEMICOLON	
public	TokenNamepublic	
class	TokenNameclass	
DataTracker	TokenNameIdentifier	 Data Tracker
{	TokenNameLBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
Logger	TokenNameIdentifier	 Logger
logger	TokenNameIdentifier	 logger
=	TokenNameEQUAL	
LoggerFactory	TokenNameIdentifier	 Logger Factory
.	TokenNameDOT	
getLogger	TokenNameIdentifier	 get Logger
(	TokenNameLPAREN	
DataTracker	TokenNameIdentifier	 Data Tracker
.	TokenNameDOT	
class	TokenNameclass	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
public	TokenNamepublic	
final	TokenNamefinal	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
INotificationConsumer	TokenNameIdentifier	 I Notification Consumer
>	TokenNameGREATER	
subscribers	TokenNameIdentifier	 subscribers
=	TokenNameEQUAL	
new	TokenNamenew	
CopyOnWriteArrayList	TokenNameIdentifier	 Copy On Write Array List
<	TokenNameLESS	
INotificationConsumer	TokenNameIdentifier	 I Notification Consumer
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
public	TokenNamepublic	
final	TokenNamefinal	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
cfstore	TokenNameIdentifier	 cfstore
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
AtomicReference	TokenNameIdentifier	 Atomic Reference
<	TokenNameLESS	
View	TokenNameIdentifier	 View
>	TokenNameGREATER	
view	TokenNameIdentifier	 view
;	TokenNameSEMICOLON	
public	TokenNamepublic	
DataTracker	TokenNameIdentifier	 Data Tracker
(	TokenNameLPAREN	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
cfstore	TokenNameIdentifier	 cfstore
)	TokenNameRPAREN	
{	TokenNameLBRACE	
this	TokenNamethis	
.	TokenNameDOT	
cfstore	TokenNameIdentifier	 cfstore
=	TokenNameEQUAL	
cfstore	TokenNameIdentifier	 cfstore
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
view	TokenNameIdentifier	 view
=	TokenNameEQUAL	
new	TokenNamenew	
AtomicReference	TokenNameIdentifier	 Atomic Reference
<	TokenNameLESS	
View	TokenNameIdentifier	 View
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
init	TokenNameIdentifier	 init
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
Memtable	TokenNameIdentifier	 Memtable
getMemtable	TokenNameIdentifier	 get Memtable
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
memtable	TokenNameIdentifier	 memtable
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
Memtable	TokenNameIdentifier	 Memtable
>	TokenNameGREATER	
getMemtablesPendingFlush	TokenNameIdentifier	 get Memtables Pending Flush
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
memtablesPendingFlush	TokenNameIdentifier	 memtables Pending Flush
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
getSSTables	TokenNameIdentifier	 get SS Tables
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
sstables	TokenNameIdentifier	 sstables
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
getUncompactingSSTables	TokenNameIdentifier	 get Uncompacting SS Tables
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
nonCompactingSStables	TokenNameIdentifier	 non Compacting S Stables
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
View	TokenNameIdentifier	 View
getView	TokenNameIdentifier	 get View
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Switch the current memtable. * This atomically adds the current memtable to the memtables pending * flush and replace it with a fresh memtable. * * @return the previous current memtable (the one added to the pending * flush) */	TokenNameCOMMENT_JAVADOC	 Switch the current memtable. This atomically adds the current memtable to the memtables pending flush and replace it with a fresh memtable. * @return the previous current memtable (the one added to the pending flush) 
public	TokenNamepublic	
Memtable	TokenNameIdentifier	 Memtable
switchMemtable	TokenNameIdentifier	 switch Memtable
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// atomically change the current memtable 	TokenNameCOMMENT_LINE	atomically change the current memtable 
Memtable	TokenNameIdentifier	 Memtable
newMemtable	TokenNameIdentifier	 new Memtable
=	TokenNameEQUAL	
new	TokenNamenew	
Memtable	TokenNameIdentifier	 Memtable
(	TokenNameLPAREN	
cfstore	TokenNameIdentifier	 cfstore
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Memtable	TokenNameIdentifier	 Memtable
toFlushMemtable	TokenNameIdentifier	 to Flush Memtable
;	TokenNameSEMICOLON	
View	TokenNameIdentifier	 View
currentView	TokenNameIdentifier	 current View
,	TokenNameCOMMA	
newView	TokenNameIdentifier	 new View
;	TokenNameSEMICOLON	
do	TokenNamedo	
{	TokenNameLBRACE	
currentView	TokenNameIdentifier	 current View
=	TokenNameEQUAL	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
toFlushMemtable	TokenNameIdentifier	 to Flush Memtable
=	TokenNameEQUAL	
currentView	TokenNameIdentifier	 current View
.	TokenNameDOT	
memtable	TokenNameIdentifier	 memtable
;	TokenNameSEMICOLON	
newView	TokenNameIdentifier	 new View
=	TokenNameEQUAL	
currentView	TokenNameIdentifier	 current View
.	TokenNameDOT	
switchMemtable	TokenNameIdentifier	 switch Memtable
(	TokenNameLPAREN	
newMemtable	TokenNameIdentifier	 new Memtable
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
while	TokenNamewhile	
(	TokenNameLPAREN	
!	TokenNameNOT	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
compareAndSet	TokenNameIdentifier	 compare And Set
(	TokenNameLPAREN	
currentView	TokenNameIdentifier	 current View
,	TokenNameCOMMA	
newView	TokenNameIdentifier	 new View
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
toFlushMemtable	TokenNameIdentifier	 to Flush Memtable
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Renew the current memtable without putting the old one for a flush. * Used when we flush but a memtable is clean (in which case we must * change it because it was frozen). */	TokenNameCOMMENT_JAVADOC	 Renew the current memtable without putting the old one for a flush. Used when we flush but a memtable is clean (in which case we must change it because it was frozen). 
public	TokenNamepublic	
void	TokenNamevoid	
renewMemtable	TokenNameIdentifier	 renew Memtable
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Memtable	TokenNameIdentifier	 Memtable
newMemtable	TokenNameIdentifier	 new Memtable
=	TokenNameEQUAL	
new	TokenNamenew	
Memtable	TokenNameIdentifier	 Memtable
(	TokenNameLPAREN	
cfstore	TokenNameIdentifier	 cfstore
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
View	TokenNameIdentifier	 View
currentView	TokenNameIdentifier	 current View
,	TokenNameCOMMA	
newView	TokenNameIdentifier	 new View
;	TokenNameSEMICOLON	
do	TokenNamedo	
{	TokenNameLBRACE	
currentView	TokenNameIdentifier	 current View
=	TokenNameEQUAL	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
newView	TokenNameIdentifier	 new View
=	TokenNameEQUAL	
currentView	TokenNameIdentifier	 current View
.	TokenNameDOT	
renewMemtable	TokenNameIdentifier	 renew Memtable
(	TokenNameLPAREN	
newMemtable	TokenNameIdentifier	 new Memtable
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
while	TokenNamewhile	
(	TokenNameLPAREN	
!	TokenNameNOT	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
compareAndSet	TokenNameIdentifier	 compare And Set
(	TokenNameLPAREN	
currentView	TokenNameIdentifier	 current View
,	TokenNameCOMMA	
newView	TokenNameIdentifier	 new View
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
replaceFlushed	TokenNameIdentifier	 replace Flushed
(	TokenNameLPAREN	
Memtable	TokenNameIdentifier	 Memtable
memtable	TokenNameIdentifier	 memtable
,	TokenNameCOMMA	
SSTableReader	TokenNameIdentifier	 SS Table Reader
sstable	TokenNameIdentifier	 sstable
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// sstable may be null if we flushed batchlog and nothing needed to be retained 	TokenNameCOMMENT_LINE	sstable may be null if we flushed batchlog and nothing needed to be retained 
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
cfstore	TokenNameIdentifier	 cfstore
.	TokenNameDOT	
isValid	TokenNameIdentifier	 is Valid
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
View	TokenNameIdentifier	 View
currentView	TokenNameIdentifier	 current View
,	TokenNameCOMMA	
newView	TokenNameIdentifier	 new View
;	TokenNameSEMICOLON	
do	TokenNamedo	
{	TokenNameLBRACE	
currentView	TokenNameIdentifier	 current View
=	TokenNameEQUAL	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
newView	TokenNameIdentifier	 new View
=	TokenNameEQUAL	
currentView	TokenNameIdentifier	 current View
.	TokenNameDOT	
replaceFlushed	TokenNameIdentifier	 replace Flushed
(	TokenNameLPAREN	
memtable	TokenNameIdentifier	 memtable
,	TokenNameCOMMA	
sstable	TokenNameIdentifier	 sstable
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
newView	TokenNameIdentifier	 new View
=	TokenNameEQUAL	
newView	TokenNameIdentifier	 new View
.	TokenNameDOT	
replace	TokenNameIdentifier	 replace
(	TokenNameLPAREN	
Arrays	TokenNameIdentifier	 Arrays
.	TokenNameDOT	
asList	TokenNameIdentifier	 as List
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
emptyList	TokenNameIdentifier	 empty List
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
while	TokenNamewhile	
(	TokenNameLPAREN	
!	TokenNameNOT	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
compareAndSet	TokenNameIdentifier	 compare And Set
(	TokenNameLPAREN	
currentView	TokenNameIdentifier	 current View
,	TokenNameCOMMA	
newView	TokenNameIdentifier	 new View
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
View	TokenNameIdentifier	 View
currentView	TokenNameIdentifier	 current View
,	TokenNameCOMMA	
newView	TokenNameIdentifier	 new View
;	TokenNameSEMICOLON	
do	TokenNamedo	
{	TokenNameLBRACE	
currentView	TokenNameIdentifier	 current View
=	TokenNameEQUAL	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
newView	TokenNameIdentifier	 new View
=	TokenNameEQUAL	
currentView	TokenNameIdentifier	 current View
.	TokenNameDOT	
replaceFlushed	TokenNameIdentifier	 replace Flushed
(	TokenNameLPAREN	
memtable	TokenNameIdentifier	 memtable
,	TokenNameCOMMA	
sstable	TokenNameIdentifier	 sstable
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
while	TokenNamewhile	
(	TokenNameLPAREN	
!	TokenNameNOT	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
compareAndSet	TokenNameIdentifier	 compare And Set
(	TokenNameLPAREN	
currentView	TokenNameIdentifier	 current View
,	TokenNameCOMMA	
newView	TokenNameIdentifier	 new View
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
addNewSSTablesSize	TokenNameIdentifier	 add New SS Tables Size
(	TokenNameLPAREN	
Arrays	TokenNameIdentifier	 Arrays
.	TokenNameDOT	
asList	TokenNameIdentifier	 as List
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
notifyAdded	TokenNameIdentifier	 notify Added
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
incrementallyBackup	TokenNameIdentifier	 incrementally Backup
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
incrementallyBackup	TokenNameIdentifier	 incrementally Backup
(	TokenNameLPAREN	
final	TokenNamefinal	
SSTableReader	TokenNameIdentifier	 SS Table Reader
sstable	TokenNameIdentifier	 sstable
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
.	TokenNameDOT	
isIncrementalBackupsEnabled	TokenNameIdentifier	 is Incremental Backups Enabled
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
return	TokenNamereturn	
;	TokenNameSEMICOLON	
Runnable	TokenNameIdentifier	 Runnable
runnable	TokenNameIdentifier	 runnable
=	TokenNameEQUAL	
new	TokenNamenew	
Runnable	TokenNameIdentifier	 Runnable
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
run	TokenNameIdentifier	 run
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
File	TokenNameIdentifier	 File
backupsDir	TokenNameIdentifier	 backups Dir
=	TokenNameEQUAL	
Directories	TokenNameIdentifier	 Directories
.	TokenNameDOT	
getBackupsDirectory	TokenNameIdentifier	 get Backups Directory
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
descriptor	TokenNameIdentifier	 descriptor
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
createLinks	TokenNameIdentifier	 create Links
(	TokenNameLPAREN	
FileUtils	TokenNameIdentifier	 File Utils
.	TokenNameDOT	
getCanonicalPath	TokenNameIdentifier	 get Canonical Path
(	TokenNameLPAREN	
backupsDir	TokenNameIdentifier	 backups Dir
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
StorageService	TokenNameIdentifier	 Storage Service
.	TokenNameDOT	
tasks	TokenNameIdentifier	 tasks
.	TokenNameDOT	
execute	TokenNameIdentifier	 execute
(	TokenNameLPAREN	
runnable	TokenNameIdentifier	 runnable
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * @return true if we are able to mark the given @param sstables as compacted, before anyone else * * Note that we could acquire references on the marked sstables and release them in * unmarkCompacting, but since we will never call markCompacted on a sstable marked * as compacting (unless there is a serious bug), we can skip this. */	TokenNameCOMMENT_JAVADOC	 @return true if we are able to mark the given @param sstables as compacted, before anyone else * Note that we could acquire references on the marked sstables and release them in unmarkCompacting, but since we will never call markCompacted on a sstable marked as compacting (unless there is a serious bug), we can skip this. 
public	TokenNamepublic	
boolean	TokenNameboolean	
markCompacting	TokenNameIdentifier	 mark Compacting
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assert	TokenNameassert	
sstables	TokenNameIdentifier	 sstables
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
&&	TokenNameAND_AND	
!	TokenNameNOT	
sstables	TokenNameIdentifier	 sstables
.	TokenNameDOT	
isEmpty	TokenNameIdentifier	 is Empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
View	TokenNameIdentifier	 View
currentView	TokenNameIdentifier	 current View
=	TokenNameEQUAL	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
inactive	TokenNameIdentifier	 inactive
=	TokenNameEQUAL	
Sets	TokenNameIdentifier	 Sets
.	TokenNameDOT	
difference	TokenNameIdentifier	 difference
(	TokenNameLPAREN	
ImmutableSet	TokenNameIdentifier	 Immutable Set
.	TokenNameDOT	
copyOf	TokenNameIdentifier	 copy Of
(	TokenNameLPAREN	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
,	TokenNameCOMMA	
currentView	TokenNameIdentifier	 current View
.	TokenNameDOT	
compacting	TokenNameIdentifier	 compacting
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
inactive	TokenNameIdentifier	 inactive
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
<	TokenNameLESS	
sstables	TokenNameIdentifier	 sstables
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
return	TokenNamereturn	
false	TokenNamefalse	
;	TokenNameSEMICOLON	
View	TokenNameIdentifier	 View
newView	TokenNameIdentifier	 new View
=	TokenNameEQUAL	
currentView	TokenNameIdentifier	 current View
.	TokenNameDOT	
markCompacting	TokenNameIdentifier	 mark Compacting
(	TokenNameLPAREN	
inactive	TokenNameIdentifier	 inactive
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
compareAndSet	TokenNameIdentifier	 compare And Set
(	TokenNameLPAREN	
currentView	TokenNameIdentifier	 current View
,	TokenNameCOMMA	
newView	TokenNameIdentifier	 new View
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Removes files from compacting status: this is different from 'markCompacted' * because it should be run regardless of whether a compaction succeeded. */	TokenNameCOMMENT_JAVADOC	 Removes files from compacting status: this is different from 'markCompacted' because it should be run regardless of whether a compaction succeeded. 
public	TokenNamepublic	
void	TokenNamevoid	
unmarkCompacting	TokenNameIdentifier	 unmark Compacting
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
unmark	TokenNameIdentifier	 unmark
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
cfstore	TokenNameIdentifier	 cfstore
.	TokenNameDOT	
isValid	TokenNameIdentifier	 is Valid
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// We don't know if the original compaction suceeded or failed, which makes it difficult to know 	TokenNameCOMMENT_LINE	We don't know if the original compaction suceeded or failed, which makes it difficult to know 
// if the sstable reference has already been released. 	TokenNameCOMMENT_LINE	if the sstable reference has already been released. 
// A "good enough" approach is to mark the sstables involved compacted, which if compaction succeeded 	TokenNameCOMMENT_LINE	A "good enough" approach is to mark the sstables involved compacted, which if compaction succeeded 
// is harmlessly redundant, and if it failed ensures that at least the sstable will get deleted on restart. 	TokenNameCOMMENT_LINE	is harmlessly redundant, and if it failed ensures that at least the sstable will get deleted on restart. 
for	TokenNamefor	
(	TokenNameLPAREN	
SSTableReader	TokenNameIdentifier	 SS Table Reader
sstable	TokenNameIdentifier	 sstable
:	TokenNameCOLON	
unmark	TokenNameIdentifier	 unmark
)	TokenNameRPAREN	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
markCompacted	TokenNameIdentifier	 mark Compacted
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
View	TokenNameIdentifier	 View
currentView	TokenNameIdentifier	 current View
,	TokenNameCOMMA	
newView	TokenNameIdentifier	 new View
;	TokenNameSEMICOLON	
do	TokenNamedo	
{	TokenNameLBRACE	
currentView	TokenNameIdentifier	 current View
=	TokenNameEQUAL	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
newView	TokenNameIdentifier	 new View
=	TokenNameEQUAL	
currentView	TokenNameIdentifier	 current View
.	TokenNameDOT	
unmarkCompacting	TokenNameIdentifier	 unmark Compacting
(	TokenNameLPAREN	
unmark	TokenNameIdentifier	 unmark
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
while	TokenNamewhile	
(	TokenNameLPAREN	
!	TokenNameNOT	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
compareAndSet	TokenNameIdentifier	 compare And Set
(	TokenNameLPAREN	
currentView	TokenNameIdentifier	 current View
,	TokenNameCOMMA	
newView	TokenNameIdentifier	 new View
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
markCompacted	TokenNameIdentifier	 mark Compacted
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
OperationType	TokenNameIdentifier	 Operation Type
compactionType	TokenNameIdentifier	 compaction Type
)	TokenNameRPAREN	
{	TokenNameLBRACE	
replace	TokenNameIdentifier	 replace
(	TokenNameLPAREN	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
emptyList	TokenNameIdentifier	 empty List
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
notifySSTablesChanged	TokenNameIdentifier	 notify SS Tables Changed
(	TokenNameLPAREN	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
emptyList	TokenNameIdentifier	 empty List
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
compactionType	TokenNameIdentifier	 compaction Type
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
replaceCompactedSSTables	TokenNameIdentifier	 replace Compacted SS Tables
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
Iterable	TokenNameIdentifier	 Iterable
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
replacements	TokenNameIdentifier	 replacements
,	TokenNameCOMMA	
OperationType	TokenNameIdentifier	 Operation Type
compactionType	TokenNameIdentifier	 compaction Type
)	TokenNameRPAREN	
{	TokenNameLBRACE	
replace	TokenNameIdentifier	 replace
(	TokenNameLPAREN	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
replacements	TokenNameIdentifier	 replacements
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
notifySSTablesChanged	TokenNameIdentifier	 notify SS Tables Changed
(	TokenNameLPAREN	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
replacements	TokenNameIdentifier	 replacements
,	TokenNameCOMMA	
compactionType	TokenNameIdentifier	 compaction Type
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
addInitialSSTables	TokenNameIdentifier	 add Initial SS Tables
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
{	TokenNameLBRACE	
replace	TokenNameIdentifier	 replace
(	TokenNameLPAREN	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
emptyList	TokenNameIdentifier	 empty List
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// no notifications or backup necessary 	TokenNameCOMMENT_LINE	no notifications or backup necessary 
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
addSSTables	TokenNameIdentifier	 add SS Tables
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
{	TokenNameLBRACE	
replace	TokenNameIdentifier	 replace
(	TokenNameLPAREN	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
emptyList	TokenNameIdentifier	 empty List
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
SSTableReader	TokenNameIdentifier	 SS Table Reader
sstable	TokenNameIdentifier	 sstable
:	TokenNameCOLON	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
{	TokenNameLBRACE	
incrementallyBackup	TokenNameIdentifier	 incrementally Backup
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
notifyAdded	TokenNameIdentifier	 notify Added
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** * removes all sstables that are not busy compacting. */	TokenNameCOMMENT_JAVADOC	 removes all sstables that are not busy compacting. 
public	TokenNamepublic	
void	TokenNamevoid	
unreferenceSSTables	TokenNameIdentifier	 unreference SS Tables
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
notCompacting	TokenNameIdentifier	 not Compacting
;	TokenNameSEMICOLON	
View	TokenNameIdentifier	 View
currentView	TokenNameIdentifier	 current View
,	TokenNameCOMMA	
newView	TokenNameIdentifier	 new View
;	TokenNameSEMICOLON	
do	TokenNamedo	
{	TokenNameLBRACE	
currentView	TokenNameIdentifier	 current View
=	TokenNameEQUAL	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
notCompacting	TokenNameIdentifier	 not Compacting
=	TokenNameEQUAL	
currentView	TokenNameIdentifier	 current View
.	TokenNameDOT	
nonCompactingSStables	TokenNameIdentifier	 non Compacting S Stables
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
newView	TokenNameIdentifier	 new View
=	TokenNameEQUAL	
currentView	TokenNameIdentifier	 current View
.	TokenNameDOT	
replace	TokenNameIdentifier	 replace
(	TokenNameLPAREN	
notCompacting	TokenNameIdentifier	 not Compacting
,	TokenNameCOMMA	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
emptySet	TokenNameIdentifier	 empty Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
while	TokenNamewhile	
(	TokenNameLPAREN	
!	TokenNameNOT	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
compareAndSet	TokenNameIdentifier	 compare And Set
(	TokenNameLPAREN	
currentView	TokenNameIdentifier	 current View
,	TokenNameCOMMA	
newView	TokenNameIdentifier	 new View
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
notCompacting	TokenNameIdentifier	 not Compacting
.	TokenNameDOT	
isEmpty	TokenNameIdentifier	 is Empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// notifySSTablesChanged -> LeveledManifest.promote doesn't like a no-op "promotion" 	TokenNameCOMMENT_LINE	notifySSTablesChanged -> LeveledManifest.promote doesn't like a no-op "promotion" 
return	TokenNamereturn	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
notifySSTablesChanged	TokenNameIdentifier	 notify SS Tables Changed
(	TokenNameLPAREN	
notCompacting	TokenNameIdentifier	 not Compacting
,	TokenNameCOMMA	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
emptySet	TokenNameIdentifier	 empty Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
OperationType	TokenNameIdentifier	 Operation Type
.	TokenNameDOT	
UNKNOWN	TokenNameIdentifier	 UNKNOWN
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
postReplace	TokenNameIdentifier	 post Replace
(	TokenNameLPAREN	
notCompacting	TokenNameIdentifier	 not Compacting
,	TokenNameCOMMA	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
emptySet	TokenNameIdentifier	 empty Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Removes every SSTable in the directory from the DataTracker's view. * @param directory the unreadable directory, possibly with SSTables in it, but not necessarily. */	TokenNameCOMMENT_JAVADOC	 Removes every SSTable in the directory from the DataTracker's view. @param directory the unreadable directory, possibly with SSTables in it, but not necessarily. 
void	TokenNamevoid	
removeUnreadableSSTables	TokenNameIdentifier	 remove Unreadable SS Tables
(	TokenNameLPAREN	
File	TokenNameIdentifier	 File
directory	TokenNameIdentifier	 directory
)	TokenNameRPAREN	
{	TokenNameLBRACE	
View	TokenNameIdentifier	 View
currentView	TokenNameIdentifier	 current View
,	TokenNameCOMMA	
newView	TokenNameIdentifier	 new View
;	TokenNameSEMICOLON	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
remaining	TokenNameIdentifier	 remaining
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
do	TokenNamedo	
{	TokenNameLBRACE	
currentView	TokenNameIdentifier	 current View
=	TokenNameEQUAL	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
SSTableReader	TokenNameIdentifier	 SS Table Reader
r	TokenNameIdentifier	 r
:	TokenNameCOLON	
currentView	TokenNameIdentifier	 current View
.	TokenNameDOT	
nonCompactingSStables	TokenNameIdentifier	 non Compacting S Stables
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
r	TokenNameIdentifier	 r
.	TokenNameDOT	
descriptor	TokenNameIdentifier	 descriptor
.	TokenNameDOT	
directory	TokenNameIdentifier	 directory
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
directory	TokenNameIdentifier	 directory
)	TokenNameRPAREN	
)	TokenNameRPAREN	
remaining	TokenNameIdentifier	 remaining
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
r	TokenNameIdentifier	 r
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
remaining	TokenNameIdentifier	 remaining
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
currentView	TokenNameIdentifier	 current View
.	TokenNameDOT	
nonCompactingSStables	TokenNameIdentifier	 non Compacting S Stables
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
return	TokenNamereturn	
;	TokenNameSEMICOLON	
newView	TokenNameIdentifier	 new View
=	TokenNameEQUAL	
currentView	TokenNameIdentifier	 current View
.	TokenNameDOT	
replace	TokenNameIdentifier	 replace
(	TokenNameLPAREN	
currentView	TokenNameIdentifier	 current View
.	TokenNameDOT	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
remaining	TokenNameIdentifier	 remaining
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
while	TokenNamewhile	
(	TokenNameLPAREN	
!	TokenNameNOT	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
compareAndSet	TokenNameIdentifier	 compare And Set
(	TokenNameLPAREN	
currentView	TokenNameIdentifier	 current View
,	TokenNameCOMMA	
newView	TokenNameIdentifier	 new View
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
notifySSTablesChanged	TokenNameIdentifier	 notify SS Tables Changed
(	TokenNameLPAREN	
remaining	TokenNameIdentifier	 remaining
,	TokenNameCOMMA	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
emptySet	TokenNameIdentifier	 empty Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
OperationType	TokenNameIdentifier	 Operation Type
.	TokenNameDOT	
UNKNOWN	TokenNameIdentifier	 UNKNOWN
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** (Re)initializes the tracker, purging all references. */	TokenNameCOMMENT_JAVADOC	 (Re)initializes the tracker, purging all references. 
void	TokenNamevoid	
init	TokenNameIdentifier	 init
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
set	TokenNameIdentifier	 set
(	TokenNameLPAREN	
new	TokenNamenew	
View	TokenNameIdentifier	 View
(	TokenNameLPAREN	
new	TokenNamenew	
Memtable	TokenNameIdentifier	 Memtable
(	TokenNameLPAREN	
cfstore	TokenNameIdentifier	 cfstore
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
<	TokenNameLESS	
Memtable	TokenNameIdentifier	 Memtable
>	TokenNameGREATER	
emptySet	TokenNameIdentifier	 empty Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
emptySet	TokenNameIdentifier	 empty Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
emptySet	TokenNameIdentifier	 empty Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
SSTableIntervalTree	TokenNameIdentifier	 SS Table Interval Tree
.	TokenNameDOT	
empty	TokenNameIdentifier	 empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
replace	TokenNameIdentifier	 replace
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
oldSSTables	TokenNameIdentifier	 old SS Tables
,	TokenNameCOMMA	
Iterable	TokenNameIdentifier	 Iterable
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
replacements	TokenNameIdentifier	 replacements
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
cfstore	TokenNameIdentifier	 cfstore
.	TokenNameDOT	
isValid	TokenNameIdentifier	 is Valid
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
removeOldSSTablesSize	TokenNameIdentifier	 remove Old SS Tables Size
(	TokenNameLPAREN	
replacements	TokenNameIdentifier	 replacements
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
replacements	TokenNameIdentifier	 replacements
=	TokenNameEQUAL	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
emptyList	TokenNameIdentifier	 empty List
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
View	TokenNameIdentifier	 View
currentView	TokenNameIdentifier	 current View
,	TokenNameCOMMA	
newView	TokenNameIdentifier	 new View
;	TokenNameSEMICOLON	
do	TokenNamedo	
{	TokenNameLBRACE	
currentView	TokenNameIdentifier	 current View
=	TokenNameEQUAL	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
newView	TokenNameIdentifier	 new View
=	TokenNameEQUAL	
currentView	TokenNameIdentifier	 current View
.	TokenNameDOT	
replace	TokenNameIdentifier	 replace
(	TokenNameLPAREN	
oldSSTables	TokenNameIdentifier	 old SS Tables
,	TokenNameCOMMA	
replacements	TokenNameIdentifier	 replacements
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
while	TokenNamewhile	
(	TokenNameLPAREN	
!	TokenNameNOT	
view	TokenNameIdentifier	 view
.	TokenNameDOT	
compareAndSet	TokenNameIdentifier	 compare And Set
(	TokenNameLPAREN	
currentView	TokenNameIdentifier	 current View
,	TokenNameCOMMA	
newView	TokenNameIdentifier	 new View
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
postReplace	TokenNameIdentifier	 post Replace
(	TokenNameLPAREN	
oldSSTables	TokenNameIdentifier	 old SS Tables
,	TokenNameCOMMA	
replacements	TokenNameIdentifier	 replacements
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
postReplace	TokenNameIdentifier	 post Replace
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
oldSSTables	TokenNameIdentifier	 old SS Tables
,	TokenNameCOMMA	
Iterable	TokenNameIdentifier	 Iterable
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
replacements	TokenNameIdentifier	 replacements
)	TokenNameRPAREN	
{	TokenNameLBRACE	
addNewSSTablesSize	TokenNameIdentifier	 add New SS Tables Size
(	TokenNameLPAREN	
replacements	TokenNameIdentifier	 replacements
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
removeOldSSTablesSize	TokenNameIdentifier	 remove Old SS Tables Size
(	TokenNameLPAREN	
oldSSTables	TokenNameIdentifier	 old SS Tables
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
addNewSSTablesSize	TokenNameIdentifier	 add New SS Tables Size
(	TokenNameLPAREN	
Iterable	TokenNameIdentifier	 Iterable
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
newSSTables	TokenNameIdentifier	 new SS Tables
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
SSTableReader	TokenNameIdentifier	 SS Table Reader
sstable	TokenNameIdentifier	 sstable
:	TokenNameCOLON	
newSSTables	TokenNameIdentifier	 new SS Tables
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assert	TokenNameassert	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
getKeySamples	TokenNameIdentifier	 get Key Samples
(	TokenNameLPAREN	
)	TokenNameRPAREN	
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
isDebugEnabled	TokenNameIdentifier	 is Debug Enabled
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"adding %s to list of files tracked for %s.%s"	TokenNameStringLiteral	adding %s to list of files tracked for %s.%s
,	TokenNameCOMMA	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
descriptor	TokenNameIdentifier	 descriptor
,	TokenNameCOMMA	
cfstore	TokenNameIdentifier	 cfstore
.	TokenNameDOT	
table	TokenNameIdentifier	 table
.	TokenNameDOT	
name	TokenNameIdentifier	 name
,	TokenNameCOMMA	
cfstore	TokenNameIdentifier	 cfstore
.	TokenNameDOT	
getColumnFamilyName	TokenNameIdentifier	 get Column Family Name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
long	TokenNamelong	
size	TokenNameIdentifier	 size
=	TokenNameEQUAL	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
bytesOnDisk	TokenNameIdentifier	 bytes On Disk
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
StorageMetrics	TokenNameIdentifier	 Storage Metrics
.	TokenNameDOT	
load	TokenNameIdentifier	 load
.	TokenNameDOT	
inc	TokenNameIdentifier	 inc
(	TokenNameLPAREN	
size	TokenNameIdentifier	 size
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
cfstore	TokenNameIdentifier	 cfstore
.	TokenNameDOT	
metric	TokenNameIdentifier	 metric
.	TokenNameDOT	
liveDiskSpaceUsed	TokenNameIdentifier	 live Disk Space Used
.	TokenNameDOT	
inc	TokenNameIdentifier	 inc
(	TokenNameLPAREN	
size	TokenNameIdentifier	 size
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
cfstore	TokenNameIdentifier	 cfstore
.	TokenNameDOT	
metric	TokenNameIdentifier	 metric
.	TokenNameDOT	
totalDiskSpaceUsed	TokenNameIdentifier	 total Disk Space Used
.	TokenNameDOT	
inc	TokenNameIdentifier	 inc
(	TokenNameLPAREN	
size	TokenNameIdentifier	 size
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
setTrackedBy	TokenNameIdentifier	 set Tracked By
(	TokenNameLPAREN	
this	TokenNamethis	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
removeOldSSTablesSize	TokenNameIdentifier	 remove Old SS Tables Size
(	TokenNameLPAREN	
Iterable	TokenNameIdentifier	 Iterable
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
oldSSTables	TokenNameIdentifier	 old SS Tables
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
SSTableReader	TokenNameIdentifier	 SS Table Reader
sstable	TokenNameIdentifier	 sstable
:	TokenNameCOLON	
oldSSTables	TokenNameIdentifier	 old SS Tables
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
isDebugEnabled	TokenNameIdentifier	 is Debug Enabled
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"removing %s from list of files tracked for %s.%s"	TokenNameStringLiteral	removing %s from list of files tracked for %s.%s
,	TokenNameCOMMA	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
descriptor	TokenNameIdentifier	 descriptor
,	TokenNameCOMMA	
cfstore	TokenNameIdentifier	 cfstore
.	TokenNameDOT	
table	TokenNameIdentifier	 table
.	TokenNameDOT	
name	TokenNameIdentifier	 name
,	TokenNameCOMMA	
cfstore	TokenNameIdentifier	 cfstore
.	TokenNameDOT	
getColumnFamilyName	TokenNameIdentifier	 get Column Family Name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
long	TokenNamelong	
size	TokenNameIdentifier	 size
=	TokenNameEQUAL	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
bytesOnDisk	TokenNameIdentifier	 bytes On Disk
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
StorageMetrics	TokenNameIdentifier	 Storage Metrics
.	TokenNameDOT	
load	TokenNameIdentifier	 load
.	TokenNameDOT	
dec	TokenNameIdentifier	 dec
(	TokenNameLPAREN	
size	TokenNameIdentifier	 size
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
cfstore	TokenNameIdentifier	 cfstore
.	TokenNameDOT	
metric	TokenNameIdentifier	 metric
.	TokenNameDOT	
liveDiskSpaceUsed	TokenNameIdentifier	 live Disk Space Used
.	TokenNameDOT	
dec	TokenNameIdentifier	 dec
(	TokenNameLPAREN	
size	TokenNameIdentifier	 size
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
boolean	TokenNameboolean	
firstToCompact	TokenNameIdentifier	 first To Compact
=	TokenNameEQUAL	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
markCompacted	TokenNameIdentifier	 mark Compacted
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assert	TokenNameassert	
firstToCompact	TokenNameIdentifier	 first To Compact
:	TokenNameCOLON	
sstable	TokenNameIdentifier	 sstable
+	TokenNamePLUS	
" was already marked compacted"	TokenNameStringLiteral	 was already marked compacted
;	TokenNameSEMICOLON	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
releaseReference	TokenNameIdentifier	 release Reference
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
spaceReclaimed	TokenNameIdentifier	 space Reclaimed
(	TokenNameLPAREN	
long	TokenNamelong	
size	TokenNameIdentifier	 size
)	TokenNameRPAREN	
{	TokenNameLBRACE	
cfstore	TokenNameIdentifier	 cfstore
.	TokenNameDOT	
metric	TokenNameIdentifier	 metric
.	TokenNameDOT	
totalDiskSpaceUsed	TokenNameIdentifier	 total Disk Space Used
.	TokenNameDOT	
dec	TokenNameIdentifier	 dec
(	TokenNameLPAREN	
size	TokenNameIdentifier	 size
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
long	TokenNamelong	
estimatedKeys	TokenNameIdentifier	 estimated Keys
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
long	TokenNamelong	
n	TokenNameIdentifier	 n
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
SSTableReader	TokenNameIdentifier	 SS Table Reader
sstable	TokenNameIdentifier	 sstable
:	TokenNameCOLON	
getSSTables	TokenNameIdentifier	 get SS Tables
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
n	TokenNameIdentifier	 n
+=	TokenNamePLUS_EQUAL	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
estimatedKeys	TokenNameIdentifier	 estimated Keys
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
n	TokenNameIdentifier	 n
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
int	TokenNameint	
getMeanColumns	TokenNameIdentifier	 get Mean Columns
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
long	TokenNamelong	
sum	TokenNameIdentifier	 sum
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
int	TokenNameint	
count	TokenNameIdentifier	 count
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
SSTableReader	TokenNameIdentifier	 SS Table Reader
sstable	TokenNameIdentifier	 sstable
:	TokenNameCOLON	
getSSTables	TokenNameIdentifier	 get SS Tables
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
sum	TokenNameIdentifier	 sum
+=	TokenNamePLUS_EQUAL	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
getEstimatedColumnCount	TokenNameIdentifier	 get Estimated Column Count
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
mean	TokenNameIdentifier	 mean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
count	TokenNameIdentifier	 count
++	TokenNamePLUS_PLUS	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
count	TokenNameIdentifier	 count
>	TokenNameGREATER	
0	TokenNameIntegerLiteral	
?	TokenNameQUESTION	
(	TokenNameLPAREN	
int	TokenNameint	
)	TokenNameRPAREN	
(	TokenNameLPAREN	
sum	TokenNameIdentifier	 sum
/	TokenNameDIVIDE	
count	TokenNameIdentifier	 count
)	TokenNameRPAREN	
:	TokenNameCOLON	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
notifySSTablesChanged	TokenNameIdentifier	 notify SS Tables Changed
(	TokenNameLPAREN	
Iterable	TokenNameIdentifier	 Iterable
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
removed	TokenNameIdentifier	 removed
,	TokenNameCOMMA	
Iterable	TokenNameIdentifier	 Iterable
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
added	TokenNameIdentifier	 added
,	TokenNameCOMMA	
OperationType	TokenNameIdentifier	 Operation Type
compactionType	TokenNameIdentifier	 compaction Type
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
INotificationConsumer	TokenNameIdentifier	 I Notification Consumer
subscriber	TokenNameIdentifier	 subscriber
:	TokenNameCOLON	
subscribers	TokenNameIdentifier	 subscribers
)	TokenNameRPAREN	
{	TokenNameLBRACE	
INotification	TokenNameIdentifier	 I Notification
notification	TokenNameIdentifier	 notification
=	TokenNameEQUAL	
new	TokenNamenew	
SSTableListChangedNotification	TokenNameIdentifier	 SS Table List Changed Notification
(	TokenNameLPAREN	
added	TokenNameIdentifier	 added
,	TokenNameCOMMA	
removed	TokenNameIdentifier	 removed
,	TokenNameCOMMA	
compactionType	TokenNameIdentifier	 compaction Type
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
subscriber	TokenNameIdentifier	 subscriber
.	TokenNameDOT	
handleNotification	TokenNameIdentifier	 handle Notification
(	TokenNameLPAREN	
notification	TokenNameIdentifier	 notification
,	TokenNameCOMMA	
this	TokenNamethis	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
notifyAdded	TokenNameIdentifier	 notify Added
(	TokenNameLPAREN	
SSTableReader	TokenNameIdentifier	 SS Table Reader
added	TokenNameIdentifier	 added
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
INotificationConsumer	TokenNameIdentifier	 I Notification Consumer
subscriber	TokenNameIdentifier	 subscriber
:	TokenNameCOLON	
subscribers	TokenNameIdentifier	 subscribers
)	TokenNameRPAREN	
{	TokenNameLBRACE	
INotification	TokenNameIdentifier	 I Notification
notification	TokenNameIdentifier	 notification
=	TokenNameEQUAL	
new	TokenNamenew	
SSTableAddedNotification	TokenNameIdentifier	 SS Table Added Notification
(	TokenNameLPAREN	
added	TokenNameIdentifier	 added
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
subscriber	TokenNameIdentifier	 subscriber
.	TokenNameDOT	
handleNotification	TokenNameIdentifier	 handle Notification
(	TokenNameLPAREN	
notification	TokenNameIdentifier	 notification
,	TokenNameCOMMA	
this	TokenNamethis	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
subscribe	TokenNameIdentifier	 subscribe
(	TokenNameLPAREN	
INotificationConsumer	TokenNameIdentifier	 I Notification Consumer
consumer	TokenNameIdentifier	 consumer
)	TokenNameRPAREN	
{	TokenNameLBRACE	
subscribers	TokenNameIdentifier	 subscribers
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
consumer	TokenNameIdentifier	 consumer
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
unsubscribe	TokenNameIdentifier	 unsubscribe
(	TokenNameLPAREN	
INotificationConsumer	TokenNameIdentifier	 I Notification Consumer
consumer	TokenNameIdentifier	 consumer
)	TokenNameRPAREN	
{	TokenNameLBRACE	
boolean	TokenNameboolean	
found	TokenNameIdentifier	 found
=	TokenNameEQUAL	
subscribers	TokenNameIdentifier	 subscribers
.	TokenNameDOT	
remove	TokenNameIdentifier	 remove
(	TokenNameLPAREN	
consumer	TokenNameIdentifier	 consumer
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assert	TokenNameassert	
found	TokenNameIdentifier	 found
:	TokenNameCOLON	
consumer	TokenNameIdentifier	 consumer
+	TokenNamePLUS	
" not subscribed"	TokenNameStringLiteral	 not subscribed
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
SSTableIntervalTree	TokenNameIdentifier	 SS Table Interval Tree
buildIntervalTree	TokenNameIdentifier	 build Interval Tree
(	TokenNameLPAREN	
Iterable	TokenNameIdentifier	 Iterable
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
{	TokenNameLBRACE	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Interval	TokenNameIdentifier	 Interval
<	TokenNameLESS	
RowPosition	TokenNameIdentifier	 Row Position
,	TokenNameCOMMA	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>>	TokenNameRIGHT_SHIFT	
intervals	TokenNameIdentifier	 intervals
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
Interval	TokenNameIdentifier	 Interval
<	TokenNameLESS	
RowPosition	TokenNameIdentifier	 Row Position
,	TokenNameCOMMA	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>>	TokenNameRIGHT_SHIFT	
(	TokenNameLPAREN	
Iterables	TokenNameIdentifier	 Iterables
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
SSTableReader	TokenNameIdentifier	 SS Table Reader
sstable	TokenNameIdentifier	 sstable
:	TokenNameCOLON	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
intervals	TokenNameIdentifier	 intervals
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
Interval	TokenNameIdentifier	 Interval
.	TokenNameDOT	
<	TokenNameLESS	
RowPosition	TokenNameIdentifier	 Row Position
,	TokenNameCOMMA	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
first	TokenNameIdentifier	 first
,	TokenNameCOMMA	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
last	TokenNameIdentifier	 last
,	TokenNameCOMMA	
sstable	TokenNameIdentifier	 sstable
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
new	TokenNamenew	
SSTableIntervalTree	TokenNameIdentifier	 SS Table Interval Tree
(	TokenNameLPAREN	
intervals	TokenNameIdentifier	 intervals
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
getCompacting	TokenNameIdentifier	 get Compacting
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
getView	TokenNameIdentifier	 get View
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
compacting	TokenNameIdentifier	 compacting
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
class	TokenNameclass	
SSTableIntervalTree	TokenNameIdentifier	 SS Table Interval Tree
extends	TokenNameextends	
IntervalTree	TokenNameIdentifier	 Interval Tree
<	TokenNameLESS	
RowPosition	TokenNameIdentifier	 Row Position
,	TokenNameCOMMA	
SSTableReader	TokenNameIdentifier	 SS Table Reader
,	TokenNameCOMMA	
Interval	TokenNameIdentifier	 Interval
<	TokenNameLESS	
RowPosition	TokenNameIdentifier	 Row Position
,	TokenNameCOMMA	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>>	TokenNameRIGHT_SHIFT	
{	TokenNameLBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
SSTableIntervalTree	TokenNameIdentifier	 SS Table Interval Tree
EMPTY	TokenNameIdentifier	 EMPTY
=	TokenNameEQUAL	
new	TokenNamenew	
SSTableIntervalTree	TokenNameIdentifier	 SS Table Interval Tree
(	TokenNameLPAREN	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
private	TokenNameprivate	
SSTableIntervalTree	TokenNameIdentifier	 SS Table Interval Tree
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
Interval	TokenNameIdentifier	 Interval
<	TokenNameLESS	
RowPosition	TokenNameIdentifier	 Row Position
,	TokenNameCOMMA	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>>	TokenNameRIGHT_SHIFT	
intervals	TokenNameIdentifier	 intervals
)	TokenNameRPAREN	
{	TokenNameLBRACE	
super	TokenNamesuper	
(	TokenNameLPAREN	
intervals	TokenNameIdentifier	 intervals
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
SSTableIntervalTree	TokenNameIdentifier	 SS Table Interval Tree
empty	TokenNameIdentifier	 empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
EMPTY	TokenNameIdentifier	 EMPTY
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** * An immutable structure holding the current memtable, the memtables pending * flush, the sstables for a column family, and the sstables that are active * in compaction (a subset of the sstables). */	TokenNameCOMMENT_JAVADOC	 An immutable structure holding the current memtable, the memtables pending flush, the sstables for a column family, and the sstables that are active in compaction (a subset of the sstables). 
static	TokenNamestatic	
class	TokenNameclass	
View	TokenNameIdentifier	 View
{	TokenNameLBRACE	
public	TokenNamepublic	
final	TokenNamefinal	
Memtable	TokenNameIdentifier	 Memtable
memtable	TokenNameIdentifier	 memtable
;	TokenNameSEMICOLON	
public	TokenNamepublic	
final	TokenNamefinal	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
Memtable	TokenNameIdentifier	 Memtable
>	TokenNameGREATER	
memtablesPendingFlush	TokenNameIdentifier	 memtables Pending Flush
;	TokenNameSEMICOLON	
public	TokenNamepublic	
final	TokenNamefinal	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
compacting	TokenNameIdentifier	 compacting
;	TokenNameSEMICOLON	
public	TokenNamepublic	
final	TokenNamefinal	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
sstables	TokenNameIdentifier	 sstables
;	TokenNameSEMICOLON	
public	TokenNamepublic	
final	TokenNamefinal	
SSTableIntervalTree	TokenNameIdentifier	 SS Table Interval Tree
intervalTree	TokenNameIdentifier	 interval Tree
;	TokenNameSEMICOLON	
View	TokenNameIdentifier	 View
(	TokenNameLPAREN	
Memtable	TokenNameIdentifier	 Memtable
memtable	TokenNameIdentifier	 memtable
,	TokenNameCOMMA	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
Memtable	TokenNameIdentifier	 Memtable
>	TokenNameGREATER	
pendingFlush	TokenNameIdentifier	 pending Flush
,	TokenNameCOMMA	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
compacting	TokenNameIdentifier	 compacting
,	TokenNameCOMMA	
SSTableIntervalTree	TokenNameIdentifier	 SS Table Interval Tree
intervalTree	TokenNameIdentifier	 interval Tree
)	TokenNameRPAREN	
{	TokenNameLBRACE	
this	TokenNamethis	
.	TokenNameDOT	
memtable	TokenNameIdentifier	 memtable
=	TokenNameEQUAL	
memtable	TokenNameIdentifier	 memtable
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
memtablesPendingFlush	TokenNameIdentifier	 memtables Pending Flush
=	TokenNameEQUAL	
pendingFlush	TokenNameIdentifier	 pending Flush
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
sstables	TokenNameIdentifier	 sstables
=	TokenNameEQUAL	
sstables	TokenNameIdentifier	 sstables
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
compacting	TokenNameIdentifier	 compacting
=	TokenNameEQUAL	
compacting	TokenNameIdentifier	 compacting
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
intervalTree	TokenNameIdentifier	 interval Tree
=	TokenNameEQUAL	
intervalTree	TokenNameIdentifier	 interval Tree
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
Sets	TokenNameIdentifier	 Sets
.	TokenNameDOT	
SetView	TokenNameIdentifier	 Set View
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
nonCompactingSStables	TokenNameIdentifier	 non Compacting S Stables
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
Sets	TokenNameIdentifier	 Sets
.	TokenNameDOT	
difference	TokenNameIdentifier	 difference
(	TokenNameLPAREN	
ImmutableSet	TokenNameIdentifier	 Immutable Set
.	TokenNameDOT	
copyOf	TokenNameIdentifier	 copy Of
(	TokenNameLPAREN	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
,	TokenNameCOMMA	
compacting	TokenNameIdentifier	 compacting
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
View	TokenNameIdentifier	 View
switchMemtable	TokenNameIdentifier	 switch Memtable
(	TokenNameLPAREN	
Memtable	TokenNameIdentifier	 Memtable
newMemtable	TokenNameIdentifier	 new Memtable
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
Memtable	TokenNameIdentifier	 Memtable
>	TokenNameGREATER	
newPending	TokenNameIdentifier	 new Pending
=	TokenNameEQUAL	
ImmutableSet	TokenNameIdentifier	 Immutable Set
.	TokenNameDOT	
<	TokenNameLESS	
Memtable	TokenNameIdentifier	 Memtable
>	TokenNameGREATER	
builder	TokenNameIdentifier	 builder
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
addAll	TokenNameIdentifier	 add All
(	TokenNameLPAREN	
memtablesPendingFlush	TokenNameIdentifier	 memtables Pending Flush
)	TokenNameRPAREN	
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
memtable	TokenNameIdentifier	 memtable
)	TokenNameRPAREN	
.	TokenNameDOT	
build	TokenNameIdentifier	 build
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
new	TokenNamenew	
View	TokenNameIdentifier	 View
(	TokenNameLPAREN	
newMemtable	TokenNameIdentifier	 new Memtable
,	TokenNameCOMMA	
newPending	TokenNameIdentifier	 new Pending
,	TokenNameCOMMA	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
compacting	TokenNameIdentifier	 compacting
,	TokenNameCOMMA	
intervalTree	TokenNameIdentifier	 interval Tree
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
View	TokenNameIdentifier	 View
renewMemtable	TokenNameIdentifier	 renew Memtable
(	TokenNameLPAREN	
Memtable	TokenNameIdentifier	 Memtable
newMemtable	TokenNameIdentifier	 new Memtable
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
new	TokenNamenew	
View	TokenNameIdentifier	 View
(	TokenNameLPAREN	
newMemtable	TokenNameIdentifier	 new Memtable
,	TokenNameCOMMA	
memtablesPendingFlush	TokenNameIdentifier	 memtables Pending Flush
,	TokenNameCOMMA	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
compacting	TokenNameIdentifier	 compacting
,	TokenNameCOMMA	
intervalTree	TokenNameIdentifier	 interval Tree
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
View	TokenNameIdentifier	 View
replaceFlushed	TokenNameIdentifier	 replace Flushed
(	TokenNameLPAREN	
Memtable	TokenNameIdentifier	 Memtable
flushedMemtable	TokenNameIdentifier	 flushed Memtable
,	TokenNameCOMMA	
SSTableReader	TokenNameIdentifier	 SS Table Reader
newSSTable	TokenNameIdentifier	 new SS Table
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
Memtable	TokenNameIdentifier	 Memtable
>	TokenNameGREATER	
newPending	TokenNameIdentifier	 new Pending
=	TokenNameEQUAL	
ImmutableSet	TokenNameIdentifier	 Immutable Set
.	TokenNameDOT	
copyOf	TokenNameIdentifier	 copy Of
(	TokenNameLPAREN	
Sets	TokenNameIdentifier	 Sets
.	TokenNameDOT	
difference	TokenNameIdentifier	 difference
(	TokenNameLPAREN	
memtablesPendingFlush	TokenNameIdentifier	 memtables Pending Flush
,	TokenNameCOMMA	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
singleton	TokenNameIdentifier	 singleton
(	TokenNameLPAREN	
flushedMemtable	TokenNameIdentifier	 flushed Memtable
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
newSSTables	TokenNameIdentifier	 new SS Tables
=	TokenNameEQUAL	
newSSTable	TokenNameIdentifier	 new SS Table
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
?	TokenNameQUESTION	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
emptySet	TokenNameIdentifier	 empty Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
:	TokenNameCOLON	
newSSTables	TokenNameIdentifier	 new SS Tables
(	TokenNameLPAREN	
newSSTable	TokenNameIdentifier	 new SS Table
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
SSTableIntervalTree	TokenNameIdentifier	 SS Table Interval Tree
intervalTree	TokenNameIdentifier	 interval Tree
=	TokenNameEQUAL	
buildIntervalTree	TokenNameIdentifier	 build Interval Tree
(	TokenNameLPAREN	
newSSTables	TokenNameIdentifier	 new SS Tables
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
new	TokenNamenew	
View	TokenNameIdentifier	 View
(	TokenNameLPAREN	
memtable	TokenNameIdentifier	 memtable
,	TokenNameCOMMA	
newPending	TokenNameIdentifier	 new Pending
,	TokenNameCOMMA	
newSSTables	TokenNameIdentifier	 new SS Tables
,	TokenNameCOMMA	
compacting	TokenNameIdentifier	 compacting
,	TokenNameCOMMA	
intervalTree	TokenNameIdentifier	 interval Tree
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
View	TokenNameIdentifier	 View
replace	TokenNameIdentifier	 replace
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
oldSSTables	TokenNameIdentifier	 old SS Tables
,	TokenNameCOMMA	
Iterable	TokenNameIdentifier	 Iterable
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
replacements	TokenNameIdentifier	 replacements
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
newSSTables	TokenNameIdentifier	 new SS Tables
=	TokenNameEQUAL	
newSSTables	TokenNameIdentifier	 new SS Tables
(	TokenNameLPAREN	
oldSSTables	TokenNameIdentifier	 old SS Tables
,	TokenNameCOMMA	
replacements	TokenNameIdentifier	 replacements
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
SSTableIntervalTree	TokenNameIdentifier	 SS Table Interval Tree
intervalTree	TokenNameIdentifier	 interval Tree
=	TokenNameEQUAL	
buildIntervalTree	TokenNameIdentifier	 build Interval Tree
(	TokenNameLPAREN	
newSSTables	TokenNameIdentifier	 new SS Tables
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
new	TokenNamenew	
View	TokenNameIdentifier	 View
(	TokenNameLPAREN	
memtable	TokenNameIdentifier	 memtable
,	TokenNameCOMMA	
memtablesPendingFlush	TokenNameIdentifier	 memtables Pending Flush
,	TokenNameCOMMA	
newSSTables	TokenNameIdentifier	 new SS Tables
,	TokenNameCOMMA	
compacting	TokenNameIdentifier	 compacting
,	TokenNameCOMMA	
intervalTree	TokenNameIdentifier	 interval Tree
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
View	TokenNameIdentifier	 View
markCompacting	TokenNameIdentifier	 mark Compacting
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
tomark	TokenNameIdentifier	 tomark
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
compactingNew	TokenNameIdentifier	 compacting New
=	TokenNameEQUAL	
ImmutableSet	TokenNameIdentifier	 Immutable Set
.	TokenNameDOT	
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
builder	TokenNameIdentifier	 builder
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
addAll	TokenNameIdentifier	 add All
(	TokenNameLPAREN	
compacting	TokenNameIdentifier	 compacting
)	TokenNameRPAREN	
.	TokenNameDOT	
addAll	TokenNameIdentifier	 add All
(	TokenNameLPAREN	
tomark	TokenNameIdentifier	 tomark
)	TokenNameRPAREN	
.	TokenNameDOT	
build	TokenNameIdentifier	 build
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
new	TokenNamenew	
View	TokenNameIdentifier	 View
(	TokenNameLPAREN	
memtable	TokenNameIdentifier	 memtable
,	TokenNameCOMMA	
memtablesPendingFlush	TokenNameIdentifier	 memtables Pending Flush
,	TokenNameCOMMA	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
compactingNew	TokenNameIdentifier	 compacting New
,	TokenNameCOMMA	
intervalTree	TokenNameIdentifier	 interval Tree
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
View	TokenNameIdentifier	 View
unmarkCompacting	TokenNameIdentifier	 unmark Compacting
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
tounmark	TokenNameIdentifier	 tounmark
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
compactingNew	TokenNameIdentifier	 compacting New
=	TokenNameEQUAL	
ImmutableSet	TokenNameIdentifier	 Immutable Set
.	TokenNameDOT	
copyOf	TokenNameIdentifier	 copy Of
(	TokenNameLPAREN	
Sets	TokenNameIdentifier	 Sets
.	TokenNameDOT	
difference	TokenNameIdentifier	 difference
(	TokenNameLPAREN	
compacting	TokenNameIdentifier	 compacting
,	TokenNameCOMMA	
ImmutableSet	TokenNameIdentifier	 Immutable Set
.	TokenNameDOT	
copyOf	TokenNameIdentifier	 copy Of
(	TokenNameLPAREN	
tounmark	TokenNameIdentifier	 tounmark
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
new	TokenNamenew	
View	TokenNameIdentifier	 View
(	TokenNameLPAREN	
memtable	TokenNameIdentifier	 memtable
,	TokenNameCOMMA	
memtablesPendingFlush	TokenNameIdentifier	 memtables Pending Flush
,	TokenNameCOMMA	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
compactingNew	TokenNameIdentifier	 compacting New
,	TokenNameCOMMA	
intervalTree	TokenNameIdentifier	 interval Tree
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
newSSTables	TokenNameIdentifier	 new SS Tables
(	TokenNameLPAREN	
SSTableReader	TokenNameIdentifier	 SS Table Reader
newSSTable	TokenNameIdentifier	 new SS Table
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assert	TokenNameassert	
newSSTable	TokenNameIdentifier	 new SS Table
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
// not performance-sensitive, don't obsess over doing a selection merge here 	TokenNameCOMMENT_LINE	not performance-sensitive, don't obsess over doing a selection merge here 
return	TokenNamereturn	
newSSTables	TokenNameIdentifier	 new SS Tables
(	TokenNameLPAREN	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
emptyList	TokenNameIdentifier	 empty List
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
singletonList	TokenNameIdentifier	 singleton List
(	TokenNameLPAREN	
newSSTable	TokenNameIdentifier	 new SS Table
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
newSSTables	TokenNameIdentifier	 new SS Tables
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
oldSSTables	TokenNameIdentifier	 old SS Tables
,	TokenNameCOMMA	
Iterable	TokenNameIdentifier	 Iterable
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
replacements	TokenNameIdentifier	 replacements
)	TokenNameRPAREN	
{	TokenNameLBRACE	
ImmutableSet	TokenNameIdentifier	 Immutable Set
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
oldSet	TokenNameIdentifier	 old Set
=	TokenNameEQUAL	
ImmutableSet	TokenNameIdentifier	 Immutable Set
.	TokenNameDOT	
copyOf	TokenNameIdentifier	 copy Of
(	TokenNameLPAREN	
oldSSTables	TokenNameIdentifier	 old SS Tables
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
int	TokenNameint	
newSSTablesSize	TokenNameIdentifier	 new SS Tables Size
=	TokenNameEQUAL	
sstables	TokenNameIdentifier	 sstables
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
-	TokenNameMINUS	
oldSSTables	TokenNameIdentifier	 old SS Tables
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
Iterables	TokenNameIdentifier	 Iterables
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
replacements	TokenNameIdentifier	 replacements
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assert	TokenNameassert	
newSSTablesSize	TokenNameIdentifier	 new SS Tables Size
>=	TokenNameGREATER_EQUAL	
Iterables	TokenNameIdentifier	 Iterables
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
replacements	TokenNameIdentifier	 replacements
)	TokenNameRPAREN	
:	TokenNameCOLON	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"Incoherent new size %d replacing %s by %s in %s"	TokenNameStringLiteral	Incoherent new size %d replacing %s by %s in %s
,	TokenNameCOMMA	
newSSTablesSize	TokenNameIdentifier	 new SS Tables Size
,	TokenNameCOMMA	
oldSSTables	TokenNameIdentifier	 old SS Tables
,	TokenNameCOMMA	
replacements	TokenNameIdentifier	 replacements
,	TokenNameCOMMA	
this	TokenNamethis	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
newSSTables	TokenNameIdentifier	 new SS Tables
=	TokenNameEQUAL	
new	TokenNamenew	
HashSet	TokenNameIdentifier	 Hash Set
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
(	TokenNameLPAREN	
newSSTablesSize	TokenNameIdentifier	 new SS Tables Size
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
SSTableReader	TokenNameIdentifier	 SS Table Reader
sstable	TokenNameIdentifier	 sstable
:	TokenNameCOLON	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
oldSet	TokenNameIdentifier	 old Set
.	TokenNameDOT	
contains	TokenNameIdentifier	 contains
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
)	TokenNameRPAREN	
)	TokenNameRPAREN	
newSSTables	TokenNameIdentifier	 new SS Tables
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
Iterables	TokenNameIdentifier	 Iterables
.	TokenNameDOT	
addAll	TokenNameIdentifier	 add All
(	TokenNameLPAREN	
newSSTables	TokenNameIdentifier	 new SS Tables
,	TokenNameCOMMA	
replacements	TokenNameIdentifier	 replacements
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assert	TokenNameassert	
newSSTables	TokenNameIdentifier	 new SS Tables
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
newSSTablesSize	TokenNameIdentifier	 new SS Tables Size
:	TokenNameCOLON	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"Expecting new size of %d, got %d while replacing %s by %s in %s"	TokenNameStringLiteral	Expecting new size of %d, got %d while replacing %s by %s in %s
,	TokenNameCOMMA	
newSSTablesSize	TokenNameIdentifier	 new SS Tables Size
,	TokenNameCOMMA	
newSSTables	TokenNameIdentifier	 new SS Tables
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
oldSSTables	TokenNameIdentifier	 old SS Tables
,	TokenNameCOMMA	
replacements	TokenNameIdentifier	 replacements
,	TokenNameCOMMA	
this	TokenNamethis	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
ImmutableSet	TokenNameIdentifier	 Immutable Set
.	TokenNameDOT	
copyOf	TokenNameIdentifier	 copy Of
(	TokenNameLPAREN	
newSSTables	TokenNameIdentifier	 new SS Tables
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
String	TokenNameIdentifier	 String
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"View(pending_count=%d, sstables=%s, compacting=%s)"	TokenNameStringLiteral	View(pending_count=%d, sstables=%s, compacting=%s)
,	TokenNameCOMMA	
memtablesPendingFlush	TokenNameIdentifier	 memtables Pending Flush
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
compacting	TokenNameIdentifier	 compacting
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
