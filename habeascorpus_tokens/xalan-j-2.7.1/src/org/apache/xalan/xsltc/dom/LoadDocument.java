/* * Licensed to the Apache Software Foundation (ASF) under one * or more contributor license agreements. See the NOTICE file * distributed with this work for additional information * regarding copyright ownership. The ASF licenses this file * to you under the Apache License, Version 2.0 (the "License"); * you may not use this file except in compliance with the License. * You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */	TokenNameCOMMENT_BLOCK	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
/* * $Id: LoadDocument.java 468651 2006-10-28 07:04:25Z minchau $ */	TokenNameCOMMENT_BLOCK	 $Id: LoadDocument.java 468651 2006-10-28 07:04:25Z minchau $ 
package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xalan	TokenNameIdentifier	 xalan
.	TokenNameDOT	
xsltc	TokenNameIdentifier	 xsltc
.	TokenNameDOT	
dom	TokenNameIdentifier	 dom
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
FileNotFoundException	TokenNameIdentifier	 File Not Found Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
javax	TokenNameIdentifier	 javax
.	TokenNameDOT	
xml	TokenNameIdentifier	 xml
.	TokenNameDOT	
transform	TokenNameIdentifier	 transform
.	TokenNameDOT	
stream	TokenNameIdentifier	 stream
.	TokenNameDOT	
StreamSource	TokenNameIdentifier	 Stream Source
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xalan	TokenNameIdentifier	 xalan
.	TokenNameDOT	
xsltc	TokenNameIdentifier	 xsltc
.	TokenNameDOT	
DOM	TokenNameIdentifier	 DOM
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xalan	TokenNameIdentifier	 xalan
.	TokenNameDOT	
xsltc	TokenNameIdentifier	 xsltc
.	TokenNameDOT	
DOMCache	TokenNameIdentifier	 DOM Cache
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xalan	TokenNameIdentifier	 xalan
.	TokenNameDOT	
xsltc	TokenNameIdentifier	 xsltc
.	TokenNameDOT	
DOMEnhancedForDTM	TokenNameIdentifier	 DOM Enhanced For DTM
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xalan	TokenNameIdentifier	 xalan
.	TokenNameDOT	
xsltc	TokenNameIdentifier	 xsltc
.	TokenNameDOT	
TransletException	TokenNameIdentifier	 Translet Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xalan	TokenNameIdentifier	 xalan
.	TokenNameDOT	
xsltc	TokenNameIdentifier	 xsltc
.	TokenNameDOT	
runtime	TokenNameIdentifier	 runtime
.	TokenNameDOT	
AbstractTranslet	TokenNameIdentifier	 Abstract Translet
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xalan	TokenNameIdentifier	 xalan
.	TokenNameDOT	
xsltc	TokenNameIdentifier	 xsltc
.	TokenNameDOT	
trax	TokenNameIdentifier	 trax
.	TokenNameDOT	
TemplatesImpl	TokenNameIdentifier	 Templates Impl
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xml	TokenNameIdentifier	 xml
.	TokenNameDOT	
dtm	TokenNameIdentifier	 dtm
.	TokenNameDOT	
DTM	TokenNameIdentifier	 DTM
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xml	TokenNameIdentifier	 xml
.	TokenNameDOT	
dtm	TokenNameIdentifier	 dtm
.	TokenNameDOT	
DTMAxisIterator	TokenNameIdentifier	 DTM Axis Iterator
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xml	TokenNameIdentifier	 xml
.	TokenNameDOT	
dtm	TokenNameIdentifier	 dtm
.	TokenNameDOT	
DTMManager	TokenNameIdentifier	 DTM Manager
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xml	TokenNameIdentifier	 xml
.	TokenNameDOT	
dtm	TokenNameIdentifier	 dtm
.	TokenNameDOT	
ref	TokenNameIdentifier	 ref
.	TokenNameDOT	
DTMDefaultBase	TokenNameIdentifier	 DTM Default Base
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xml	TokenNameIdentifier	 xml
.	TokenNameDOT	
dtm	TokenNameIdentifier	 dtm
.	TokenNameDOT	
ref	TokenNameIdentifier	 ref
.	TokenNameDOT	
EmptyIterator	TokenNameIdentifier	 Empty Iterator
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
xml	TokenNameIdentifier	 xml
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
SystemIDResolver	TokenNameIdentifier	 System ID Resolver
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
xml	TokenNameIdentifier	 xml
.	TokenNameDOT	
sax	TokenNameIdentifier	 sax
.	TokenNameDOT	
InputSource	TokenNameIdentifier	 Input Source
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
xml	TokenNameIdentifier	 xml
.	TokenNameDOT	
sax	TokenNameIdentifier	 sax
.	TokenNameDOT	
XMLReader	TokenNameIdentifier	 XML Reader
;	TokenNameSEMICOLON	
/** * @author Morten Jorgensen */	TokenNameCOMMENT_JAVADOC	 @author Morten Jorgensen 
public	TokenNamepublic	
final	TokenNamefinal	
class	TokenNameclass	
LoadDocument	TokenNameIdentifier	 Load Document
{	TokenNameLBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
NAMESPACE_FEATURE	TokenNameIdentifier	 NAMESPACE  FEATURE
=	TokenNameEQUAL	
"http://xml.org/sax/features/namespaces"	TokenNameStringLiteral	http://xml.org/sax/features/namespaces
;	TokenNameSEMICOLON	
/** * Interprets the arguments passed from the document() function (see * org/apache/xalan/xsltc/compiler/DocumentCall.java) and returns an * iterator containing the requested nodes. Builds a union-iterator if * several documents are requested. * 2 arguments arg1 and arg2. document(Obj, node-set) call */	TokenNameCOMMENT_JAVADOC	 Interprets the arguments passed from the document() function (see org/apache/xalan/xsltc/compiler/DocumentCall.java) and returns an iterator containing the requested nodes. Builds a union-iterator if several documents are requested. 2 arguments arg1 and arg2. document(Obj, node-set) call 
public	TokenNamepublic	
static	TokenNamestatic	
DTMAxisIterator	TokenNameIdentifier	 DTM Axis Iterator
documentF	TokenNameIdentifier	 document F
(	TokenNameLPAREN	
Object	TokenNameIdentifier	 Object
arg1	TokenNameIdentifier	 arg1
,	TokenNameCOMMA	
DTMAxisIterator	TokenNameIdentifier	 DTM Axis Iterator
arg2	TokenNameIdentifier	 arg2
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
xslURI	TokenNameIdentifier	 xsl URI
,	TokenNameCOMMA	
AbstractTranslet	TokenNameIdentifier	 Abstract Translet
translet	TokenNameIdentifier	 translet
,	TokenNameCOMMA	
DOM	TokenNameIdentifier	 DOM
dom	TokenNameIdentifier	 dom
)	TokenNameRPAREN	
throws	TokenNamethrows	
TransletException	TokenNameIdentifier	 Translet Exception
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
baseURI	TokenNameIdentifier	 base URI
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
int	TokenNameint	
arg2FirstNode	TokenNameIdentifier	 arg2 First Node
=	TokenNameEQUAL	
arg2	TokenNameIdentifier	 arg2
.	TokenNameDOT	
next	TokenNameIdentifier	 next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
arg2FirstNode	TokenNameIdentifier	 arg2 First Node
==	TokenNameEQUAL_EQUAL	
DTMAxisIterator	TokenNameIdentifier	 DTM Axis Iterator
.	TokenNameDOT	
END	TokenNameIdentifier	 END
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// the second argument node-set is empty 	TokenNameCOMMENT_LINE	the second argument node-set is empty 
return	TokenNamereturn	
EmptyIterator	TokenNameIdentifier	 Empty Iterator
.	TokenNameDOT	
getInstance	TokenNameIdentifier	 get Instance
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
//System.err.println("arg2FirstNode name: " 	TokenNameCOMMENT_LINE	System.err.println("arg2FirstNode name: " 
// + dom.getNodeName(arg2FirstNode )+"[" 	TokenNameCOMMENT_LINE	+ dom.getNodeName(arg2FirstNode )+"[" 
// +Integer.toHexString(arg2FirstNode )+"]"); 	TokenNameCOMMENT_LINE	+Integer.toHexString(arg2FirstNode )+"]"); 
baseURI	TokenNameIdentifier	 base URI
=	TokenNameEQUAL	
dom	TokenNameIdentifier	 dom
.	TokenNameDOT	
getDocumentURI	TokenNameIdentifier	 get Document URI
(	TokenNameLPAREN	
arg2FirstNode	TokenNameIdentifier	 arg2 First Node
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
SystemIDResolver	TokenNameIdentifier	 System ID Resolver
.	TokenNameDOT	
isAbsoluteURI	TokenNameIdentifier	 is Absolute URI
(	TokenNameLPAREN	
baseURI	TokenNameIdentifier	 base URI
)	TokenNameRPAREN	
)	TokenNameRPAREN	
baseURI	TokenNameIdentifier	 base URI
=	TokenNameEQUAL	
SystemIDResolver	TokenNameIdentifier	 System ID Resolver
.	TokenNameDOT	
getAbsoluteURIFromRelative	TokenNameIdentifier	 get Absolute URI From Relative
(	TokenNameLPAREN	
baseURI	TokenNameIdentifier	 base URI
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
arg1	TokenNameIdentifier	 arg1
instanceof	TokenNameinstanceof	
String	TokenNameIdentifier	 String
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
)	TokenNameRPAREN	
arg1	TokenNameIdentifier	 arg1
)	TokenNameRPAREN	
.	TokenNameDOT	
length	TokenNameIdentifier	 length
(	TokenNameLPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
xslURI	TokenNameIdentifier	 xsl URI
,	TokenNameCOMMA	
""	TokenNameStringLiteral	 
,	TokenNameCOMMA	
translet	TokenNameIdentifier	 translet
,	TokenNameCOMMA	
dom	TokenNameIdentifier	 dom
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
return	TokenNamereturn	
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
)	TokenNameRPAREN	
arg1	TokenNameIdentifier	 arg1
,	TokenNameCOMMA	
baseURI	TokenNameIdentifier	 base URI
,	TokenNameCOMMA	
translet	TokenNameIdentifier	 translet
,	TokenNameCOMMA	
dom	TokenNameIdentifier	 dom
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
arg1	TokenNameIdentifier	 arg1
instanceof	TokenNameinstanceof	
DTMAxisIterator	TokenNameIdentifier	 DTM Axis Iterator
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
(	TokenNameLPAREN	
DTMAxisIterator	TokenNameIdentifier	 DTM Axis Iterator
)	TokenNameRPAREN	
arg1	TokenNameIdentifier	 arg1
,	TokenNameCOMMA	
baseURI	TokenNameIdentifier	 base URI
,	TokenNameCOMMA	
translet	TokenNameIdentifier	 translet
,	TokenNameCOMMA	
dom	TokenNameIdentifier	 dom
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
err	TokenNameIdentifier	 err
=	TokenNameEQUAL	
"document("	TokenNameStringLiteral	document(
+	TokenNamePLUS	
arg1	TokenNameIdentifier	 arg1
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
")"	TokenNameStringLiteral	)
;	TokenNameSEMICOLON	
throw	TokenNamethrow	
new	TokenNamenew	
IllegalArgumentException	TokenNameIdentifier	 Illegal Argument Exception
(	TokenNameLPAREN	
err	TokenNameIdentifier	 err
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
Exception	TokenNameIdentifier	 Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
TransletException	TokenNameIdentifier	 Translet Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** * Interprets the arguments passed from the document() function (see * org/apache/xalan/xsltc/compiler/DocumentCall.java) and returns an * iterator containing the requested nodes. Builds a union-iterator if * several documents are requested. * 1 arguments arg. document(Obj) call */	TokenNameCOMMENT_JAVADOC	 Interprets the arguments passed from the document() function (see org/apache/xalan/xsltc/compiler/DocumentCall.java) and returns an iterator containing the requested nodes. Builds a union-iterator if several documents are requested. 1 arguments arg. document(Obj) call 
public	TokenNamepublic	
static	TokenNamestatic	
DTMAxisIterator	TokenNameIdentifier	 DTM Axis Iterator
documentF	TokenNameIdentifier	 document F
(	TokenNameLPAREN	
Object	TokenNameIdentifier	 Object
arg	TokenNameIdentifier	 arg
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
xslURI	TokenNameIdentifier	 xsl URI
,	TokenNameCOMMA	
AbstractTranslet	TokenNameIdentifier	 Abstract Translet
translet	TokenNameIdentifier	 translet
,	TokenNameCOMMA	
DOM	TokenNameIdentifier	 DOM
dom	TokenNameIdentifier	 dom
)	TokenNameRPAREN	
throws	TokenNamethrows	
TransletException	TokenNameIdentifier	 Translet Exception
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
arg	TokenNameIdentifier	 arg
instanceof	TokenNameinstanceof	
String	TokenNameIdentifier	 String
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
xslURI	TokenNameIdentifier	 xsl URI
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
xslURI	TokenNameIdentifier	 xsl URI
=	TokenNameEQUAL	
""	TokenNameStringLiteral	 
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
baseURI	TokenNameIdentifier	 base URI
=	TokenNameEQUAL	
xslURI	TokenNameIdentifier	 xsl URI
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
SystemIDResolver	TokenNameIdentifier	 System ID Resolver
.	TokenNameDOT	
isAbsoluteURI	TokenNameIdentifier	 is Absolute URI
(	TokenNameLPAREN	
xslURI	TokenNameIdentifier	 xsl URI
)	TokenNameRPAREN	
)	TokenNameRPAREN	
baseURI	TokenNameIdentifier	 base URI
=	TokenNameEQUAL	
SystemIDResolver	TokenNameIdentifier	 System ID Resolver
.	TokenNameDOT	
getAbsoluteURIFromRelative	TokenNameIdentifier	 get Absolute URI From Relative
(	TokenNameLPAREN	
xslURI	TokenNameIdentifier	 xsl URI
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
href	TokenNameIdentifier	 href
=	TokenNameEQUAL	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
)	TokenNameRPAREN	
arg	TokenNameIdentifier	 arg
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
href	TokenNameIdentifier	 href
.	TokenNameDOT	
length	TokenNameIdentifier	 length
(	TokenNameLPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
href	TokenNameIdentifier	 href
=	TokenNameEQUAL	
""	TokenNameStringLiteral	 
;	TokenNameSEMICOLON	
// %OPT% Optimization to cache the stylesheet DOM. 	TokenNameCOMMENT_LINE	%OPT% Optimization to cache the stylesheet DOM. 
// The stylesheet DOM is built once and cached 	TokenNameCOMMENT_LINE	The stylesheet DOM is built once and cached 
// in the Templates object. 	TokenNameCOMMENT_LINE	in the Templates object. 
TemplatesImpl	TokenNameIdentifier	 Templates Impl
templates	TokenNameIdentifier	 templates
=	TokenNameEQUAL	
(	TokenNameLPAREN	
TemplatesImpl	TokenNameIdentifier	 Templates Impl
)	TokenNameRPAREN	
translet	TokenNameIdentifier	 translet
.	TokenNameDOT	
getTemplates	TokenNameIdentifier	 get Templates
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
DOM	TokenNameIdentifier	 DOM
sdom	TokenNameIdentifier	 sdom
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
templates	TokenNameIdentifier	 templates
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
sdom	TokenNameIdentifier	 sdom
=	TokenNameEQUAL	
templates	TokenNameIdentifier	 templates
.	TokenNameDOT	
getStylesheetDOM	TokenNameIdentifier	 get Stylesheet DOM
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// If the cached dom exists, we need to migrate it 	TokenNameCOMMENT_LINE	If the cached dom exists, we need to migrate it 
// to the new DTMManager and create a DTMAxisIterator 	TokenNameCOMMENT_LINE	to the new DTMManager and create a DTMAxisIterator 
// for the document. 	TokenNameCOMMENT_LINE	for the document. 
if	TokenNameif	
(	TokenNameLPAREN	
sdom	TokenNameIdentifier	 sdom
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
sdom	TokenNameIdentifier	 sdom
,	TokenNameCOMMA	
translet	TokenNameIdentifier	 translet
,	TokenNameCOMMA	
dom	TokenNameIdentifier	 dom
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
return	TokenNamereturn	
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
href	TokenNameIdentifier	 href
,	TokenNameCOMMA	
baseURI	TokenNameIdentifier	 base URI
,	TokenNameCOMMA	
translet	TokenNameIdentifier	 translet
,	TokenNameCOMMA	
dom	TokenNameIdentifier	 dom
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
return	TokenNamereturn	
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
href	TokenNameIdentifier	 href
,	TokenNameCOMMA	
baseURI	TokenNameIdentifier	 base URI
,	TokenNameCOMMA	
translet	TokenNameIdentifier	 translet
,	TokenNameCOMMA	
dom	TokenNameIdentifier	 dom
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
arg	TokenNameIdentifier	 arg
instanceof	TokenNameinstanceof	
DTMAxisIterator	TokenNameIdentifier	 DTM Axis Iterator
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
(	TokenNameLPAREN	
DTMAxisIterator	TokenNameIdentifier	 DTM Axis Iterator
)	TokenNameRPAREN	
arg	TokenNameIdentifier	 arg
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
translet	TokenNameIdentifier	 translet
,	TokenNameCOMMA	
dom	TokenNameIdentifier	 dom
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
err	TokenNameIdentifier	 err
=	TokenNameEQUAL	
"document("	TokenNameStringLiteral	document(
+	TokenNamePLUS	
arg	TokenNameIdentifier	 arg
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
")"	TokenNameStringLiteral	)
;	TokenNameSEMICOLON	
throw	TokenNamethrow	
new	TokenNamenew	
IllegalArgumentException	TokenNameIdentifier	 Illegal Argument Exception
(	TokenNameLPAREN	
err	TokenNameIdentifier	 err
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
Exception	TokenNameIdentifier	 Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
TransletException	TokenNameIdentifier	 Translet Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
DTMAxisIterator	TokenNameIdentifier	 DTM Axis Iterator
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
uri	TokenNameIdentifier	 uri
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
base	TokenNameIdentifier	 base
,	TokenNameCOMMA	
AbstractTranslet	TokenNameIdentifier	 Abstract Translet
translet	TokenNameIdentifier	 translet
,	TokenNameCOMMA	
DOM	TokenNameIdentifier	 DOM
dom	TokenNameIdentifier	 dom
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
return	TokenNamereturn	
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
uri	TokenNameIdentifier	 uri
,	TokenNameCOMMA	
base	TokenNameIdentifier	 base
,	TokenNameCOMMA	
translet	TokenNameIdentifier	 translet
,	TokenNameCOMMA	
dom	TokenNameIdentifier	 dom
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
DTMAxisIterator	TokenNameIdentifier	 DTM Axis Iterator
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
uri	TokenNameIdentifier	 uri
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
base	TokenNameIdentifier	 base
,	TokenNameCOMMA	
AbstractTranslet	TokenNameIdentifier	 Abstract Translet
translet	TokenNameIdentifier	 translet
,	TokenNameCOMMA	
DOM	TokenNameIdentifier	 DOM
dom	TokenNameIdentifier	 dom
,	TokenNameCOMMA	
boolean	TokenNameboolean	
cacheDOM	TokenNameIdentifier	 cache DOM
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
originalUri	TokenNameIdentifier	 original Uri
=	TokenNameEQUAL	
uri	TokenNameIdentifier	 uri
;	TokenNameSEMICOLON	
MultiDOM	TokenNameIdentifier	 Multi DOM
multiplexer	TokenNameIdentifier	 multiplexer
=	TokenNameEQUAL	
(	TokenNameLPAREN	
MultiDOM	TokenNameIdentifier	 Multi DOM
)	TokenNameRPAREN	
dom	TokenNameIdentifier	 dom
;	TokenNameSEMICOLON	
// Prepend URI base to URI (from context) 	TokenNameCOMMENT_LINE	Prepend URI base to URI (from context) 
if	TokenNameif	
(	TokenNameLPAREN	
base	TokenNameIdentifier	 base
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
&&	TokenNameAND_AND	
!	TokenNameNOT	
base	TokenNameIdentifier	 base
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
""	TokenNameStringLiteral	 
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
uri	TokenNameIdentifier	 uri
=	TokenNameEQUAL	
SystemIDResolver	TokenNameIdentifier	 System ID Resolver
.	TokenNameDOT	
getAbsoluteURI	TokenNameIdentifier	 get Absolute URI
(	TokenNameLPAREN	
uri	TokenNameIdentifier	 uri
,	TokenNameCOMMA	
base	TokenNameIdentifier	 base
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Return an empty iterator if the URI is clearly invalid 	TokenNameCOMMENT_LINE	Return an empty iterator if the URI is clearly invalid 
// (to prevent some unncessary MalformedURL exceptions). 	TokenNameCOMMENT_LINE	(to prevent some unncessary MalformedURL exceptions). 
if	TokenNameif	
(	TokenNameLPAREN	
uri	TokenNameIdentifier	 uri
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
||	TokenNameOR_OR	
uri	TokenNameIdentifier	 uri
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
""	TokenNameStringLiteral	 
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
(	TokenNameLPAREN	
EmptyIterator	TokenNameIdentifier	 Empty Iterator
.	TokenNameDOT	
getInstance	TokenNameIdentifier	 get Instance
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Check if this DOM has already been added to the multiplexer 	TokenNameCOMMENT_LINE	Check if this DOM has already been added to the multiplexer 
int	TokenNameint	
mask	TokenNameIdentifier	 mask
=	TokenNameEQUAL	
multiplexer	TokenNameIdentifier	 multiplexer
.	TokenNameDOT	
getDocumentMask	TokenNameIdentifier	 get Document Mask
(	TokenNameLPAREN	
uri	TokenNameIdentifier	 uri
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
mask	TokenNameIdentifier	 mask
!=	TokenNameNOT_EQUAL	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
DOM	TokenNameIdentifier	 DOM
newDom	TokenNameIdentifier	 new Dom
=	TokenNameEQUAL	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
DOMAdapter	TokenNameIdentifier	 DOM Adapter
)	TokenNameRPAREN	
multiplexer	TokenNameIdentifier	 multiplexer
.	TokenNameDOT	
getDOMAdapter	TokenNameIdentifier	 get DOM Adapter
(	TokenNameLPAREN	
uri	TokenNameIdentifier	 uri
)	TokenNameRPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getDOMImpl	TokenNameIdentifier	 get DOM Impl
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
newDom	TokenNameIdentifier	 new Dom
instanceof	TokenNameinstanceof	
DOMEnhancedForDTM	TokenNameIdentifier	 DOM Enhanced For DTM
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
new	TokenNamenew	
SingletonIterator	TokenNameIdentifier	 Singleton Iterator
(	TokenNameLPAREN	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
DOMEnhancedForDTM	TokenNameIdentifier	 DOM Enhanced For DTM
)	TokenNameRPAREN	
newDom	TokenNameIdentifier	 new Dom
)	TokenNameRPAREN	
.	TokenNameDOT	
getDocument	TokenNameIdentifier	 get Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
// Check if we can get the DOM from a DOMCache 	TokenNameCOMMENT_LINE	Check if we can get the DOM from a DOMCache 
DOMCache	TokenNameIdentifier	 DOM Cache
cache	TokenNameIdentifier	 cache
=	TokenNameEQUAL	
translet	TokenNameIdentifier	 translet
.	TokenNameDOT	
getDOMCache	TokenNameIdentifier	 get DOM Cache
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
DOM	TokenNameIdentifier	 DOM
newdom	TokenNameIdentifier	 newdom
;	TokenNameSEMICOLON	
mask	TokenNameIdentifier	 mask
=	TokenNameEQUAL	
multiplexer	TokenNameIdentifier	 multiplexer
.	TokenNameDOT	
nextMask	TokenNameIdentifier	 next Mask
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// peek 	TokenNameCOMMENT_LINE	peek 
if	TokenNameif	
(	TokenNameLPAREN	
cache	TokenNameIdentifier	 cache
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
newdom	TokenNameIdentifier	 newdom
=	TokenNameEQUAL	
cache	TokenNameIdentifier	 cache
.	TokenNameDOT	
retrieveDocument	TokenNameIdentifier	 retrieve Document
(	TokenNameLPAREN	
base	TokenNameIdentifier	 base
,	TokenNameCOMMA	
originalUri	TokenNameIdentifier	 original Uri
,	TokenNameCOMMA	
translet	TokenNameIdentifier	 translet
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
newdom	TokenNameIdentifier	 newdom
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
Exception	TokenNameIdentifier	 Exception
e	TokenNameIdentifier	 e
=	TokenNameEQUAL	
new	TokenNamenew	
FileNotFoundException	TokenNameIdentifier	 File Not Found Exception
(	TokenNameLPAREN	
originalUri	TokenNameIdentifier	 original Uri
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
throw	TokenNamethrow	
new	TokenNamenew	
TransletException	TokenNameIdentifier	 Translet Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
// Parse the input document and construct DOM object 	TokenNameCOMMENT_LINE	Parse the input document and construct DOM object 
// Trust the DTMManager to pick the right parser and 	TokenNameCOMMENT_LINE	Trust the DTMManager to pick the right parser and 
// set up the DOM correctly. 	TokenNameCOMMENT_LINE	set up the DOM correctly. 
XSLTCDTMManager	TokenNameIdentifier	 XSLTCDTM Manager
dtmManager	TokenNameIdentifier	 dtm Manager
=	TokenNameEQUAL	
(	TokenNameLPAREN	
XSLTCDTMManager	TokenNameIdentifier	 XSLTCDTM Manager
)	TokenNameRPAREN	
multiplexer	TokenNameIdentifier	 multiplexer
.	TokenNameDOT	
getDTMManager	TokenNameIdentifier	 get DTM Manager
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
DOMEnhancedForDTM	TokenNameIdentifier	 DOM Enhanced For DTM
enhancedDOM	TokenNameIdentifier	 enhanced DOM
=	TokenNameEQUAL	
(	TokenNameLPAREN	
DOMEnhancedForDTM	TokenNameIdentifier	 DOM Enhanced For DTM
)	TokenNameRPAREN	
dtmManager	TokenNameIdentifier	 dtm Manager
.	TokenNameDOT	
getDTM	TokenNameIdentifier	 get DTM
(	TokenNameLPAREN	
new	TokenNamenew	
StreamSource	TokenNameIdentifier	 Stream Source
(	TokenNameLPAREN	
uri	TokenNameIdentifier	 uri
)	TokenNameRPAREN	
,	TokenNameCOMMA	
false	TokenNamefalse	
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
false	TokenNamefalse	
,	TokenNameCOMMA	
translet	TokenNameIdentifier	 translet
.	TokenNameDOT	
hasIdCall	TokenNameIdentifier	 has Id Call
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
cacheDOM	TokenNameIdentifier	 cache DOM
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
newdom	TokenNameIdentifier	 newdom
=	TokenNameEQUAL	
enhancedDOM	TokenNameIdentifier	 enhanced DOM
;	TokenNameSEMICOLON	
// Cache the stylesheet DOM in the Templates object 	TokenNameCOMMENT_LINE	Cache the stylesheet DOM in the Templates object 
if	TokenNameif	
(	TokenNameLPAREN	
cacheDOM	TokenNameIdentifier	 cache DOM
)	TokenNameRPAREN	
{	TokenNameLBRACE	
TemplatesImpl	TokenNameIdentifier	 Templates Impl
templates	TokenNameIdentifier	 templates
=	TokenNameEQUAL	
(	TokenNameLPAREN	
TemplatesImpl	TokenNameIdentifier	 Templates Impl
)	TokenNameRPAREN	
translet	TokenNameIdentifier	 translet
.	TokenNameDOT	
getTemplates	TokenNameIdentifier	 get Templates
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
templates	TokenNameIdentifier	 templates
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
templates	TokenNameIdentifier	 templates
.	TokenNameDOT	
setStylesheetDOM	TokenNameIdentifier	 set Stylesheet DOM
(	TokenNameLPAREN	
enhancedDOM	TokenNameIdentifier	 enhanced DOM
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
translet	TokenNameIdentifier	 translet
.	TokenNameDOT	
prepassDocument	TokenNameIdentifier	 prepass Document
(	TokenNameLPAREN	
enhancedDOM	TokenNameIdentifier	 enhanced DOM
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
enhancedDOM	TokenNameIdentifier	 enhanced DOM
.	TokenNameDOT	
setDocumentURI	TokenNameIdentifier	 set Document URI
(	TokenNameLPAREN	
uri	TokenNameIdentifier	 uri
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Wrap the DOM object in a DOM adapter and add to multiplexer 	TokenNameCOMMENT_LINE	Wrap the DOM object in a DOM adapter and add to multiplexer 
final	TokenNamefinal	
DOMAdapter	TokenNameIdentifier	 DOM Adapter
domAdapter	TokenNameIdentifier	 dom Adapter
=	TokenNameEQUAL	
translet	TokenNameIdentifier	 translet
.	TokenNameDOT	
makeDOMAdapter	TokenNameIdentifier	 make DOM Adapter
(	TokenNameLPAREN	
newdom	TokenNameIdentifier	 newdom
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
multiplexer	TokenNameIdentifier	 multiplexer
.	TokenNameDOT	
addDOMAdapter	TokenNameIdentifier	 add DOM Adapter
(	TokenNameLPAREN	
domAdapter	TokenNameIdentifier	 dom Adapter
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Create index for any key elements 	TokenNameCOMMENT_LINE	Create index for any key elements 
translet	TokenNameIdentifier	 translet
.	TokenNameDOT	
buildKeys	TokenNameIdentifier	 build Keys
(	TokenNameLPAREN	
domAdapter	TokenNameIdentifier	 dom Adapter
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
newdom	TokenNameIdentifier	 newdom
.	TokenNameDOT	
getDocument	TokenNameIdentifier	 get Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Return a singleton iterator containing the root node 	TokenNameCOMMENT_LINE	Return a singleton iterator containing the root node 
return	TokenNamereturn	
new	TokenNamenew	
SingletonIterator	TokenNameIdentifier	 Singleton Iterator
(	TokenNameLPAREN	
newdom	TokenNameIdentifier	 newdom
.	TokenNameDOT	
getDocument	TokenNameIdentifier	 get Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
Exception	TokenNameIdentifier	 Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
e	TokenNameIdentifier	 e
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
DTMAxisIterator	TokenNameIdentifier	 DTM Axis Iterator
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
DTMAxisIterator	TokenNameIdentifier	 DTM Axis Iterator
arg1	TokenNameIdentifier	 arg1
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
baseURI	TokenNameIdentifier	 base URI
,	TokenNameCOMMA	
AbstractTranslet	TokenNameIdentifier	 Abstract Translet
translet	TokenNameIdentifier	 translet
,	TokenNameCOMMA	
DOM	TokenNameIdentifier	 DOM
dom	TokenNameIdentifier	 dom
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
UnionIterator	TokenNameIdentifier	 Union Iterator
union	TokenNameIdentifier	 union
=	TokenNameEQUAL	
new	TokenNamenew	
UnionIterator	TokenNameIdentifier	 Union Iterator
(	TokenNameLPAREN	
dom	TokenNameIdentifier	 dom
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
int	TokenNameint	
node	TokenNameIdentifier	 node
=	TokenNameEQUAL	
DTM	TokenNameIdentifier	 DTM
.	TokenNameDOT	
NULL	TokenNameIdentifier	 NULL
;	TokenNameSEMICOLON	
while	TokenNamewhile	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
node	TokenNameIdentifier	 node
=	TokenNameEQUAL	
arg1	TokenNameIdentifier	 arg1
.	TokenNameDOT	
next	TokenNameIdentifier	 next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
!=	TokenNameNOT_EQUAL	
DTM	TokenNameIdentifier	 DTM
.	TokenNameDOT	
NULL	TokenNameIdentifier	 NULL
)	TokenNameRPAREN	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
uri	TokenNameIdentifier	 uri
=	TokenNameEQUAL	
dom	TokenNameIdentifier	 dom
.	TokenNameDOT	
getStringValueX	TokenNameIdentifier	 get String Value X
(	TokenNameLPAREN	
node	TokenNameIdentifier	 node
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//document(node-set) if true; document(node-set,node-set) if false 	TokenNameCOMMENT_LINE	document(node-set) if true; document(node-set,node-set) if false 
if	TokenNameif	
(	TokenNameLPAREN	
baseURI	TokenNameIdentifier	 base URI
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
baseURI	TokenNameIdentifier	 base URI
=	TokenNameEQUAL	
dom	TokenNameIdentifier	 dom
.	TokenNameDOT	
getDocumentURI	TokenNameIdentifier	 get Document URI
(	TokenNameLPAREN	
node	TokenNameIdentifier	 node
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
SystemIDResolver	TokenNameIdentifier	 System ID Resolver
.	TokenNameDOT	
isAbsoluteURI	TokenNameIdentifier	 is Absolute URI
(	TokenNameLPAREN	
baseURI	TokenNameIdentifier	 base URI
)	TokenNameRPAREN	
)	TokenNameRPAREN	
baseURI	TokenNameIdentifier	 base URI
=	TokenNameEQUAL	
SystemIDResolver	TokenNameIdentifier	 System ID Resolver
.	TokenNameDOT	
getAbsoluteURIFromRelative	TokenNameIdentifier	 get Absolute URI From Relative
(	TokenNameLPAREN	
baseURI	TokenNameIdentifier	 base URI
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
union	TokenNameIdentifier	 union
.	TokenNameDOT	
addIterator	TokenNameIdentifier	 add Iterator
(	TokenNameLPAREN	
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
uri	TokenNameIdentifier	 uri
,	TokenNameCOMMA	
baseURI	TokenNameIdentifier	 base URI
,	TokenNameCOMMA	
translet	TokenNameIdentifier	 translet
,	TokenNameCOMMA	
dom	TokenNameIdentifier	 dom
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
(	TokenNameLPAREN	
union	TokenNameIdentifier	 union
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Create a DTMAxisIterator for the newdom. This is currently only * used to create an iterator for the cached stylesheet DOM. * * @param newdom the cached stylesheet DOM * @param translet the translet * @param the main dom (should be a MultiDOM) * @return a DTMAxisIterator from the document root */	TokenNameCOMMENT_JAVADOC	 Create a DTMAxisIterator for the newdom. This is currently only used to create an iterator for the cached stylesheet DOM. * @param newdom the cached stylesheet DOM @param translet the translet @param the main dom (should be a MultiDOM) @return a DTMAxisIterator from the document root 
private	TokenNameprivate	
static	TokenNamestatic	
DTMAxisIterator	TokenNameIdentifier	 DTM Axis Iterator
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
DOM	TokenNameIdentifier	 DOM
newdom	TokenNameIdentifier	 newdom
,	TokenNameCOMMA	
AbstractTranslet	TokenNameIdentifier	 Abstract Translet
translet	TokenNameIdentifier	 translet
,	TokenNameCOMMA	
DOM	TokenNameIdentifier	 DOM
dom	TokenNameIdentifier	 dom
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
DTMManager	TokenNameIdentifier	 DTM Manager
dtmManager	TokenNameIdentifier	 dtm Manager
=	TokenNameEQUAL	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
MultiDOM	TokenNameIdentifier	 Multi DOM
)	TokenNameRPAREN	
dom	TokenNameIdentifier	 dom
)	TokenNameRPAREN	
.	TokenNameDOT	
getDTMManager	TokenNameIdentifier	 get DTM Manager
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Need to migrate the cached DTM to the new DTMManager 	TokenNameCOMMENT_LINE	Need to migrate the cached DTM to the new DTMManager 
if	TokenNameif	
(	TokenNameLPAREN	
dtmManager	TokenNameIdentifier	 dtm Manager
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
&&	TokenNameAND_AND	
newdom	TokenNameIdentifier	 newdom
instanceof	TokenNameinstanceof	
DTM	TokenNameIdentifier	 DTM
)	TokenNameRPAREN	
{	TokenNameLBRACE	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
DTM	TokenNameIdentifier	 DTM
)	TokenNameRPAREN	
newdom	TokenNameIdentifier	 newdom
)	TokenNameRPAREN	
.	TokenNameDOT	
migrateTo	TokenNameIdentifier	 migrate To
(	TokenNameLPAREN	
dtmManager	TokenNameIdentifier	 dtm Manager
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
translet	TokenNameIdentifier	 translet
.	TokenNameDOT	
prepassDocument	TokenNameIdentifier	 prepass Document
(	TokenNameLPAREN	
newdom	TokenNameIdentifier	 newdom
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Wrap the DOM object in a DOM adapter and add to multiplexer 	TokenNameCOMMENT_LINE	Wrap the DOM object in a DOM adapter and add to multiplexer 
final	TokenNamefinal	
DOMAdapter	TokenNameIdentifier	 DOM Adapter
domAdapter	TokenNameIdentifier	 dom Adapter
=	TokenNameEQUAL	
translet	TokenNameIdentifier	 translet
.	TokenNameDOT	
makeDOMAdapter	TokenNameIdentifier	 make DOM Adapter
(	TokenNameLPAREN	
newdom	TokenNameIdentifier	 newdom
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
MultiDOM	TokenNameIdentifier	 Multi DOM
)	TokenNameRPAREN	
dom	TokenNameIdentifier	 dom
)	TokenNameRPAREN	
.	TokenNameDOT	
addDOMAdapter	TokenNameIdentifier	 add DOM Adapter
(	TokenNameLPAREN	
domAdapter	TokenNameIdentifier	 dom Adapter
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Create index for any key elements 	TokenNameCOMMENT_LINE	Create index for any key elements 
translet	TokenNameIdentifier	 translet
.	TokenNameDOT	
buildKeys	TokenNameIdentifier	 build Keys
(	TokenNameLPAREN	
domAdapter	TokenNameIdentifier	 dom Adapter
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
newdom	TokenNameIdentifier	 newdom
.	TokenNameDOT	
getDocument	TokenNameIdentifier	 get Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Return a singleton iterator containing the root node 	TokenNameCOMMENT_LINE	Return a singleton iterator containing the root node 
return	TokenNamereturn	
new	TokenNamenew	
SingletonIterator	TokenNameIdentifier	 Singleton Iterator
(	TokenNameLPAREN	
newdom	TokenNameIdentifier	 newdom
.	TokenNameDOT	
getDocument	TokenNameIdentifier	 get Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
