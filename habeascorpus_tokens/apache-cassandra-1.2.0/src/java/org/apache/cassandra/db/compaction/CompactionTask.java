/* * Licensed to the Apache Software Foundation (ASF) under one * or more contributor license agreements. See the NOTICE file * distributed with this work for additional information * regarding copyright ownership. The ASF licenses this file * to you under the Apache License, Version 2.0 (the * "License"); you may not use this file except in compliance * with the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */	TokenNameCOMMENT_BLOCK	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
compaction	TokenNameIdentifier	 compaction
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
File	TokenNameIdentifier	 File
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
IOException	TokenNameIdentifier	 IO Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
com	TokenNameIdentifier	 com
.	TokenNameDOT	
google	TokenNameIdentifier	 google
.	TokenNameDOT	
common	TokenNameIdentifier	 common
.	TokenNameDOT	
base	TokenNameIdentifier	 base
.	TokenNameDOT	
Predicates	TokenNameIdentifier	 Predicates
;	TokenNameSEMICOLON	
import	TokenNameimport	
com	TokenNameIdentifier	 com
.	TokenNameDOT	
google	TokenNameIdentifier	 google
.	TokenNameDOT	
common	TokenNameIdentifier	 common
.	TokenNameDOT	
base	TokenNameIdentifier	 base
.	TokenNameDOT	
Throwables	TokenNameIdentifier	 Throwables
;	TokenNameSEMICOLON	
import	TokenNameimport	
com	TokenNameIdentifier	 com
.	TokenNameDOT	
google	TokenNameIdentifier	 google
.	TokenNameDOT	
common	TokenNameIdentifier	 common
.	TokenNameDOT	
collect	TokenNameIdentifier	 collect
.	TokenNameDOT	
Iterators	TokenNameIdentifier	 Iterators
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
commons	TokenNameIdentifier	 commons
.	TokenNameDOT	
lang	TokenNameIdentifier	 lang
.	TokenNameDOT	
StringUtils	TokenNameIdentifier	 String Utils
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
Logger	TokenNameIdentifier	 Logger
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
LoggerFactory	TokenNameIdentifier	 Logger Factory
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
config	TokenNameIdentifier	 config
.	TokenNameDOT	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
DecoratedKey	TokenNameIdentifier	 Decorated Key
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
RowIndexEntry	TokenNameIdentifier	 Row Index Entry
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
compaction	TokenNameIdentifier	 compaction
.	TokenNameDOT	
CompactionManager	TokenNameIdentifier	 Compaction Manager
.	TokenNameDOT	
CompactionExecutorStatsCollector	TokenNameIdentifier	 Compaction Executor Stats Collector
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
SSTable	TokenNameIdentifier	 SS Table
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
SSTableReader	TokenNameIdentifier	 SS Table Reader
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
SSTableWriter	TokenNameIdentifier	 SS Table Writer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
CloseableIterator	TokenNameIdentifier	 Closeable Iterator
;	TokenNameSEMICOLON	
public	TokenNamepublic	
class	TokenNameclass	
CompactionTask	TokenNameIdentifier	 Compaction Task
extends	TokenNameextends	
AbstractCompactionTask	TokenNameIdentifier	 Abstract Compaction Task
{	TokenNameLBRACE	
protected	TokenNameprotected	
static	TokenNamestatic	
final	TokenNamefinal	
Logger	TokenNameIdentifier	 Logger
logger	TokenNameIdentifier	 logger
=	TokenNameEQUAL	
LoggerFactory	TokenNameIdentifier	 Logger Factory
.	TokenNameDOT	
getLogger	TokenNameIdentifier	 get Logger
(	TokenNameLPAREN	
CompactionTask	TokenNameIdentifier	 Compaction Task
.	TokenNameDOT	
class	TokenNameclass	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
protected	TokenNameprotected	
final	TokenNamefinal	
int	TokenNameint	
gcBefore	TokenNameIdentifier	 gc Before
;	TokenNameSEMICOLON	
protected	TokenNameprotected	
static	TokenNamestatic	
long	TokenNamelong	
totalBytesCompacted	TokenNameIdentifier	 total Bytes Compacted
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
private	TokenNameprivate	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
toCompact	TokenNameIdentifier	 to Compact
;	TokenNameSEMICOLON	
private	TokenNameprivate	
CompactionExecutorStatsCollector	TokenNameIdentifier	 Compaction Executor Stats Collector
collector	TokenNameIdentifier	 collector
;	TokenNameSEMICOLON	
public	TokenNamepublic	
CompactionTask	TokenNameIdentifier	 Compaction Task
(	TokenNameLPAREN	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
cfs	TokenNameIdentifier	 cfs
,	TokenNameCOMMA	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
final	TokenNamefinal	
int	TokenNameint	
gcBefore	TokenNameIdentifier	 gc Before
)	TokenNameRPAREN	
{	TokenNameLBRACE	
super	TokenNamesuper	
(	TokenNameLPAREN	
cfs	TokenNameIdentifier	 cfs
,	TokenNameCOMMA	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
gcBefore	TokenNameIdentifier	 gc Before
=	TokenNameEQUAL	
gcBefore	TokenNameIdentifier	 gc Before
;	TokenNameSEMICOLON	
toCompact	TokenNameIdentifier	 to Compact
=	TokenNameEQUAL	
new	TokenNamenew	
HashSet	TokenNameIdentifier	 Hash Set
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
(	TokenNameLPAREN	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
synchronized	TokenNamesynchronized	
long	TokenNamelong	
addToTotalBytesCompacted	TokenNameIdentifier	 add To Total Bytes Compacted
(	TokenNameLPAREN	
long	TokenNamelong	
bytesCompacted	TokenNameIdentifier	 bytes Compacted
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
totalBytesCompacted	TokenNameIdentifier	 total Bytes Compacted
+=	TokenNamePLUS_EQUAL	
bytesCompacted	TokenNameIdentifier	 bytes Compacted
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * For internal use and testing only. The rest of the system should go through the submit* methods, * which are properly serialized. * Caller is in charge of marking/unmarking the sstables as compacting. */	TokenNameCOMMENT_JAVADOC	 For internal use and testing only. The rest of the system should go through the submit* methods, which are properly serialized. Caller is in charge of marking/unmarking the sstables as compacting. 
public	TokenNamepublic	
int	TokenNameint	
execute	TokenNameIdentifier	 execute
(	TokenNameLPAREN	
CompactionExecutorStatsCollector	TokenNameIdentifier	 Compaction Executor Stats Collector
collector	TokenNameIdentifier	 collector
)	TokenNameRPAREN	
{	TokenNameLBRACE	
this	TokenNamethis	
.	TokenNameDOT	
collector	TokenNameIdentifier	 collector
=	TokenNameEQUAL	
collector	TokenNameIdentifier	 collector
;	TokenNameSEMICOLON	
run	TokenNameIdentifier	 run
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
toCompact	TokenNameIdentifier	 to Compact
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
long	TokenNamelong	
getExpectedWriteSize	TokenNameIdentifier	 get Expected Write Size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
getExpectedCompactedFileSize	TokenNameIdentifier	 get Expected Compacted File Size
(	TokenNameLPAREN	
toCompact	TokenNameIdentifier	 to Compact
,	TokenNameCOMMA	
compactionType	TokenNameIdentifier	 compaction Type
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
boolean	TokenNameboolean	
reduceScopeForLimitedSpace	TokenNameIdentifier	 reduce Scope For Limited Space
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
partialCompactionsAcceptable	TokenNameIdentifier	 partial Compactions Acceptable
(	TokenNameLPAREN	
)	TokenNameRPAREN	
&&	TokenNameAND_AND	
toCompact	TokenNameIdentifier	 to Compact
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
>	TokenNameGREATER	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// Try again w/o the largest one. 	TokenNameCOMMENT_LINE	Try again w/o the largest one. 
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
warn	TokenNameIdentifier	 warn
(	TokenNameLPAREN	
"insufficient space to compact all requested files "	TokenNameStringLiteral	insufficient space to compact all requested files 
+	TokenNamePLUS	
StringUtils	TokenNameIdentifier	 String Utils
.	TokenNameDOT	
join	TokenNameIdentifier	 join
(	TokenNameLPAREN	
toCompact	TokenNameIdentifier	 to Compact
,	TokenNameCOMMA	
", "	TokenNameStringLiteral	, 
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Note that we have removed files that are still marked as compacting. 	TokenNameCOMMENT_LINE	Note that we have removed files that are still marked as compacting. 
// This suboptimal but ok since the caller will unmark all the sstables at the end. 	TokenNameCOMMENT_LINE	This suboptimal but ok since the caller will unmark all the sstables at the end. 
return	TokenNamereturn	
toCompact	TokenNameIdentifier	 to Compact
.	TokenNameDOT	
remove	TokenNameIdentifier	 remove
(	TokenNameLPAREN	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
getMaxSizeFile	TokenNameIdentifier	 get Max Size File
(	TokenNameLPAREN	
toCompact	TokenNameIdentifier	 to Compact
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
return	TokenNamereturn	
false	TokenNamefalse	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** * For internal use and testing only. The rest of the system should go through the submit* methods, * which are properly serialized. * Caller is in charge of marking/unmarking the sstables as compacting. */	TokenNameCOMMENT_JAVADOC	 For internal use and testing only. The rest of the system should go through the submit* methods, which are properly serialized. Caller is in charge of marking/unmarking the sstables as compacting. 
protected	TokenNameprotected	
void	TokenNamevoid	
runWith	TokenNameIdentifier	 run With
(	TokenNameLPAREN	
File	TokenNameIdentifier	 File
dataDirectory	TokenNameIdentifier	 data Directory
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
// The collection of sstables passed may be empty (but not null); even if 	TokenNameCOMMENT_LINE	The collection of sstables passed may be empty (but not null); even if 
// it is not empty, it may compact down to nothing if all rows are deleted. 	TokenNameCOMMENT_LINE	it is not empty, it may compact down to nothing if all rows are deleted. 
assert	TokenNameassert	
sstables	TokenNameIdentifier	 sstables
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
&&	TokenNameAND_AND	
dataDirectory	TokenNameIdentifier	 data Directory
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
.	TokenNameDOT	
isSnapshotBeforeCompaction	TokenNameIdentifier	 is Snapshot Before Compaction
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
snapshotWithoutFlush	TokenNameIdentifier	 snapshot Without Flush
(	TokenNameLPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
currentTimeMillis	TokenNameIdentifier	 current Time Millis
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
"-compact-"	TokenNameStringLiteral	-compact-
+	TokenNamePLUS	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
columnFamily	TokenNameIdentifier	 column Family
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// sanity check: all sstables must belong to the same cfs 	TokenNameCOMMENT_LINE	sanity check: all sstables must belong to the same cfs 
for	TokenNamefor	
(	TokenNameLPAREN	
SSTableReader	TokenNameIdentifier	 SS Table Reader
sstable	TokenNameIdentifier	 sstable
:	TokenNameCOLON	
toCompact	TokenNameIdentifier	 to Compact
)	TokenNameRPAREN	
assert	TokenNameassert	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
descriptor	TokenNameIdentifier	 descriptor
.	TokenNameDOT	
cfname	TokenNameIdentifier	 cfname
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
columnFamily	TokenNameIdentifier	 column Family
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
CompactionController	TokenNameIdentifier	 Compaction Controller
controller	TokenNameIdentifier	 controller
=	TokenNameEQUAL	
new	TokenNamenew	
CompactionController	TokenNameIdentifier	 Compaction Controller
(	TokenNameLPAREN	
cfs	TokenNameIdentifier	 cfs
,	TokenNameCOMMA	
toCompact	TokenNameIdentifier	 to Compact
,	TokenNameCOMMA	
gcBefore	TokenNameIdentifier	 gc Before
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// new sstables from flush can be added during a compaction, but only the compaction can remove them, 	TokenNameCOMMENT_LINE	new sstables from flush can be added during a compaction, but only the compaction can remove them, 
// so in our single-threaded compaction world this is a valid way of determining if we're compacting 	TokenNameCOMMENT_LINE	so in our single-threaded compaction world this is a valid way of determining if we're compacting 
// all the sstables (that existed when we started) 	TokenNameCOMMENT_LINE	all the sstables (that existed when we started) 
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
info	TokenNameIdentifier	 info
(	TokenNameLPAREN	
"Compacting {}"	TokenNameStringLiteral	Compacting {}
,	TokenNameCOMMA	
toCompact	TokenNameIdentifier	 to Compact
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
long	TokenNamelong	
startTime	TokenNameIdentifier	 start Time
=	TokenNameEQUAL	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
currentTimeMillis	TokenNameIdentifier	 current Time Millis
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
long	TokenNamelong	
totalkeysWritten	TokenNameIdentifier	 totalkeys Written
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
AbstractCompactionStrategy	TokenNameIdentifier	 Abstract Compaction Strategy
strategy	TokenNameIdentifier	 strategy
=	TokenNameEQUAL	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
getCompactionStrategy	TokenNameIdentifier	 get Compaction Strategy
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
long	TokenNamelong	
estimatedTotalKeys	TokenNameIdentifier	 estimated Total Keys
=	TokenNameEQUAL	
Math	TokenNameIdentifier	 Math
.	TokenNameDOT	
max	TokenNameIdentifier	 max
(	TokenNameLPAREN	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
.	TokenNameDOT	
getIndexInterval	TokenNameIdentifier	 get Index Interval
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
SSTableReader	TokenNameIdentifier	 SS Table Reader
.	TokenNameDOT	
getApproximateKeyCount	TokenNameIdentifier	 get Approximate Key Count
(	TokenNameLPAREN	
toCompact	TokenNameIdentifier	 to Compact
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
long	TokenNamelong	
estimatedSSTables	TokenNameIdentifier	 estimated SS Tables
=	TokenNameEQUAL	
Math	TokenNameIdentifier	 Math
.	TokenNameDOT	
max	TokenNameIdentifier	 max
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
SSTable	TokenNameIdentifier	 SS Table
.	TokenNameDOT	
getTotalBytes	TokenNameIdentifier	 get Total Bytes
(	TokenNameLPAREN	
toCompact	TokenNameIdentifier	 to Compact
)	TokenNameRPAREN	
/	TokenNameDIVIDE	
strategy	TokenNameIdentifier	 strategy
.	TokenNameDOT	
getMaxSSTableSize	TokenNameIdentifier	 get Max SS Table Size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
long	TokenNamelong	
keysPerSSTable	TokenNameIdentifier	 keys Per SS Table
=	TokenNameEQUAL	
(	TokenNameLPAREN	
long	TokenNamelong	
)	TokenNameRPAREN	
Math	TokenNameIdentifier	 Math
.	TokenNameDOT	
ceil	TokenNameIdentifier	 ceil
(	TokenNameLPAREN	
(	TokenNameLPAREN	
double	TokenNamedouble	
)	TokenNameRPAREN	
estimatedTotalKeys	TokenNameIdentifier	 estimated Total Keys
/	TokenNameDIVIDE	
estimatedSSTables	TokenNameIdentifier	 estimated SS Tables
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
isDebugEnabled	TokenNameIdentifier	 is Debug Enabled
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"Expected bloom filter size : "	TokenNameStringLiteral	Expected bloom filter size : 
+	TokenNamePLUS	
keysPerSSTable	TokenNameIdentifier	 keys Per SS Table
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
AbstractCompactionIterable	TokenNameIdentifier	 Abstract Compaction Iterable
ci	TokenNameIdentifier	 ci
=	TokenNameEQUAL	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
.	TokenNameDOT	
isMultithreadedCompaction	TokenNameIdentifier	 is Multithreaded Compaction
(	TokenNameLPAREN	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
new	TokenNamenew	
ParallelCompactionIterable	TokenNameIdentifier	 Parallel Compaction Iterable
(	TokenNameLPAREN	
compactionType	TokenNameIdentifier	 compaction Type
,	TokenNameCOMMA	
strategy	TokenNameIdentifier	 strategy
.	TokenNameDOT	
getScanners	TokenNameIdentifier	 get Scanners
(	TokenNameLPAREN	
toCompact	TokenNameIdentifier	 to Compact
)	TokenNameRPAREN	
,	TokenNameCOMMA	
controller	TokenNameIdentifier	 controller
)	TokenNameRPAREN	
:	TokenNameCOLON	
new	TokenNamenew	
CompactionIterable	TokenNameIdentifier	 Compaction Iterable
(	TokenNameLPAREN	
compactionType	TokenNameIdentifier	 compaction Type
,	TokenNameCOMMA	
strategy	TokenNameIdentifier	 strategy
.	TokenNameDOT	
getScanners	TokenNameIdentifier	 get Scanners
(	TokenNameLPAREN	
toCompact	TokenNameIdentifier	 to Compact
)	TokenNameRPAREN	
,	TokenNameCOMMA	
controller	TokenNameIdentifier	 controller
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
CloseableIterator	TokenNameIdentifier	 Closeable Iterator
<	TokenNameLESS	
AbstractCompactedRow	TokenNameIdentifier	 Abstract Compacted Row
>	TokenNameGREATER	
iter	TokenNameIdentifier	 iter
=	TokenNameEQUAL	
ci	TokenNameIdentifier	 ci
.	TokenNameDOT	
iterator	TokenNameIdentifier	 iterator
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Iterator	TokenNameIdentifier	 Iterator
<	TokenNameLESS	
AbstractCompactedRow	TokenNameIdentifier	 Abstract Compacted Row
>	TokenNameGREATER	
nni	TokenNameIdentifier	 nni
=	TokenNameEQUAL	
Iterators	TokenNameIdentifier	 Iterators
.	TokenNameDOT	
filter	TokenNameIdentifier	 filter
(	TokenNameLPAREN	
iter	TokenNameIdentifier	 iter
,	TokenNameCOMMA	
Predicates	TokenNameIdentifier	 Predicates
.	TokenNameDOT	
notNull	TokenNameIdentifier	 not Null
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
DecoratedKey	TokenNameIdentifier	 Decorated Key
,	TokenNameCOMMA	
RowIndexEntry	TokenNameIdentifier	 Row Index Entry
>	TokenNameGREATER	
cachedKeys	TokenNameIdentifier	 cached Keys
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
DecoratedKey	TokenNameIdentifier	 Decorated Key
,	TokenNameCOMMA	
RowIndexEntry	TokenNameIdentifier	 Row Index Entry
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// we can't preheat until the tracker has been set. This doesn't happen until we tell the cfs to 	TokenNameCOMMENT_LINE	we can't preheat until the tracker has been set. This doesn't happen until we tell the cfs to 
// replace the old entries. Track entries to preheat here until then. 	TokenNameCOMMENT_LINE	replace the old entries. Track entries to preheat here until then. 
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
,	TokenNameCOMMA	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
DecoratedKey	TokenNameIdentifier	 Decorated Key
,	TokenNameCOMMA	
RowIndexEntry	TokenNameIdentifier	 Row Index Entry
>>	TokenNameRIGHT_SHIFT	
cachedKeyMap	TokenNameIdentifier	 cached Key Map
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
,	TokenNameCOMMA	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
DecoratedKey	TokenNameIdentifier	 Decorated Key
,	TokenNameCOMMA	
RowIndexEntry	TokenNameIdentifier	 Row Index Entry
>>	TokenNameRIGHT_SHIFT	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
sstables	TokenNameIdentifier	 sstables
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SSTableWriter	TokenNameIdentifier	 SS Table Writer
>	TokenNameGREATER	
writers	TokenNameIdentifier	 writers
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
SSTableWriter	TokenNameIdentifier	 SS Table Writer
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
collector	TokenNameIdentifier	 collector
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
collector	TokenNameIdentifier	 collector
.	TokenNameDOT	
beginCompaction	TokenNameIdentifier	 begin Compaction
(	TokenNameLPAREN	
ci	TokenNameIdentifier	 ci
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
nni	TokenNameIdentifier	 nni
.	TokenNameDOT	
hasNext	TokenNameIdentifier	 has Next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// don't mark compacted in the finally block, since if there _is_ nondeleted data, 	TokenNameCOMMENT_LINE	don't mark compacted in the finally block, since if there _is_ nondeleted data, 
// we need to sync it (via closeAndOpen) first, so there is no period during which 	TokenNameCOMMENT_LINE	we need to sync it (via closeAndOpen) first, so there is no period during which 
// a crash could cause data loss. 	TokenNameCOMMENT_LINE	a crash could cause data loss. 
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
markCompacted	TokenNameIdentifier	 mark Compacted
(	TokenNameLPAREN	
toCompact	TokenNameIdentifier	 to Compact
,	TokenNameCOMMA	
compactionType	TokenNameIdentifier	 compaction Type
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
SSTableWriter	TokenNameIdentifier	 SS Table Writer
writer	TokenNameIdentifier	 writer
=	TokenNameEQUAL	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
createCompactionWriter	TokenNameIdentifier	 create Compaction Writer
(	TokenNameLPAREN	
keysPerSSTable	TokenNameIdentifier	 keys Per SS Table
,	TokenNameCOMMA	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
directories	TokenNameIdentifier	 directories
.	TokenNameDOT	
getLocationForDisk	TokenNameIdentifier	 get Location For Disk
(	TokenNameLPAREN	
dataDirectory	TokenNameIdentifier	 data Directory
)	TokenNameRPAREN	
,	TokenNameCOMMA	
toCompact	TokenNameIdentifier	 to Compact
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
writers	TokenNameIdentifier	 writers
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
while	TokenNamewhile	
(	TokenNameLPAREN	
nni	TokenNameIdentifier	 nni
.	TokenNameDOT	
hasNext	TokenNameIdentifier	 has Next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
ci	TokenNameIdentifier	 ci
.	TokenNameDOT	
isStopRequested	TokenNameIdentifier	 is Stop Requested
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
throw	TokenNamethrow	
new	TokenNamenew	
CompactionInterruptedException	TokenNameIdentifier	 Compaction Interrupted Exception
(	TokenNameLPAREN	
ci	TokenNameIdentifier	 ci
.	TokenNameDOT	
getCompactionInfo	TokenNameIdentifier	 get Compaction Info
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
AbstractCompactedRow	TokenNameIdentifier	 Abstract Compacted Row
row	TokenNameIdentifier	 row
=	TokenNameEQUAL	
nni	TokenNameIdentifier	 nni
.	TokenNameDOT	
next	TokenNameIdentifier	 next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
isEmpty	TokenNameIdentifier	 is Empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
continue	TokenNamecontinue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
RowIndexEntry	TokenNameIdentifier	 Row Index Entry
indexEntry	TokenNameIdentifier	 index Entry
=	TokenNameEQUAL	
writer	TokenNameIdentifier	 writer
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
row	TokenNameIdentifier	 row
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
totalkeysWritten	TokenNameIdentifier	 totalkeys Written
++	TokenNamePLUS_PLUS	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
DatabaseDescriptor	TokenNameIdentifier	 Database Descriptor
.	TokenNameDOT	
getPreheatKeyCache	TokenNameIdentifier	 get Preheat Key Cache
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
SSTableReader	TokenNameIdentifier	 SS Table Reader
sstable	TokenNameIdentifier	 sstable
:	TokenNameCOLON	
toCompact	TokenNameIdentifier	 to Compact
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
getCachedPosition	TokenNameIdentifier	 get Cached Position
(	TokenNameLPAREN	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
cachedKeys	TokenNameIdentifier	 cached Keys
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
indexEntry	TokenNameIdentifier	 index Entry
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
break	TokenNamebreak	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
nni	TokenNameIdentifier	 nni
.	TokenNameDOT	
hasNext	TokenNameIdentifier	 has Next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
||	TokenNameOR_OR	
newSSTableSegmentThresholdReached	TokenNameIdentifier	 new SS Table Segment Threshold Reached
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
SSTableReader	TokenNameIdentifier	 SS Table Reader
toIndex	TokenNameIdentifier	 to Index
=	TokenNameEQUAL	
writer	TokenNameIdentifier	 writer
.	TokenNameDOT	
closeAndOpenReader	TokenNameIdentifier	 close And Open Reader
(	TokenNameLPAREN	
getMaxDataAge	TokenNameIdentifier	 get Max Data Age
(	TokenNameLPAREN	
toCompact	TokenNameIdentifier	 to Compact
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
cachedKeyMap	TokenNameIdentifier	 cached Key Map
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
toIndex	TokenNameIdentifier	 to Index
,	TokenNameCOMMA	
cachedKeys	TokenNameIdentifier	 cached Keys
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sstables	TokenNameIdentifier	 sstables
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
toIndex	TokenNameIdentifier	 to Index
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
nni	TokenNameIdentifier	 nni
.	TokenNameDOT	
hasNext	TokenNameIdentifier	 has Next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
writer	TokenNameIdentifier	 writer
=	TokenNameEQUAL	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
createCompactionWriter	TokenNameIdentifier	 create Compaction Writer
(	TokenNameLPAREN	
keysPerSSTable	TokenNameIdentifier	 keys Per SS Table
,	TokenNameCOMMA	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
directories	TokenNameIdentifier	 directories
.	TokenNameDOT	
getLocationForDisk	TokenNameIdentifier	 get Location For Disk
(	TokenNameLPAREN	
dataDirectory	TokenNameIdentifier	 data Directory
)	TokenNameRPAREN	
,	TokenNameCOMMA	
toCompact	TokenNameIdentifier	 to Compact
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
writers	TokenNameIdentifier	 writers
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
writer	TokenNameIdentifier	 writer
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
cachedKeys	TokenNameIdentifier	 cached Keys
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
DecoratedKey	TokenNameIdentifier	 Decorated Key
,	TokenNameCOMMA	
RowIndexEntry	TokenNameIdentifier	 Row Index Entry
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
Throwable	TokenNameIdentifier	 Throwable
t	TokenNameIdentifier	 t
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
SSTableWriter	TokenNameIdentifier	 SS Table Writer
writer	TokenNameIdentifier	 writer
:	TokenNameCOLON	
writers	TokenNameIdentifier	 writers
)	TokenNameRPAREN	
writer	TokenNameIdentifier	 writer
.	TokenNameDOT	
abort	TokenNameIdentifier	 abort
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
throw	TokenNamethrow	
Throwables	TokenNameIdentifier	 Throwables
.	TokenNameDOT	
propagate	TokenNameIdentifier	 propagate
(	TokenNameLPAREN	
t	TokenNameIdentifier	 t
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
finally	TokenNamefinally	
{	TokenNameLBRACE	
controller	TokenNameIdentifier	 controller
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
iter	TokenNameIdentifier	 iter
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
IOException	TokenNameIdentifier	 IO Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
collector	TokenNameIdentifier	 collector
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
collector	TokenNameIdentifier	 collector
.	TokenNameDOT	
finishCompaction	TokenNameIdentifier	 finish Compaction
(	TokenNameLPAREN	
ci	TokenNameIdentifier	 ci
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
replaceCompactedSSTables	TokenNameIdentifier	 replace Compacted SS Tables
(	TokenNameLPAREN	
toCompact	TokenNameIdentifier	 to Compact
,	TokenNameCOMMA	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
compactionType	TokenNameIdentifier	 compaction Type
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// TODO: this doesn't belong here, it should be part of the reader to load when the tracker is wired up 	TokenNameCOMMENT_LINE	TODO: this doesn't belong here, it should be part of the reader to load when the tracker is wired up 
for	TokenNamefor	
(	TokenNameLPAREN	
Map	TokenNameIdentifier	 Map
.	TokenNameDOT	
Entry	TokenNameIdentifier	 Entry
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
,	TokenNameCOMMA	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
DecoratedKey	TokenNameIdentifier	 Decorated Key
,	TokenNameCOMMA	
RowIndexEntry	TokenNameIdentifier	 Row Index Entry
>>	TokenNameRIGHT_SHIFT	
ssTableReaderMapEntry	TokenNameIdentifier	 ss Table Reader Map Entry
:	TokenNameCOLON	
cachedKeyMap	TokenNameIdentifier	 cached Key Map
.	TokenNameDOT	
entrySet	TokenNameIdentifier	 entry Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
SSTableReader	TokenNameIdentifier	 SS Table Reader
key	TokenNameIdentifier	 key
=	TokenNameEQUAL	
ssTableReaderMapEntry	TokenNameIdentifier	 ss Table Reader Map Entry
.	TokenNameDOT	
getKey	TokenNameIdentifier	 get Key
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
Map	TokenNameIdentifier	 Map
.	TokenNameDOT	
Entry	TokenNameIdentifier	 Entry
<	TokenNameLESS	
DecoratedKey	TokenNameIdentifier	 Decorated Key
,	TokenNameCOMMA	
RowIndexEntry	TokenNameIdentifier	 Row Index Entry
>	TokenNameGREATER	
entry	TokenNameIdentifier	 entry
:	TokenNameCOLON	
ssTableReaderMapEntry	TokenNameIdentifier	 ss Table Reader Map Entry
.	TokenNameDOT	
getValue	TokenNameIdentifier	 get Value
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
entrySet	TokenNameIdentifier	 entry Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
key	TokenNameIdentifier	 key
.	TokenNameDOT	
cacheKey	TokenNameIdentifier	 cache Key
(	TokenNameLPAREN	
entry	TokenNameIdentifier	 entry
.	TokenNameDOT	
getKey	TokenNameIdentifier	 get Key
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
entry	TokenNameIdentifier	 entry
.	TokenNameDOT	
getValue	TokenNameIdentifier	 get Value
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
long	TokenNamelong	
dTime	TokenNameIdentifier	 d Time
=	TokenNameEQUAL	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
currentTimeMillis	TokenNameIdentifier	 current Time Millis
(	TokenNameLPAREN	
)	TokenNameRPAREN	
-	TokenNameMINUS	
startTime	TokenNameIdentifier	 start Time
;	TokenNameSEMICOLON	
long	TokenNamelong	
startsize	TokenNameIdentifier	 startsize
=	TokenNameEQUAL	
SSTable	TokenNameIdentifier	 SS Table
.	TokenNameDOT	
getTotalBytes	TokenNameIdentifier	 get Total Bytes
(	TokenNameLPAREN	
toCompact	TokenNameIdentifier	 to Compact
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
long	TokenNamelong	
endsize	TokenNameIdentifier	 endsize
=	TokenNameEQUAL	
SSTable	TokenNameIdentifier	 SS Table
.	TokenNameDOT	
getTotalBytes	TokenNameIdentifier	 get Total Bytes
(	TokenNameLPAREN	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
ratio	TokenNameIdentifier	 ratio
=	TokenNameEQUAL	
(	TokenNameLPAREN	
double	TokenNamedouble	
)	TokenNameRPAREN	
endsize	TokenNameIdentifier	 endsize
/	TokenNameDIVIDE	
(	TokenNameLPAREN	
double	TokenNamedouble	
)	TokenNameRPAREN	
startsize	TokenNameIdentifier	 startsize
;	TokenNameSEMICOLON	
StringBuilder	TokenNameIdentifier	 String Builder
builder	TokenNameIdentifier	 builder
=	TokenNameEQUAL	
new	TokenNamenew	
StringBuilder	TokenNameIdentifier	 String Builder
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
builder	TokenNameIdentifier	 builder
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
"["	TokenNameStringLiteral	[
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
SSTableReader	TokenNameIdentifier	 SS Table Reader
reader	TokenNameIdentifier	 reader
:	TokenNameCOLON	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
builder	TokenNameIdentifier	 builder
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
reader	TokenNameIdentifier	 reader
.	TokenNameDOT	
getFilename	TokenNameIdentifier	 get Filename
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
","	TokenNameStringLiteral	,
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
builder	TokenNameIdentifier	 builder
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
"]"	TokenNameStringLiteral	]
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
mbps	TokenNameIdentifier	 mbps
=	TokenNameEQUAL	
dTime	TokenNameIdentifier	 d Time
>	TokenNameGREATER	
0	TokenNameIntegerLiteral	
?	TokenNameQUESTION	
(	TokenNameLPAREN	
double	TokenNamedouble	
)	TokenNameRPAREN	
endsize	TokenNameIdentifier	 endsize
/	TokenNameDIVIDE	
(	TokenNameLPAREN	
1024	TokenNameIntegerLiteral	
*	TokenNameMULTIPLY	
1024	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
/	TokenNameDIVIDE	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
double	TokenNamedouble	
)	TokenNameRPAREN	
dTime	TokenNameIdentifier	 d Time
/	TokenNameDIVIDE	
1000	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
:	TokenNameCOLON	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
info	TokenNameIdentifier	 info
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"Compacted to %s. %,d to %,d (~%d%% of original) bytes for %,d keys at %fMB/s. Time: %,dms."	TokenNameStringLiteral	Compacted to %s. %,d to %,d (~%d%% of original) bytes for %,d keys at %fMB/s. Time: %,dms.
,	TokenNameCOMMA	
builder	TokenNameIdentifier	 builder
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
startsize	TokenNameIdentifier	 startsize
,	TokenNameCOMMA	
endsize	TokenNameIdentifier	 endsize
,	TokenNameCOMMA	
(	TokenNameLPAREN	
int	TokenNameint	
)	TokenNameRPAREN	
(	TokenNameLPAREN	
ratio	TokenNameIdentifier	 ratio
*	TokenNameMULTIPLY	
100	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
totalkeysWritten	TokenNameIdentifier	 totalkeys Written
,	TokenNameCOMMA	
mbps	TokenNameIdentifier	 mbps
,	TokenNameCOMMA	
dTime	TokenNameIdentifier	 d Time
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"CF Total Bytes Compacted: %,d"	TokenNameStringLiteral	CF Total Bytes Compacted: %,d
,	TokenNameCOMMA	
CompactionTask	TokenNameIdentifier	 Compaction Task
.	TokenNameDOT	
addToTotalBytesCompacted	TokenNameIdentifier	 add To Total Bytes Compacted
(	TokenNameLPAREN	
endsize	TokenNameIdentifier	 endsize
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
protected	TokenNameprotected	
boolean	TokenNameboolean	
partialCompactionsAcceptable	TokenNameIdentifier	 partial Compactions Acceptable
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
!	TokenNameNOT	
isUserDefined	TokenNameIdentifier	 is User Defined
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// extensibility point for other strategies that may want to limit the upper bounds of the sstable segment size 	TokenNameCOMMENT_LINE	extensibility point for other strategies that may want to limit the upper bounds of the sstable segment size 
protected	TokenNameprotected	
boolean	TokenNameboolean	
newSSTableSegmentThresholdReached	TokenNameIdentifier	 new SS Table Segment Threshold Reached
(	TokenNameLPAREN	
SSTableWriter	TokenNameIdentifier	 SS Table Writer
writer	TokenNameIdentifier	 writer
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
false	TokenNamefalse	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
long	TokenNamelong	
getMaxDataAge	TokenNameIdentifier	 get Max Data Age
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
{	TokenNameLBRACE	
long	TokenNamelong	
max	TokenNameIdentifier	 max
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
SSTableReader	TokenNameIdentifier	 SS Table Reader
sstable	TokenNameIdentifier	 sstable
:	TokenNameCOLON	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
maxDataAge	TokenNameIdentifier	 max Data Age
>	TokenNameGREATER	
max	TokenNameIdentifier	 max
)	TokenNameRPAREN	
max	TokenNameIdentifier	 max
=	TokenNameEQUAL	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
maxDataAge	TokenNameIdentifier	 max Data Age
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
max	TokenNameIdentifier	 max
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
