/* * Licensed to the Apache Software Foundation (ASF) under one * or more contributor license agreements. See the NOTICE file * distributed with this work for additional information * regarding copyright ownership. The ASF licenses this file * to you under the Apache License, Version 2.0 (the * "License"); you may not use this file except in compliance * with the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */	TokenNameCOMMENT_BLOCK	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
compaction	TokenNameIdentifier	 compaction
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
IOException	TokenNameIdentifier	 IO Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
com	TokenNameIdentifier	 com
.	TokenNameDOT	
google	TokenNameIdentifier	 google
.	TokenNameDOT	
common	TokenNameIdentifier	 common
.	TokenNameDOT	
annotations	TokenNameIdentifier	 annotations
.	TokenNameDOT	
VisibleForTesting	TokenNameIdentifier	 Visible For Testing
;	TokenNameSEMICOLON	
import	TokenNameimport	
com	TokenNameIdentifier	 com
.	TokenNameDOT	
google	TokenNameIdentifier	 google
.	TokenNameDOT	
common	TokenNameIdentifier	 common
.	TokenNameDOT	
base	TokenNameIdentifier	 base
.	TokenNameDOT	
Joiner	TokenNameIdentifier	 Joiner
;	TokenNameSEMICOLON	
import	TokenNameimport	
com	TokenNameIdentifier	 com
.	TokenNameDOT	
google	TokenNameIdentifier	 google
.	TokenNameDOT	
common	TokenNameIdentifier	 common
.	TokenNameDOT	
collect	TokenNameIdentifier	 collect
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
com	TokenNameIdentifier	 com
.	TokenNameDOT	
google	TokenNameIdentifier	 google
.	TokenNameDOT	
common	TokenNameIdentifier	 common
.	TokenNameDOT	
primitives	TokenNameIdentifier	 primitives
.	TokenNameDOT	
Doubles	TokenNameIdentifier	 Doubles
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
Logger	TokenNameIdentifier	 Logger
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
LoggerFactory	TokenNameIdentifier	 Logger Factory
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
columniterator	TokenNameIdentifier	 columniterator
.	TokenNameDOT	
OnDiskAtomIterator	TokenNameIdentifier	 On Disk Atom Iterator
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
dht	TokenNameIdentifier	 dht
.	TokenNameDOT	
Range	TokenNameIdentifier	 Range
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
dht	TokenNameIdentifier	 dht
.	TokenNameDOT	
Token	TokenNameIdentifier	 Token
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
SSTable	TokenNameIdentifier	 SS Table
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
SSTableReader	TokenNameIdentifier	 SS Table Reader
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
SSTableScanner	TokenNameIdentifier	 SS Table Scanner
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
notifications	TokenNameIdentifier	 notifications
.	TokenNameDOT	
INotification	TokenNameIdentifier	 I Notification
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
notifications	TokenNameIdentifier	 notifications
.	TokenNameDOT	
INotificationConsumer	TokenNameIdentifier	 I Notification Consumer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
notifications	TokenNameIdentifier	 notifications
.	TokenNameDOT	
SSTableAddedNotification	TokenNameIdentifier	 SS Table Added Notification
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
notifications	TokenNameIdentifier	 notifications
.	TokenNameDOT	
SSTableListChangedNotification	TokenNameIdentifier	 SS Table List Changed Notification
;	TokenNameSEMICOLON	
public	TokenNamepublic	
class	TokenNameclass	
LeveledCompactionStrategy	TokenNameIdentifier	 Leveled Compaction Strategy
extends	TokenNameextends	
AbstractCompactionStrategy	TokenNameIdentifier	 Abstract Compaction Strategy
implements	TokenNameimplements	
INotificationConsumer	TokenNameIdentifier	 I Notification Consumer
{	TokenNameLBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
Logger	TokenNameIdentifier	 Logger
logger	TokenNameIdentifier	 logger
=	TokenNameEQUAL	
LoggerFactory	TokenNameIdentifier	 Logger Factory
.	TokenNameDOT	
getLogger	TokenNameIdentifier	 get Logger
(	TokenNameLPAREN	
LeveledCompactionStrategy	TokenNameIdentifier	 Leveled Compaction Strategy
.	TokenNameDOT	
class	TokenNameclass	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
SSTABLE_SIZE_OPTION	TokenNameIdentifier	 SSTABLE  SIZE  OPTION
=	TokenNameEQUAL	
"sstable_size_in_mb"	TokenNameStringLiteral	sstable_size_in_mb
;	TokenNameSEMICOLON	
@	TokenNameAT	
VisibleForTesting	TokenNameIdentifier	 Visible For Testing
final	TokenNamefinal	
LeveledManifest	TokenNameIdentifier	 Leveled Manifest
manifest	TokenNameIdentifier	 manifest
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
int	TokenNameint	
maxSSTableSizeInMB	TokenNameIdentifier	 max SS Table Size In MB
;	TokenNameSEMICOLON	
public	TokenNamepublic	
LeveledCompactionStrategy	TokenNameIdentifier	 Leveled Compaction Strategy
(	TokenNameLPAREN	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
cfs	TokenNameIdentifier	 cfs
,	TokenNameCOMMA	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
options	TokenNameIdentifier	 options
)	TokenNameRPAREN	
{	TokenNameLBRACE	
super	TokenNamesuper	
(	TokenNameLPAREN	
cfs	TokenNameIdentifier	 cfs
,	TokenNameCOMMA	
options	TokenNameIdentifier	 options
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
int	TokenNameint	
configuredMaxSSTableSize	TokenNameIdentifier	 configured Max SS Table Size
=	TokenNameEQUAL	
5	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
options	TokenNameIdentifier	 options
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
value	TokenNameIdentifier	 value
=	TokenNameEQUAL	
options	TokenNameIdentifier	 options
.	TokenNameDOT	
containsKey	TokenNameIdentifier	 contains Key
(	TokenNameLPAREN	
SSTABLE_SIZE_OPTION	TokenNameIdentifier	 SSTABLE  SIZE  OPTION
)	TokenNameRPAREN	
?	TokenNameQUESTION	
options	TokenNameIdentifier	 options
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
SSTABLE_SIZE_OPTION	TokenNameIdentifier	 SSTABLE  SIZE  OPTION
)	TokenNameRPAREN	
:	TokenNameCOLON	
null	TokenNamenull	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
value	TokenNameIdentifier	 value
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
configuredMaxSSTableSize	TokenNameIdentifier	 configured Max SS Table Size
=	TokenNameEQUAL	
Integer	TokenNameIdentifier	 Integer
.	TokenNameDOT	
parseInt	TokenNameIdentifier	 parse Int
(	TokenNameLPAREN	
value	TokenNameIdentifier	 value
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
NumberFormatException	TokenNameIdentifier	 Number Format Exception
ex	TokenNameIdentifier	 ex
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
warn	TokenNameIdentifier	 warn
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"%s is not a parsable int (base10) for %s using default value"	TokenNameStringLiteral	%s is not a parsable int (base10) for %s using default value
,	TokenNameCOMMA	
value	TokenNameIdentifier	 value
,	TokenNameCOMMA	
SSTABLE_SIZE_OPTION	TokenNameIdentifier	 SSTABLE  SIZE  OPTION
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
maxSSTableSizeInMB	TokenNameIdentifier	 max SS Table Size In MB
=	TokenNameEQUAL	
configuredMaxSSTableSize	TokenNameIdentifier	 configured Max SS Table Size
;	TokenNameSEMICOLON	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
getDataTracker	TokenNameIdentifier	 get Data Tracker
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
subscribe	TokenNameIdentifier	 subscribe
(	TokenNameLPAREN	
this	TokenNamethis	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"{} subscribed to the data tracker."	TokenNameStringLiteral	{} subscribed to the data tracker.
,	TokenNameCOMMA	
this	TokenNamethis	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
manifest	TokenNameIdentifier	 manifest
=	TokenNameEQUAL	
LeveledManifest	TokenNameIdentifier	 Leveled Manifest
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
cfs	TokenNameIdentifier	 cfs
,	TokenNameCOMMA	
this	TokenNamethis	
.	TokenNameDOT	
maxSSTableSizeInMB	TokenNameIdentifier	 max SS Table Size In MB
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"Created {}"	TokenNameStringLiteral	Created {}
,	TokenNameCOMMA	
manifest	TokenNameIdentifier	 manifest
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
shutdown	TokenNameIdentifier	 shutdown
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
super	TokenNamesuper	
.	TokenNameDOT	
shutdown	TokenNameIdentifier	 shutdown
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
getDataTracker	TokenNameIdentifier	 get Data Tracker
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
unsubscribe	TokenNameIdentifier	 unsubscribe
(	TokenNameLPAREN	
this	TokenNamethis	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
int	TokenNameint	
getLevelSize	TokenNameIdentifier	 get Level Size
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
manifest	TokenNameIdentifier	 manifest
.	TokenNameDOT	
getLevelSize	TokenNameIdentifier	 get Level Size
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
getAllLevelSize	TokenNameIdentifier	 get All Level Size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
manifest	TokenNameIdentifier	 manifest
.	TokenNameDOT	
getAllLevelSize	TokenNameIdentifier	 get All Level Size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * the only difference between background and maximal in LCS is that maximal is still allowed * (by explicit user request) even when compaction is disabled. */	TokenNameCOMMENT_JAVADOC	 the only difference between background and maximal in LCS is that maximal is still allowed (by explicit user request) even when compaction is disabled. 
public	TokenNamepublic	
AbstractCompactionTask	TokenNameIdentifier	 Abstract Compaction Task
getNextBackgroundTask	TokenNameIdentifier	 get Next Background Task
(	TokenNameLPAREN	
int	TokenNameint	
gcBefore	TokenNameIdentifier	 gc Before
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
isCompactionDisabled	TokenNameIdentifier	 is Compaction Disabled
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
return	TokenNamereturn	
null	TokenNamenull	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
getMaximalTask	TokenNameIdentifier	 get Maximal Task
(	TokenNameLPAREN	
gcBefore	TokenNameIdentifier	 gc Before
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
synchronized	TokenNamesynchronized	
AbstractCompactionTask	TokenNameIdentifier	 Abstract Compaction Task
getMaximalTask	TokenNameIdentifier	 get Maximal Task
(	TokenNameLPAREN	
int	TokenNameint	
gcBefore	TokenNameIdentifier	 gc Before
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
sstables	TokenNameIdentifier	 sstables
=	TokenNameEQUAL	
manifest	TokenNameIdentifier	 manifest
.	TokenNameDOT	
getCompactionCandidates	TokenNameIdentifier	 get Compaction Candidates
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
OperationType	TokenNameIdentifier	 Operation Type
op	TokenNameIdentifier	 op
=	TokenNameEQUAL	
OperationType	TokenNameIdentifier	 Operation Type
.	TokenNameDOT	
COMPACTION	TokenNameIdentifier	 COMPACTION
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
sstables	TokenNameIdentifier	 sstables
.	TokenNameDOT	
isEmpty	TokenNameIdentifier	 is Empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// if there is no sstable to compact in standard way, try compacting based on droppable tombstone ratio 	TokenNameCOMMENT_LINE	if there is no sstable to compact in standard way, try compacting based on droppable tombstone ratio 
SSTableReader	TokenNameIdentifier	 SS Table Reader
sstable	TokenNameIdentifier	 sstable
=	TokenNameEQUAL	
findDroppableSSTable	TokenNameIdentifier	 find Droppable SS Table
(	TokenNameLPAREN	
gcBefore	TokenNameIdentifier	 gc Before
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"No compaction necessary for {}"	TokenNameStringLiteral	No compaction necessary for {}
,	TokenNameCOMMA	
this	TokenNamethis	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
null	TokenNamenull	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
sstables	TokenNameIdentifier	 sstables
=	TokenNameEQUAL	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
singleton	TokenNameIdentifier	 singleton
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
op	TokenNameIdentifier	 op
=	TokenNameEQUAL	
OperationType	TokenNameIdentifier	 Operation Type
.	TokenNameDOT	
TOMBSTONE_COMPACTION	TokenNameIdentifier	 TOMBSTONE  COMPACTION
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
getDataTracker	TokenNameIdentifier	 get Data Tracker
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
markCompacting	TokenNameIdentifier	 mark Compacting
(	TokenNameLPAREN	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"Unable to mark {} for compaction; probably a user-defined compaction got in the way"	TokenNameStringLiteral	Unable to mark {} for compaction; probably a user-defined compaction got in the way
,	TokenNameCOMMA	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
null	TokenNamenull	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
LeveledCompactionTask	TokenNameIdentifier	 Leveled Compaction Task
newTask	TokenNameIdentifier	 new Task
=	TokenNameEQUAL	
new	TokenNamenew	
LeveledCompactionTask	TokenNameIdentifier	 Leveled Compaction Task
(	TokenNameLPAREN	
cfs	TokenNameIdentifier	 cfs
,	TokenNameCOMMA	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
gcBefore	TokenNameIdentifier	 gc Before
,	TokenNameCOMMA	
maxSSTableSizeInMB	TokenNameIdentifier	 max SS Table Size In MB
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
newTask	TokenNameIdentifier	 new Task
.	TokenNameDOT	
setCompactionType	TokenNameIdentifier	 set Compaction Type
(	TokenNameLPAREN	
op	TokenNameIdentifier	 op
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
newTask	TokenNameIdentifier	 new Task
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
AbstractCompactionTask	TokenNameIdentifier	 Abstract Compaction Task
getUserDefinedTask	TokenNameIdentifier	 get User Defined Task
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
int	TokenNameint	
gcBefore	TokenNameIdentifier	 gc Before
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
UnsupportedOperationException	TokenNameIdentifier	 Unsupported Operation Exception
(	TokenNameLPAREN	
"LevelDB compaction strategy does not allow user-specified compactions"	TokenNameStringLiteral	LevelDB compaction strategy does not allow user-specified compactions
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
int	TokenNameint	
getEstimatedRemainingTasks	TokenNameIdentifier	 get Estimated Remaining Tasks
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
manifest	TokenNameIdentifier	 manifest
.	TokenNameDOT	
getEstimatedTasks	TokenNameIdentifier	 get Estimated Tasks
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
handleNotification	TokenNameIdentifier	 handle Notification
(	TokenNameLPAREN	
INotification	TokenNameIdentifier	 I Notification
notification	TokenNameIdentifier	 notification
,	TokenNameCOMMA	
Object	TokenNameIdentifier	 Object
sender	TokenNameIdentifier	 sender
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
notification	TokenNameIdentifier	 notification
instanceof	TokenNameinstanceof	
SSTableAddedNotification	TokenNameIdentifier	 SS Table Added Notification
)	TokenNameRPAREN	
{	TokenNameLBRACE	
SSTableAddedNotification	TokenNameIdentifier	 SS Table Added Notification
flushedNotification	TokenNameIdentifier	 flushed Notification
=	TokenNameEQUAL	
(	TokenNameLPAREN	
SSTableAddedNotification	TokenNameIdentifier	 SS Table Added Notification
)	TokenNameRPAREN	
notification	TokenNameIdentifier	 notification
;	TokenNameSEMICOLON	
manifest	TokenNameIdentifier	 manifest
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
flushedNotification	TokenNameIdentifier	 flushed Notification
.	TokenNameDOT	
added	TokenNameIdentifier	 added
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
notification	TokenNameIdentifier	 notification
instanceof	TokenNameinstanceof	
SSTableListChangedNotification	TokenNameIdentifier	 SS Table List Changed Notification
)	TokenNameRPAREN	
{	TokenNameLBRACE	
SSTableListChangedNotification	TokenNameIdentifier	 SS Table List Changed Notification
listChangedNotification	TokenNameIdentifier	 list Changed Notification
=	TokenNameEQUAL	
(	TokenNameLPAREN	
SSTableListChangedNotification	TokenNameIdentifier	 SS Table List Changed Notification
)	TokenNameRPAREN	
notification	TokenNameIdentifier	 notification
;	TokenNameSEMICOLON	
switch	TokenNameswitch	
(	TokenNameLPAREN	
listChangedNotification	TokenNameIdentifier	 list Changed Notification
.	TokenNameDOT	
compactionType	TokenNameIdentifier	 compaction Type
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// Cleanup, scrub and updateSSTable shouldn't promote (see #3989) 	TokenNameCOMMENT_LINE	Cleanup, scrub and updateSSTable shouldn't promote (see #3989) 
case	TokenNamecase	
CLEANUP	TokenNameIdentifier	 CLEANUP
:	TokenNameCOLON	
case	TokenNamecase	
SCRUB	TokenNameIdentifier	 SCRUB
:	TokenNameCOLON	
case	TokenNamecase	
UPGRADE_SSTABLES	TokenNameIdentifier	 UPGRADE  SSTABLES
:	TokenNameCOLON	
case	TokenNamecase	
TOMBSTONE_COMPACTION	TokenNameIdentifier	 TOMBSTONE  COMPACTION
:	TokenNameCOLON	
// Also when performing tombstone removal. 	TokenNameCOMMENT_LINE	Also when performing tombstone removal. 
manifest	TokenNameIdentifier	 manifest
.	TokenNameDOT	
replace	TokenNameIdentifier	 replace
(	TokenNameLPAREN	
listChangedNotification	TokenNameIdentifier	 list Changed Notification
.	TokenNameDOT	
removed	TokenNameIdentifier	 removed
,	TokenNameCOMMA	
listChangedNotification	TokenNameIdentifier	 list Changed Notification
.	TokenNameDOT	
added	TokenNameIdentifier	 added
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
break	TokenNamebreak	
;	TokenNameSEMICOLON	
default	TokenNamedefault	
:	TokenNameCOLON	
manifest	TokenNameIdentifier	 manifest
.	TokenNameDOT	
promote	TokenNameIdentifier	 promote
(	TokenNameLPAREN	
listChangedNotification	TokenNameIdentifier	 list Changed Notification
.	TokenNameDOT	
removed	TokenNameIdentifier	 removed
,	TokenNameCOMMA	
listChangedNotification	TokenNameIdentifier	 list Changed Notification
.	TokenNameDOT	
added	TokenNameIdentifier	 added
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
break	TokenNamebreak	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
public	TokenNamepublic	
long	TokenNamelong	
getMaxSSTableSize	TokenNameIdentifier	 get Max SS Table Size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
maxSSTableSizeInMB	TokenNameIdentifier	 max SS Table Size In MB
*	TokenNameMULTIPLY	
1024L	TokenNameLongLiteral	
*	TokenNameMULTIPLY	
1024L	TokenNameLongLiteral	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
ICompactionScanner	TokenNameIdentifier	 I Compaction Scanner
>	TokenNameGREATER	
getScanners	TokenNameIdentifier	 get Scanners
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
Range	TokenNameIdentifier	 Range
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
range	TokenNameIdentifier	 range
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Multimap	TokenNameIdentifier	 Multimap
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
,	TokenNameCOMMA	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
byLevel	TokenNameIdentifier	 by Level
=	TokenNameEQUAL	
ArrayListMultimap	TokenNameIdentifier	 Array List Multimap
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
SSTableReader	TokenNameIdentifier	 SS Table Reader
sstable	TokenNameIdentifier	 sstable
:	TokenNameCOLON	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
byLevel	TokenNameIdentifier	 by Level
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
manifest	TokenNameIdentifier	 manifest
.	TokenNameDOT	
levelOf	TokenNameIdentifier	 level Of
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
)	TokenNameRPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
ICompactionScanner	TokenNameIdentifier	 I Compaction Scanner
>	TokenNameGREATER	
scanners	TokenNameIdentifier	 scanners
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
ICompactionScanner	TokenNameIdentifier	 I Compaction Scanner
>	TokenNameGREATER	
(	TokenNameLPAREN	
sstables	TokenNameIdentifier	 sstables
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
Integer	TokenNameIdentifier	 Integer
level	TokenNameIdentifier	 level
:	TokenNameCOLON	
byLevel	TokenNameIdentifier	 by Level
.	TokenNameDOT	
keySet	TokenNameIdentifier	 key Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// level can be -1 when sstables are added to DataTracker but not to LeveledManifest 	TokenNameCOMMENT_LINE	level can be -1 when sstables are added to DataTracker but not to LeveledManifest 
// since we don't know which level those sstable belong yet, we simply do the same as L0 sstables. 	TokenNameCOMMENT_LINE	since we don't know which level those sstable belong yet, we simply do the same as L0 sstables. 
if	TokenNameif	
(	TokenNameLPAREN	
level	TokenNameIdentifier	 level
<=	TokenNameLESS_EQUAL	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// L0 makes no guarantees about overlapping-ness. Just create a direct scanner for each 	TokenNameCOMMENT_LINE	L0 makes no guarantees about overlapping-ness. Just create a direct scanner for each 
for	TokenNamefor	
(	TokenNameLPAREN	
SSTableReader	TokenNameIdentifier	 SS Table Reader
sstable	TokenNameIdentifier	 sstable
:	TokenNameCOLON	
byLevel	TokenNameIdentifier	 by Level
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
level	TokenNameIdentifier	 level
)	TokenNameRPAREN	
)	TokenNameRPAREN	
scanners	TokenNameIdentifier	 scanners
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
getDirectScanner	TokenNameIdentifier	 get Direct Scanner
(	TokenNameLPAREN	
range	TokenNameIdentifier	 range
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
// Create a LeveledScanner that only opens one sstable at a time, in sorted order 	TokenNameCOMMENT_LINE	Create a LeveledScanner that only opens one sstable at a time, in sorted order 
scanners	TokenNameIdentifier	 scanners
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
LeveledScanner	TokenNameIdentifier	 Leveled Scanner
(	TokenNameLPAREN	
byLevel	TokenNameIdentifier	 by Level
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
level	TokenNameIdentifier	 level
)	TokenNameRPAREN	
,	TokenNameCOMMA	
range	TokenNameIdentifier	 range
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
return	TokenNamereturn	
scanners	TokenNameIdentifier	 scanners
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Lazily creates SSTableBoundedScanner for sstable that are assumed to be from the 	TokenNameCOMMENT_LINE	Lazily creates SSTableBoundedScanner for sstable that are assumed to be from the 
// same level (e.g. non overlapping) - see #4142 	TokenNameCOMMENT_LINE	same level (e.g. non overlapping) - see #4142 
private	TokenNameprivate	
static	TokenNamestatic	
class	TokenNameclass	
LeveledScanner	TokenNameIdentifier	 Leveled Scanner
extends	TokenNameextends	
AbstractIterator	TokenNameIdentifier	 Abstract Iterator
<	TokenNameLESS	
OnDiskAtomIterator	TokenNameIdentifier	 On Disk Atom Iterator
>	TokenNameGREATER	
implements	TokenNameimplements	
ICompactionScanner	TokenNameIdentifier	 I Compaction Scanner
{	TokenNameLBRACE	
private	TokenNameprivate	
final	TokenNamefinal	
Range	TokenNameIdentifier	 Range
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
range	TokenNameIdentifier	 range
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
sstables	TokenNameIdentifier	 sstables
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
Iterator	TokenNameIdentifier	 Iterator
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
sstableIterator	TokenNameIdentifier	 sstable Iterator
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
long	TokenNamelong	
totalLength	TokenNameIdentifier	 total Length
;	TokenNameSEMICOLON	
private	TokenNameprivate	
SSTableScanner	TokenNameIdentifier	 SS Table Scanner
currentScanner	TokenNameIdentifier	 current Scanner
;	TokenNameSEMICOLON	
private	TokenNameprivate	
long	TokenNamelong	
positionOffset	TokenNameIdentifier	 position Offset
;	TokenNameSEMICOLON	
public	TokenNamepublic	
LeveledScanner	TokenNameIdentifier	 Leveled Scanner
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
Range	TokenNameIdentifier	 Range
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>	TokenNameGREATER	
range	TokenNameIdentifier	 range
)	TokenNameRPAREN	
{	TokenNameLBRACE	
this	TokenNamethis	
.	TokenNameDOT	
range	TokenNameIdentifier	 range
=	TokenNameEQUAL	
range	TokenNameIdentifier	 range
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
sstables	TokenNameIdentifier	 sstables
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
(	TokenNameLPAREN	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
sort	TokenNameIdentifier	 sort
(	TokenNameLPAREN	
this	TokenNamethis	
.	TokenNameDOT	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
SSTable	TokenNameIdentifier	 SS Table
.	TokenNameDOT	
sstableComparator	TokenNameIdentifier	 sstable Comparator
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sstableIterator	TokenNameIdentifier	 sstable Iterator
=	TokenNameEQUAL	
this	TokenNamethis	
.	TokenNameDOT	
sstables	TokenNameIdentifier	 sstables
.	TokenNameDOT	
iterator	TokenNameIdentifier	 iterator
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
currentScanner	TokenNameIdentifier	 current Scanner
=	TokenNameEQUAL	
sstableIterator	TokenNameIdentifier	 sstable Iterator
.	TokenNameDOT	
next	TokenNameIdentifier	 next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getDirectScanner	TokenNameIdentifier	 get Direct Scanner
(	TokenNameLPAREN	
range	TokenNameIdentifier	 range
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
long	TokenNamelong	
length	TokenNameIdentifier	 length
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
SSTableReader	TokenNameIdentifier	 SS Table Reader
sstable	TokenNameIdentifier	 sstable
:	TokenNameCOLON	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
length	TokenNameIdentifier	 length
+=	TokenNamePLUS_EQUAL	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
uncompressedLength	TokenNameIdentifier	 uncompressed Length
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
totalLength	TokenNameIdentifier	 total Length
=	TokenNameEQUAL	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
protected	TokenNameprotected	
OnDiskAtomIterator	TokenNameIdentifier	 On Disk Atom Iterator
computeNext	TokenNameIdentifier	 compute Next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
while	TokenNamewhile	
(	TokenNameLPAREN	
true	TokenNametrue	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
currentScanner	TokenNameIdentifier	 current Scanner
.	TokenNameDOT	
hasNext	TokenNameIdentifier	 has Next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
return	TokenNamereturn	
currentScanner	TokenNameIdentifier	 current Scanner
.	TokenNameDOT	
next	TokenNameIdentifier	 next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
positionOffset	TokenNameIdentifier	 position Offset
+=	TokenNamePLUS_EQUAL	
currentScanner	TokenNameIdentifier	 current Scanner
.	TokenNameDOT	
getLengthInBytes	TokenNameIdentifier	 get Length In Bytes
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
currentScanner	TokenNameIdentifier	 current Scanner
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
sstableIterator	TokenNameIdentifier	 sstable Iterator
.	TokenNameDOT	
hasNext	TokenNameIdentifier	 has Next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// reset to null so getCurrentPosition does not return wrong value 	TokenNameCOMMENT_LINE	reset to null so getCurrentPosition does not return wrong value 
currentScanner	TokenNameIdentifier	 current Scanner
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
endOfData	TokenNameIdentifier	 end Of Data
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
currentScanner	TokenNameIdentifier	 current Scanner
=	TokenNameEQUAL	
sstableIterator	TokenNameIdentifier	 sstable Iterator
.	TokenNameDOT	
next	TokenNameIdentifier	 next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getDirectScanner	TokenNameIdentifier	 get Direct Scanner
(	TokenNameLPAREN	
range	TokenNameIdentifier	 range
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
IOException	TokenNameIdentifier	 IO Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
currentScanner	TokenNameIdentifier	 current Scanner
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
currentScanner	TokenNameIdentifier	 current Scanner
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
long	TokenNamelong	
getLengthInBytes	TokenNameIdentifier	 get Length In Bytes
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
totalLength	TokenNameIdentifier	 total Length
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
long	TokenNamelong	
getCurrentPosition	TokenNameIdentifier	 get Current Position
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
positionOffset	TokenNameIdentifier	 position Offset
+	TokenNamePLUS	
(	TokenNameLPAREN	
currentScanner	TokenNameIdentifier	 current Scanner
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
?	TokenNameQUESTION	
0L	TokenNameLongLiteral	
:	TokenNameCOLON	
currentScanner	TokenNameIdentifier	 current Scanner
.	TokenNameDOT	
getCurrentPosition	TokenNameIdentifier	 get Current Position
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
String	TokenNameIdentifier	 String
getBackingFiles	TokenNameIdentifier	 get Backing Files
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
Joiner	TokenNameIdentifier	 Joiner
.	TokenNameDOT	
on	TokenNameIdentifier	 on
(	TokenNameLPAREN	
", "	TokenNameStringLiteral	, 
)	TokenNameRPAREN	
.	TokenNameDOT	
join	TokenNameIdentifier	 join
(	TokenNameLPAREN	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
String	TokenNameIdentifier	 String
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"LCS@%d(%s)"	TokenNameStringLiteral	LCS@%d(%s)
,	TokenNameCOMMA	
hashCode	TokenNameIdentifier	 hash Code
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
columnFamily	TokenNameIdentifier	 column Family
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
SSTableReader	TokenNameIdentifier	 SS Table Reader
findDroppableSSTable	TokenNameIdentifier	 find Droppable SS Table
(	TokenNameLPAREN	
final	TokenNamefinal	
int	TokenNameint	
gcBefore	TokenNameIdentifier	 gc Before
)	TokenNameRPAREN	
{	TokenNameLBRACE	
level	TokenNameIdentifier	 level
:	TokenNameCOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
manifest	TokenNameIdentifier	 manifest
.	TokenNameDOT	
getLevelCount	TokenNameIdentifier	 get Level Count
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
>=	TokenNameGREATER_EQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
--	TokenNameMINUS_MINUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// sort sstables by droppable ratio in descending order 	TokenNameCOMMENT_LINE	sort sstables by droppable ratio in descending order 
SortedSet	TokenNameIdentifier	 Sorted Set
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
sstables	TokenNameIdentifier	 sstables
=	TokenNameEQUAL	
manifest	TokenNameIdentifier	 manifest
.	TokenNameDOT	
getLevelSorted	TokenNameIdentifier	 get Level Sorted
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
,	TokenNameCOMMA	
new	TokenNamenew	
Comparator	TokenNameIdentifier	 Comparator
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
public	TokenNamepublic	
int	TokenNameint	
compare	TokenNameIdentifier	 compare
(	TokenNameLPAREN	
SSTableReader	TokenNameIdentifier	 SS Table Reader
o1	TokenNameIdentifier	 o1
,	TokenNameCOMMA	
SSTableReader	TokenNameIdentifier	 SS Table Reader
o2	TokenNameIdentifier	 o2
)	TokenNameRPAREN	
{	TokenNameLBRACE	
double	TokenNamedouble	
r1	TokenNameIdentifier	 r1
=	TokenNameEQUAL	
o1	TokenNameIdentifier	 o1
.	TokenNameDOT	
getEstimatedDroppableTombstoneRatio	TokenNameIdentifier	 get Estimated Droppable Tombstone Ratio
(	TokenNameLPAREN	
gcBefore	TokenNameIdentifier	 gc Before
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
r2	TokenNameIdentifier	 r2
=	TokenNameEQUAL	
o2	TokenNameIdentifier	 o2
.	TokenNameDOT	
getEstimatedDroppableTombstoneRatio	TokenNameIdentifier	 get Estimated Droppable Tombstone Ratio
(	TokenNameLPAREN	
gcBefore	TokenNameIdentifier	 gc Before
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
*	TokenNameMULTIPLY	
Doubles	TokenNameIdentifier	 Doubles
.	TokenNameDOT	
compare	TokenNameIdentifier	 compare
(	TokenNameLPAREN	
r1	TokenNameIdentifier	 r1
,	TokenNameCOMMA	
r2	TokenNameIdentifier	 r2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
sstables	TokenNameIdentifier	 sstables
.	TokenNameDOT	
isEmpty	TokenNameIdentifier	 is Empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
continue	TokenNamecontinue	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
SSTableReader	TokenNameIdentifier	 SS Table Reader
sstable	TokenNameIdentifier	 sstable
:	TokenNameCOLON	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
getEstimatedDroppableTombstoneRatio	TokenNameIdentifier	 get Estimated Droppable Tombstone Ratio
(	TokenNameLPAREN	
gcBefore	TokenNameIdentifier	 gc Before
)	TokenNameRPAREN	
<=	TokenNameLESS_EQUAL	
tombstoneThreshold	TokenNameIdentifier	 tombstone Threshold
)	TokenNameRPAREN	
continue	TokenNamecontinue	
level	TokenNameIdentifier	 level
;	TokenNameSEMICOLON	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
isMarkedSuspect	TokenNameIdentifier	 is Marked Suspect
(	TokenNameLPAREN	
)	TokenNameRPAREN	
&&	TokenNameAND_AND	
worthDroppingTombstones	TokenNameIdentifier	 worth Dropping Tombstones
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
,	TokenNameCOMMA	
gcBefore	TokenNameIdentifier	 gc Before
)	TokenNameRPAREN	
)	TokenNameRPAREN	
return	TokenNamereturn	
sstable	TokenNameIdentifier	 sstable
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
return	TokenNamereturn	
null	TokenNamenull	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
