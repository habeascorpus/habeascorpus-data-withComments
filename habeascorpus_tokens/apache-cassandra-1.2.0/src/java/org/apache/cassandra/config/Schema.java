/* * Licensed to the Apache Software Foundation (ASF) under one * or more contributor license agreements. See the NOTICE file * distributed with this work for additional information * regarding copyright ownership. The ASF licenses this file * to you under the Apache License, Version 2.0 (the * "License"); you may not use this file except in compliance * with the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */	TokenNameCOMMENT_BLOCK	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
config	TokenNameIdentifier	 config
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
nio	TokenNameIdentifier	 nio
.	TokenNameDOT	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
nio	TokenNameIdentifier	 nio
.	TokenNameDOT	
charset	TokenNameIdentifier	 charset
.	TokenNameDOT	
CharacterCodingException	TokenNameIdentifier	 Character Coding Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
security	TokenNameIdentifier	 security
.	TokenNameDOT	
MessageDigest	TokenNameIdentifier	 Message Digest
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
security	TokenNameIdentifier	 security
.	TokenNameDOT	
NoSuchAlgorithmException	TokenNameIdentifier	 No Such Algorithm Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
com	TokenNameIdentifier	 com
.	TokenNameDOT	
google	TokenNameIdentifier	 google
.	TokenNameDOT	
common	TokenNameIdentifier	 common
.	TokenNameDOT	
collect	TokenNameIdentifier	 collect
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
Logger	TokenNameIdentifier	 Logger
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
LoggerFactory	TokenNameIdentifier	 Logger Factory
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
auth	TokenNameIdentifier	 auth
.	TokenNameDOT	
Auth	TokenNameIdentifier	 Auth
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
Table	TokenNameIdentifier	 Table
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
marshal	TokenNameIdentifier	 marshal
.	TokenNameDOT	
AbstractType	TokenNameIdentifier	 Abstract Type
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
Descriptor	TokenNameIdentifier	 Descriptor
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
service	TokenNameIdentifier	 service
.	TokenNameDOT	
MigrationManager	TokenNameIdentifier	 Migration Manager
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
tracing	TokenNameIdentifier	 tracing
.	TokenNameDOT	
Tracing	TokenNameIdentifier	 Tracing
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
Pair	TokenNameIdentifier	 Pair
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
cliffc	TokenNameIdentifier	 cliffc
.	TokenNameDOT	
high_scale_lib	TokenNameIdentifier	 high scale lib
.	TokenNameDOT	
NonBlockingHashMap	TokenNameIdentifier	 Non Blocking Hash Map
;	TokenNameSEMICOLON	
public	TokenNamepublic	
class	TokenNameclass	
Schema	TokenNameIdentifier	 Schema
{	TokenNameLBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
Logger	TokenNameIdentifier	 Logger
logger	TokenNameIdentifier	 logger
=	TokenNameEQUAL	
LoggerFactory	TokenNameIdentifier	 Logger Factory
.	TokenNameDOT	
getLogger	TokenNameIdentifier	 get Logger
(	TokenNameLPAREN	
Schema	TokenNameIdentifier	 Schema
.	TokenNameDOT	
class	TokenNameclass	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
public	TokenNamepublic	
static	TokenNamestatic	
final	TokenNamefinal	
Schema	TokenNameIdentifier	 Schema
instance	TokenNameIdentifier	 instance
=	TokenNameEQUAL	
new	TokenNamenew	
Schema	TokenNameIdentifier	 Schema
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
/** * longest permissible KS or CF name. Our main concern is that filename not be more than 255 characters; * the filename will contain both the KS and CF names. Since non-schema-name components only take up * ~64 characters, we could allow longer names than this, but on Windows, the entire path should be not greater than * 255 characters, so a lower limit here helps avoid problems. See CASSANDRA-4110. */	TokenNameCOMMENT_JAVADOC	 longest permissible KS or CF name. Our main concern is that filename not be more than 255 characters; the filename will contain both the KS and CF names. Since non-schema-name components only take up ~64 characters, we could allow longer names than this, but on Windows, the entire path should be not greater than 255 characters, so a lower limit here helps avoid problems. See CASSANDRA-4110. 
public	TokenNamepublic	
static	TokenNamestatic	
final	TokenNamefinal	
int	TokenNameint	
NAME_LENGTH	TokenNameIdentifier	 NAME  LENGTH
=	TokenNameEQUAL	
48	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
/* metadata map for faster table lookup */	TokenNameCOMMENT_BLOCK	 metadata map for faster table lookup 
private	TokenNameprivate	
final	TokenNamefinal	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
KSMetaData	TokenNameIdentifier	 KS Meta Data
>	TokenNameGREATER	
tables	TokenNameIdentifier	 tables
=	TokenNameEQUAL	
new	TokenNamenew	
NonBlockingHashMap	TokenNameIdentifier	 Non Blocking Hash Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
KSMetaData	TokenNameIdentifier	 KS Meta Data
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
/* Table objects, one per keyspace. Only one instance should ever exist for any given keyspace. */	TokenNameCOMMENT_BLOCK	 Table objects, one per keyspace. Only one instance should ever exist for any given keyspace. 
private	TokenNameprivate	
final	TokenNamefinal	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
Table	TokenNameIdentifier	 Table
>	TokenNameGREATER	
tableInstances	TokenNameIdentifier	 table Instances
=	TokenNameEQUAL	
new	TokenNamenew	
NonBlockingHashMap	TokenNameIdentifier	 Non Blocking Hash Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
Table	TokenNameIdentifier	 Table
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
/* metadata map for faster ColumnFamily lookup */	TokenNameCOMMENT_BLOCK	 metadata map for faster ColumnFamily lookup 
private	TokenNameprivate	
final	TokenNamefinal	
BiMap	TokenNameIdentifier	 Bi Map
<	TokenNameLESS	
Pair	TokenNameIdentifier	 Pair
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
,	TokenNameCOMMA	
UUID	TokenNameIdentifier	 UUID
>	TokenNameGREATER	
cfIdMap	TokenNameIdentifier	 cf Id Map
=	TokenNameEQUAL	
HashBiMap	TokenNameIdentifier	 Hash Bi Map
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// mapping from old ColumnFamily Id (Integer) to a new version which is UUID 	TokenNameCOMMENT_LINE	mapping from old ColumnFamily Id (Integer) to a new version which is UUID 
private	TokenNameprivate	
final	TokenNamefinal	
BiMap	TokenNameIdentifier	 Bi Map
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
,	TokenNameCOMMA	
UUID	TokenNameIdentifier	 UUID
>	TokenNameGREATER	
oldCfIdMap	TokenNameIdentifier	 old Cf Id Map
=	TokenNameEQUAL	
HashBiMap	TokenNameIdentifier	 Hash Bi Map
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
private	TokenNameprivate	
volatile	TokenNamevolatile	
UUID	TokenNameIdentifier	 UUID
version	TokenNameIdentifier	 version
;	TokenNameSEMICOLON	
// 59adb24e-f3cd-3e02-97f0-5b395827453f 	TokenNameCOMMENT_LINE	59adb24e-f3cd-3e02-97f0-5b395827453f 
public	TokenNamepublic	
static	TokenNamestatic	
final	TokenNamefinal	
UUID	TokenNameIdentifier	 UUID
emptyVersion	TokenNameIdentifier	 empty Version
;	TokenNameSEMICOLON	
public	TokenNamepublic	
static	TokenNamestatic	
final	TokenNamefinal	
ImmutableSet	TokenNameIdentifier	 Immutable Set
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
systemKeyspaceNames	TokenNameIdentifier	 system Keyspace Names
=	TokenNameEQUAL	
ImmutableSet	TokenNameIdentifier	 Immutable Set
.	TokenNameDOT	
of	TokenNameIdentifier	 of
(	TokenNameLPAREN	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
SYSTEM_KS	TokenNameIdentifier	 SYSTEM  KS
,	TokenNameCOMMA	
Tracing	TokenNameIdentifier	 Tracing
.	TokenNameDOT	
TRACE_KS	TokenNameIdentifier	 TRACE  KS
,	TokenNameCOMMA	
Auth	TokenNameIdentifier	 Auth
.	TokenNameDOT	
AUTH_KS	TokenNameIdentifier	 AUTH  KS
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
static	TokenNamestatic	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
emptyVersion	TokenNameIdentifier	 empty Version
=	TokenNameEQUAL	
UUID	TokenNameIdentifier	 UUID
.	TokenNameDOT	
nameUUIDFromBytes	TokenNameIdentifier	 name UUID From Bytes
(	TokenNameLPAREN	
MessageDigest	TokenNameIdentifier	 Message Digest
.	TokenNameDOT	
getInstance	TokenNameIdentifier	 get Instance
(	TokenNameLPAREN	
"MD5"	TokenNameStringLiteral	MD5
)	TokenNameRPAREN	
.	TokenNameDOT	
digest	TokenNameIdentifier	 digest
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
NoSuchAlgorithmException	TokenNameIdentifier	 No Such Algorithm Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
AssertionError	TokenNameIdentifier	 Assertion Error
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** * Initialize empty schema object */	TokenNameCOMMENT_JAVADOC	 Initialize empty schema object 
public	TokenNamepublic	
Schema	TokenNameIdentifier	 Schema
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
}	TokenNameRBRACE	
/** * Load up non-system tables * * @param tableDefs The non-system table definitions * * @return self to support chaining calls */	TokenNameCOMMENT_JAVADOC	 Load up non-system tables * @param tableDefs The non-system table definitions * @return self to support chaining calls 
public	TokenNamepublic	
Schema	TokenNameIdentifier	 Schema
load	TokenNameIdentifier	 load
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
KSMetaData	TokenNameIdentifier	 KS Meta Data
>	TokenNameGREATER	
tableDefs	TokenNameIdentifier	 table Defs
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
KSMetaData	TokenNameIdentifier	 KS Meta Data
def	TokenNameIdentifier	 def
:	TokenNameCOLON	
tableDefs	TokenNameIdentifier	 table Defs
)	TokenNameRPAREN	
load	TokenNameIdentifier	 load
(	TokenNameLPAREN	
def	TokenNameIdentifier	 def
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
this	TokenNamethis	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Load specific keyspace into Schema * * @param keyspaceDef The keyspace to load up * * @return self to support chaining calls */	TokenNameCOMMENT_JAVADOC	 Load specific keyspace into Schema * @param keyspaceDef The keyspace to load up * @return self to support chaining calls 
public	TokenNamepublic	
Schema	TokenNameIdentifier	 Schema
load	TokenNameIdentifier	 load
(	TokenNameLPAREN	
KSMetaData	TokenNameIdentifier	 KS Meta Data
keyspaceDef	TokenNameIdentifier	 keyspace Def
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
CFMetaData	TokenNameIdentifier	 CF Meta Data
cfm	TokenNameIdentifier	 cfm
:	TokenNameCOLON	
keyspaceDef	TokenNameIdentifier	 keyspace Def
.	TokenNameDOT	
cfMetaData	TokenNameIdentifier	 cf Meta Data
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
values	TokenNameIdentifier	 values
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
load	TokenNameIdentifier	 load
(	TokenNameLPAREN	
cfm	TokenNameIdentifier	 cfm
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
setTableDefinition	TokenNameIdentifier	 set Table Definition
(	TokenNameLPAREN	
keyspaceDef	TokenNameIdentifier	 keyspace Def
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
this	TokenNamethis	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Get table instance by name * * @param tableName The name of the table * * @return Table object or null if table was not found */	TokenNameCOMMENT_JAVADOC	 Get table instance by name * @param tableName The name of the table * @return Table object or null if table was not found 
public	TokenNamepublic	
Table	TokenNameIdentifier	 Table
getTableInstance	TokenNameIdentifier	 get Table Instance
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
tableName	TokenNameIdentifier	 table Name
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
tableInstances	TokenNameIdentifier	 table Instances
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
tableName	TokenNameIdentifier	 table Name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Store given Table instance to the schema * * @param table The Table instance to store * * @throws IllegalArgumentException if Table is already stored */	TokenNameCOMMENT_JAVADOC	 Store given Table instance to the schema * @param table The Table instance to store * @throws IllegalArgumentException if Table is already stored 
public	TokenNamepublic	
void	TokenNamevoid	
storeTableInstance	TokenNameIdentifier	 store Table Instance
(	TokenNameLPAREN	
Table	TokenNameIdentifier	 Table
table	TokenNameIdentifier	 table
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
tableInstances	TokenNameIdentifier	 table Instances
.	TokenNameDOT	
containsKey	TokenNameIdentifier	 contains Key
(	TokenNameLPAREN	
table	TokenNameIdentifier	 table
.	TokenNameDOT	
name	TokenNameIdentifier	 name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
throw	TokenNamethrow	
new	TokenNamenew	
IllegalArgumentException	TokenNameIdentifier	 Illegal Argument Exception
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"Table %s was already initialized."	TokenNameStringLiteral	Table %s was already initialized.
,	TokenNameCOMMA	
table	TokenNameIdentifier	 table
.	TokenNameDOT	
name	TokenNameIdentifier	 name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
tableInstances	TokenNameIdentifier	 table Instances
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
table	TokenNameIdentifier	 table
.	TokenNameDOT	
name	TokenNameIdentifier	 name
,	TokenNameCOMMA	
table	TokenNameIdentifier	 table
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Remove table from schema * * @param tableName The name of the table to remove * * @return removed table instance or null if it wasn't found */	TokenNameCOMMENT_JAVADOC	 Remove table from schema * @param tableName The name of the table to remove * @return removed table instance or null if it wasn't found 
public	TokenNamepublic	
Table	TokenNameIdentifier	 Table
removeTableInstance	TokenNameIdentifier	 remove Table Instance
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
tableName	TokenNameIdentifier	 table Name
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
tableInstances	TokenNameIdentifier	 table Instances
.	TokenNameDOT	
remove	TokenNameIdentifier	 remove
(	TokenNameLPAREN	
tableName	TokenNameIdentifier	 table Name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Remove table definition from system * * @param ksm The table definition to remove */	TokenNameCOMMENT_JAVADOC	 Remove table definition from system * @param ksm The table definition to remove 
public	TokenNamepublic	
void	TokenNamevoid	
clearTableDefinition	TokenNameIdentifier	 clear Table Definition
(	TokenNameLPAREN	
KSMetaData	TokenNameIdentifier	 KS Meta Data
ksm	TokenNameIdentifier	 ksm
)	TokenNameRPAREN	
{	TokenNameLBRACE	
tables	TokenNameIdentifier	 tables
.	TokenNameDOT	
remove	TokenNameIdentifier	 remove
(	TokenNameLPAREN	
ksm	TokenNameIdentifier	 ksm
.	TokenNameDOT	
name	TokenNameIdentifier	 name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Given a table name & column family name, get the column family * meta data. If the table name or column family name is not valid * this function returns null. * * @param tableName The table name * @param cfName The ColumnFamily name * * @return ColumnFamily Metadata object or null if it wasn't found */	TokenNameCOMMENT_JAVADOC	 Given a table name & column family name, get the column family meta data. If the table name or column family name is not valid this function returns null. * @param tableName The table name @param cfName The ColumnFamily name * @return ColumnFamily Metadata object or null if it wasn't found 
public	TokenNamepublic	
CFMetaData	TokenNameIdentifier	 CF Meta Data
getCFMetaData	TokenNameIdentifier	 get CF Meta Data
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
tableName	TokenNameIdentifier	 table Name
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
cfName	TokenNameIdentifier	 cf Name
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assert	TokenNameassert	
tableName	TokenNameIdentifier	 table Name
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
KSMetaData	TokenNameIdentifier	 KS Meta Data
ksm	TokenNameIdentifier	 ksm
=	TokenNameEQUAL	
tables	TokenNameIdentifier	 tables
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
tableName	TokenNameIdentifier	 table Name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
(	TokenNameLPAREN	
ksm	TokenNameIdentifier	 ksm
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
null	TokenNamenull	
:	TokenNameCOLON	
ksm	TokenNameIdentifier	 ksm
.	TokenNameDOT	
cfMetaData	TokenNameIdentifier	 cf Meta Data
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
cfName	TokenNameIdentifier	 cf Name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Get ColumnFamily metadata by its identifier * * @param cfId The ColumnFamily identifier * * @return metadata about ColumnFamily */	TokenNameCOMMENT_JAVADOC	 Get ColumnFamily metadata by its identifier * @param cfId The ColumnFamily identifier * @return metadata about ColumnFamily 
public	TokenNamepublic	
CFMetaData	TokenNameIdentifier	 CF Meta Data
getCFMetaData	TokenNameIdentifier	 get CF Meta Data
(	TokenNameLPAREN	
UUID	TokenNameIdentifier	 UUID
cfId	TokenNameIdentifier	 cf Id
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Pair	TokenNameIdentifier	 Pair
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
cf	TokenNameIdentifier	 cf
=	TokenNameEQUAL	
getCF	TokenNameIdentifier	 get CF
(	TokenNameLPAREN	
cfId	TokenNameIdentifier	 cf Id
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
(	TokenNameLPAREN	
cf	TokenNameIdentifier	 cf
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
null	TokenNamenull	
:	TokenNameCOLON	
getCFMetaData	TokenNameIdentifier	 get CF Meta Data
(	TokenNameLPAREN	
cf	TokenNameIdentifier	 cf
.	TokenNameDOT	
left	TokenNameIdentifier	 left
,	TokenNameCOMMA	
cf	TokenNameIdentifier	 cf
.	TokenNameDOT	
right	TokenNameIdentifier	 right
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
CFMetaData	TokenNameIdentifier	 CF Meta Data
getCFMetaData	TokenNameIdentifier	 get CF Meta Data
(	TokenNameLPAREN	
Descriptor	TokenNameIdentifier	 Descriptor
descriptor	TokenNameIdentifier	 descriptor
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
getCFMetaData	TokenNameIdentifier	 get CF Meta Data
(	TokenNameLPAREN	
descriptor	TokenNameIdentifier	 descriptor
.	TokenNameDOT	
ksname	TokenNameIdentifier	 ksname
,	TokenNameCOMMA	
descriptor	TokenNameIdentifier	 descriptor
.	TokenNameDOT	
cfname	TokenNameIdentifier	 cfname
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Get type of the ColumnFamily but it's keyspace/name * * @param ksName The keyspace name * @param cfName The ColumnFamily name * * @return The type of the ColumnFamily */	TokenNameCOMMENT_JAVADOC	 Get type of the ColumnFamily but it's keyspace/name * @param ksName The keyspace name @param cfName The ColumnFamily name * @return The type of the ColumnFamily 
public	TokenNamepublic	
ColumnFamilyType	TokenNameIdentifier	 Column Family Type
getColumnFamilyType	TokenNameIdentifier	 get Column Family Type
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
ksName	TokenNameIdentifier	 ks Name
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
cfName	TokenNameIdentifier	 cf Name
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assert	TokenNameassert	
ksName	TokenNameIdentifier	 ks Name
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
&&	TokenNameAND_AND	
cfName	TokenNameIdentifier	 cf Name
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
CFMetaData	TokenNameIdentifier	 CF Meta Data
cfMetaData	TokenNameIdentifier	 cf Meta Data
=	TokenNameEQUAL	
getCFMetaData	TokenNameIdentifier	 get CF Meta Data
(	TokenNameLPAREN	
ksName	TokenNameIdentifier	 ks Name
,	TokenNameCOMMA	
cfName	TokenNameIdentifier	 cf Name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
(	TokenNameLPAREN	
cfMetaData	TokenNameIdentifier	 cf Meta Data
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
null	TokenNamenull	
:	TokenNameCOLON	
cfMetaData	TokenNameIdentifier	 cf Meta Data
.	TokenNameDOT	
cfType	TokenNameIdentifier	 cf Type
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Get column comparator for ColumnFamily but it's keyspace/name * * @param ksName The keyspace name * @param cfName The ColumnFamily name * * @return The comparator of the ColumnFamily */	TokenNameCOMMENT_JAVADOC	 Get column comparator for ColumnFamily but it's keyspace/name * @param ksName The keyspace name @param cfName The ColumnFamily name * @return The comparator of the ColumnFamily 
public	TokenNamepublic	
AbstractType	TokenNameIdentifier	 Abstract Type
<	TokenNameLESS	
?	TokenNameQUESTION	
>	TokenNameGREATER	
getComparator	TokenNameIdentifier	 get Comparator
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
ksName	TokenNameIdentifier	 ks Name
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
cfName	TokenNameIdentifier	 cf Name
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assert	TokenNameassert	
ksName	TokenNameIdentifier	 ks Name
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
CFMetaData	TokenNameIdentifier	 CF Meta Data
cfmd	TokenNameIdentifier	 cfmd
=	TokenNameEQUAL	
getCFMetaData	TokenNameIdentifier	 get CF Meta Data
(	TokenNameLPAREN	
ksName	TokenNameIdentifier	 ks Name
,	TokenNameCOMMA	
cfName	TokenNameIdentifier	 cf Name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
cfmd	TokenNameIdentifier	 cfmd
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
throw	TokenNamethrow	
new	TokenNamenew	
IllegalArgumentException	TokenNameIdentifier	 Illegal Argument Exception
(	TokenNameLPAREN	
"Unknown ColumnFamily "	TokenNameStringLiteral	Unknown ColumnFamily 
+	TokenNamePLUS	
cfName	TokenNameIdentifier	 cf Name
+	TokenNamePLUS	
" in keyspace "	TokenNameStringLiteral	 in keyspace 
+	TokenNamePLUS	
ksName	TokenNameIdentifier	 ks Name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
cfmd	TokenNameIdentifier	 cfmd
.	TokenNameDOT	
comparator	TokenNameIdentifier	 comparator
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Get subComparator of the ColumnFamily * * @param ksName The keyspace name * @param cfName The ColumnFamily name * * @return The subComparator of the ColumnFamily */	TokenNameCOMMENT_JAVADOC	 Get subComparator of the ColumnFamily * @param ksName The keyspace name @param cfName The ColumnFamily name * @return The subComparator of the ColumnFamily 
public	TokenNamepublic	
AbstractType	TokenNameIdentifier	 Abstract Type
<	TokenNameLESS	
?	TokenNameQUESTION	
>	TokenNameGREATER	
getSubComparator	TokenNameIdentifier	 get Sub Comparator
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
ksName	TokenNameIdentifier	 ks Name
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
cfName	TokenNameIdentifier	 cf Name
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assert	TokenNameassert	
ksName	TokenNameIdentifier	 ks Name
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
getCFMetaData	TokenNameIdentifier	 get CF Meta Data
(	TokenNameLPAREN	
ksName	TokenNameIdentifier	 ks Name
,	TokenNameCOMMA	
cfName	TokenNameIdentifier	 cf Name
)	TokenNameRPAREN	
.	TokenNameDOT	
subcolumnComparator	TokenNameIdentifier	 subcolumn Comparator
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Get value validator for specific column * * @param ksName The keyspace name * @param cfName The ColumnFamily name * @param column The name of the column * * @return value validator specific to the column or default (per-cf) one */	TokenNameCOMMENT_JAVADOC	 Get value validator for specific column * @param ksName The keyspace name @param cfName The ColumnFamily name @param column The name of the column * @return value validator specific to the column or default (per-cf) one 
public	TokenNamepublic	
AbstractType	TokenNameIdentifier	 Abstract Type
<	TokenNameLESS	
?	TokenNameQUESTION	
>	TokenNameGREATER	
getValueValidator	TokenNameIdentifier	 get Value Validator
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
ksName	TokenNameIdentifier	 ks Name
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
cfName	TokenNameIdentifier	 cf Name
,	TokenNameCOMMA	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
column	TokenNameIdentifier	 column
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
getCFMetaData	TokenNameIdentifier	 get CF Meta Data
(	TokenNameLPAREN	
ksName	TokenNameIdentifier	 ks Name
,	TokenNameCOMMA	
cfName	TokenNameIdentifier	 cf Name
)	TokenNameRPAREN	
.	TokenNameDOT	
getValueValidator	TokenNameIdentifier	 get Value Validator
(	TokenNameLPAREN	
column	TokenNameIdentifier	 column
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Get metadata about table by its name * * @param table The name of the table * * @return The table metadata or null if it wasn't found */	TokenNameCOMMENT_JAVADOC	 Get metadata about table by its name * @param table The name of the table * @return The table metadata or null if it wasn't found 
public	TokenNamepublic	
KSMetaData	TokenNameIdentifier	 KS Meta Data
getKSMetaData	TokenNameIdentifier	 get KS Meta Data
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
table	TokenNameIdentifier	 table
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assert	TokenNameassert	
table	TokenNameIdentifier	 table
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
tables	TokenNameIdentifier	 tables
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
table	TokenNameIdentifier	 table
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * @return collection of the non-system tables */	TokenNameCOMMENT_JAVADOC	 @return collection of the non-system tables 
public	TokenNamepublic	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
getNonSystemTables	TokenNameIdentifier	 get Non System Tables
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
ImmutableList	TokenNameIdentifier	 Immutable List
.	TokenNameDOT	
copyOf	TokenNameIdentifier	 copy Of
(	TokenNameLPAREN	
Sets	TokenNameIdentifier	 Sets
.	TokenNameDOT	
difference	TokenNameIdentifier	 difference
(	TokenNameLPAREN	
tables	TokenNameIdentifier	 tables
.	TokenNameDOT	
keySet	TokenNameIdentifier	 key Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
systemKeyspaceNames	TokenNameIdentifier	 system Keyspace Names
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Get metadata about table by its name * * @param table The name of the table * * @return The table metadata or null if it wasn't found */	TokenNameCOMMENT_JAVADOC	 Get metadata about table by its name * @param table The name of the table * @return The table metadata or null if it wasn't found 
public	TokenNamepublic	
KSMetaData	TokenNameIdentifier	 KS Meta Data
getTableDefinition	TokenNameIdentifier	 get Table Definition
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
table	TokenNameIdentifier	 table
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
getKSMetaData	TokenNameIdentifier	 get KS Meta Data
(	TokenNameLPAREN	
table	TokenNameIdentifier	 table
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Get metadata about table inner ColumnFamilies * * @param tableName The name of the table * * @return metadata about ColumnFamilies the belong to the given table */	TokenNameCOMMENT_JAVADOC	 Get metadata about table inner ColumnFamilies * @param tableName The name of the table * @return metadata about ColumnFamilies the belong to the given table 
public	TokenNamepublic	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
CFMetaData	TokenNameIdentifier	 CF Meta Data
>	TokenNameGREATER	
getTableMetaData	TokenNameIdentifier	 get Table Meta Data
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
tableName	TokenNameIdentifier	 table Name
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assert	TokenNameassert	
tableName	TokenNameIdentifier	 table Name
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
KSMetaData	TokenNameIdentifier	 KS Meta Data
ksm	TokenNameIdentifier	 ksm
=	TokenNameEQUAL	
tables	TokenNameIdentifier	 tables
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
tableName	TokenNameIdentifier	 table Name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assert	TokenNameassert	
ksm	TokenNameIdentifier	 ksm
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
ksm	TokenNameIdentifier	 ksm
.	TokenNameDOT	
cfMetaData	TokenNameIdentifier	 cf Meta Data
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * @return collection of the all table names registered in the system (system and non-system) */	TokenNameCOMMENT_JAVADOC	 @return collection of the all table names registered in the system (system and non-system) 
public	TokenNamepublic	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
getTables	TokenNameIdentifier	 get Tables
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
tables	TokenNameIdentifier	 tables
.	TokenNameDOT	
keySet	TokenNameIdentifier	 key Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * @return collection of the metadata about all tables registered in the system (system and non-system) */	TokenNameCOMMENT_JAVADOC	 @return collection of the metadata about all tables registered in the system (system and non-system) 
public	TokenNamepublic	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
KSMetaData	TokenNameIdentifier	 KS Meta Data
>	TokenNameGREATER	
getTableDefinitions	TokenNameIdentifier	 get Table Definitions
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
tables	TokenNameIdentifier	 tables
.	TokenNameDOT	
values	TokenNameIdentifier	 values
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Update (or insert) new table definition * * @param ksm The metadata about table */	TokenNameCOMMENT_JAVADOC	 Update (or insert) new table definition * @param ksm The metadata about table 
public	TokenNamepublic	
void	TokenNamevoid	
setTableDefinition	TokenNameIdentifier	 set Table Definition
(	TokenNameLPAREN	
KSMetaData	TokenNameIdentifier	 KS Meta Data
ksm	TokenNameIdentifier	 ksm
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assert	TokenNameassert	
ksm	TokenNameIdentifier	 ksm
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
tables	TokenNameIdentifier	 tables
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
ksm	TokenNameIdentifier	 ksm
.	TokenNameDOT	
name	TokenNameIdentifier	 name
,	TokenNameCOMMA	
ksm	TokenNameIdentifier	 ksm
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/* ColumnFamily query/control methods */	TokenNameCOMMENT_BLOCK	 ColumnFamily query/control methods 
public	TokenNamepublic	
void	TokenNamevoid	
addOldCfIdMapping	TokenNameIdentifier	 add Old Cf Id Mapping
(	TokenNameLPAREN	
Integer	TokenNameIdentifier	 Integer
oldId	TokenNameIdentifier	 old Id
,	TokenNameCOMMA	
UUID	TokenNameIdentifier	 UUID
newId	TokenNameIdentifier	 new Id
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
oldId	TokenNameIdentifier	 old Id
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
return	TokenNamereturn	
;	TokenNameSEMICOLON	
oldCfIdMap	TokenNameIdentifier	 old Cf Id Map
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
oldId	TokenNameIdentifier	 old Id
,	TokenNameCOMMA	
newId	TokenNameIdentifier	 new Id
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
UUID	TokenNameIdentifier	 UUID
convertOldCfId	TokenNameIdentifier	 convert Old Cf Id
(	TokenNameLPAREN	
Integer	TokenNameIdentifier	 Integer
oldCfId	TokenNameIdentifier	 old Cf Id
)	TokenNameRPAREN	
throws	TokenNamethrows	
UnknownColumnFamilyException	TokenNameIdentifier	 Unknown Column Family Exception
{	TokenNameLBRACE	
UUID	TokenNameIdentifier	 UUID
cfId	TokenNameIdentifier	 cf Id
=	TokenNameEQUAL	
oldCfIdMap	TokenNameIdentifier	 old Cf Id Map
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
oldCfId	TokenNameIdentifier	 old Cf Id
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
cfId	TokenNameIdentifier	 cf Id
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
throw	TokenNamethrow	
new	TokenNamenew	
UnknownColumnFamilyException	TokenNameIdentifier	 Unknown Column Family Exception
(	TokenNameLPAREN	
"ColumnFamily identified by old "	TokenNameStringLiteral	ColumnFamily identified by old 
+	TokenNamePLUS	
oldCfId	TokenNameIdentifier	 old Cf Id
+	TokenNamePLUS	
" was not found."	TokenNameStringLiteral	 was not found.
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
cfId	TokenNameIdentifier	 cf Id
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
Integer	TokenNameIdentifier	 Integer
convertNewCfId	TokenNameIdentifier	 convert New Cf Id
(	TokenNameLPAREN	
UUID	TokenNameIdentifier	 UUID
newCfId	TokenNameIdentifier	 new Cf Id
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
oldCfIdMap	TokenNameIdentifier	 old Cf Id Map
.	TokenNameDOT	
containsValue	TokenNameIdentifier	 contains Value
(	TokenNameLPAREN	
newCfId	TokenNameIdentifier	 new Cf Id
)	TokenNameRPAREN	
?	TokenNameQUESTION	
oldCfIdMap	TokenNameIdentifier	 old Cf Id Map
.	TokenNameDOT	
inverse	TokenNameIdentifier	 inverse
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
newCfId	TokenNameIdentifier	 new Cf Id
)	TokenNameRPAREN	
:	TokenNameCOLON	
null	TokenNamenull	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * @param cfId The identifier of the ColumnFamily to lookup * @return The (ksname,cfname) pair for the given id, or null if it has been dropped. */	TokenNameCOMMENT_JAVADOC	 @param cfId The identifier of the ColumnFamily to lookup @return The (ksname,cfname) pair for the given id, or null if it has been dropped. 
public	TokenNamepublic	
Pair	TokenNameIdentifier	 Pair
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
getCF	TokenNameIdentifier	 get CF
(	TokenNameLPAREN	
UUID	TokenNameIdentifier	 UUID
cfId	TokenNameIdentifier	 cf Id
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
cfIdMap	TokenNameIdentifier	 cf Id Map
.	TokenNameDOT	
inverse	TokenNameIdentifier	 inverse
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
cfId	TokenNameIdentifier	 cf Id
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Lookup keyspace/ColumnFamily identifier * * @param ksName The keyspace name * @param cfName The ColumnFamily name * * @return The id for the given (ksname,cfname) pair, or null if it has been dropped. */	TokenNameCOMMENT_JAVADOC	 Lookup keyspace/ColumnFamily identifier * @param ksName The keyspace name @param cfName The ColumnFamily name * @return The id for the given (ksname,cfname) pair, or null if it has been dropped. 
public	TokenNamepublic	
UUID	TokenNameIdentifier	 UUID
getId	TokenNameIdentifier	 get Id
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
ksName	TokenNameIdentifier	 ks Name
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
cfName	TokenNameIdentifier	 cf Name
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
cfIdMap	TokenNameIdentifier	 cf Id Map
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
Pair	TokenNameIdentifier	 Pair
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
ksName	TokenNameIdentifier	 ks Name
,	TokenNameCOMMA	
cfName	TokenNameIdentifier	 cf Name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Load individual ColumnFamily Definition to the schema * (to make ColumnFamily lookup faster) * * @param cfm The ColumnFamily definition to load */	TokenNameCOMMENT_JAVADOC	 Load individual ColumnFamily Definition to the schema (to make ColumnFamily lookup faster) * @param cfm The ColumnFamily definition to load 
public	TokenNamepublic	
void	TokenNamevoid	
load	TokenNameIdentifier	 load
(	TokenNameLPAREN	
CFMetaData	TokenNameIdentifier	 CF Meta Data
cfm	TokenNameIdentifier	 cfm
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Pair	TokenNameIdentifier	 Pair
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
key	TokenNameIdentifier	 key
=	TokenNameEQUAL	
Pair	TokenNameIdentifier	 Pair
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
cfm	TokenNameIdentifier	 cfm
.	TokenNameDOT	
ksName	TokenNameIdentifier	 ks Name
,	TokenNameCOMMA	
cfm	TokenNameIdentifier	 cfm
.	TokenNameDOT	
cfName	TokenNameIdentifier	 cf Name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
cfIdMap	TokenNameIdentifier	 cf Id Map
.	TokenNameDOT	
containsKey	TokenNameIdentifier	 contains Key
(	TokenNameLPAREN	
key	TokenNameIdentifier	 key
)	TokenNameRPAREN	
)	TokenNameRPAREN	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"Attempting to load already loaded column family %s.%s"	TokenNameStringLiteral	Attempting to load already loaded column family %s.%s
,	TokenNameCOMMA	
cfm	TokenNameIdentifier	 cfm
.	TokenNameDOT	
ksName	TokenNameIdentifier	 ks Name
,	TokenNameCOMMA	
cfm	TokenNameIdentifier	 cfm
.	TokenNameDOT	
cfName	TokenNameIdentifier	 cf Name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"Adding {} to cfIdMap"	TokenNameStringLiteral	Adding {} to cfIdMap
,	TokenNameCOMMA	
cfm	TokenNameIdentifier	 cfm
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
cfIdMap	TokenNameIdentifier	 cf Id Map
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
cfm	TokenNameIdentifier	 cfm
.	TokenNameDOT	
cfId	TokenNameIdentifier	 cf Id
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Used for ColumnFamily data eviction out from the schema * * @param cfm The ColumnFamily Definition to evict */	TokenNameCOMMENT_JAVADOC	 Used for ColumnFamily data eviction out from the schema * @param cfm The ColumnFamily Definition to evict 
public	TokenNamepublic	
void	TokenNamevoid	
purge	TokenNameIdentifier	 purge
(	TokenNameLPAREN	
CFMetaData	TokenNameIdentifier	 CF Meta Data
cfm	TokenNameIdentifier	 cfm
)	TokenNameRPAREN	
{	TokenNameLBRACE	
cfIdMap	TokenNameIdentifier	 cf Id Map
.	TokenNameDOT	
remove	TokenNameIdentifier	 remove
(	TokenNameLPAREN	
Pair	TokenNameIdentifier	 Pair
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
cfm	TokenNameIdentifier	 cfm
.	TokenNameDOT	
ksName	TokenNameIdentifier	 ks Name
,	TokenNameCOMMA	
cfm	TokenNameIdentifier	 cfm
.	TokenNameDOT	
cfName	TokenNameIdentifier	 cf Name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/* Version control */	TokenNameCOMMENT_BLOCK	 Version control 
/** * @return current schema version */	TokenNameCOMMENT_JAVADOC	 @return current schema version 
public	TokenNamepublic	
UUID	TokenNameIdentifier	 UUID
getVersion	TokenNameIdentifier	 get Version
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
version	TokenNameIdentifier	 version
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Read schema from system table and calculate MD5 digest of every row, resulting digest * will be converted into UUID which would act as content-based version of the schema. */	TokenNameCOMMENT_JAVADOC	 Read schema from system table and calculate MD5 digest of every row, resulting digest will be converted into UUID which would act as content-based version of the schema. 
public	TokenNamepublic	
void	TokenNamevoid	
updateVersion	TokenNameIdentifier	 update Version
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
MessageDigest	TokenNameIdentifier	 Message Digest
versionDigest	TokenNameIdentifier	 version Digest
=	TokenNameEQUAL	
MessageDigest	TokenNameIdentifier	 Message Digest
.	TokenNameDOT	
getInstance	TokenNameIdentifier	 get Instance
(	TokenNameLPAREN	
"MD5"	TokenNameStringLiteral	MD5
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
Row	TokenNameIdentifier	 Row
row	TokenNameIdentifier	 row
:	TokenNameCOLON	
SystemTable	TokenNameIdentifier	 System Table
.	TokenNameDOT	
serializedSchema	TokenNameIdentifier	 serialized Schema
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
invalidSchemaRow	TokenNameIdentifier	 invalid Schema Row
(	TokenNameLPAREN	
row	TokenNameIdentifier	 row
)	TokenNameRPAREN	
||	TokenNameOR_OR	
ignoredSchemaRow	TokenNameIdentifier	 ignored Schema Row
(	TokenNameLPAREN	
row	TokenNameIdentifier	 row
)	TokenNameRPAREN	
)	TokenNameRPAREN	
continue	TokenNamecontinue	
;	TokenNameSEMICOLON	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
cf	TokenNameIdentifier	 cf
.	TokenNameDOT	
updateDigest	TokenNameIdentifier	 update Digest
(	TokenNameLPAREN	
versionDigest	TokenNameIdentifier	 version Digest
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
version	TokenNameIdentifier	 version
=	TokenNameEQUAL	
UUID	TokenNameIdentifier	 UUID
.	TokenNameDOT	
nameUUIDFromBytes	TokenNameIdentifier	 name UUID From Bytes
(	TokenNameLPAREN	
versionDigest	TokenNameIdentifier	 version Digest
.	TokenNameDOT	
digest	TokenNameIdentifier	 digest
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
SystemTable	TokenNameIdentifier	 System Table
.	TokenNameDOT	
updateSchemaVersion	TokenNameIdentifier	 update Schema Version
(	TokenNameLPAREN	
version	TokenNameIdentifier	 version
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
Exception	TokenNameIdentifier	 Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/* * Like updateVersion, but also announces via gossip */	TokenNameCOMMENT_BLOCK	 Like updateVersion, but also announces via gossip 
public	TokenNamepublic	
void	TokenNamevoid	
updateVersionAndAnnounce	TokenNameIdentifier	 update Version And Announce
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
updateVersion	TokenNameIdentifier	 update Version
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
MigrationManager	TokenNameIdentifier	 Migration Manager
.	TokenNameDOT	
passiveAnnounce	TokenNameIdentifier	 passive Announce
(	TokenNameLPAREN	
version	TokenNameIdentifier	 version
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Clear all KS/CF metadata and reset version. */	TokenNameCOMMENT_JAVADOC	 Clear all KS/CF metadata and reset version. 
public	TokenNamepublic	
synchronized	TokenNamesynchronized	
void	TokenNamevoid	
clear	TokenNameIdentifier	 clear
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
table	TokenNameIdentifier	 table
:	TokenNameCOLON	
getNonSystemTables	TokenNameIdentifier	 get Non System Tables
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
KSMetaData	TokenNameIdentifier	 KS Meta Data
ksm	TokenNameIdentifier	 ksm
=	TokenNameEQUAL	
getTableDefinition	TokenNameIdentifier	 get Table Definition
(	TokenNameLPAREN	
table	TokenNameIdentifier	 table
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
CFMetaData	TokenNameIdentifier	 CF Meta Data
cfm	TokenNameIdentifier	 cfm
:	TokenNameCOLON	
ksm	TokenNameIdentifier	 ksm
.	TokenNameDOT	
cfMetaData	TokenNameIdentifier	 cf Meta Data
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
values	TokenNameIdentifier	 values
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
purge	TokenNameIdentifier	 purge
(	TokenNameLPAREN	
cfm	TokenNameIdentifier	 cfm
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
clearTableDefinition	TokenNameIdentifier	 clear Table Definition
(	TokenNameLPAREN	
ksm	TokenNameIdentifier	 ksm
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
updateVersionAndAnnounce	TokenNameIdentifier	 update Version And Announce
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
boolean	TokenNameboolean	
invalidSchemaRow	TokenNameIdentifier	 invalid Schema Row
(	TokenNameLPAREN	
Row	TokenNameIdentifier	 Row
row	TokenNameIdentifier	 row
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
cf	TokenNameIdentifier	 cf
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
||	TokenNameOR_OR	
(	TokenNameLPAREN	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
cf	TokenNameIdentifier	 cf
.	TokenNameDOT	
isMarkedForDelete	TokenNameIdentifier	 is Marked For Delete
(	TokenNameLPAREN	
)	TokenNameRPAREN	
&&	TokenNameAND_AND	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
cf	TokenNameIdentifier	 cf
.	TokenNameDOT	
isEmpty	TokenNameIdentifier	 is Empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
boolean	TokenNameboolean	
ignoredSchemaRow	TokenNameIdentifier	 ignored Schema Row
(	TokenNameLPAREN	
Row	TokenNameIdentifier	 Row
row	TokenNameIdentifier	 row
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
return	TokenNamereturn	
systemKeyspaceNames	TokenNameIdentifier	 system Keyspace Names
.	TokenNameDOT	
contains	TokenNameIdentifier	 contains
(	TokenNameLPAREN	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
string	TokenNameIdentifier	 string
(	TokenNameLPAREN	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
key	TokenNameIdentifier	 key
.	TokenNameDOT	
key	TokenNameIdentifier	 key
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
CharacterCodingException	TokenNameIdentifier	 Character Coding Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
