package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
;	TokenNameSEMICOLON	
/** * Licensed to the Apache Software Foundation (ASF) under one or more * contributor license agreements. See the NOTICE file distributed with * this work for additional information regarding copyright ownership. * The ASF licenses this file to You under the Apache License, Version 2.0 * (the "License"); you may not use this file except in compliance with * the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */	TokenNameCOMMENT_JAVADOC	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
IOException	TokenNameIdentifier	 IO Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
ArrayList	TokenNameIdentifier	 Array List
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
Arrays	TokenNameIdentifier	 Arrays
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
Collections	TokenNameIdentifier	 Collections
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
List	TokenNameIdentifier	 List
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
analysis	TokenNameIdentifier	 analysis
.	TokenNameDOT	
MockAnalyzer	TokenNameIdentifier	 Mock Analyzer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
document	TokenNameIdentifier	 document
.	TokenNameDOT	
Document	TokenNameIdentifier	 Document
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
document	TokenNameIdentifier	 document
.	TokenNameDOT	
Field	TokenNameIdentifier	 Field
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
document	TokenNameIdentifier	 document
.	TokenNameDOT	
NumericField	TokenNameIdentifier	 Numeric Field
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
IndexReader	TokenNameIdentifier	 Index Reader
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
LogDocMergePolicy	TokenNameIdentifier	 Log Doc Merge Policy
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
Term	TokenNameIdentifier	 Term
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
grouping	TokenNameIdentifier	 grouping
.	TokenNameDOT	
GroupDocs	TokenNameIdentifier	 Group Docs
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
grouping	TokenNameIdentifier	 grouping
.	TokenNameDOT	
TopGroups	TokenNameIdentifier	 Top Groups
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
join	TokenNameIdentifier	 join
.	TokenNameDOT	
RawTermFilter	TokenNameIdentifier	 Raw Term Filter
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
join	TokenNameIdentifier	 join
.	TokenNameDOT	
ToChildBlockJoinQuery	TokenNameIdentifier	 To Child Block Join Query
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
join	TokenNameIdentifier	 join
.	TokenNameDOT	
ToParentBlockJoinCollector	TokenNameIdentifier	 To Parent Block Join Collector
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
join	TokenNameIdentifier	 join
.	TokenNameDOT	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
store	TokenNameIdentifier	 store
.	TokenNameDOT	
Directory	TokenNameIdentifier	 Directory
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
BytesRef	TokenNameIdentifier	 Bytes Ref
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
FixedBitSet	TokenNameIdentifier	 Fixed Bit Set
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
LuceneTestCase	TokenNameIdentifier	 Lucene Test Case
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
ReaderUtil	TokenNameIdentifier	 Reader Util
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
_TestUtil	TokenNameIdentifier	 Test Util
;	TokenNameSEMICOLON	
public	TokenNamepublic	
class	TokenNameclass	
TestBlockJoin	TokenNameIdentifier	 Test Block Join
extends	TokenNameextends	
LuceneTestCase	TokenNameIdentifier	 Lucene Test Case
{	TokenNameLBRACE	
// One resume... 	TokenNameCOMMENT_LINE	One resume... 
private	TokenNameprivate	
Document	TokenNameIdentifier	 Document
makeResume	TokenNameIdentifier	 make Resume
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
name	TokenNameIdentifier	 name
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
country	TokenNameIdentifier	 country
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Document	TokenNameIdentifier	 Document
resume	TokenNameIdentifier	 resume
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
resume	TokenNameIdentifier	 resume
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"docType"	TokenNameStringLiteral	docType
,	TokenNameCOMMA	
"resume"	TokenNameStringLiteral	resume
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
resume	TokenNameIdentifier	 resume
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"name"	TokenNameStringLiteral	name
,	TokenNameCOMMA	
name	TokenNameIdentifier	 name
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
resume	TokenNameIdentifier	 resume
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"country"	TokenNameStringLiteral	country
,	TokenNameCOMMA	
country	TokenNameIdentifier	 country
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
resume	TokenNameIdentifier	 resume
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// ... has multiple jobs 	TokenNameCOMMENT_LINE	... has multiple jobs 
private	TokenNameprivate	
Document	TokenNameIdentifier	 Document
makeJob	TokenNameIdentifier	 make Job
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
skill	TokenNameIdentifier	 skill
,	TokenNameCOMMA	
int	TokenNameint	
year	TokenNameIdentifier	 year
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Document	TokenNameIdentifier	 Document
job	TokenNameIdentifier	 job
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
job	TokenNameIdentifier	 job
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"skill"	TokenNameStringLiteral	skill
,	TokenNameCOMMA	
skill	TokenNameIdentifier	 skill
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
job	TokenNameIdentifier	 job
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
NumericField	TokenNameIdentifier	 Numeric Field
(	TokenNameLPAREN	
"year"	TokenNameStringLiteral	year
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
.	TokenNameDOT	
setIntValue	TokenNameIdentifier	 set Int Value
(	TokenNameLPAREN	
year	TokenNameIdentifier	 year
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
job	TokenNameIdentifier	 job
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// ... has multiple qualifications 	TokenNameCOMMENT_LINE	... has multiple qualifications 
private	TokenNameprivate	
Document	TokenNameIdentifier	 Document
makeQualification	TokenNameIdentifier	 make Qualification
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
qualification	TokenNameIdentifier	 qualification
,	TokenNameCOMMA	
int	TokenNameint	
year	TokenNameIdentifier	 year
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Document	TokenNameIdentifier	 Document
job	TokenNameIdentifier	 job
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
job	TokenNameIdentifier	 job
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"qualification"	TokenNameStringLiteral	qualification
,	TokenNameCOMMA	
qualification	TokenNameIdentifier	 qualification
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
job	TokenNameIdentifier	 job
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
NumericField	TokenNameIdentifier	 Numeric Field
(	TokenNameLPAREN	
"year"	TokenNameStringLiteral	year
)	TokenNameRPAREN	
.	TokenNameDOT	
setIntValue	TokenNameIdentifier	 set Int Value
(	TokenNameLPAREN	
year	TokenNameIdentifier	 year
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
job	TokenNameIdentifier	 job
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
testSimple	TokenNameIdentifier	 test Simple
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
final	TokenNamefinal	
Directory	TokenNameIdentifier	 Directory
dir	TokenNameIdentifier	 dir
=	TokenNameEQUAL	
newDirectory	TokenNameIdentifier	 new Directory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
w	TokenNameIdentifier	 w
=	TokenNameEQUAL	
new	TokenNamenew	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
dir	TokenNameIdentifier	 dir
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Document	TokenNameIdentifier	 Document
>	TokenNameGREATER	
docs	TokenNameIdentifier	 docs
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
Document	TokenNameIdentifier	 Document
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
makeJob	TokenNameIdentifier	 make Job
(	TokenNameLPAREN	
"java"	TokenNameStringLiteral	java
,	TokenNameCOMMA	
2007	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
makeJob	TokenNameIdentifier	 make Job
(	TokenNameLPAREN	
"python"	TokenNameStringLiteral	python
,	TokenNameCOMMA	
2010	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
makeResume	TokenNameIdentifier	 make Resume
(	TokenNameLPAREN	
"Lisa"	TokenNameStringLiteral	Lisa
,	TokenNameCOMMA	
"United Kingdom"	TokenNameStringLiteral	United Kingdom
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
addDocuments	TokenNameIdentifier	 add Documents
(	TokenNameLPAREN	
docs	TokenNameIdentifier	 docs
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
clear	TokenNameIdentifier	 clear
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
makeJob	TokenNameIdentifier	 make Job
(	TokenNameLPAREN	
"ruby"	TokenNameStringLiteral	ruby
,	TokenNameCOMMA	
2005	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
makeJob	TokenNameIdentifier	 make Job
(	TokenNameLPAREN	
"java"	TokenNameStringLiteral	java
,	TokenNameCOMMA	
2006	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
makeResume	TokenNameIdentifier	 make Resume
(	TokenNameLPAREN	
"Frank"	TokenNameStringLiteral	Frank
,	TokenNameCOMMA	
"United States"	TokenNameStringLiteral	United States
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
addDocuments	TokenNameIdentifier	 add Documents
(	TokenNameLPAREN	
docs	TokenNameIdentifier	 docs
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IndexReader	TokenNameIdentifier	 Index Reader
r	TokenNameIdentifier	 r
=	TokenNameEQUAL	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
getReader	TokenNameIdentifier	 get Reader
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IndexSearcher	TokenNameIdentifier	 Index Searcher
s	TokenNameIdentifier	 s
=	TokenNameEQUAL	
newSearcher	TokenNameIdentifier	 new Searcher
(	TokenNameLPAREN	
r	TokenNameIdentifier	 r
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Create a filter that defines "parent" documents in 	TokenNameCOMMENT_LINE	Create a filter that defines "parent" documents in 
// the index - in this case resumes 	TokenNameCOMMENT_LINE	the index - in this case resumes 
final	TokenNamefinal	
Filter	TokenNameIdentifier	 Filter
parentsFilter	TokenNameIdentifier	 parents Filter
=	TokenNameEQUAL	
new	TokenNamenew	
CachingWrapperFilter	TokenNameIdentifier	 Caching Wrapper Filter
(	TokenNameLPAREN	
new	TokenNamenew	
RawTermFilter	TokenNameIdentifier	 Raw Term Filter
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"docType"	TokenNameStringLiteral	docType
,	TokenNameCOMMA	
"resume"	TokenNameStringLiteral	resume
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
CachingWrapperFilter	TokenNameIdentifier	 Caching Wrapper Filter
.	TokenNameDOT	
DeletesMode	TokenNameIdentifier	 Deletes Mode
.	TokenNameDOT	
IGNORE	TokenNameIdentifier	 IGNORE
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Define child document criteria (finds an example of relevant work experience) 	TokenNameCOMMENT_LINE	Define child document criteria (finds an example of relevant work experience) 
BooleanQuery	TokenNameIdentifier	 Boolean Query
childQuery	TokenNameIdentifier	 child Query
=	TokenNameEQUAL	
new	TokenNamenew	
BooleanQuery	TokenNameIdentifier	 Boolean Query
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
childQuery	TokenNameIdentifier	 child Query
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
BooleanClause	TokenNameIdentifier	 Boolean Clause
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"skill"	TokenNameStringLiteral	skill
,	TokenNameCOMMA	
"java"	TokenNameStringLiteral	java
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
childQuery	TokenNameIdentifier	 child Query
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
BooleanClause	TokenNameIdentifier	 Boolean Clause
(	TokenNameLPAREN	
NumericRangeQuery	TokenNameIdentifier	 Numeric Range Query
.	TokenNameDOT	
newIntRange	TokenNameIdentifier	 new Int Range
(	TokenNameLPAREN	
"year"	TokenNameStringLiteral	year
,	TokenNameCOMMA	
2006	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
2011	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Define parent document criteria (find a resident in the UK) 	TokenNameCOMMENT_LINE	Define parent document criteria (find a resident in the UK) 
Query	TokenNameIdentifier	 Query
parentQuery	TokenNameIdentifier	 parent Query
=	TokenNameEQUAL	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"country"	TokenNameStringLiteral	country
,	TokenNameCOMMA	
"United Kingdom"	TokenNameStringLiteral	United Kingdom
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Wrap the child document query to 'join' any matches 	TokenNameCOMMENT_LINE	Wrap the child document query to 'join' any matches 
// up to corresponding parent: 	TokenNameCOMMENT_LINE	up to corresponding parent: 
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
childJoinQuery	TokenNameIdentifier	 child Join Query
=	TokenNameEQUAL	
new	TokenNamenew	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
(	TokenNameLPAREN	
childQuery	TokenNameIdentifier	 child Query
,	TokenNameCOMMA	
parentsFilter	TokenNameIdentifier	 parents Filter
,	TokenNameCOMMA	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
.	TokenNameDOT	
ScoreMode	TokenNameIdentifier	 Score Mode
.	TokenNameDOT	
Avg	TokenNameIdentifier	 Avg
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Combine the parent and nested child queries into a single query for a candidate 	TokenNameCOMMENT_LINE	Combine the parent and nested child queries into a single query for a candidate 
BooleanQuery	TokenNameIdentifier	 Boolean Query
fullQuery	TokenNameIdentifier	 full Query
=	TokenNameEQUAL	
new	TokenNamenew	
BooleanQuery	TokenNameIdentifier	 Boolean Query
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
fullQuery	TokenNameIdentifier	 full Query
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
BooleanClause	TokenNameIdentifier	 Boolean Clause
(	TokenNameLPAREN	
parentQuery	TokenNameIdentifier	 parent Query
,	TokenNameCOMMA	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
fullQuery	TokenNameIdentifier	 full Query
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
BooleanClause	TokenNameIdentifier	 Boolean Clause
(	TokenNameLPAREN	
childJoinQuery	TokenNameIdentifier	 child Join Query
,	TokenNameCOMMA	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ToParentBlockJoinCollector	TokenNameIdentifier	 To Parent Block Join Collector
c	TokenNameIdentifier	 c
=	TokenNameEQUAL	
new	TokenNamenew	
ToParentBlockJoinCollector	TokenNameIdentifier	 To Parent Block Join Collector
(	TokenNameLPAREN	
Sort	TokenNameIdentifier	 Sort
.	TokenNameDOT	
RELEVANCE	TokenNameIdentifier	 RELEVANCE
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
fullQuery	TokenNameIdentifier	 full Query
,	TokenNameCOMMA	
c	TokenNameIdentifier	 c
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
>	TokenNameGREATER	
results	TokenNameIdentifier	 results
=	TokenNameEQUAL	
c	TokenNameIdentifier	 c
.	TokenNameDOT	
getTopGroups	TokenNameIdentifier	 get Top Groups
(	TokenNameLPAREN	
childJoinQuery	TokenNameIdentifier	 child Join Query
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
10	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//assertEquals(1, results.totalHitCount); 	TokenNameCOMMENT_LINE	assertEquals(1, results.totalHitCount); 
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
results	TokenNameIdentifier	 results
.	TokenNameDOT	
totalGroupedHitCount	TokenNameIdentifier	 total Grouped Hit Count
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
results	TokenNameIdentifier	 results
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
GroupDocs	TokenNameIdentifier	 Group Docs
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
>	TokenNameGREATER	
group	TokenNameIdentifier	 group
=	TokenNameEQUAL	
results	TokenNameIdentifier	 results
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Document	TokenNameIdentifier	 Document
childDoc	TokenNameIdentifier	 child Doc
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//System.out.println(" doc=" + group.scoreDocs[0].doc); 	TokenNameCOMMENT_LINE	System.out.println(" doc=" + group.scoreDocs[0].doc); 
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"java"	TokenNameStringLiteral	java
,	TokenNameCOMMA	
childDoc	TokenNameIdentifier	 child Doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"skill"	TokenNameStringLiteral	skill
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertNotNull	TokenNameIdentifier	 assert Not Null
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Document	TokenNameIdentifier	 Document
parentDoc	TokenNameIdentifier	 parent Doc
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"Lisa"	TokenNameStringLiteral	Lisa
,	TokenNameCOMMA	
parentDoc	TokenNameIdentifier	 parent Doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"name"	TokenNameStringLiteral	name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//System.out.println("TEST: now test up"); 	TokenNameCOMMENT_LINE	System.out.println("TEST: now test up"); 
// Now join "up" (map parent hits to child docs) instead...: 	TokenNameCOMMENT_LINE	Now join "up" (map parent hits to child docs) instead...: 
ToChildBlockJoinQuery	TokenNameIdentifier	 To Child Block Join Query
parentJoinQuery	TokenNameIdentifier	 parent Join Query
=	TokenNameEQUAL	
new	TokenNamenew	
ToChildBlockJoinQuery	TokenNameIdentifier	 To Child Block Join Query
(	TokenNameLPAREN	
parentQuery	TokenNameIdentifier	 parent Query
,	TokenNameCOMMA	
parentsFilter	TokenNameIdentifier	 parents Filter
,	TokenNameCOMMA	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
BooleanQuery	TokenNameIdentifier	 Boolean Query
fullChildQuery	TokenNameIdentifier	 full Child Query
=	TokenNameEQUAL	
new	TokenNamenew	
BooleanQuery	TokenNameIdentifier	 Boolean Query
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
fullChildQuery	TokenNameIdentifier	 full Child Query
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
BooleanClause	TokenNameIdentifier	 Boolean Clause
(	TokenNameLPAREN	
parentJoinQuery	TokenNameIdentifier	 parent Join Query
,	TokenNameCOMMA	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
fullChildQuery	TokenNameIdentifier	 full Child Query
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
BooleanClause	TokenNameIdentifier	 Boolean Clause
(	TokenNameLPAREN	
childQuery	TokenNameIdentifier	 child Query
,	TokenNameCOMMA	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//System.out.println("FULL: " + fullChildQuery); 	TokenNameCOMMENT_LINE	System.out.println("FULL: " + fullChildQuery); 
TopDocs	TokenNameIdentifier	 Top Docs
hits	TokenNameIdentifier	 hits
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
fullChildQuery	TokenNameIdentifier	 full Child Query
,	TokenNameCOMMA	
10	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
hits	TokenNameIdentifier	 hits
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
childDoc	TokenNameIdentifier	 child Doc
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
(	TokenNameLPAREN	
hits	TokenNameIdentifier	 hits
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//System.out.println("CHILD = " + childDoc + " docID=" + hits.scoreDocs[0].doc); 	TokenNameCOMMENT_LINE	System.out.println("CHILD = " + childDoc + " docID=" + hits.scoreDocs[0].doc); 
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"java"	TokenNameStringLiteral	java
,	TokenNameCOMMA	
childDoc	TokenNameIdentifier	 child Doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"skill"	TokenNameStringLiteral	skill
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
2007	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
NumericField	TokenNameIdentifier	 Numeric Field
)	TokenNameRPAREN	
childDoc	TokenNameIdentifier	 child Doc
.	TokenNameDOT	
getFieldable	TokenNameIdentifier	 get Fieldable
(	TokenNameLPAREN	
"year"	TokenNameStringLiteral	year
)	TokenNameRPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getNumericValue	TokenNameIdentifier	 get Numeric Value
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"Lisa"	TokenNameStringLiteral	Lisa
,	TokenNameCOMMA	
getParentDoc	TokenNameIdentifier	 get Parent Doc
(	TokenNameLPAREN	
r	TokenNameIdentifier	 r
,	TokenNameCOMMA	
parentsFilter	TokenNameIdentifier	 parents Filter
,	TokenNameCOMMA	
hits	TokenNameIdentifier	 hits
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"name"	TokenNameStringLiteral	name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Test with filter on child docs: 	TokenNameCOMMENT_LINE	Test with filter on child docs: 
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
fullChildQuery	TokenNameIdentifier	 full Child Query
,	TokenNameCOMMA	
new	TokenNamenew	
QueryWrapperFilter	TokenNameIdentifier	 Query Wrapper Filter
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"skill"	TokenNameStringLiteral	skill
,	TokenNameCOMMA	
"foosball"	TokenNameStringLiteral	foosball
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
r	TokenNameIdentifier	 r
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
dir	TokenNameIdentifier	 dir
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
protected	TokenNameprotected	
QueryWrapperFilter	TokenNameIdentifier	 Query Wrapper Filter
skill	TokenNameIdentifier	 skill
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
skill	TokenNameIdentifier	 skill
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
new	TokenNamenew	
QueryWrapperFilter	TokenNameIdentifier	 Query Wrapper Filter
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"skill"	TokenNameStringLiteral	skill
,	TokenNameCOMMA	
skill	TokenNameIdentifier	 skill
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
testSimpleFilter	TokenNameIdentifier	 test Simple Filter
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
final	TokenNamefinal	
Directory	TokenNameIdentifier	 Directory
dir	TokenNameIdentifier	 dir
=	TokenNameEQUAL	
newDirectory	TokenNameIdentifier	 new Directory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
w	TokenNameIdentifier	 w
=	TokenNameEQUAL	
new	TokenNamenew	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
dir	TokenNameIdentifier	 dir
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Document	TokenNameIdentifier	 Document
>	TokenNameGREATER	
docs	TokenNameIdentifier	 docs
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
Document	TokenNameIdentifier	 Document
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
makeJob	TokenNameIdentifier	 make Job
(	TokenNameLPAREN	
"java"	TokenNameStringLiteral	java
,	TokenNameCOMMA	
2007	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
makeJob	TokenNameIdentifier	 make Job
(	TokenNameLPAREN	
"python"	TokenNameStringLiteral	python
,	TokenNameCOMMA	
2010	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
shuffle	TokenNameIdentifier	 shuffle
(	TokenNameLPAREN	
docs	TokenNameIdentifier	 docs
,	TokenNameCOMMA	
random	TokenNameIdentifier	 random
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
makeResume	TokenNameIdentifier	 make Resume
(	TokenNameLPAREN	
"Lisa"	TokenNameStringLiteral	Lisa
,	TokenNameCOMMA	
"United Kingdom"	TokenNameStringLiteral	United Kingdom
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Document	TokenNameIdentifier	 Document
>	TokenNameGREATER	
docs2	TokenNameIdentifier	 docs2
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
Document	TokenNameIdentifier	 Document
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docs2	TokenNameIdentifier	 docs2
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
makeJob	TokenNameIdentifier	 make Job
(	TokenNameLPAREN	
"ruby"	TokenNameStringLiteral	ruby
,	TokenNameCOMMA	
2005	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docs2	TokenNameIdentifier	 docs2
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
makeJob	TokenNameIdentifier	 make Job
(	TokenNameLPAREN	
"java"	TokenNameStringLiteral	java
,	TokenNameCOMMA	
2006	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
shuffle	TokenNameIdentifier	 shuffle
(	TokenNameLPAREN	
docs2	TokenNameIdentifier	 docs2
,	TokenNameCOMMA	
random	TokenNameIdentifier	 random
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docs2	TokenNameIdentifier	 docs2
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
makeResume	TokenNameIdentifier	 make Resume
(	TokenNameLPAREN	
"Frank"	TokenNameStringLiteral	Frank
,	TokenNameCOMMA	
"United States"	TokenNameStringLiteral	United States
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addSkillless	TokenNameIdentifier	 add Skillless
(	TokenNameLPAREN	
w	TokenNameIdentifier	 w
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
boolean	TokenNameboolean	
turn	TokenNameIdentifier	 turn
=	TokenNameEQUAL	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
addDocuments	TokenNameIdentifier	 add Documents
(	TokenNameLPAREN	
turn	TokenNameIdentifier	 turn
?	TokenNameQUESTION	
docs	TokenNameIdentifier	 docs
:	TokenNameCOLON	
docs2	TokenNameIdentifier	 docs2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addSkillless	TokenNameIdentifier	 add Skillless
(	TokenNameLPAREN	
w	TokenNameIdentifier	 w
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
addDocuments	TokenNameIdentifier	 add Documents
(	TokenNameLPAREN	
!	TokenNameNOT	
turn	TokenNameIdentifier	 turn
?	TokenNameQUESTION	
docs	TokenNameIdentifier	 docs
:	TokenNameCOLON	
docs2	TokenNameIdentifier	 docs2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addSkillless	TokenNameIdentifier	 add Skillless
(	TokenNameLPAREN	
w	TokenNameIdentifier	 w
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IndexReader	TokenNameIdentifier	 Index Reader
r	TokenNameIdentifier	 r
=	TokenNameEQUAL	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
getReader	TokenNameIdentifier	 get Reader
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IndexSearcher	TokenNameIdentifier	 Index Searcher
s	TokenNameIdentifier	 s
=	TokenNameEQUAL	
newSearcher	TokenNameIdentifier	 new Searcher
(	TokenNameLPAREN	
r	TokenNameIdentifier	 r
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Create a filter that defines "parent" documents in the index - in this case resumes 	TokenNameCOMMENT_LINE	Create a filter that defines "parent" documents in the index - in this case resumes 
final	TokenNamefinal	
Filter	TokenNameIdentifier	 Filter
parentsFilter	TokenNameIdentifier	 parents Filter
=	TokenNameEQUAL	
new	TokenNamenew	
CachingWrapperFilter	TokenNameIdentifier	 Caching Wrapper Filter
(	TokenNameLPAREN	
new	TokenNamenew	
RawTermFilter	TokenNameIdentifier	 Raw Term Filter
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"docType"	TokenNameStringLiteral	docType
,	TokenNameCOMMA	
"resume"	TokenNameStringLiteral	resume
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
CachingWrapperFilter	TokenNameIdentifier	 Caching Wrapper Filter
.	TokenNameDOT	
DeletesMode	TokenNameIdentifier	 Deletes Mode
.	TokenNameDOT	
IGNORE	TokenNameIdentifier	 IGNORE
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Define child document criteria (finds an example of relevant work experience) 	TokenNameCOMMENT_LINE	Define child document criteria (finds an example of relevant work experience) 
BooleanQuery	TokenNameIdentifier	 Boolean Query
childQuery	TokenNameIdentifier	 child Query
=	TokenNameEQUAL	
new	TokenNamenew	
BooleanQuery	TokenNameIdentifier	 Boolean Query
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
childQuery	TokenNameIdentifier	 child Query
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
BooleanClause	TokenNameIdentifier	 Boolean Clause
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"skill"	TokenNameStringLiteral	skill
,	TokenNameCOMMA	
"java"	TokenNameStringLiteral	java
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
childQuery	TokenNameIdentifier	 child Query
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
BooleanClause	TokenNameIdentifier	 Boolean Clause
(	TokenNameLPAREN	
NumericRangeQuery	TokenNameIdentifier	 Numeric Range Query
.	TokenNameDOT	
newIntRange	TokenNameIdentifier	 new Int Range
(	TokenNameLPAREN	
"year"	TokenNameStringLiteral	year
,	TokenNameCOMMA	
2006	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
2011	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Define parent document criteria (find a resident in the UK) 	TokenNameCOMMENT_LINE	Define parent document criteria (find a resident in the UK) 
Query	TokenNameIdentifier	 Query
parentQuery	TokenNameIdentifier	 parent Query
=	TokenNameEQUAL	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"country"	TokenNameStringLiteral	country
,	TokenNameCOMMA	
"United Kingdom"	TokenNameStringLiteral	United Kingdom
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Wrap the child document query to 'join' any matches 	TokenNameCOMMENT_LINE	Wrap the child document query to 'join' any matches 
// up to corresponding parent: 	TokenNameCOMMENT_LINE	up to corresponding parent: 
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
childJoinQuery	TokenNameIdentifier	 child Join Query
=	TokenNameEQUAL	
new	TokenNamenew	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
(	TokenNameLPAREN	
childQuery	TokenNameIdentifier	 child Query
,	TokenNameCOMMA	
parentsFilter	TokenNameIdentifier	 parents Filter
,	TokenNameCOMMA	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
.	TokenNameDOT	
ScoreMode	TokenNameIdentifier	 Score Mode
.	TokenNameDOT	
Avg	TokenNameIdentifier	 Avg
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"no filter - both passed"	TokenNameStringLiteral	no filter - both passed
,	TokenNameCOMMA	
2	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
childJoinQuery	TokenNameIdentifier	 child Join Query
,	TokenNameCOMMA	
10	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"dummy filter passes everyone "	TokenNameStringLiteral	dummy filter passes everyone 
,	TokenNameCOMMA	
2	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
childJoinQuery	TokenNameIdentifier	 child Join Query
,	TokenNameCOMMA	
parentsFilter	TokenNameIdentifier	 parents Filter
,	TokenNameCOMMA	
10	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"dummy filter passes everyone "	TokenNameStringLiteral	dummy filter passes everyone 
,	TokenNameCOMMA	
2	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
childJoinQuery	TokenNameIdentifier	 child Join Query
,	TokenNameCOMMA	
new	TokenNamenew	
QueryWrapperFilter	TokenNameIdentifier	 Query Wrapper Filter
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"docType"	TokenNameStringLiteral	docType
,	TokenNameCOMMA	
"resume"	TokenNameStringLiteral	resume
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
10	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// not found test 	TokenNameCOMMENT_LINE	not found test 
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"noone live there"	TokenNameStringLiteral	noone live there
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
childJoinQuery	TokenNameIdentifier	 child Join Query
,	TokenNameCOMMA	
new	TokenNamenew	
CachingWrapperFilter	TokenNameIdentifier	 Caching Wrapper Filter
(	TokenNameLPAREN	
new	TokenNamenew	
QueryWrapperFilter	TokenNameIdentifier	 Query Wrapper Filter
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"country"	TokenNameStringLiteral	country
,	TokenNameCOMMA	
"Oz"	TokenNameStringLiteral	Oz
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"noone live there"	TokenNameStringLiteral	noone live there
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
childJoinQuery	TokenNameIdentifier	 child Join Query
,	TokenNameCOMMA	
new	TokenNamenew	
QueryWrapperFilter	TokenNameIdentifier	 Query Wrapper Filter
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"country"	TokenNameStringLiteral	country
,	TokenNameCOMMA	
"Oz"	TokenNameStringLiteral	Oz
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// apply the UK filter by the searcher 	TokenNameCOMMENT_LINE	apply the UK filter by the searcher 
TopDocs	TokenNameIdentifier	 Top Docs
ukOnly	TokenNameIdentifier	 uk Only
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
childJoinQuery	TokenNameIdentifier	 child Join Query
,	TokenNameCOMMA	
new	TokenNamenew	
QueryWrapperFilter	TokenNameIdentifier	 Query Wrapper Filter
(	TokenNameLPAREN	
parentQuery	TokenNameIdentifier	 parent Query
)	TokenNameRPAREN	
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"has filter - single passed"	TokenNameStringLiteral	has filter - single passed
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
ukOnly	TokenNameIdentifier	 uk Only
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"Lisa"	TokenNameStringLiteral	Lisa
,	TokenNameCOMMA	
r	TokenNameIdentifier	 r
.	TokenNameDOT	
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
ukOnly	TokenNameIdentifier	 uk Only
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"name"	TokenNameStringLiteral	name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// looking for US candidates 	TokenNameCOMMENT_LINE	looking for US candidates 
TopDocs	TokenNameIdentifier	 Top Docs
usThen	TokenNameIdentifier	 us Then
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
childJoinQuery	TokenNameIdentifier	 child Join Query
,	TokenNameCOMMA	
new	TokenNamenew	
QueryWrapperFilter	TokenNameIdentifier	 Query Wrapper Filter
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"country"	TokenNameStringLiteral	country
,	TokenNameCOMMA	
"United States"	TokenNameStringLiteral	United States
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"has filter - single passed"	TokenNameStringLiteral	has filter - single passed
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
usThen	TokenNameIdentifier	 us Then
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"Frank"	TokenNameStringLiteral	Frank
,	TokenNameCOMMA	
r	TokenNameIdentifier	 r
.	TokenNameDOT	
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
usThen	TokenNameIdentifier	 us Then
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"name"	TokenNameStringLiteral	name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
TermQuery	TokenNameIdentifier	 Term Query
us	TokenNameIdentifier	 us
=	TokenNameEQUAL	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"country"	TokenNameStringLiteral	country
,	TokenNameCOMMA	
"United States"	TokenNameStringLiteral	United States
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"@ US we have java and ruby"	TokenNameStringLiteral	@ US we have java and ruby
,	TokenNameCOMMA	
2	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
new	TokenNamenew	
ToChildBlockJoinQuery	TokenNameIdentifier	 To Child Block Join Query
(	TokenNameLPAREN	
us	TokenNameIdentifier	 us
,	TokenNameCOMMA	
parentsFilter	TokenNameIdentifier	 parents Filter
,	TokenNameCOMMA	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
10	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"java skills in US"	TokenNameStringLiteral	java skills in US
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
new	TokenNamenew	
ToChildBlockJoinQuery	TokenNameIdentifier	 To Child Block Join Query
(	TokenNameLPAREN	
us	TokenNameIdentifier	 us
,	TokenNameCOMMA	
parentsFilter	TokenNameIdentifier	 parents Filter
,	TokenNameCOMMA	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
skill	TokenNameIdentifier	 skill
(	TokenNameLPAREN	
"java"	TokenNameStringLiteral	java
)	TokenNameRPAREN	
,	TokenNameCOMMA	
10	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
BooleanQuery	TokenNameIdentifier	 Boolean Query
rubyPython	TokenNameIdentifier	 ruby Python
=	TokenNameEQUAL	
new	TokenNamenew	
BooleanQuery	TokenNameIdentifier	 Boolean Query
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
rubyPython	TokenNameIdentifier	 ruby Python
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"skill"	TokenNameStringLiteral	skill
,	TokenNameCOMMA	
"ruby"	TokenNameStringLiteral	ruby
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
SHOULD	TokenNameIdentifier	 SHOULD
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
rubyPython	TokenNameIdentifier	 ruby Python
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"skill"	TokenNameStringLiteral	skill
,	TokenNameCOMMA	
"python"	TokenNameStringLiteral	python
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
SHOULD	TokenNameIdentifier	 SHOULD
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"ruby skills in US"	TokenNameStringLiteral	ruby skills in US
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
new	TokenNamenew	
ToChildBlockJoinQuery	TokenNameIdentifier	 To Child Block Join Query
(	TokenNameLPAREN	
us	TokenNameIdentifier	 us
,	TokenNameCOMMA	
parentsFilter	TokenNameIdentifier	 parents Filter
,	TokenNameCOMMA	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
new	TokenNamenew	
QueryWrapperFilter	TokenNameIdentifier	 Query Wrapper Filter
(	TokenNameLPAREN	
rubyPython	TokenNameIdentifier	 ruby Python
)	TokenNameRPAREN	
,	TokenNameCOMMA	
10	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
r	TokenNameIdentifier	 r
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
dir	TokenNameIdentifier	 dir
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
addSkillless	TokenNameIdentifier	 add Skillless
(	TokenNameLPAREN	
final	TokenNamefinal	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
w	TokenNameIdentifier	 w
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
addDocument	TokenNameIdentifier	 add Document
(	TokenNameLPAREN	
makeResume	TokenNameIdentifier	 make Resume
(	TokenNameLPAREN	
"Skillless"	TokenNameStringLiteral	Skillless
,	TokenNameCOMMA	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
"United Kingdom"	TokenNameStringLiteral	United Kingdom
:	TokenNameCOLON	
"United States"	TokenNameStringLiteral	United States
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
Document	TokenNameIdentifier	 Document
getParentDoc	TokenNameIdentifier	 get Parent Doc
(	TokenNameLPAREN	
IndexReader	TokenNameIdentifier	 Index Reader
reader	TokenNameIdentifier	 reader
,	TokenNameCOMMA	
Filter	TokenNameIdentifier	 Filter
parents	TokenNameIdentifier	 parents
,	TokenNameCOMMA	
int	TokenNameint	
childDocID	TokenNameIdentifier	 child Doc ID
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
IndexReader	TokenNameIdentifier	 Index Reader
>	TokenNameGREATER	
subReadersList	TokenNameIdentifier	 sub Readers List
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
IndexReader	TokenNameIdentifier	 Index Reader
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ReaderUtil	TokenNameIdentifier	 Reader Util
.	TokenNameDOT	
gatherSubReaders	TokenNameIdentifier	 gather Sub Readers
(	TokenNameLPAREN	
subReadersList	TokenNameIdentifier	 sub Readers List
,	TokenNameCOMMA	
reader	TokenNameIdentifier	 reader
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IndexReader	TokenNameIdentifier	 Index Reader
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
subReaders	TokenNameIdentifier	 sub Readers
=	TokenNameEQUAL	
subReadersList	TokenNameIdentifier	 sub Readers List
.	TokenNameDOT	
toArray	TokenNameIdentifier	 to Array
(	TokenNameLPAREN	
new	TokenNamenew	
IndexReader	TokenNameIdentifier	 Index Reader
[	TokenNameLBRACKET	
subReadersList	TokenNameIdentifier	 sub Readers List
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
docStarts	TokenNameIdentifier	 doc Starts
=	TokenNameEQUAL	
new	TokenNamenew	
int	TokenNameint	
[	TokenNameLBRACKET	
subReaders	TokenNameIdentifier	 sub Readers
.	TokenNameDOT	
length	TokenNameIdentifier	 length
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
int	TokenNameint	
maxDoc	TokenNameIdentifier	 max Doc
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
subReaders	TokenNameIdentifier	 sub Readers
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
docStarts	TokenNameIdentifier	 doc Starts
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
maxDoc	TokenNameIdentifier	 max Doc
;	TokenNameSEMICOLON	
maxDoc	TokenNameIdentifier	 max Doc
+=	TokenNamePLUS_EQUAL	
subReaders	TokenNameIdentifier	 sub Readers
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
.	TokenNameDOT	
maxDoc	TokenNameIdentifier	 max Doc
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
final	TokenNamefinal	
int	TokenNameint	
subIndex	TokenNameIdentifier	 sub Index
=	TokenNameEQUAL	
ReaderUtil	TokenNameIdentifier	 Reader Util
.	TokenNameDOT	
subIndex	TokenNameIdentifier	 sub Index
(	TokenNameLPAREN	
childDocID	TokenNameIdentifier	 child Doc ID
,	TokenNameCOMMA	
docStarts	TokenNameIdentifier	 doc Starts
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
IndexReader	TokenNameIdentifier	 Index Reader
subReader	TokenNameIdentifier	 sub Reader
=	TokenNameEQUAL	
subReaders	TokenNameIdentifier	 sub Readers
[	TokenNameLBRACKET	
subIndex	TokenNameIdentifier	 sub Index
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
FixedBitSet	TokenNameIdentifier	 Fixed Bit Set
bits	TokenNameIdentifier	 bits
=	TokenNameEQUAL	
(	TokenNameLPAREN	
FixedBitSet	TokenNameIdentifier	 Fixed Bit Set
)	TokenNameRPAREN	
parents	TokenNameIdentifier	 parents
.	TokenNameDOT	
getDocIdSet	TokenNameIdentifier	 get Doc Id Set
(	TokenNameLPAREN	
subReader	TokenNameIdentifier	 sub Reader
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
subReader	TokenNameIdentifier	 sub Reader
.	TokenNameDOT	
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
bits	TokenNameIdentifier	 bits
.	TokenNameDOT	
nextSetBit	TokenNameIdentifier	 next Set Bit
(	TokenNameLPAREN	
childDocID	TokenNameIdentifier	 child Doc ID
-	TokenNameMINUS	
docStarts	TokenNameIdentifier	 doc Starts
[	TokenNameLBRACKET	
subIndex	TokenNameIdentifier	 sub Index
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
testBoostBug	TokenNameIdentifier	 test Boost Bug
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
final	TokenNamefinal	
Directory	TokenNameIdentifier	 Directory
dir	TokenNameIdentifier	 dir
=	TokenNameEQUAL	
newDirectory	TokenNameIdentifier	 new Directory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
w	TokenNameIdentifier	 w
=	TokenNameEQUAL	
new	TokenNamenew	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
dir	TokenNameIdentifier	 dir
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IndexReader	TokenNameIdentifier	 Index Reader
r	TokenNameIdentifier	 r
=	TokenNameEQUAL	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
getReader	TokenNameIdentifier	 get Reader
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IndexSearcher	TokenNameIdentifier	 Index Searcher
s	TokenNameIdentifier	 s
=	TokenNameEQUAL	
newSearcher	TokenNameIdentifier	 new Searcher
(	TokenNameLPAREN	
r	TokenNameIdentifier	 r
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
q	TokenNameIdentifier	 q
=	TokenNameEQUAL	
new	TokenNamenew	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
(	TokenNameLPAREN	
new	TokenNamenew	
MatchAllDocsQuery	TokenNameIdentifier	 Match All Docs Query
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
new	TokenNamenew	
QueryWrapperFilter	TokenNameIdentifier	 Query Wrapper Filter
(	TokenNameLPAREN	
new	TokenNamenew	
MatchAllDocsQuery	TokenNameIdentifier	 Match All Docs Query
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
.	TokenNameDOT	
ScoreMode	TokenNameIdentifier	 Score Mode
.	TokenNameDOT	
Avg	TokenNameIdentifier	 Avg
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
q	TokenNameIdentifier	 q
,	TokenNameCOMMA	
10	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
BooleanQuery	TokenNameIdentifier	 Boolean Query
bq	TokenNameIdentifier	 bq
=	TokenNameEQUAL	
new	TokenNamenew	
BooleanQuery	TokenNameIdentifier	 Boolean Query
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
bq	TokenNameIdentifier	 bq
.	TokenNameDOT	
setBoost	TokenNameIdentifier	 set Boost
(	TokenNameLPAREN	
2f	TokenNameFloatingPointLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// we boost the BQ 	TokenNameCOMMENT_LINE	we boost the BQ 
bq	TokenNameIdentifier	 bq
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
q	TokenNameIdentifier	 q
,	TokenNameCOMMA	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
bq	TokenNameIdentifier	 bq
,	TokenNameCOMMA	
10	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
r	TokenNameIdentifier	 r
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
dir	TokenNameIdentifier	 dir
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
getRandomFields	TokenNameIdentifier	 get Random Fields
(	TokenNameLPAREN	
int	TokenNameint	
maxUniqueValues	TokenNameIdentifier	 max Unique Values
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
fields	TokenNameIdentifier	 fields
=	TokenNameEQUAL	
new	TokenNamenew	
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
2	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
4	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
fieldID	TokenNameIdentifier	 field ID
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
fieldID	TokenNameIdentifier	 field ID
<	TokenNameLESS	
fields	TokenNameIdentifier	 fields
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
fieldID	TokenNameIdentifier	 field ID
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
int	TokenNameint	
valueCount	TokenNameIdentifier	 value Count
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
fieldID	TokenNameIdentifier	 field ID
==	TokenNameEQUAL_EQUAL	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
valueCount	TokenNameIdentifier	 value Count
=	TokenNameEQUAL	
2	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
valueCount	TokenNameIdentifier	 value Count
=	TokenNameEQUAL	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
maxUniqueValues	TokenNameIdentifier	 max Unique Values
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
values	TokenNameIdentifier	 values
=	TokenNameEQUAL	
fields	TokenNameIdentifier	 fields
[	TokenNameLBRACKET	
fieldID	TokenNameIdentifier	 field ID
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
new	TokenNamenew	
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
valueCount	TokenNameIdentifier	 value Count
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
valueCount	TokenNameIdentifier	 value Count
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
values	TokenNameIdentifier	 values
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
randomRealisticUnicodeString	TokenNameIdentifier	 random Realistic Unicode String
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//values[i] = _TestUtil.randomSimpleString(random); 	TokenNameCOMMENT_LINE	values[i] = _TestUtil.randomSimpleString(random); 
}	TokenNameRBRACE	
}	TokenNameRBRACE	
return	TokenNamereturn	
fields	TokenNameIdentifier	 fields
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
Term	TokenNameIdentifier	 Term
randomParentTerm	TokenNameIdentifier	 random Parent Term
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
values	TokenNameIdentifier	 values
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"parent0"	TokenNameStringLiteral	parent0
,	TokenNameCOMMA	
values	TokenNameIdentifier	 values
[	TokenNameLBRACKET	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
values	TokenNameIdentifier	 values
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
Term	TokenNameIdentifier	 Term
randomChildTerm	TokenNameIdentifier	 random Child Term
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
values	TokenNameIdentifier	 values
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"child0"	TokenNameStringLiteral	child0
,	TokenNameCOMMA	
values	TokenNameIdentifier	 values
[	TokenNameLBRACKET	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
values	TokenNameIdentifier	 values
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
Sort	TokenNameIdentifier	 Sort
getRandomSort	TokenNameIdentifier	 get Random Sort
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
prefix	TokenNameIdentifier	 prefix
,	TokenNameCOMMA	
int	TokenNameint	
numFields	TokenNameIdentifier	 num Fields
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
SortField	TokenNameIdentifier	 Sort Field
>	TokenNameGREATER	
sortFields	TokenNameIdentifier	 sort Fields
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
SortField	TokenNameIdentifier	 Sort Field
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// TODO: sometimes sort by score; problem is scores are 	TokenNameCOMMENT_LINE	TODO: sometimes sort by score; problem is scores are 
// not comparable across the two indices 	TokenNameCOMMENT_LINE	not comparable across the two indices 
// sortFields.add(SortField.FIELD_SCORE); 	TokenNameCOMMENT_LINE	sortFields.add(SortField.FIELD_SCORE); 
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
sortFields	TokenNameIdentifier	 sort Fields
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
SortField	TokenNameIdentifier	 Sort Field
(	TokenNameLPAREN	
prefix	TokenNameIdentifier	 prefix
+	TokenNamePLUS	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
numFields	TokenNameIdentifier	 num Fields
)	TokenNameRPAREN	
,	TokenNameCOMMA	
SortField	TokenNameIdentifier	 Sort Field
.	TokenNameDOT	
STRING	TokenNameIdentifier	 STRING
,	TokenNameCOMMA	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
sortFields	TokenNameIdentifier	 sort Fields
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
SortField	TokenNameIdentifier	 Sort Field
(	TokenNameLPAREN	
prefix	TokenNameIdentifier	 prefix
+	TokenNamePLUS	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
numFields	TokenNameIdentifier	 num Fields
)	TokenNameRPAREN	
,	TokenNameCOMMA	
SortField	TokenNameIdentifier	 Sort Field
.	TokenNameDOT	
STRING	TokenNameIdentifier	 STRING
,	TokenNameCOMMA	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sortFields	TokenNameIdentifier	 sort Fields
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
SortField	TokenNameIdentifier	 Sort Field
(	TokenNameLPAREN	
prefix	TokenNameIdentifier	 prefix
+	TokenNamePLUS	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
numFields	TokenNameIdentifier	 num Fields
)	TokenNameRPAREN	
,	TokenNameCOMMA	
SortField	TokenNameIdentifier	 Sort Field
.	TokenNameDOT	
STRING	TokenNameIdentifier	 STRING
,	TokenNameCOMMA	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Break ties: 	TokenNameCOMMENT_LINE	Break ties: 
sortFields	TokenNameIdentifier	 sort Fields
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
SortField	TokenNameIdentifier	 Sort Field
(	TokenNameLPAREN	
prefix	TokenNameIdentifier	 prefix
+	TokenNamePLUS	
"ID"	TokenNameStringLiteral	ID
,	TokenNameCOMMA	
SortField	TokenNameIdentifier	 Sort Field
.	TokenNameDOT	
INT	TokenNameIdentifier	 INT
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
new	TokenNamenew	
Sort	TokenNameIdentifier	 Sort
(	TokenNameLPAREN	
sortFields	TokenNameIdentifier	 sort Fields
.	TokenNameDOT	
toArray	TokenNameIdentifier	 to Array
(	TokenNameLPAREN	
new	TokenNamenew	
SortField	TokenNameIdentifier	 Sort Field
[	TokenNameLBRACKET	
sortFields	TokenNameIdentifier	 sort Fields
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
testRandom	TokenNameIdentifier	 test Random
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
// We build two indices at once: one normalized (which 	TokenNameCOMMENT_LINE	We build two indices at once: one normalized (which 
// ToParentBlockJoinQuery/Collector, 	TokenNameCOMMENT_LINE	ToParentBlockJoinQuery/Collector, 
// ToChildBlockJoinQuery can query) and the other w/ 	TokenNameCOMMENT_LINE	ToChildBlockJoinQuery can query) and the other w/ 
// the same docs, just fully denormalized: 	TokenNameCOMMENT_LINE	the same docs, just fully denormalized: 
final	TokenNamefinal	
Directory	TokenNameIdentifier	 Directory
dir	TokenNameIdentifier	 dir
=	TokenNameEQUAL	
newDirectory	TokenNameIdentifier	 new Directory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Directory	TokenNameIdentifier	 Directory
joinDir	TokenNameIdentifier	 join Dir
=	TokenNameEQUAL	
newDirectory	TokenNameIdentifier	 new Directory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
int	TokenNameint	
numParentDocs	TokenNameIdentifier	 num Parent Docs
=	TokenNameEQUAL	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
100	TokenNameIntegerLiteral	
*	TokenNameMULTIPLY	
RANDOM_MULTIPLIER	TokenNameIdentifier	 RANDOM  MULTIPLIER
,	TokenNameCOMMA	
300	TokenNameIntegerLiteral	
*	TokenNameMULTIPLY	
RANDOM_MULTIPLIER	TokenNameIdentifier	 RANDOM  MULTIPLIER
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//final int numParentDocs = 30; 	TokenNameCOMMENT_LINE	final int numParentDocs = 30; 
// Values for parent fields: 	TokenNameCOMMENT_LINE	Values for parent fields: 
final	TokenNamefinal	
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
parentFields	TokenNameIdentifier	 parent Fields
=	TokenNameEQUAL	
getRandomFields	TokenNameIdentifier	 get Random Fields
(	TokenNameLPAREN	
numParentDocs	TokenNameIdentifier	 num Parent Docs
/	TokenNameDIVIDE	
2	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Values for child fields: 	TokenNameCOMMENT_LINE	Values for child fields: 
final	TokenNamefinal	
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
childFields	TokenNameIdentifier	 child Fields
=	TokenNameEQUAL	
getRandomFields	TokenNameIdentifier	 get Random Fields
(	TokenNameLPAREN	
numParentDocs	TokenNameIdentifier	 num Parent Docs
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
boolean	TokenNameboolean	
doDeletes	TokenNameIdentifier	 do Deletes
=	TokenNameEQUAL	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
>	TokenNameGREATER	
toDelete	TokenNameIdentifier	 to Delete
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// TODO: parallel star join, nested join cases too! 	TokenNameCOMMENT_LINE	TODO: parallel star join, nested join cases too! 
final	TokenNamefinal	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
w	TokenNameIdentifier	 w
=	TokenNameEQUAL	
new	TokenNamenew	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
dir	TokenNameIdentifier	 dir
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
joinW	TokenNameIdentifier	 join W
=	TokenNameEQUAL	
new	TokenNamenew	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
joinDir	TokenNameIdentifier	 join Dir
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
parentDocID	TokenNameIdentifier	 parent Doc ID
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
parentDocID	TokenNameIdentifier	 parent Doc ID
<	TokenNameLESS	
numParentDocs	TokenNameIdentifier	 num Parent Docs
;	TokenNameSEMICOLON	
parentDocID	TokenNameIdentifier	 parent Doc ID
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Document	TokenNameIdentifier	 Document
parentDoc	TokenNameIdentifier	 parent Doc
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Document	TokenNameIdentifier	 Document
parentJoinDoc	TokenNameIdentifier	 parent Join Doc
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Field	TokenNameIdentifier	 Field
id	TokenNameIdentifier	 id
=	TokenNameEQUAL	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"parentID"	TokenNameStringLiteral	parentID
,	TokenNameCOMMA	
""	TokenNameStringLiteral	 
+	TokenNamePLUS	
parentDocID	TokenNameIdentifier	 parent Doc ID
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
parentDoc	TokenNameIdentifier	 parent Doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
id	TokenNameIdentifier	 id
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
parentJoinDoc	TokenNameIdentifier	 parent Join Doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
id	TokenNameIdentifier	 id
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
parentJoinDoc	TokenNameIdentifier	 parent Join Doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"isParent"	TokenNameStringLiteral	isParent
,	TokenNameCOMMA	
"x"	TokenNameStringLiteral	x
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
field	TokenNameIdentifier	 field
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
field	TokenNameIdentifier	 field
<	TokenNameLESS	
parentFields	TokenNameIdentifier	 parent Fields
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
field	TokenNameIdentifier	 field
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextDouble	TokenNameIdentifier	 next Double
(	TokenNameLPAREN	
)	TokenNameRPAREN	
<	TokenNameLESS	
0.9	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Field	TokenNameIdentifier	 Field
f	TokenNameIdentifier	 f
=	TokenNameEQUAL	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"parent"	TokenNameStringLiteral	parent
+	TokenNamePLUS	
field	TokenNameIdentifier	 field
,	TokenNameCOMMA	
parentFields	TokenNameIdentifier	 parent Fields
[	TokenNameLBRACKET	
field	TokenNameIdentifier	 field
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
parentFields	TokenNameIdentifier	 parent Fields
[	TokenNameLBRACKET	
field	TokenNameIdentifier	 field
]	TokenNameRBRACKET	
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
parentDoc	TokenNameIdentifier	 parent Doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
f	TokenNameIdentifier	 f
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
parentJoinDoc	TokenNameIdentifier	 parent Join Doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
f	TokenNameIdentifier	 f
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
doDeletes	TokenNameIdentifier	 do Deletes
)	TokenNameRPAREN	
{	TokenNameLBRACE	
parentDoc	TokenNameIdentifier	 parent Doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"blockID"	TokenNameStringLiteral	blockID
,	TokenNameCOMMA	
""	TokenNameStringLiteral	 
+	TokenNamePLUS	
parentDocID	TokenNameIdentifier	 parent Doc ID
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
parentJoinDoc	TokenNameIdentifier	 parent Join Doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"blockID"	TokenNameStringLiteral	blockID
,	TokenNameCOMMA	
""	TokenNameStringLiteral	 
+	TokenNamePLUS	
parentDocID	TokenNameIdentifier	 parent Doc ID
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
final	TokenNamefinal	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Document	TokenNameIdentifier	 Document
>	TokenNameGREATER	
joinDocs	TokenNameIdentifier	 join Docs
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
Document	TokenNameIdentifier	 Document
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
StringBuilder	TokenNameIdentifier	 String Builder
sb	TokenNameIdentifier	 sb
=	TokenNameEQUAL	
new	TokenNamenew	
StringBuilder	TokenNameIdentifier	 String Builder
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
"parentID="	TokenNameStringLiteral	parentID=
+	TokenNamePLUS	
parentDoc	TokenNameIdentifier	 parent Doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"parentID"	TokenNameStringLiteral	parentID
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
fieldID	TokenNameIdentifier	 field ID
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
fieldID	TokenNameIdentifier	 field ID
<	TokenNameLESS	
parentFields	TokenNameIdentifier	 parent Fields
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
fieldID	TokenNameIdentifier	 field ID
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
s	TokenNameIdentifier	 s
=	TokenNameEQUAL	
parentDoc	TokenNameIdentifier	 parent Doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"parent"	TokenNameStringLiteral	parent
+	TokenNamePLUS	
fieldID	TokenNameIdentifier	 field ID
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
s	TokenNameIdentifier	 s
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
" parent"	TokenNameStringLiteral	 parent
+	TokenNamePLUS	
fieldID	TokenNameIdentifier	 field ID
+	TokenNamePLUS	
"="	TokenNameStringLiteral	=
+	TokenNamePLUS	
s	TokenNameIdentifier	 s
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" "	TokenNameStringLiteral	 
+	TokenNamePLUS	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
final	TokenNamefinal	
int	TokenNameint	
numChildDocs	TokenNameIdentifier	 num Child Docs
=	TokenNameEQUAL	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
20	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
childDocID	TokenNameIdentifier	 child Doc ID
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
childDocID	TokenNameIdentifier	 child Doc ID
<	TokenNameLESS	
numChildDocs	TokenNameIdentifier	 num Child Docs
;	TokenNameSEMICOLON	
childDocID	TokenNameIdentifier	 child Doc ID
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// Denormalize: copy all parent fields into child doc: 	TokenNameCOMMENT_LINE	Denormalize: copy all parent fields into child doc: 
Document	TokenNameIdentifier	 Document
childDoc	TokenNameIdentifier	 child Doc
=	TokenNameEQUAL	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
cloneDocument	TokenNameIdentifier	 clone Document
(	TokenNameLPAREN	
parentDoc	TokenNameIdentifier	 parent Doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Document	TokenNameIdentifier	 Document
joinChildDoc	TokenNameIdentifier	 join Child Doc
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
joinDocs	TokenNameIdentifier	 join Docs
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
joinChildDoc	TokenNameIdentifier	 join Child Doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Field	TokenNameIdentifier	 Field
childID	TokenNameIdentifier	 child ID
=	TokenNameEQUAL	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"childID"	TokenNameStringLiteral	childID
,	TokenNameCOMMA	
""	TokenNameStringLiteral	 
+	TokenNamePLUS	
childDocID	TokenNameIdentifier	 child Doc ID
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
childDoc	TokenNameIdentifier	 child Doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
childID	TokenNameIdentifier	 child ID
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
joinChildDoc	TokenNameIdentifier	 join Child Doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
childID	TokenNameIdentifier	 child ID
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
childFieldID	TokenNameIdentifier	 child Field ID
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
childFieldID	TokenNameIdentifier	 child Field ID
<	TokenNameLESS	
childFields	TokenNameIdentifier	 child Fields
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
childFieldID	TokenNameIdentifier	 child Field ID
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextDouble	TokenNameIdentifier	 next Double
(	TokenNameLPAREN	
)	TokenNameRPAREN	
<	TokenNameLESS	
0.9	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Field	TokenNameIdentifier	 Field
f	TokenNameIdentifier	 f
=	TokenNameEQUAL	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"child"	TokenNameStringLiteral	child
+	TokenNamePLUS	
childFieldID	TokenNameIdentifier	 child Field ID
,	TokenNameCOMMA	
childFields	TokenNameIdentifier	 child Fields
[	TokenNameLBRACKET	
childFieldID	TokenNameIdentifier	 child Field ID
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
childFields	TokenNameIdentifier	 child Fields
[	TokenNameLBRACKET	
childFieldID	TokenNameIdentifier	 child Field ID
]	TokenNameRBRACKET	
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
childDoc	TokenNameIdentifier	 child Doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
f	TokenNameIdentifier	 f
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
joinChildDoc	TokenNameIdentifier	 join Child Doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
f	TokenNameIdentifier	 f
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
StringBuilder	TokenNameIdentifier	 String Builder
sb	TokenNameIdentifier	 sb
=	TokenNameEQUAL	
new	TokenNamenew	
StringBuilder	TokenNameIdentifier	 String Builder
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
"childID="	TokenNameStringLiteral	childID=
+	TokenNamePLUS	
joinChildDoc	TokenNameIdentifier	 join Child Doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"childID"	TokenNameStringLiteral	childID
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
fieldID	TokenNameIdentifier	 field ID
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
fieldID	TokenNameIdentifier	 field ID
<	TokenNameLESS	
childFields	TokenNameIdentifier	 child Fields
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
fieldID	TokenNameIdentifier	 field ID
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
s	TokenNameIdentifier	 s
=	TokenNameEQUAL	
joinChildDoc	TokenNameIdentifier	 join Child Doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"child"	TokenNameStringLiteral	child
+	TokenNamePLUS	
fieldID	TokenNameIdentifier	 field ID
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
s	TokenNameIdentifier	 s
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
" child"	TokenNameStringLiteral	 child
+	TokenNamePLUS	
fieldID	TokenNameIdentifier	 field ID
+	TokenNamePLUS	
"="	TokenNameStringLiteral	=
+	TokenNamePLUS	
s	TokenNameIdentifier	 s
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" "	TokenNameStringLiteral	 
+	TokenNamePLUS	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
doDeletes	TokenNameIdentifier	 do Deletes
)	TokenNameRPAREN	
{	TokenNameLBRACE	
joinChildDoc	TokenNameIdentifier	 join Child Doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"blockID"	TokenNameStringLiteral	blockID
,	TokenNameCOMMA	
""	TokenNameStringLiteral	 
+	TokenNamePLUS	
parentDocID	TokenNameIdentifier	 parent Doc ID
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
YES	TokenNameIdentifier	 YES
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
addDocument	TokenNameIdentifier	 add Document
(	TokenNameLPAREN	
childDoc	TokenNameIdentifier	 child Doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Parent last: 	TokenNameCOMMENT_LINE	Parent last: 
joinDocs	TokenNameIdentifier	 join Docs
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
parentJoinDoc	TokenNameIdentifier	 parent Join Doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
joinW	TokenNameIdentifier	 join W
.	TokenNameDOT	
addDocuments	TokenNameIdentifier	 add Documents
(	TokenNameLPAREN	
joinDocs	TokenNameIdentifier	 join Docs
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
doDeletes	TokenNameIdentifier	 do Deletes
&&	TokenNameAND_AND	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
30	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
7	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
toDelete	TokenNameIdentifier	 to Delete
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
parentDocID	TokenNameIdentifier	 parent Doc ID
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
deleteID	TokenNameIdentifier	 delete ID
:	TokenNameCOLON	
toDelete	TokenNameIdentifier	 to Delete
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"DELETE parentID="	TokenNameStringLiteral	DELETE parentID=
+	TokenNamePLUS	
deleteID	TokenNameIdentifier	 delete ID
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
deleteDocuments	TokenNameIdentifier	 delete Documents
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"blockID"	TokenNameStringLiteral	blockID
,	TokenNameCOMMA	
""	TokenNameStringLiteral	 
+	TokenNamePLUS	
deleteID	TokenNameIdentifier	 delete ID
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
joinW	TokenNameIdentifier	 join W
.	TokenNameDOT	
deleteDocuments	TokenNameIdentifier	 delete Documents
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"blockID"	TokenNameStringLiteral	blockID
,	TokenNameCOMMA	
""	TokenNameStringLiteral	 
+	TokenNamePLUS	
deleteID	TokenNameIdentifier	 delete ID
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
final	TokenNamefinal	
IndexReader	TokenNameIdentifier	 Index Reader
r	TokenNameIdentifier	 r
=	TokenNameEQUAL	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
getReader	TokenNameIdentifier	 get Reader
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
IndexReader	TokenNameIdentifier	 Index Reader
joinR	TokenNameIdentifier	 join R
=	TokenNameEQUAL	
joinW	TokenNameIdentifier	 join W
.	TokenNameDOT	
getReader	TokenNameIdentifier	 get Reader
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
joinW	TokenNameIdentifier	 join W
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: reader="	TokenNameStringLiteral	TEST: reader=
+	TokenNamePLUS	
r	TokenNameIdentifier	 r
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: joinReader="	TokenNameStringLiteral	TEST: joinReader=
+	TokenNamePLUS	
joinR	TokenNameIdentifier	 join R
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
docIDX	TokenNameIdentifier	 doc IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
docIDX	TokenNameIdentifier	 doc IDX
<	TokenNameLESS	
joinR	TokenNameIdentifier	 join R
.	TokenNameDOT	
maxDoc	TokenNameIdentifier	 max Doc
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docIDX	TokenNameIdentifier	 doc IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" docID="	TokenNameStringLiteral	 docID=
+	TokenNamePLUS	
docIDX	TokenNameIdentifier	 doc IDX
+	TokenNamePLUS	
" doc="	TokenNameStringLiteral	 doc=
+	TokenNamePLUS	
joinR	TokenNameIdentifier	 join R
.	TokenNameDOT	
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
docIDX	TokenNameIdentifier	 doc IDX
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
final	TokenNamefinal	
IndexSearcher	TokenNameIdentifier	 Index Searcher
s	TokenNameIdentifier	 s
=	TokenNameEQUAL	
newSearcher	TokenNameIdentifier	 new Searcher
(	TokenNameLPAREN	
r	TokenNameIdentifier	 r
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
setDefaultFieldSortScoring	TokenNameIdentifier	 set Default Field Sort Scoring
(	TokenNameLPAREN	
true	TokenNametrue	
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
IndexSearcher	TokenNameIdentifier	 Index Searcher
joinS	TokenNameIdentifier	 join S
=	TokenNameEQUAL	
newSearcher	TokenNameIdentifier	 new Searcher
(	TokenNameLPAREN	
joinR	TokenNameIdentifier	 join R
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Filter	TokenNameIdentifier	 Filter
parentsFilter	TokenNameIdentifier	 parents Filter
=	TokenNameEQUAL	
new	TokenNamenew	
CachingWrapperFilter	TokenNameIdentifier	 Caching Wrapper Filter
(	TokenNameLPAREN	
new	TokenNamenew	
RawTermFilter	TokenNameIdentifier	 Raw Term Filter
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"isParent"	TokenNameStringLiteral	isParent
,	TokenNameCOMMA	
"x"	TokenNameStringLiteral	x
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
CachingWrapperFilter	TokenNameIdentifier	 Caching Wrapper Filter
.	TokenNameDOT	
DeletesMode	TokenNameIdentifier	 Deletes Mode
.	TokenNameDOT	
IGNORE	TokenNameIdentifier	 IGNORE
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
int	TokenNameint	
iters	TokenNameIdentifier	 iters
=	TokenNameEQUAL	
200	TokenNameIntegerLiteral	
*	TokenNameMULTIPLY	
RANDOM_MULTIPLIER	TokenNameIdentifier	 RANDOM  MULTIPLIER
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
iter	TokenNameIdentifier	 iter
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
iter	TokenNameIdentifier	 iter
<	TokenNameLESS	
iters	TokenNameIdentifier	 iters
;	TokenNameSEMICOLON	
iter	TokenNameIdentifier	 iter
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: iter="	TokenNameStringLiteral	TEST: iter=
+	TokenNamePLUS	
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
+	TokenNamePLUS	
iter	TokenNameIdentifier	 iter
)	TokenNameRPAREN	
+	TokenNamePLUS	
" of "	TokenNameStringLiteral	 of 
+	TokenNamePLUS	
iters	TokenNameIdentifier	 iters
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
final	TokenNamefinal	
Query	TokenNameIdentifier	 Query
childQuery	TokenNameIdentifier	 child Query
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
3	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
2	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
int	TokenNameint	
childFieldID	TokenNameIdentifier	 child Field ID
=	TokenNameEQUAL	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
childFields	TokenNameIdentifier	 child Fields
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
childQuery	TokenNameIdentifier	 child Query
=	TokenNameEQUAL	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"child"	TokenNameStringLiteral	child
+	TokenNamePLUS	
childFieldID	TokenNameIdentifier	 child Field ID
,	TokenNameCOMMA	
childFields	TokenNameIdentifier	 child Fields
[	TokenNameLBRACKET	
childFieldID	TokenNameIdentifier	 child Field ID
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
childFields	TokenNameIdentifier	 child Fields
[	TokenNameLBRACKET	
childFieldID	TokenNameIdentifier	 child Field ID
]	TokenNameRBRACKET	
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
3	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
2	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
BooleanQuery	TokenNameIdentifier	 Boolean Query
bq	TokenNameIdentifier	 bq
=	TokenNameEQUAL	
new	TokenNamenew	
BooleanQuery	TokenNameIdentifier	 Boolean Query
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
childQuery	TokenNameIdentifier	 child Query
=	TokenNameEQUAL	
bq	TokenNameIdentifier	 bq
;	TokenNameSEMICOLON	
final	TokenNamefinal	
int	TokenNameint	
numClauses	TokenNameIdentifier	 num Clauses
=	TokenNameEQUAL	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
2	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
4	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
boolean	TokenNameboolean	
didMust	TokenNameIdentifier	 did Must
=	TokenNameEQUAL	
false	TokenNamefalse	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
clauseIDX	TokenNameIdentifier	 clause IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
clauseIDX	TokenNameIdentifier	 clause IDX
<	TokenNameLESS	
numClauses	TokenNameIdentifier	 num Clauses
;	TokenNameSEMICOLON	
clauseIDX	TokenNameIdentifier	 clause IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Query	TokenNameIdentifier	 Query
clause	TokenNameIdentifier	 clause
;	TokenNameSEMICOLON	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
occur	TokenNameIdentifier	 occur
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
didMust	TokenNameIdentifier	 did Must
&&	TokenNameAND_AND	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
occur	TokenNameIdentifier	 occur
=	TokenNameEQUAL	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
:	TokenNameCOLON	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST_NOT	TokenNameIdentifier	 MUST  NOT
;	TokenNameSEMICOLON	
clause	TokenNameIdentifier	 clause
=	TokenNameEQUAL	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
randomChildTerm	TokenNameIdentifier	 random Child Term
(	TokenNameLPAREN	
childFields	TokenNameIdentifier	 child Fields
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
didMust	TokenNameIdentifier	 did Must
=	TokenNameEQUAL	
true	TokenNametrue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
occur	TokenNameIdentifier	 occur
=	TokenNameEQUAL	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
SHOULD	TokenNameIdentifier	 SHOULD
;	TokenNameSEMICOLON	
final	TokenNamefinal	
int	TokenNameint	
childFieldID	TokenNameIdentifier	 child Field ID
=	TokenNameEQUAL	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
childFields	TokenNameIdentifier	 child Fields
.	TokenNameDOT	
length	TokenNameIdentifier	 length
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
clause	TokenNameIdentifier	 clause
=	TokenNameEQUAL	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"child"	TokenNameStringLiteral	child
+	TokenNamePLUS	
childFieldID	TokenNameIdentifier	 child Field ID
,	TokenNameCOMMA	
childFields	TokenNameIdentifier	 child Fields
[	TokenNameLBRACKET	
childFieldID	TokenNameIdentifier	 child Field ID
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
childFields	TokenNameIdentifier	 child Fields
[	TokenNameLBRACKET	
childFieldID	TokenNameIdentifier	 child Field ID
]	TokenNameRBRACKET	
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
bq	TokenNameIdentifier	 bq
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
clause	TokenNameIdentifier	 clause
,	TokenNameCOMMA	
occur	TokenNameIdentifier	 occur
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
BooleanQuery	TokenNameIdentifier	 Boolean Query
bq	TokenNameIdentifier	 bq
=	TokenNameEQUAL	
new	TokenNamenew	
BooleanQuery	TokenNameIdentifier	 Boolean Query
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
childQuery	TokenNameIdentifier	 child Query
=	TokenNameEQUAL	
bq	TokenNameIdentifier	 bq
;	TokenNameSEMICOLON	
bq	TokenNameIdentifier	 bq
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
randomChildTerm	TokenNameIdentifier	 random Child Term
(	TokenNameLPAREN	
childFields	TokenNameIdentifier	 child Fields
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
int	TokenNameint	
childFieldID	TokenNameIdentifier	 child Field ID
=	TokenNameEQUAL	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
childFields	TokenNameIdentifier	 child Fields
.	TokenNameDOT	
length	TokenNameIdentifier	 length
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
bq	TokenNameIdentifier	 bq
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"child"	TokenNameStringLiteral	child
+	TokenNamePLUS	
childFieldID	TokenNameIdentifier	 child Field ID
,	TokenNameCOMMA	
childFields	TokenNameIdentifier	 child Fields
[	TokenNameLBRACKET	
childFieldID	TokenNameIdentifier	 child Field ID
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
childFields	TokenNameIdentifier	 child Fields
[	TokenNameLBRACKET	
childFieldID	TokenNameIdentifier	 child Field ID
]	TokenNameRBRACKET	
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
:	TokenNameCOLON	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST_NOT	TokenNameIdentifier	 MUST  NOT
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
final	TokenNamefinal	
int	TokenNameint	
x	TokenNameIdentifier	 x
=	TokenNameEQUAL	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
4	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
.	TokenNameDOT	
ScoreMode	TokenNameIdentifier	 Score Mode
agg	TokenNameIdentifier	 agg
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
x	TokenNameIdentifier	 x
==	TokenNameEQUAL_EQUAL	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
agg	TokenNameIdentifier	 agg
=	TokenNameEQUAL	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
.	TokenNameDOT	
ScoreMode	TokenNameIdentifier	 Score Mode
.	TokenNameDOT	
None	TokenNameIdentifier	 None
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
x	TokenNameIdentifier	 x
==	TokenNameEQUAL_EQUAL	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
agg	TokenNameIdentifier	 agg
=	TokenNameEQUAL	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
.	TokenNameDOT	
ScoreMode	TokenNameIdentifier	 Score Mode
.	TokenNameDOT	
Max	TokenNameIdentifier	 Max
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
x	TokenNameIdentifier	 x
==	TokenNameEQUAL_EQUAL	
2	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
agg	TokenNameIdentifier	 agg
=	TokenNameEQUAL	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
.	TokenNameDOT	
ScoreMode	TokenNameIdentifier	 Score Mode
.	TokenNameDOT	
Total	TokenNameIdentifier	 Total
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
agg	TokenNameIdentifier	 agg
=	TokenNameEQUAL	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
.	TokenNameDOT	
ScoreMode	TokenNameIdentifier	 Score Mode
.	TokenNameDOT	
Avg	TokenNameIdentifier	 Avg
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
final	TokenNamefinal	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
childJoinQuery	TokenNameIdentifier	 child Join Query
=	TokenNameEQUAL	
new	TokenNamenew	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
(	TokenNameLPAREN	
childQuery	TokenNameIdentifier	 child Query
,	TokenNameCOMMA	
parentsFilter	TokenNameIdentifier	 parents Filter
,	TokenNameCOMMA	
agg	TokenNameIdentifier	 agg
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// To run against the block-join index: 	TokenNameCOMMENT_LINE	To run against the block-join index: 
final	TokenNamefinal	
Query	TokenNameIdentifier	 Query
parentJoinQuery	TokenNameIdentifier	 parent Join Query
;	TokenNameSEMICOLON	
// Same query as parentJoinQuery, but to run against 	TokenNameCOMMENT_LINE	Same query as parentJoinQuery, but to run against 
// the fully denormalized index (so we can compare 	TokenNameCOMMENT_LINE	the fully denormalized index (so we can compare 
// results): 	TokenNameCOMMENT_LINE	results): 
final	TokenNamefinal	
Query	TokenNameIdentifier	 Query
parentQuery	TokenNameIdentifier	 parent Query
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
parentQuery	TokenNameIdentifier	 parent Query
=	TokenNameEQUAL	
childQuery	TokenNameIdentifier	 child Query
;	TokenNameSEMICOLON	
parentJoinQuery	TokenNameIdentifier	 parent Join Query
=	TokenNameEQUAL	
childJoinQuery	TokenNameIdentifier	 child Join Query
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
// AND parent field w/ child field 	TokenNameCOMMENT_LINE	AND parent field w/ child field 
final	TokenNamefinal	
BooleanQuery	TokenNameIdentifier	 Boolean Query
bq	TokenNameIdentifier	 bq
=	TokenNameEQUAL	
new	TokenNamenew	
BooleanQuery	TokenNameIdentifier	 Boolean Query
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
parentJoinQuery	TokenNameIdentifier	 parent Join Query
=	TokenNameEQUAL	
bq	TokenNameIdentifier	 bq
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Term	TokenNameIdentifier	 Term
parentTerm	TokenNameIdentifier	 parent Term
=	TokenNameEQUAL	
randomParentTerm	TokenNameIdentifier	 random Parent Term
(	TokenNameLPAREN	
parentFields	TokenNameIdentifier	 parent Fields
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
bq	TokenNameIdentifier	 bq
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
childJoinQuery	TokenNameIdentifier	 child Join Query
,	TokenNameCOMMA	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
bq	TokenNameIdentifier	 bq
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
parentTerm	TokenNameIdentifier	 parent Term
)	TokenNameRPAREN	
,	TokenNameCOMMA	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
bq	TokenNameIdentifier	 bq
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
parentTerm	TokenNameIdentifier	 parent Term
)	TokenNameRPAREN	
,	TokenNameCOMMA	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
bq	TokenNameIdentifier	 bq
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
childJoinQuery	TokenNameIdentifier	 child Join Query
,	TokenNameCOMMA	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
final	TokenNamefinal	
BooleanQuery	TokenNameIdentifier	 Boolean Query
bq2	TokenNameIdentifier	 bq2
=	TokenNameEQUAL	
new	TokenNamenew	
BooleanQuery	TokenNameIdentifier	 Boolean Query
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
parentQuery	TokenNameIdentifier	 parent Query
=	TokenNameEQUAL	
bq2	TokenNameIdentifier	 bq2
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
bq2	TokenNameIdentifier	 bq2
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
childQuery	TokenNameIdentifier	 child Query
,	TokenNameCOMMA	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
bq2	TokenNameIdentifier	 bq2
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
parentTerm	TokenNameIdentifier	 parent Term
)	TokenNameRPAREN	
,	TokenNameCOMMA	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
bq2	TokenNameIdentifier	 bq2
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
parentTerm	TokenNameIdentifier	 parent Term
)	TokenNameRPAREN	
,	TokenNameCOMMA	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
bq2	TokenNameIdentifier	 bq2
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
childQuery	TokenNameIdentifier	 child Query
,	TokenNameCOMMA	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
final	TokenNamefinal	
Sort	TokenNameIdentifier	 Sort
parentSort	TokenNameIdentifier	 parent Sort
=	TokenNameEQUAL	
getRandomSort	TokenNameIdentifier	 get Random Sort
(	TokenNameLPAREN	
"parent"	TokenNameStringLiteral	parent
,	TokenNameCOMMA	
parentFields	TokenNameIdentifier	 parent Fields
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Sort	TokenNameIdentifier	 Sort
childSort	TokenNameIdentifier	 child Sort
=	TokenNameEQUAL	
getRandomSort	TokenNameIdentifier	 get Random Sort
(	TokenNameLPAREN	
"child"	TokenNameStringLiteral	child
,	TokenNameCOMMA	
childFields	TokenNameIdentifier	 child Fields
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" TEST: query="	TokenNameStringLiteral	 TEST: query=
+	TokenNamePLUS	
parentQuery	TokenNameIdentifier	 parent Query
+	TokenNamePLUS	
" joinQuery="	TokenNameStringLiteral	 joinQuery=
+	TokenNamePLUS	
parentJoinQuery	TokenNameIdentifier	 parent Join Query
+	TokenNamePLUS	
" parentSort="	TokenNameStringLiteral	 parentSort=
+	TokenNamePLUS	
parentSort	TokenNameIdentifier	 parent Sort
+	TokenNamePLUS	
" childSort="	TokenNameStringLiteral	 childSort=
+	TokenNamePLUS	
childSort	TokenNameIdentifier	 child Sort
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Merge both sorts: 	TokenNameCOMMENT_LINE	Merge both sorts: 
final	TokenNamefinal	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
SortField	TokenNameIdentifier	 Sort Field
>	TokenNameGREATER	
sortFields	TokenNameIdentifier	 sort Fields
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
SortField	TokenNameIdentifier	 Sort Field
>	TokenNameGREATER	
(	TokenNameLPAREN	
Arrays	TokenNameIdentifier	 Arrays
.	TokenNameDOT	
asList	TokenNameIdentifier	 as List
(	TokenNameLPAREN	
parentSort	TokenNameIdentifier	 parent Sort
.	TokenNameDOT	
getSort	TokenNameIdentifier	 get Sort
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sortFields	TokenNameIdentifier	 sort Fields
.	TokenNameDOT	
addAll	TokenNameIdentifier	 add All
(	TokenNameLPAREN	
Arrays	TokenNameIdentifier	 Arrays
.	TokenNameDOT	
asList	TokenNameIdentifier	 as List
(	TokenNameLPAREN	
childSort	TokenNameIdentifier	 child Sort
.	TokenNameDOT	
getSort	TokenNameIdentifier	 get Sort
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Sort	TokenNameIdentifier	 Sort
parentAndChildSort	TokenNameIdentifier	 parent And Child Sort
=	TokenNameEQUAL	
new	TokenNamenew	
Sort	TokenNameIdentifier	 Sort
(	TokenNameLPAREN	
sortFields	TokenNameIdentifier	 sort Fields
.	TokenNameDOT	
toArray	TokenNameIdentifier	 to Array
(	TokenNameLPAREN	
new	TokenNamenew	
SortField	TokenNameIdentifier	 Sort Field
[	TokenNameLBRACKET	
sortFields	TokenNameIdentifier	 sort Fields
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
TopDocs	TokenNameIdentifier	 Top Docs
results	TokenNameIdentifier	 results
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
parentQuery	TokenNameIdentifier	 parent Query
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
r	TokenNameIdentifier	 r
.	TokenNameDOT	
numDocs	TokenNameIdentifier	 num Docs
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
parentAndChildSort	TokenNameIdentifier	 parent And Child Sort
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" TEST: normal index gets "	TokenNameStringLiteral	 TEST: normal index gets 
+	TokenNamePLUS	
results	TokenNameIdentifier	 results
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
+	TokenNamePLUS	
" hits"	TokenNameStringLiteral	 hits
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
ScoreDoc	TokenNameIdentifier	 Score Doc
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
hits	TokenNameIdentifier	 hits
=	TokenNameEQUAL	
results	TokenNameIdentifier	 results
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
hitIDX	TokenNameIdentifier	 hit IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
hitIDX	TokenNameIdentifier	 hit IDX
<	TokenNameLESS	
hits	TokenNameIdentifier	 hits
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
hitIDX	TokenNameIdentifier	 hit IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
Document	TokenNameIdentifier	 Document
doc	TokenNameIdentifier	 doc
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
(	TokenNameLPAREN	
hits	TokenNameIdentifier	 hits
[	TokenNameLBRACKET	
hitIDX	TokenNameIdentifier	 hit IDX
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//System.out.println(" score=" + hits[hitIDX].score + " parentID=" + doc.get("parentID") + " childID=" + doc.get("childID") + " (docID=" + hits[hitIDX].doc + ")"); 	TokenNameCOMMENT_LINE	System.out.println(" score=" + hits[hitIDX].score + " parentID=" + doc.get("parentID") + " childID=" + doc.get("childID") + " (docID=" + hits[hitIDX].doc + ")"); 
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" parentID="	TokenNameStringLiteral	 parentID=
+	TokenNamePLUS	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"parentID"	TokenNameStringLiteral	parentID
)	TokenNameRPAREN	
+	TokenNamePLUS	
" childID="	TokenNameStringLiteral	 childID=
+	TokenNamePLUS	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"childID"	TokenNameStringLiteral	childID
)	TokenNameRPAREN	
+	TokenNamePLUS	
" (docID="	TokenNameStringLiteral	 (docID=
+	TokenNamePLUS	
hits	TokenNameIdentifier	 hits
[	TokenNameLBRACKET	
hitIDX	TokenNameIdentifier	 hit IDX
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
+	TokenNamePLUS	
")"	TokenNameStringLiteral	)
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
FieldDoc	TokenNameIdentifier	 Field Doc
fd	TokenNameIdentifier	 fd
=	TokenNameEQUAL	
(	TokenNameLPAREN	
FieldDoc	TokenNameIdentifier	 Field Doc
)	TokenNameRPAREN	
hits	TokenNameIdentifier	 hits
[	TokenNameLBRACKET	
hitIDX	TokenNameIdentifier	 hit IDX
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
fd	TokenNameIdentifier	 fd
.	TokenNameDOT	
fields	TokenNameIdentifier	 fields
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
print	TokenNameIdentifier	 print
(	TokenNameLPAREN	
" "	TokenNameStringLiteral	 
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
Object	TokenNameIdentifier	 Object
o	TokenNameIdentifier	 o
:	TokenNameCOLON	
fd	TokenNameIdentifier	 fd
.	TokenNameDOT	
fields	TokenNameIdentifier	 fields
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
o	TokenNameIdentifier	 o
instanceof	TokenNameinstanceof	
BytesRef	TokenNameIdentifier	 Bytes Ref
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
print	TokenNameIdentifier	 print
(	TokenNameLPAREN	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
BytesRef	TokenNameIdentifier	 Bytes Ref
)	TokenNameRPAREN	
o	TokenNameIdentifier	 o
)	TokenNameRPAREN	
.	TokenNameDOT	
utf8ToString	TokenNameIdentifier	 utf8 To String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
" "	TokenNameStringLiteral	 
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
print	TokenNameIdentifier	 print
(	TokenNameLPAREN	
o	TokenNameIdentifier	 o
+	TokenNamePLUS	
" "	TokenNameStringLiteral	 
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
final	TokenNamefinal	
boolean	TokenNameboolean	
trackScores	TokenNameIdentifier	 track Scores
;	TokenNameSEMICOLON	
final	TokenNamefinal	
boolean	TokenNameboolean	
trackMaxScore	TokenNameIdentifier	 track Max Score
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
agg	TokenNameIdentifier	 agg
==	TokenNameEQUAL_EQUAL	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
.	TokenNameDOT	
ScoreMode	TokenNameIdentifier	 Score Mode
.	TokenNameDOT	
None	TokenNameIdentifier	 None
)	TokenNameRPAREN	
{	TokenNameLBRACE	
trackScores	TokenNameIdentifier	 track Scores
=	TokenNameEQUAL	
false	TokenNamefalse	
;	TokenNameSEMICOLON	
trackMaxScore	TokenNameIdentifier	 track Max Score
=	TokenNameEQUAL	
false	TokenNamefalse	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
trackScores	TokenNameIdentifier	 track Scores
=	TokenNameEQUAL	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
trackMaxScore	TokenNameIdentifier	 track Max Score
=	TokenNameEQUAL	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
final	TokenNamefinal	
ToParentBlockJoinCollector	TokenNameIdentifier	 To Parent Block Join Collector
c	TokenNameIdentifier	 c
=	TokenNameEQUAL	
new	TokenNamenew	
ToParentBlockJoinCollector	TokenNameIdentifier	 To Parent Block Join Collector
(	TokenNameLPAREN	
parentSort	TokenNameIdentifier	 parent Sort
,	TokenNameCOMMA	
10	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
trackScores	TokenNameIdentifier	 track Scores
,	TokenNameCOMMA	
trackMaxScore	TokenNameIdentifier	 track Max Score
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
joinS	TokenNameIdentifier	 join S
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
parentJoinQuery	TokenNameIdentifier	 parent Join Query
,	TokenNameCOMMA	
c	TokenNameIdentifier	 c
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
int	TokenNameint	
hitsPerGroup	TokenNameIdentifier	 hits Per Group
=	TokenNameEQUAL	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
20	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//final int hitsPerGroup = 100; 	TokenNameCOMMENT_LINE	final int hitsPerGroup = 100; 
final	TokenNamefinal	
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
>	TokenNameGREATER	
joinResults	TokenNameIdentifier	 join Results
=	TokenNameEQUAL	
c	TokenNameIdentifier	 c
.	TokenNameDOT	
getTopGroups	TokenNameIdentifier	 get Top Groups
(	TokenNameLPAREN	
childJoinQuery	TokenNameIdentifier	 child Join Query
,	TokenNameCOMMA	
childSort	TokenNameIdentifier	 child Sort
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
hitsPerGroup	TokenNameIdentifier	 hits Per Group
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" TEST: block join index gets "	TokenNameStringLiteral	 TEST: block join index gets 
+	TokenNamePLUS	
(	TokenNameLPAREN	
joinResults	TokenNameIdentifier	 join Results
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
?	TokenNameQUESTION	
0	TokenNameIntegerLiteral	
:	TokenNameCOLON	
joinResults	TokenNameIdentifier	 join Results
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
+	TokenNamePLUS	
" groups; hitsPerGroup="	TokenNameStringLiteral	 groups; hitsPerGroup=
+	TokenNamePLUS	
hitsPerGroup	TokenNameIdentifier	 hits Per Group
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
joinResults	TokenNameIdentifier	 join Results
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
GroupDocs	TokenNameIdentifier	 Group Docs
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
>	TokenNameGREATER	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
groups	TokenNameIdentifier	 groups
=	TokenNameEQUAL	
joinResults	TokenNameIdentifier	 join Results
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
groupIDX	TokenNameIdentifier	 group IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
groupIDX	TokenNameIdentifier	 group IDX
<	TokenNameLESS	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
groupIDX	TokenNameIdentifier	 group IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
GroupDocs	TokenNameIdentifier	 Group Docs
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
>	TokenNameGREATER	
group	TokenNameIdentifier	 group
=	TokenNameEQUAL	
groups	TokenNameIdentifier	 groups
[	TokenNameLBRACKET	
groupIDX	TokenNameIdentifier	 group IDX
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
groupSortValues	TokenNameIdentifier	 group Sort Values
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
print	TokenNameIdentifier	 print
(	TokenNameLPAREN	
" "	TokenNameStringLiteral	 
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
Object	TokenNameIdentifier	 Object
o	TokenNameIdentifier	 o
:	TokenNameCOLON	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
groupSortValues	TokenNameIdentifier	 group Sort Values
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
o	TokenNameIdentifier	 o
instanceof	TokenNameinstanceof	
BytesRef	TokenNameIdentifier	 Bytes Ref
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
print	TokenNameIdentifier	 print
(	TokenNameLPAREN	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
BytesRef	TokenNameIdentifier	 Bytes Ref
)	TokenNameRPAREN	
o	TokenNameIdentifier	 o
)	TokenNameRPAREN	
.	TokenNameDOT	
utf8ToString	TokenNameIdentifier	 utf8 To String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
" "	TokenNameStringLiteral	 
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
print	TokenNameIdentifier	 print
(	TokenNameLPAREN	
o	TokenNameIdentifier	 o
+	TokenNamePLUS	
" "	TokenNameStringLiteral	 
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
assertNotNull	TokenNameIdentifier	 assert Not Null
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Document	TokenNameIdentifier	 Document
parentDoc	TokenNameIdentifier	 parent Doc
=	TokenNameEQUAL	
joinS	TokenNameIdentifier	 join S
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" group parentID="	TokenNameStringLiteral	 group parentID=
+	TokenNamePLUS	
parentDoc	TokenNameIdentifier	 parent Doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"parentID"	TokenNameStringLiteral	parentID
)	TokenNameRPAREN	
+	TokenNamePLUS	
" (docID="	TokenNameStringLiteral	 (docID=
+	TokenNamePLUS	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
+	TokenNamePLUS	
")"	TokenNameStringLiteral	)
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
hitIDX	TokenNameIdentifier	 hit IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
hitIDX	TokenNameIdentifier	 hit IDX
<	TokenNameLESS	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
hitIDX	TokenNameIdentifier	 hit IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
Document	TokenNameIdentifier	 Document
doc	TokenNameIdentifier	 doc
=	TokenNameEQUAL	
joinS	TokenNameIdentifier	 join S
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
hitIDX	TokenNameIdentifier	 hit IDX
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//System.out.println(" score=" + group.scoreDocs[hitIDX].score + " childID=" + doc.get("childID") + " (docID=" + group.scoreDocs[hitIDX].doc + ")"); 	TokenNameCOMMENT_LINE	System.out.println(" score=" + group.scoreDocs[hitIDX].score + " childID=" + doc.get("childID") + " (docID=" + group.scoreDocs[hitIDX].doc + ")"); 
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" childID="	TokenNameStringLiteral	 childID=
+	TokenNamePLUS	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"childID"	TokenNameStringLiteral	childID
)	TokenNameRPAREN	
+	TokenNamePLUS	
" child0="	TokenNameStringLiteral	 child0=
+	TokenNamePLUS	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"child0"	TokenNameStringLiteral	child0
)	TokenNameRPAREN	
+	TokenNamePLUS	
" (docID="	TokenNameStringLiteral	 (docID=
+	TokenNamePLUS	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
hitIDX	TokenNameIdentifier	 hit IDX
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
+	TokenNamePLUS	
")"	TokenNameStringLiteral	)
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
results	TokenNameIdentifier	 results
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
==	TokenNameEQUAL_EQUAL	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assertNull	TokenNameIdentifier	 assert Null
(	TokenNameLPAREN	
joinResults	TokenNameIdentifier	 join Results
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
compareHits	TokenNameIdentifier	 compare Hits
(	TokenNameLPAREN	
r	TokenNameIdentifier	 r
,	TokenNameCOMMA	
joinR	TokenNameIdentifier	 join R
,	TokenNameCOMMA	
results	TokenNameIdentifier	 results
,	TokenNameCOMMA	
joinResults	TokenNameIdentifier	 join Results
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Test joining in the opposite direction (parent to 	TokenNameCOMMENT_LINE	Test joining in the opposite direction (parent to 
// child): 	TokenNameCOMMENT_LINE	child): 
// Get random query against parent documents: 	TokenNameCOMMENT_LINE	Get random query against parent documents: 
final	TokenNamefinal	
Query	TokenNameIdentifier	 Query
parentQuery2	TokenNameIdentifier	 parent Query2
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
3	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
2	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
int	TokenNameint	
fieldID	TokenNameIdentifier	 field ID
=	TokenNameEQUAL	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
parentFields	TokenNameIdentifier	 parent Fields
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
parentQuery2	TokenNameIdentifier	 parent Query2
=	TokenNameEQUAL	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"parent"	TokenNameStringLiteral	parent
+	TokenNamePLUS	
fieldID	TokenNameIdentifier	 field ID
,	TokenNameCOMMA	
parentFields	TokenNameIdentifier	 parent Fields
[	TokenNameLBRACKET	
fieldID	TokenNameIdentifier	 field ID
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
parentFields	TokenNameIdentifier	 parent Fields
[	TokenNameLBRACKET	
fieldID	TokenNameIdentifier	 field ID
]	TokenNameRBRACKET	
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
3	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
2	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
BooleanQuery	TokenNameIdentifier	 Boolean Query
bq	TokenNameIdentifier	 bq
=	TokenNameEQUAL	
new	TokenNamenew	
BooleanQuery	TokenNameIdentifier	 Boolean Query
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
parentQuery2	TokenNameIdentifier	 parent Query2
=	TokenNameEQUAL	
bq	TokenNameIdentifier	 bq
;	TokenNameSEMICOLON	
final	TokenNamefinal	
int	TokenNameint	
numClauses	TokenNameIdentifier	 num Clauses
=	TokenNameEQUAL	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
2	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
4	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
boolean	TokenNameboolean	
didMust	TokenNameIdentifier	 did Must
=	TokenNameEQUAL	
false	TokenNamefalse	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
clauseIDX	TokenNameIdentifier	 clause IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
clauseIDX	TokenNameIdentifier	 clause IDX
<	TokenNameLESS	
numClauses	TokenNameIdentifier	 num Clauses
;	TokenNameSEMICOLON	
clauseIDX	TokenNameIdentifier	 clause IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Query	TokenNameIdentifier	 Query
clause	TokenNameIdentifier	 clause
;	TokenNameSEMICOLON	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
occur	TokenNameIdentifier	 occur
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
didMust	TokenNameIdentifier	 did Must
&&	TokenNameAND_AND	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
occur	TokenNameIdentifier	 occur
=	TokenNameEQUAL	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
:	TokenNameCOLON	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST_NOT	TokenNameIdentifier	 MUST  NOT
;	TokenNameSEMICOLON	
clause	TokenNameIdentifier	 clause
=	TokenNameEQUAL	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
randomParentTerm	TokenNameIdentifier	 random Parent Term
(	TokenNameLPAREN	
parentFields	TokenNameIdentifier	 parent Fields
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
didMust	TokenNameIdentifier	 did Must
=	TokenNameEQUAL	
true	TokenNametrue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
occur	TokenNameIdentifier	 occur
=	TokenNameEQUAL	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
SHOULD	TokenNameIdentifier	 SHOULD
;	TokenNameSEMICOLON	
final	TokenNamefinal	
int	TokenNameint	
fieldID	TokenNameIdentifier	 field ID
=	TokenNameEQUAL	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
parentFields	TokenNameIdentifier	 parent Fields
.	TokenNameDOT	
length	TokenNameIdentifier	 length
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
clause	TokenNameIdentifier	 clause
=	TokenNameEQUAL	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"parent"	TokenNameStringLiteral	parent
+	TokenNamePLUS	
fieldID	TokenNameIdentifier	 field ID
,	TokenNameCOMMA	
parentFields	TokenNameIdentifier	 parent Fields
[	TokenNameLBRACKET	
fieldID	TokenNameIdentifier	 field ID
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
parentFields	TokenNameIdentifier	 parent Fields
[	TokenNameLBRACKET	
fieldID	TokenNameIdentifier	 field ID
]	TokenNameRBRACKET	
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
bq	TokenNameIdentifier	 bq
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
clause	TokenNameIdentifier	 clause
,	TokenNameCOMMA	
occur	TokenNameIdentifier	 occur
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
BooleanQuery	TokenNameIdentifier	 Boolean Query
bq	TokenNameIdentifier	 bq
=	TokenNameEQUAL	
new	TokenNamenew	
BooleanQuery	TokenNameIdentifier	 Boolean Query
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
parentQuery2	TokenNameIdentifier	 parent Query2
=	TokenNameEQUAL	
bq	TokenNameIdentifier	 bq
;	TokenNameSEMICOLON	
bq	TokenNameIdentifier	 bq
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
randomParentTerm	TokenNameIdentifier	 random Parent Term
(	TokenNameLPAREN	
parentFields	TokenNameIdentifier	 parent Fields
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
int	TokenNameint	
fieldID	TokenNameIdentifier	 field ID
=	TokenNameEQUAL	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
parentFields	TokenNameIdentifier	 parent Fields
.	TokenNameDOT	
length	TokenNameIdentifier	 length
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
bq	TokenNameIdentifier	 bq
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"parent"	TokenNameStringLiteral	parent
+	TokenNamePLUS	
fieldID	TokenNameIdentifier	 field ID
,	TokenNameCOMMA	
parentFields	TokenNameIdentifier	 parent Fields
[	TokenNameLBRACKET	
fieldID	TokenNameIdentifier	 field ID
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
parentFields	TokenNameIdentifier	 parent Fields
[	TokenNameLBRACKET	
fieldID	TokenNameIdentifier	 field ID
]	TokenNameRBRACKET	
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
:	TokenNameCOLON	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST_NOT	TokenNameIdentifier	 MUST  NOT
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" TEST: top down: parentQuery2="	TokenNameStringLiteral	 TEST: top down: parentQuery2=
+	TokenNamePLUS	
parentQuery2	TokenNameIdentifier	 parent Query2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Maps parent query to child docs: 	TokenNameCOMMENT_LINE	Maps parent query to child docs: 
final	TokenNamefinal	
ToChildBlockJoinQuery	TokenNameIdentifier	 To Child Block Join Query
parentJoinQuery2	TokenNameIdentifier	 parent Join Query2
=	TokenNameEQUAL	
new	TokenNamenew	
ToChildBlockJoinQuery	TokenNameIdentifier	 To Child Block Join Query
(	TokenNameLPAREN	
parentQuery2	TokenNameIdentifier	 parent Query2
,	TokenNameCOMMA	
parentsFilter	TokenNameIdentifier	 parents Filter
,	TokenNameCOMMA	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// To run against the block-join index: 	TokenNameCOMMENT_LINE	To run against the block-join index: 
final	TokenNamefinal	
Query	TokenNameIdentifier	 Query
childJoinQuery2	TokenNameIdentifier	 child Join Query2
;	TokenNameSEMICOLON	
// Same query as parentJoinQuery, but to run against 	TokenNameCOMMENT_LINE	Same query as parentJoinQuery, but to run against 
// the fully denormalized index (so we can compare 	TokenNameCOMMENT_LINE	the fully denormalized index (so we can compare 
// results): 	TokenNameCOMMENT_LINE	results): 
final	TokenNamefinal	
Query	TokenNameIdentifier	 Query
childQuery2	TokenNameIdentifier	 child Query2
;	TokenNameSEMICOLON	
// apply a filter to children 	TokenNameCOMMENT_LINE	apply a filter to children 
final	TokenNamefinal	
Filter	TokenNameIdentifier	 Filter
childFilter2	TokenNameIdentifier	 child Filter2
,	TokenNameCOMMA	
childJoinFilter2	TokenNameIdentifier	 child Join Filter2
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
childQuery2	TokenNameIdentifier	 child Query2
=	TokenNameEQUAL	
parentQuery2	TokenNameIdentifier	 parent Query2
;	TokenNameSEMICOLON	
childJoinQuery2	TokenNameIdentifier	 child Join Query2
=	TokenNameEQUAL	
parentJoinQuery2	TokenNameIdentifier	 parent Join Query2
;	TokenNameSEMICOLON	
childFilter2	TokenNameIdentifier	 child Filter2
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
childJoinFilter2	TokenNameIdentifier	 child Join Filter2
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
final	TokenNamefinal	
Term	TokenNameIdentifier	 Term
childTerm	TokenNameIdentifier	 child Term
=	TokenNameEQUAL	
randomChildTerm	TokenNameIdentifier	 random Child Term
(	TokenNameLPAREN	
childFields	TokenNameIdentifier	 child Fields
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// filtered case 	TokenNameCOMMENT_LINE	filtered case 
childJoinQuery2	TokenNameIdentifier	 child Join Query2
=	TokenNameEQUAL	
parentJoinQuery2	TokenNameIdentifier	 parent Join Query2
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Filter	TokenNameIdentifier	 Filter
f	TokenNameIdentifier	 f
=	TokenNameEQUAL	
new	TokenNamenew	
QueryWrapperFilter	TokenNameIdentifier	 Query Wrapper Filter
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
childTerm	TokenNameIdentifier	 child Term
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
childJoinFilter2	TokenNameIdentifier	 child Join Filter2
=	TokenNameEQUAL	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
new	TokenNamenew	
CachingWrapperFilter	TokenNameIdentifier	 Caching Wrapper Filter
(	TokenNameLPAREN	
f	TokenNameIdentifier	 f
)	TokenNameRPAREN	
:	TokenNameCOLON	
f	TokenNameIdentifier	 f
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
childJoinFilter2	TokenNameIdentifier	 child Join Filter2
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
// AND child field w/ parent query: 	TokenNameCOMMENT_LINE	AND child field w/ parent query: 
final	TokenNamefinal	
BooleanQuery	TokenNameIdentifier	 Boolean Query
bq	TokenNameIdentifier	 bq
=	TokenNameEQUAL	
new	TokenNamenew	
BooleanQuery	TokenNameIdentifier	 Boolean Query
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
childJoinQuery2	TokenNameIdentifier	 child Join Query2
=	TokenNameEQUAL	
bq	TokenNameIdentifier	 bq
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
bq	TokenNameIdentifier	 bq
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
parentJoinQuery2	TokenNameIdentifier	 parent Join Query2
,	TokenNameCOMMA	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
bq	TokenNameIdentifier	 bq
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
childTerm	TokenNameIdentifier	 child Term
)	TokenNameRPAREN	
,	TokenNameCOMMA	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
bq	TokenNameIdentifier	 bq
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
childTerm	TokenNameIdentifier	 child Term
)	TokenNameRPAREN	
,	TokenNameCOMMA	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
bq	TokenNameIdentifier	 bq
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
parentJoinQuery2	TokenNameIdentifier	 parent Join Query2
,	TokenNameCOMMA	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// filtered case 	TokenNameCOMMENT_LINE	filtered case 
childQuery2	TokenNameIdentifier	 child Query2
=	TokenNameEQUAL	
parentQuery2	TokenNameIdentifier	 parent Query2
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Filter	TokenNameIdentifier	 Filter
f	TokenNameIdentifier	 f
=	TokenNameEQUAL	
new	TokenNamenew	
QueryWrapperFilter	TokenNameIdentifier	 Query Wrapper Filter
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
childTerm	TokenNameIdentifier	 child Term
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
childFilter2	TokenNameIdentifier	 child Filter2
=	TokenNameEQUAL	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
new	TokenNamenew	
CachingWrapperFilter	TokenNameIdentifier	 Caching Wrapper Filter
(	TokenNameLPAREN	
f	TokenNameIdentifier	 f
)	TokenNameRPAREN	
:	TokenNameCOLON	
f	TokenNameIdentifier	 f
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
childFilter2	TokenNameIdentifier	 child Filter2
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
BooleanQuery	TokenNameIdentifier	 Boolean Query
bq2	TokenNameIdentifier	 bq2
=	TokenNameEQUAL	
new	TokenNamenew	
BooleanQuery	TokenNameIdentifier	 Boolean Query
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
childQuery2	TokenNameIdentifier	 child Query2
=	TokenNameEQUAL	
bq2	TokenNameIdentifier	 bq2
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
bq2	TokenNameIdentifier	 bq2
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
parentQuery2	TokenNameIdentifier	 parent Query2
,	TokenNameCOMMA	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
bq2	TokenNameIdentifier	 bq2
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
childTerm	TokenNameIdentifier	 child Term
)	TokenNameRPAREN	
,	TokenNameCOMMA	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
bq2	TokenNameIdentifier	 bq2
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
childTerm	TokenNameIdentifier	 child Term
)	TokenNameRPAREN	
,	TokenNameCOMMA	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
bq2	TokenNameIdentifier	 bq2
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
parentQuery2	TokenNameIdentifier	 parent Query2
,	TokenNameCOMMA	
BooleanClause	TokenNameIdentifier	 Boolean Clause
.	TokenNameDOT	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
final	TokenNamefinal	
Sort	TokenNameIdentifier	 Sort
childSort2	TokenNameIdentifier	 child Sort2
=	TokenNameEQUAL	
getRandomSort	TokenNameIdentifier	 get Random Sort
(	TokenNameLPAREN	
"child"	TokenNameStringLiteral	child
,	TokenNameCOMMA	
childFields	TokenNameIdentifier	 child Fields
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Search denormalized index: 	TokenNameCOMMENT_LINE	Search denormalized index: 
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: run top down query="	TokenNameStringLiteral	TEST: run top down query=
+	TokenNamePLUS	
childQuery2	TokenNameIdentifier	 child Query2
+	TokenNamePLUS	
" filter="	TokenNameStringLiteral	 filter=
+	TokenNamePLUS	
childFilter2	TokenNameIdentifier	 child Filter2
+	TokenNamePLUS	
" sort="	TokenNameStringLiteral	 sort=
+	TokenNamePLUS	
childSort2	TokenNameIdentifier	 child Sort2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
final	TokenNamefinal	
TopDocs	TokenNameIdentifier	 Top Docs
results2	TokenNameIdentifier	 results2
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
childQuery2	TokenNameIdentifier	 child Query2
,	TokenNameCOMMA	
childFilter2	TokenNameIdentifier	 child Filter2
,	TokenNameCOMMA	
r	TokenNameIdentifier	 r
.	TokenNameDOT	
numDocs	TokenNameIdentifier	 num Docs
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
childSort2	TokenNameIdentifier	 child Sort2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" "	TokenNameStringLiteral	 
+	TokenNamePLUS	
results2	TokenNameIdentifier	 results2
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
+	TokenNamePLUS	
" totalHits:"	TokenNameStringLiteral	 totalHits:
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
ScoreDoc	TokenNameIdentifier	 Score Doc
sd	TokenNameIdentifier	 sd
:	TokenNameCOLON	
results2	TokenNameIdentifier	 results2
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
Document	TokenNameIdentifier	 Document
doc	TokenNameIdentifier	 doc
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
(	TokenNameLPAREN	
sd	TokenNameIdentifier	 sd
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" childID="	TokenNameStringLiteral	 childID=
+	TokenNamePLUS	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"childID"	TokenNameStringLiteral	childID
)	TokenNameRPAREN	
+	TokenNamePLUS	
" parentID="	TokenNameStringLiteral	 parentID=
+	TokenNamePLUS	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"parentID"	TokenNameStringLiteral	parentID
)	TokenNameRPAREN	
+	TokenNamePLUS	
" docID="	TokenNameStringLiteral	 docID=
+	TokenNamePLUS	
sd	TokenNameIdentifier	 sd
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
// Search join index: 	TokenNameCOMMENT_LINE	Search join index: 
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"TEST: run top down join query="	TokenNameStringLiteral	TEST: run top down join query=
+	TokenNamePLUS	
childJoinQuery2	TokenNameIdentifier	 child Join Query2
+	TokenNamePLUS	
" filter="	TokenNameStringLiteral	 filter=
+	TokenNamePLUS	
childJoinFilter2	TokenNameIdentifier	 child Join Filter2
+	TokenNamePLUS	
" sort="	TokenNameStringLiteral	 sort=
+	TokenNamePLUS	
childSort2	TokenNameIdentifier	 child Sort2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
TopDocs	TokenNameIdentifier	 Top Docs
joinResults2	TokenNameIdentifier	 join Results2
=	TokenNameEQUAL	
joinS	TokenNameIdentifier	 join S
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
childJoinQuery2	TokenNameIdentifier	 child Join Query2
,	TokenNameCOMMA	
childJoinFilter2	TokenNameIdentifier	 child Join Filter2
,	TokenNameCOMMA	
joinR	TokenNameIdentifier	 join R
.	TokenNameDOT	
numDocs	TokenNameIdentifier	 num Docs
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
childSort2	TokenNameIdentifier	 child Sort2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
VERBOSE	TokenNameIdentifier	 VERBOSE
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" "	TokenNameStringLiteral	 
+	TokenNamePLUS	
joinResults2	TokenNameIdentifier	 join Results2
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
+	TokenNamePLUS	
" totalHits:"	TokenNameStringLiteral	 totalHits:
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
ScoreDoc	TokenNameIdentifier	 Score Doc
sd	TokenNameIdentifier	 sd
:	TokenNameCOLON	
joinResults2	TokenNameIdentifier	 join Results2
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
Document	TokenNameIdentifier	 Document
doc	TokenNameIdentifier	 doc
=	TokenNameEQUAL	
joinS	TokenNameIdentifier	 join S
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
(	TokenNameLPAREN	
sd	TokenNameIdentifier	 sd
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Document	TokenNameIdentifier	 Document
parentDoc	TokenNameIdentifier	 parent Doc
=	TokenNameEQUAL	
getParentDoc	TokenNameIdentifier	 get Parent Doc
(	TokenNameLPAREN	
joinR	TokenNameIdentifier	 join R
,	TokenNameCOMMA	
parentsFilter	TokenNameIdentifier	 parents Filter
,	TokenNameCOMMA	
sd	TokenNameIdentifier	 sd
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
out	TokenNameIdentifier	 out
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
" childID="	TokenNameStringLiteral	 childID=
+	TokenNamePLUS	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"childID"	TokenNameStringLiteral	childID
)	TokenNameRPAREN	
+	TokenNamePLUS	
" parentID="	TokenNameStringLiteral	 parentID=
+	TokenNamePLUS	
parentDoc	TokenNameIdentifier	 parent Doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"parentID"	TokenNameStringLiteral	parentID
)	TokenNameRPAREN	
+	TokenNamePLUS	
" blockID="	TokenNameStringLiteral	 blockID=
+	TokenNamePLUS	
doc	TokenNameIdentifier	 doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"blockID"	TokenNameStringLiteral	blockID
)	TokenNameRPAREN	
+	TokenNamePLUS	
" docID="	TokenNameStringLiteral	 docID=
+	TokenNamePLUS	
sd	TokenNameIdentifier	 sd
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
compareChildHits	TokenNameIdentifier	 compare Child Hits
(	TokenNameLPAREN	
r	TokenNameIdentifier	 r
,	TokenNameCOMMA	
joinR	TokenNameIdentifier	 join R
,	TokenNameCOMMA	
results2	TokenNameIdentifier	 results2
,	TokenNameCOMMA	
joinResults2	TokenNameIdentifier	 join Results2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
r	TokenNameIdentifier	 r
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
joinS	TokenNameIdentifier	 join S
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
joinR	TokenNameIdentifier	 join R
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
dir	TokenNameIdentifier	 dir
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
joinDir	TokenNameIdentifier	 join Dir
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
compareChildHits	TokenNameIdentifier	 compare Child Hits
(	TokenNameLPAREN	
IndexReader	TokenNameIdentifier	 Index Reader
r	TokenNameIdentifier	 r
,	TokenNameCOMMA	
IndexReader	TokenNameIdentifier	 Index Reader
joinR	TokenNameIdentifier	 join R
,	TokenNameCOMMA	
TopDocs	TokenNameIdentifier	 Top Docs
results	TokenNameIdentifier	 results
,	TokenNameCOMMA	
TopDocs	TokenNameIdentifier	 Top Docs
joinResults	TokenNameIdentifier	 join Results
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
results	TokenNameIdentifier	 results
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
,	TokenNameCOMMA	
joinResults	TokenNameIdentifier	 join Results
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
results	TokenNameIdentifier	 results
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
.	TokenNameDOT	
length	TokenNameIdentifier	 length
,	TokenNameCOMMA	
joinResults	TokenNameIdentifier	 join Results
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
hitCount	TokenNameIdentifier	 hit Count
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
hitCount	TokenNameIdentifier	 hit Count
<	TokenNameLESS	
results	TokenNameIdentifier	 results
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
hitCount	TokenNameIdentifier	 hit Count
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
ScoreDoc	TokenNameIdentifier	 Score Doc
hit	TokenNameIdentifier	 hit
=	TokenNameEQUAL	
results	TokenNameIdentifier	 results
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
hitCount	TokenNameIdentifier	 hit Count
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
ScoreDoc	TokenNameIdentifier	 Score Doc
joinHit	TokenNameIdentifier	 join Hit
=	TokenNameEQUAL	
joinResults	TokenNameIdentifier	 join Results
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
hitCount	TokenNameIdentifier	 hit Count
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
Document	TokenNameIdentifier	 Document
doc1	TokenNameIdentifier	 doc1
=	TokenNameEQUAL	
r	TokenNameIdentifier	 r
.	TokenNameDOT	
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
hit	TokenNameIdentifier	 hit
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Document	TokenNameIdentifier	 Document
doc2	TokenNameIdentifier	 doc2
=	TokenNameEQUAL	
joinR	TokenNameIdentifier	 join R
.	TokenNameDOT	
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
joinHit	TokenNameIdentifier	 join Hit
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"hit "	TokenNameStringLiteral	hit 
+	TokenNamePLUS	
hitCount	TokenNameIdentifier	 hit Count
+	TokenNamePLUS	
" differs"	TokenNameStringLiteral	 differs
,	TokenNameCOMMA	
doc1	TokenNameIdentifier	 doc1
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"childID"	TokenNameStringLiteral	childID
)	TokenNameRPAREN	
,	TokenNameCOMMA	
doc2	TokenNameIdentifier	 doc2
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"childID"	TokenNameStringLiteral	childID
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// don't compare scores -- they are expected to differ 	TokenNameCOMMENT_LINE	don't compare scores -- they are expected to differ 
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
hit	TokenNameIdentifier	 hit
instanceof	TokenNameinstanceof	
FieldDoc	TokenNameIdentifier	 Field Doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
joinHit	TokenNameIdentifier	 join Hit
instanceof	TokenNameinstanceof	
FieldDoc	TokenNameIdentifier	 Field Doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
FieldDoc	TokenNameIdentifier	 Field Doc
hit0	TokenNameIdentifier	 hit0
=	TokenNameEQUAL	
(	TokenNameLPAREN	
FieldDoc	TokenNameIdentifier	 Field Doc
)	TokenNameRPAREN	
hit	TokenNameIdentifier	 hit
;	TokenNameSEMICOLON	
FieldDoc	TokenNameIdentifier	 Field Doc
joinHit0	TokenNameIdentifier	 join Hit0
=	TokenNameEQUAL	
(	TokenNameLPAREN	
FieldDoc	TokenNameIdentifier	 Field Doc
)	TokenNameRPAREN	
joinHit	TokenNameIdentifier	 join Hit
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
hit0	TokenNameIdentifier	 hit0
.	TokenNameDOT	
fields	TokenNameIdentifier	 fields
,	TokenNameCOMMA	
joinHit0	TokenNameIdentifier	 join Hit0
.	TokenNameDOT	
fields	TokenNameIdentifier	 fields
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
compareHits	TokenNameIdentifier	 compare Hits
(	TokenNameLPAREN	
IndexReader	TokenNameIdentifier	 Index Reader
r	TokenNameIdentifier	 r
,	TokenNameCOMMA	
IndexReader	TokenNameIdentifier	 Index Reader
joinR	TokenNameIdentifier	 join R
,	TokenNameCOMMA	
TopDocs	TokenNameIdentifier	 Top Docs
results	TokenNameIdentifier	 results
,	TokenNameCOMMA	
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
>	TokenNameGREATER	
joinResults	TokenNameIdentifier	 join Results
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
// results is 'complete'; joinResults is a subset 	TokenNameCOMMENT_LINE	results is 'complete'; joinResults is a subset 
int	TokenNameint	
resultUpto	TokenNameIdentifier	 result Upto
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
int	TokenNameint	
joinGroupUpto	TokenNameIdentifier	 join Group Upto
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
ScoreDoc	TokenNameIdentifier	 Score Doc
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
hits	TokenNameIdentifier	 hits
=	TokenNameEQUAL	
results	TokenNameIdentifier	 results
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
;	TokenNameSEMICOLON	
final	TokenNamefinal	
GroupDocs	TokenNameIdentifier	 Group Docs
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
>	TokenNameGREATER	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
groupDocs	TokenNameIdentifier	 group Docs
=	TokenNameEQUAL	
joinResults	TokenNameIdentifier	 join Results
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
;	TokenNameSEMICOLON	
while	TokenNamewhile	
(	TokenNameLPAREN	
joinGroupUpto	TokenNameIdentifier	 join Group Upto
<	TokenNameLESS	
groupDocs	TokenNameIdentifier	 group Docs
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
GroupDocs	TokenNameIdentifier	 Group Docs
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
>	TokenNameGREATER	
group	TokenNameIdentifier	 group
=	TokenNameEQUAL	
groupDocs	TokenNameIdentifier	 group Docs
[	TokenNameLBRACKET	
joinGroupUpto	TokenNameIdentifier	 join Group Upto
++	TokenNamePLUS_PLUS	
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
ScoreDoc	TokenNameIdentifier	 Score Doc
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
groupHits	TokenNameIdentifier	 group Hits
=	TokenNameEQUAL	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
;	TokenNameSEMICOLON	
assertNotNull	TokenNameIdentifier	 assert Not Null
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Document	TokenNameIdentifier	 Document
parentDoc	TokenNameIdentifier	 parent Doc
=	TokenNameEQUAL	
joinR	TokenNameIdentifier	 join R
.	TokenNameDOT	
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
parentID	TokenNameIdentifier	 parent ID
=	TokenNameEQUAL	
parentDoc	TokenNameIdentifier	 parent Doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"parentID"	TokenNameStringLiteral	parentID
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//System.out.println("GROUP groupDoc=" + group.groupDoc + " parent=" + parentDoc); 	TokenNameCOMMENT_LINE	System.out.println("GROUP groupDoc=" + group.groupDoc + " parent=" + parentDoc); 
assertNotNull	TokenNameIdentifier	 assert Not Null
(	TokenNameLPAREN	
parentID	TokenNameIdentifier	 parent ID
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
groupHits	TokenNameIdentifier	 group Hits
.	TokenNameDOT	
length	TokenNameIdentifier	 length
>	TokenNameGREATER	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
hitIDX	TokenNameIdentifier	 hit IDX
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
hitIDX	TokenNameIdentifier	 hit IDX
<	TokenNameLESS	
groupHits	TokenNameIdentifier	 group Hits
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
hitIDX	TokenNameIdentifier	 hit IDX
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
Document	TokenNameIdentifier	 Document
nonJoinHit	TokenNameIdentifier	 non Join Hit
=	TokenNameEQUAL	
r	TokenNameIdentifier	 r
.	TokenNameDOT	
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
hits	TokenNameIdentifier	 hits
[	TokenNameLBRACKET	
resultUpto	TokenNameIdentifier	 result Upto
++	TokenNamePLUS_PLUS	
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Document	TokenNameIdentifier	 Document
joinHit	TokenNameIdentifier	 join Hit
=	TokenNameEQUAL	
joinR	TokenNameIdentifier	 join R
.	TokenNameDOT	
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
groupHits	TokenNameIdentifier	 group Hits
[	TokenNameLBRACKET	
hitIDX	TokenNameIdentifier	 hit IDX
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
parentID	TokenNameIdentifier	 parent ID
,	TokenNameCOMMA	
nonJoinHit	TokenNameIdentifier	 non Join Hit
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"parentID"	TokenNameStringLiteral	parentID
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
joinHit	TokenNameIdentifier	 join Hit
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"childID"	TokenNameStringLiteral	childID
)	TokenNameRPAREN	
,	TokenNameCOMMA	
nonJoinHit	TokenNameIdentifier	 non Join Hit
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"childID"	TokenNameStringLiteral	childID
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
joinGroupUpto	TokenNameIdentifier	 join Group Upto
<	TokenNameLESS	
groupDocs	TokenNameIdentifier	 group Docs
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// Advance non-join hit to the next parentID: 	TokenNameCOMMENT_LINE	Advance non-join hit to the next parentID: 
//System.out.println(" next joingroupUpto=" + joinGroupUpto + " gd.length=" + groupDocs.length + " parentID=" + parentID); 	TokenNameCOMMENT_LINE	System.out.println(" next joingroupUpto=" + joinGroupUpto + " gd.length=" + groupDocs.length + " parentID=" + parentID); 
while	TokenNamewhile	
(	TokenNameLPAREN	
true	TokenNametrue	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
resultUpto	TokenNameIdentifier	 result Upto
<	TokenNameLESS	
hits	TokenNameIdentifier	 hits
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
parentID	TokenNameIdentifier	 parent ID
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
r	TokenNameIdentifier	 r
.	TokenNameDOT	
document	TokenNameIdentifier	 document
(	TokenNameLPAREN	
hits	TokenNameIdentifier	 hits
[	TokenNameLBRACKET	
resultUpto	TokenNameIdentifier	 result Upto
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"parentID"	TokenNameStringLiteral	parentID
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
break	TokenNamebreak	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
resultUpto	TokenNameIdentifier	 result Upto
++	TokenNamePLUS_PLUS	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
testMultiChildTypes	TokenNameIdentifier	 test Multi Child Types
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
final	TokenNamefinal	
Directory	TokenNameIdentifier	 Directory
dir	TokenNameIdentifier	 dir
=	TokenNameEQUAL	
newDirectory	TokenNameIdentifier	 new Directory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
w	TokenNameIdentifier	 w
=	TokenNameEQUAL	
new	TokenNamenew	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
dir	TokenNameIdentifier	 dir
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Document	TokenNameIdentifier	 Document
>	TokenNameGREATER	
docs	TokenNameIdentifier	 docs
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
Document	TokenNameIdentifier	 Document
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
makeJob	TokenNameIdentifier	 make Job
(	TokenNameLPAREN	
"java"	TokenNameStringLiteral	java
,	TokenNameCOMMA	
2007	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
makeJob	TokenNameIdentifier	 make Job
(	TokenNameLPAREN	
"python"	TokenNameStringLiteral	python
,	TokenNameCOMMA	
2010	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
makeQualification	TokenNameIdentifier	 make Qualification
(	TokenNameLPAREN	
"maths"	TokenNameStringLiteral	maths
,	TokenNameCOMMA	
1999	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
docs	TokenNameIdentifier	 docs
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
makeResume	TokenNameIdentifier	 make Resume
(	TokenNameLPAREN	
"Lisa"	TokenNameStringLiteral	Lisa
,	TokenNameCOMMA	
"United Kingdom"	TokenNameStringLiteral	United Kingdom
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
addDocuments	TokenNameIdentifier	 add Documents
(	TokenNameLPAREN	
docs	TokenNameIdentifier	 docs
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IndexReader	TokenNameIdentifier	 Index Reader
r	TokenNameIdentifier	 r
=	TokenNameEQUAL	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
getReader	TokenNameIdentifier	 get Reader
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IndexSearcher	TokenNameIdentifier	 Index Searcher
s	TokenNameIdentifier	 s
=	TokenNameEQUAL	
newSearcher	TokenNameIdentifier	 new Searcher
(	TokenNameLPAREN	
r	TokenNameIdentifier	 r
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Create a filter that defines "parent" documents in the index - in this case resumes 	TokenNameCOMMENT_LINE	Create a filter that defines "parent" documents in the index - in this case resumes 
final	TokenNamefinal	
Filter	TokenNameIdentifier	 Filter
parentsFilter	TokenNameIdentifier	 parents Filter
=	TokenNameEQUAL	
new	TokenNamenew	
CachingWrapperFilter	TokenNameIdentifier	 Caching Wrapper Filter
(	TokenNameLPAREN	
new	TokenNamenew	
RawTermFilter	TokenNameIdentifier	 Raw Term Filter
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"docType"	TokenNameStringLiteral	docType
,	TokenNameCOMMA	
"resume"	TokenNameStringLiteral	resume
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
CachingWrapperFilter	TokenNameIdentifier	 Caching Wrapper Filter
.	TokenNameDOT	
DeletesMode	TokenNameIdentifier	 Deletes Mode
.	TokenNameDOT	
IGNORE	TokenNameIdentifier	 IGNORE
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Define child document criteria (finds an example of relevant work experience) 	TokenNameCOMMENT_LINE	Define child document criteria (finds an example of relevant work experience) 
BooleanQuery	TokenNameIdentifier	 Boolean Query
childJobQuery	TokenNameIdentifier	 child Job Query
=	TokenNameEQUAL	
new	TokenNamenew	
BooleanQuery	TokenNameIdentifier	 Boolean Query
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
childJobQuery	TokenNameIdentifier	 child Job Query
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
BooleanClause	TokenNameIdentifier	 Boolean Clause
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"skill"	TokenNameStringLiteral	skill
,	TokenNameCOMMA	
"java"	TokenNameStringLiteral	java
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
childJobQuery	TokenNameIdentifier	 child Job Query
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
BooleanClause	TokenNameIdentifier	 Boolean Clause
(	TokenNameLPAREN	
NumericRangeQuery	TokenNameIdentifier	 Numeric Range Query
.	TokenNameDOT	
newIntRange	TokenNameIdentifier	 new Int Range
(	TokenNameLPAREN	
"year"	TokenNameStringLiteral	year
,	TokenNameCOMMA	
2006	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
2011	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
BooleanQuery	TokenNameIdentifier	 Boolean Query
childQualificationQuery	TokenNameIdentifier	 child Qualification Query
=	TokenNameEQUAL	
new	TokenNamenew	
BooleanQuery	TokenNameIdentifier	 Boolean Query
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
childQualificationQuery	TokenNameIdentifier	 child Qualification Query
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
BooleanClause	TokenNameIdentifier	 Boolean Clause
(	TokenNameLPAREN	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"qualification"	TokenNameStringLiteral	qualification
,	TokenNameCOMMA	
"maths"	TokenNameStringLiteral	maths
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
childQualificationQuery	TokenNameIdentifier	 child Qualification Query
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
BooleanClause	TokenNameIdentifier	 Boolean Clause
(	TokenNameLPAREN	
NumericRangeQuery	TokenNameIdentifier	 Numeric Range Query
.	TokenNameDOT	
newIntRange	TokenNameIdentifier	 new Int Range
(	TokenNameLPAREN	
"year"	TokenNameStringLiteral	year
,	TokenNameCOMMA	
1980	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
2000	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Define parent document criteria (find a resident in the UK) 	TokenNameCOMMENT_LINE	Define parent document criteria (find a resident in the UK) 
Query	TokenNameIdentifier	 Query
parentQuery	TokenNameIdentifier	 parent Query
=	TokenNameEQUAL	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"country"	TokenNameStringLiteral	country
,	TokenNameCOMMA	
"United Kingdom"	TokenNameStringLiteral	United Kingdom
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Wrap the child document query to 'join' any matches 	TokenNameCOMMENT_LINE	Wrap the child document query to 'join' any matches 
// up to corresponding parent: 	TokenNameCOMMENT_LINE	up to corresponding parent: 
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
childJobJoinQuery	TokenNameIdentifier	 child Job Join Query
=	TokenNameEQUAL	
new	TokenNamenew	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
(	TokenNameLPAREN	
childJobQuery	TokenNameIdentifier	 child Job Query
,	TokenNameCOMMA	
parentsFilter	TokenNameIdentifier	 parents Filter
,	TokenNameCOMMA	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
.	TokenNameDOT	
ScoreMode	TokenNameIdentifier	 Score Mode
.	TokenNameDOT	
Avg	TokenNameIdentifier	 Avg
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
childQualificationJoinQuery	TokenNameIdentifier	 child Qualification Join Query
=	TokenNameEQUAL	
new	TokenNamenew	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
(	TokenNameLPAREN	
childQualificationQuery	TokenNameIdentifier	 child Qualification Query
,	TokenNameCOMMA	
parentsFilter	TokenNameIdentifier	 parents Filter
,	TokenNameCOMMA	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
.	TokenNameDOT	
ScoreMode	TokenNameIdentifier	 Score Mode
.	TokenNameDOT	
Avg	TokenNameIdentifier	 Avg
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Combine the parent and nested child queries into a single query for a candidate 	TokenNameCOMMENT_LINE	Combine the parent and nested child queries into a single query for a candidate 
BooleanQuery	TokenNameIdentifier	 Boolean Query
fullQuery	TokenNameIdentifier	 full Query
=	TokenNameEQUAL	
new	TokenNamenew	
BooleanQuery	TokenNameIdentifier	 Boolean Query
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
fullQuery	TokenNameIdentifier	 full Query
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
BooleanClause	TokenNameIdentifier	 Boolean Clause
(	TokenNameLPAREN	
parentQuery	TokenNameIdentifier	 parent Query
,	TokenNameCOMMA	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
fullQuery	TokenNameIdentifier	 full Query
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
BooleanClause	TokenNameIdentifier	 Boolean Clause
(	TokenNameLPAREN	
childJobJoinQuery	TokenNameIdentifier	 child Job Join Query
,	TokenNameCOMMA	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
fullQuery	TokenNameIdentifier	 full Query
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
BooleanClause	TokenNameIdentifier	 Boolean Clause
(	TokenNameLPAREN	
childQualificationJoinQuery	TokenNameIdentifier	 child Qualification Join Query
,	TokenNameCOMMA	
Occur	TokenNameIdentifier	 Occur
.	TokenNameDOT	
MUST	TokenNameIdentifier	 MUST
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Collects all job and qualification child docs for 	TokenNameCOMMENT_LINE	Collects all job and qualification child docs for 
// each resume hit in the top N (sorted by score): 	TokenNameCOMMENT_LINE	each resume hit in the top N (sorted by score): 
ToParentBlockJoinCollector	TokenNameIdentifier	 To Parent Block Join Collector
c	TokenNameIdentifier	 c
=	TokenNameEQUAL	
new	TokenNamenew	
ToParentBlockJoinCollector	TokenNameIdentifier	 To Parent Block Join Collector
(	TokenNameLPAREN	
Sort	TokenNameIdentifier	 Sort
.	TokenNameDOT	
RELEVANCE	TokenNameIdentifier	 RELEVANCE
,	TokenNameCOMMA	
10	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
fullQuery	TokenNameIdentifier	 full Query
,	TokenNameCOMMA	
c	TokenNameIdentifier	 c
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Examine "Job" children 	TokenNameCOMMENT_LINE	Examine "Job" children 
boolean	TokenNameboolean	
showNullPointerIssue	TokenNameIdentifier	 show Null Pointer Issue
=	TokenNameEQUAL	
true	TokenNametrue	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
showNullPointerIssue	TokenNameIdentifier	 show Null Pointer Issue
)	TokenNameRPAREN	
{	TokenNameLBRACE	
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
>	TokenNameGREATER	
jobResults	TokenNameIdentifier	 job Results
=	TokenNameEQUAL	
c	TokenNameIdentifier	 c
.	TokenNameDOT	
getTopGroups	TokenNameIdentifier	 get Top Groups
(	TokenNameLPAREN	
childJobJoinQuery	TokenNameIdentifier	 child Job Join Query
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
10	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//assertEquals(1, results.totalHitCount); 	TokenNameCOMMENT_LINE	assertEquals(1, results.totalHitCount); 
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
jobResults	TokenNameIdentifier	 job Results
.	TokenNameDOT	
totalGroupedHitCount	TokenNameIdentifier	 total Grouped Hit Count
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
jobResults	TokenNameIdentifier	 job Results
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
GroupDocs	TokenNameIdentifier	 Group Docs
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
>	TokenNameGREATER	
group	TokenNameIdentifier	 group
=	TokenNameEQUAL	
jobResults	TokenNameIdentifier	 job Results
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Document	TokenNameIdentifier	 Document
childJobDoc	TokenNameIdentifier	 child Job Doc
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//System.out.println(" doc=" + group.scoreDocs[0].doc); 	TokenNameCOMMENT_LINE	System.out.println(" doc=" + group.scoreDocs[0].doc); 
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"java"	TokenNameStringLiteral	java
,	TokenNameCOMMA	
childJobDoc	TokenNameIdentifier	 child Job Doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"skill"	TokenNameStringLiteral	skill
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertNotNull	TokenNameIdentifier	 assert Not Null
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Document	TokenNameIdentifier	 Document
parentDoc	TokenNameIdentifier	 parent Doc
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
(	TokenNameLPAREN	
group	TokenNameIdentifier	 group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"Lisa"	TokenNameStringLiteral	Lisa
,	TokenNameCOMMA	
parentDoc	TokenNameIdentifier	 parent Doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"name"	TokenNameStringLiteral	name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Now Examine qualification children 	TokenNameCOMMENT_LINE	Now Examine qualification children 
TopGroups	TokenNameIdentifier	 Top Groups
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
>	TokenNameGREATER	
qualificationResults	TokenNameIdentifier	 qualification Results
=	TokenNameEQUAL	
c	TokenNameIdentifier	 c
.	TokenNameDOT	
getTopGroups	TokenNameIdentifier	 get Top Groups
(	TokenNameLPAREN	
childQualificationJoinQuery	TokenNameIdentifier	 child Qualification Join Query
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
10	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
qualificationResults	TokenNameIdentifier	 qualification Results
.	TokenNameDOT	
totalGroupedHitCount	TokenNameIdentifier	 total Grouped Hit Count
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
qualificationResults	TokenNameIdentifier	 qualification Results
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
GroupDocs	TokenNameIdentifier	 Group Docs
<	TokenNameLESS	
Integer	TokenNameIdentifier	 Integer
>	TokenNameGREATER	
qGroup	TokenNameIdentifier	 q Group
=	TokenNameEQUAL	
qualificationResults	TokenNameIdentifier	 qualification Results
.	TokenNameDOT	
groups	TokenNameIdentifier	 groups
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
qGroup	TokenNameIdentifier	 q Group
.	TokenNameDOT	
totalHits	TokenNameIdentifier	 total Hits
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Document	TokenNameIdentifier	 Document
childQualificationDoc	TokenNameIdentifier	 child Qualification Doc
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
(	TokenNameLPAREN	
qGroup	TokenNameIdentifier	 q Group
.	TokenNameDOT	
scoreDocs	TokenNameIdentifier	 score Docs
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"maths"	TokenNameStringLiteral	maths
,	TokenNameCOMMA	
childQualificationDoc	TokenNameIdentifier	 child Qualification Doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"qualification"	TokenNameStringLiteral	qualification
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertNotNull	TokenNameIdentifier	 assert Not Null
(	TokenNameLPAREN	
qGroup	TokenNameIdentifier	 q Group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Document	TokenNameIdentifier	 Document
parentDoc	TokenNameIdentifier	 parent Doc
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
doc	TokenNameIdentifier	 doc
(	TokenNameLPAREN	
qGroup	TokenNameIdentifier	 q Group
.	TokenNameDOT	
groupValue	TokenNameIdentifier	 group Value
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"Lisa"	TokenNameStringLiteral	Lisa
,	TokenNameCOMMA	
parentDoc	TokenNameIdentifier	 parent Doc
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
"name"	TokenNameStringLiteral	name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
r	TokenNameIdentifier	 r
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
dir	TokenNameIdentifier	 dir
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
testAdvanceSingleParentSingleChild	TokenNameIdentifier	 test Advance Single Parent Single Child
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
Directory	TokenNameIdentifier	 Directory
dir	TokenNameIdentifier	 dir
=	TokenNameEQUAL	
newDirectory	TokenNameIdentifier	 new Directory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
w	TokenNameIdentifier	 w
=	TokenNameEQUAL	
new	TokenNamenew	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
dir	TokenNameIdentifier	 dir
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Document	TokenNameIdentifier	 Document
childDoc	TokenNameIdentifier	 child Doc
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
childDoc	TokenNameIdentifier	 child Doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"child"	TokenNameStringLiteral	child
,	TokenNameCOMMA	
"1"	TokenNameStringLiteral	1
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
NO	TokenNameIdentifier	 NO
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Document	TokenNameIdentifier	 Document
parentDoc	TokenNameIdentifier	 parent Doc
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
parentDoc	TokenNameIdentifier	 parent Doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"parent"	TokenNameStringLiteral	parent
,	TokenNameCOMMA	
"1"	TokenNameStringLiteral	1
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
NO	TokenNameIdentifier	 NO
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
addDocuments	TokenNameIdentifier	 add Documents
(	TokenNameLPAREN	
Arrays	TokenNameIdentifier	 Arrays
.	TokenNameDOT	
asList	TokenNameIdentifier	 as List
(	TokenNameLPAREN	
childDoc	TokenNameIdentifier	 child Doc
,	TokenNameCOMMA	
parentDoc	TokenNameIdentifier	 parent Doc
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IndexReader	TokenNameIdentifier	 Index Reader
r	TokenNameIdentifier	 r
=	TokenNameEQUAL	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
getReader	TokenNameIdentifier	 get Reader
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IndexSearcher	TokenNameIdentifier	 Index Searcher
s	TokenNameIdentifier	 s
=	TokenNameEQUAL	
newSearcher	TokenNameIdentifier	 new Searcher
(	TokenNameLPAREN	
r	TokenNameIdentifier	 r
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Query	TokenNameIdentifier	 Query
tq	TokenNameIdentifier	 tq
=	TokenNameEQUAL	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"child"	TokenNameStringLiteral	child
,	TokenNameCOMMA	
"1"	TokenNameStringLiteral	1
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Filter	TokenNameIdentifier	 Filter
parentsFilter	TokenNameIdentifier	 parents Filter
=	TokenNameEQUAL	
new	TokenNamenew	
CachingWrapperFilter	TokenNameIdentifier	 Caching Wrapper Filter
(	TokenNameLPAREN	
new	TokenNamenew	
RawTermFilter	TokenNameIdentifier	 Raw Term Filter
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"parent"	TokenNameStringLiteral	parent
,	TokenNameCOMMA	
"1"	TokenNameStringLiteral	1
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
CachingWrapperFilter	TokenNameIdentifier	 Caching Wrapper Filter
.	TokenNameDOT	
DeletesMode	TokenNameIdentifier	 Deletes Mode
.	TokenNameDOT	
IGNORE	TokenNameIdentifier	 IGNORE
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
q	TokenNameIdentifier	 q
=	TokenNameEQUAL	
new	TokenNamenew	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
(	TokenNameLPAREN	
tq	TokenNameIdentifier	 tq
,	TokenNameCOMMA	
parentsFilter	TokenNameIdentifier	 parents Filter
,	TokenNameCOMMA	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
.	TokenNameDOT	
ScoreMode	TokenNameIdentifier	 Score Mode
.	TokenNameDOT	
Avg	TokenNameIdentifier	 Avg
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Weight	TokenNameIdentifier	 Weight
weight	TokenNameIdentifier	 weight
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
createNormalizedWeight	TokenNameIdentifier	 create Normalized Weight
(	TokenNameLPAREN	
q	TokenNameIdentifier	 q
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IndexReader	TokenNameIdentifier	 Index Reader
atomic	TokenNameIdentifier	 atomic
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
getIndexReader	TokenNameIdentifier	 get Index Reader
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getSequentialSubReaders	TokenNameIdentifier	 get Sequential Sub Readers
(	TokenNameLPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
atomic	TokenNameIdentifier	 atomic
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
getIndexReader	TokenNameIdentifier	 get Index Reader
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
atomic	TokenNameIdentifier	 atomic
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
getIndexReader	TokenNameIdentifier	 get Index Reader
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getSequentialSubReaders	TokenNameIdentifier	 get Sequential Sub Readers
(	TokenNameLPAREN	
)	TokenNameRPAREN	
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
DocIdSetIterator	TokenNameIdentifier	 Doc Id Set Iterator
disi	TokenNameIdentifier	 disi
=	TokenNameEQUAL	
weight	TokenNameIdentifier	 weight
.	TokenNameDOT	
scorer	TokenNameIdentifier	 scorer
(	TokenNameLPAREN	
atomic	TokenNameIdentifier	 atomic
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
disi	TokenNameIdentifier	 disi
.	TokenNameDOT	
advance	TokenNameIdentifier	 advance
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
r	TokenNameIdentifier	 r
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
dir	TokenNameIdentifier	 dir
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
testAdvanceSingleParentNoChild	TokenNameIdentifier	 test Advance Single Parent No Child
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
Directory	TokenNameIdentifier	 Directory
dir	TokenNameIdentifier	 dir
=	TokenNameEQUAL	
newDirectory	TokenNameIdentifier	 new Directory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
w	TokenNameIdentifier	 w
=	TokenNameEQUAL	
new	TokenNamenew	
RandomIndexWriter	TokenNameIdentifier	 Random Index Writer
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
dir	TokenNameIdentifier	 dir
,	TokenNameCOMMA	
newIndexWriterConfig	TokenNameIdentifier	 new Index Writer Config
(	TokenNameLPAREN	
TEST_VERSION_CURRENT	TokenNameIdentifier	 TEST  VERSION  CURRENT
,	TokenNameCOMMA	
new	TokenNamenew	
MockAnalyzer	TokenNameIdentifier	 Mock Analyzer
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
)	TokenNameRPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
setMergePolicy	TokenNameIdentifier	 set Merge Policy
(	TokenNameLPAREN	
new	TokenNamenew	
LogDocMergePolicy	TokenNameIdentifier	 Log Doc Merge Policy
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Document	TokenNameIdentifier	 Document
parentDoc	TokenNameIdentifier	 parent Doc
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
parentDoc	TokenNameIdentifier	 parent Doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"parent"	TokenNameStringLiteral	parent
,	TokenNameCOMMA	
"1"	TokenNameStringLiteral	1
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
NO	TokenNameIdentifier	 NO
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
parentDoc	TokenNameIdentifier	 parent Doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"isparent"	TokenNameStringLiteral	isparent
,	TokenNameCOMMA	
"yes"	TokenNameStringLiteral	yes
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
NO	TokenNameIdentifier	 NO
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
addDocuments	TokenNameIdentifier	 add Documents
(	TokenNameLPAREN	
Arrays	TokenNameIdentifier	 Arrays
.	TokenNameDOT	
asList	TokenNameIdentifier	 as List
(	TokenNameLPAREN	
parentDoc	TokenNameIdentifier	 parent Doc
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Add another doc so scorer is not null 	TokenNameCOMMENT_LINE	Add another doc so scorer is not null 
parentDoc	TokenNameIdentifier	 parent Doc
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
parentDoc	TokenNameIdentifier	 parent Doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"parent"	TokenNameStringLiteral	parent
,	TokenNameCOMMA	
"2"	TokenNameStringLiteral	2
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
NO	TokenNameIdentifier	 NO
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
parentDoc	TokenNameIdentifier	 parent Doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"isparent"	TokenNameStringLiteral	isparent
,	TokenNameCOMMA	
"yes"	TokenNameStringLiteral	yes
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
NO	TokenNameIdentifier	 NO
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Document	TokenNameIdentifier	 Document
childDoc	TokenNameIdentifier	 child Doc
=	TokenNameEQUAL	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
childDoc	TokenNameIdentifier	 child Doc
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
newField	TokenNameIdentifier	 new Field
(	TokenNameLPAREN	
"child"	TokenNameStringLiteral	child
,	TokenNameCOMMA	
"2"	TokenNameStringLiteral	2
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Store	TokenNameIdentifier	 Store
.	TokenNameDOT	
NO	TokenNameIdentifier	 NO
,	TokenNameCOMMA	
Field	TokenNameIdentifier	 Field
.	TokenNameDOT	
Index	TokenNameIdentifier	 Index
.	TokenNameDOT	
NOT_ANALYZED	TokenNameIdentifier	 NOT  ANALYZED
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
addDocuments	TokenNameIdentifier	 add Documents
(	TokenNameLPAREN	
Arrays	TokenNameIdentifier	 Arrays
.	TokenNameDOT	
asList	TokenNameIdentifier	 as List
(	TokenNameLPAREN	
childDoc	TokenNameIdentifier	 child Doc
,	TokenNameCOMMA	
parentDoc	TokenNameIdentifier	 parent Doc
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Need single seg: 	TokenNameCOMMENT_LINE	Need single seg: 
w	TokenNameIdentifier	 w
.	TokenNameDOT	
forceMerge	TokenNameIdentifier	 force Merge
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IndexReader	TokenNameIdentifier	 Index Reader
r	TokenNameIdentifier	 r
=	TokenNameEQUAL	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
getReader	TokenNameIdentifier	 get Reader
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IndexSearcher	TokenNameIdentifier	 Index Searcher
s	TokenNameIdentifier	 s
=	TokenNameEQUAL	
newSearcher	TokenNameIdentifier	 new Searcher
(	TokenNameLPAREN	
r	TokenNameIdentifier	 r
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Query	TokenNameIdentifier	 Query
tq	TokenNameIdentifier	 tq
=	TokenNameEQUAL	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"child"	TokenNameStringLiteral	child
,	TokenNameCOMMA	
"2"	TokenNameStringLiteral	2
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Filter	TokenNameIdentifier	 Filter
parentsFilter	TokenNameIdentifier	 parents Filter
=	TokenNameEQUAL	
new	TokenNamenew	
CachingWrapperFilter	TokenNameIdentifier	 Caching Wrapper Filter
(	TokenNameLPAREN	
new	TokenNamenew	
RawTermFilter	TokenNameIdentifier	 Raw Term Filter
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
"isparent"	TokenNameStringLiteral	isparent
,	TokenNameCOMMA	
"yes"	TokenNameStringLiteral	yes
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
CachingWrapperFilter	TokenNameIdentifier	 Caching Wrapper Filter
.	TokenNameDOT	
DeletesMode	TokenNameIdentifier	 Deletes Mode
.	TokenNameDOT	
IGNORE	TokenNameIdentifier	 IGNORE
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
q	TokenNameIdentifier	 q
=	TokenNameEQUAL	
new	TokenNamenew	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
(	TokenNameLPAREN	
tq	TokenNameIdentifier	 tq
,	TokenNameCOMMA	
parentsFilter	TokenNameIdentifier	 parents Filter
,	TokenNameCOMMA	
ToParentBlockJoinQuery	TokenNameIdentifier	 To Parent Block Join Query
.	TokenNameDOT	
ScoreMode	TokenNameIdentifier	 Score Mode
.	TokenNameDOT	
Avg	TokenNameIdentifier	 Avg
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Weight	TokenNameIdentifier	 Weight
weight	TokenNameIdentifier	 weight
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
createNormalizedWeight	TokenNameIdentifier	 create Normalized Weight
(	TokenNameLPAREN	
q	TokenNameIdentifier	 q
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
IndexReader	TokenNameIdentifier	 Index Reader
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
subs	TokenNameIdentifier	 subs
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
getIndexReader	TokenNameIdentifier	 get Index Reader
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getSequentialSubReaders	TokenNameIdentifier	 get Sequential Sub Readers
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
IndexReader	TokenNameIdentifier	 Index Reader
sub	TokenNameIdentifier	 sub
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
subs	TokenNameIdentifier	 subs
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
sub	TokenNameIdentifier	 sub
=	TokenNameEQUAL	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
getIndexReader	TokenNameIdentifier	 get Index Reader
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
subs	TokenNameIdentifier	 subs
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sub	TokenNameIdentifier	 sub
=	TokenNameEQUAL	
subs	TokenNameIdentifier	 subs
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
DocIdSetIterator	TokenNameIdentifier	 Doc Id Set Iterator
disi	TokenNameIdentifier	 disi
=	TokenNameEQUAL	
weight	TokenNameIdentifier	 weight
.	TokenNameDOT	
scorer	TokenNameIdentifier	 scorer
(	TokenNameLPAREN	
sub	TokenNameIdentifier	 sub
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
2	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
disi	TokenNameIdentifier	 disi
.	TokenNameDOT	
advance	TokenNameIdentifier	 advance
(	TokenNameLPAREN	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
s	TokenNameIdentifier	 s
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
r	TokenNameIdentifier	 r
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
dir	TokenNameIdentifier	 dir
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
