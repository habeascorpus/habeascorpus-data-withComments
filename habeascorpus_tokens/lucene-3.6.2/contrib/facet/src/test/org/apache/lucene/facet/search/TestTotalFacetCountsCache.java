package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
search	TokenNameIdentifier	 search
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
File	TokenNameIdentifier	 File
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
IOException	TokenNameIdentifier	 IO Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
ArrayList	TokenNameIdentifier	 Array List
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
List	TokenNameIdentifier	 List
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
analysis	TokenNameIdentifier	 analysis
.	TokenNameDOT	
MockAnalyzer	TokenNameIdentifier	 Mock Analyzer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
analysis	TokenNameIdentifier	 analysis
.	TokenNameDOT	
MockTokenizer	TokenNameIdentifier	 Mock Tokenizer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
document	TokenNameIdentifier	 document
.	TokenNameDOT	
Document	TokenNameIdentifier	 Document
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
CorruptIndexException	TokenNameIdentifier	 Corrupt Index Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
IndexReader	TokenNameIdentifier	 Index Reader
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
IndexWriter	TokenNameIdentifier	 Index Writer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
IndexWriterConfig	TokenNameIdentifier	 Index Writer Config
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
store	TokenNameIdentifier	 store
.	TokenNameDOT	
Directory	TokenNameIdentifier	 Directory
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
store	TokenNameIdentifier	 store
.	TokenNameDOT	
MockDirectoryWrapper	TokenNameIdentifier	 Mock Directory Wrapper
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
junit	TokenNameIdentifier	 junit
.	TokenNameDOT	
Before	TokenNameIdentifier	 Before
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
junit	TokenNameIdentifier	 junit
.	TokenNameDOT	
Test	TokenNameIdentifier	 Test
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
LuceneTestCase	TokenNameIdentifier	 Lucene Test Case
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
FacetTestUtils	TokenNameIdentifier	 Facet Test Utils
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
FacetTestUtils	TokenNameIdentifier	 Facet Test Utils
.	TokenNameDOT	
IndexTaxonomyReaderPair	TokenNameIdentifier	 Index Taxonomy Reader Pair
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
FacetTestUtils	TokenNameIdentifier	 Facet Test Utils
.	TokenNameDOT	
IndexTaxonomyWriterPair	TokenNameIdentifier	 Index Taxonomy Writer Pair
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
example	TokenNameIdentifier	 example
.	TokenNameDOT	
ExampleResult	TokenNameIdentifier	 Example Result
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
example	TokenNameIdentifier	 example
.	TokenNameDOT	
TestMultiCLExample	TokenNameIdentifier	 Test Multi CL Example
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
example	TokenNameIdentifier	 example
.	TokenNameDOT	
multiCL	TokenNameIdentifier	 multi CL
.	TokenNameDOT	
MultiCLIndexer	TokenNameIdentifier	 Multi CL Indexer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
example	TokenNameIdentifier	 example
.	TokenNameDOT	
multiCL	TokenNameIdentifier	 multi CL
.	TokenNameDOT	
MultiCLSearcher	TokenNameIdentifier	 Multi CL Searcher
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
CategoryDocumentBuilder	TokenNameIdentifier	 Category Document Builder
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
params	TokenNameIdentifier	 params
.	TokenNameDOT	
DefaultFacetIndexingParams	TokenNameIdentifier	 Default Facet Indexing Params
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
params	TokenNameIdentifier	 params
.	TokenNameDOT	
FacetIndexingParams	TokenNameIdentifier	 Facet Indexing Params
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
TotalFacetCounts	TokenNameIdentifier	 Total Facet Counts
.	TokenNameDOT	
CreationType	TokenNameIdentifier	 Creation Type
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
results	TokenNameIdentifier	 results
.	TokenNameDOT	
FacetResult	TokenNameIdentifier	 Facet Result
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
results	TokenNameIdentifier	 results
.	TokenNameDOT	
FacetResultNode	TokenNameIdentifier	 Facet Result Node
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
taxonomy	TokenNameIdentifier	 taxonomy
.	TokenNameDOT	
CategoryPath	TokenNameIdentifier	 Category Path
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
taxonomy	TokenNameIdentifier	 taxonomy
.	TokenNameDOT	
TaxonomyReader	TokenNameIdentifier	 Taxonomy Reader
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
taxonomy	TokenNameIdentifier	 taxonomy
.	TokenNameDOT	
TaxonomyWriter	TokenNameIdentifier	 Taxonomy Writer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
taxonomy	TokenNameIdentifier	 taxonomy
.	TokenNameDOT	
directory	TokenNameIdentifier	 directory
.	TokenNameDOT	
DirectoryTaxonomyReader	TokenNameIdentifier	 Directory Taxonomy Reader
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
taxonomy	TokenNameIdentifier	 taxonomy
.	TokenNameDOT	
directory	TokenNameIdentifier	 directory
.	TokenNameDOT	
DirectoryTaxonomyWriter	TokenNameIdentifier	 Directory Taxonomy Writer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
IOUtils	TokenNameIdentifier	 IO Utils
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
SlowRAMDirectory	TokenNameIdentifier	 Slow RAM Directory
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
_TestUtil	TokenNameIdentifier	 Test Util
;	TokenNameSEMICOLON	
/** * Licensed to the Apache Software Foundation (ASF) under one or more * contributor license agreements. See the NOTICE file distributed with * this work for additional information regarding copyright ownership. * The ASF licenses this file to You under the Apache License, Version 2.0 * (the "License"); you may not use this file except in compliance with * the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */	TokenNameCOMMENT_JAVADOC	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
public	TokenNamepublic	
class	TokenNameclass	
TestTotalFacetCountsCache	TokenNameIdentifier	 Test Total Facet Counts Cache
extends	TokenNameextends	
LuceneTestCase	TokenNameIdentifier	 Lucene Test Case
{	TokenNameLBRACE	
static	TokenNamestatic	
final	TokenNamefinal	
TotalFacetCountsCache	TokenNameIdentifier	 Total Facet Counts Cache
TFC	TokenNameIdentifier	 TFC
=	TokenNameEQUAL	
TotalFacetCountsCache	TokenNameIdentifier	 Total Facet Counts Cache
.	TokenNameDOT	
getSingleton	TokenNameIdentifier	 get Singleton
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
/** * Thread class to be used in tests for this method. This thread gets a TFC * and records times. */	TokenNameCOMMENT_JAVADOC	 Thread class to be used in tests for this method. This thread gets a TFC and records times. 
private	TokenNameprivate	
static	TokenNamestatic	
class	TokenNameclass	
TFCThread	TokenNameIdentifier	 TFC Thread
extends	TokenNameextends	
Thread	TokenNameIdentifier	 Thread
{	TokenNameLBRACE	
private	TokenNameprivate	
final	TokenNamefinal	
IndexReader	TokenNameIdentifier	 Index Reader
r	TokenNameIdentifier	 r
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
DirectoryTaxonomyReader	TokenNameIdentifier	 Directory Taxonomy Reader
tr	TokenNameIdentifier	 tr
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
FacetIndexingParams	TokenNameIdentifier	 Facet Indexing Params
iParams	TokenNameIdentifier	 i Params
;	TokenNameSEMICOLON	
TotalFacetCounts	TokenNameIdentifier	 Total Facet Counts
tfc	TokenNameIdentifier	 tfc
;	TokenNameSEMICOLON	
public	TokenNamepublic	
TFCThread	TokenNameIdentifier	 TFC Thread
(	TokenNameLPAREN	
IndexReader	TokenNameIdentifier	 Index Reader
r	TokenNameIdentifier	 r
,	TokenNameCOMMA	
DirectoryTaxonomyReader	TokenNameIdentifier	 Directory Taxonomy Reader
tr	TokenNameIdentifier	 tr
,	TokenNameCOMMA	
FacetIndexingParams	TokenNameIdentifier	 Facet Indexing Params
iParams	TokenNameIdentifier	 i Params
)	TokenNameRPAREN	
{	TokenNameLBRACE	
this	TokenNamethis	
.	TokenNameDOT	
r	TokenNameIdentifier	 r
=	TokenNameEQUAL	
r	TokenNameIdentifier	 r
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
tr	TokenNameIdentifier	 tr
=	TokenNameEQUAL	
tr	TokenNameIdentifier	 tr
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
iParams	TokenNameIdentifier	 i Params
=	TokenNameEQUAL	
iParams	TokenNameIdentifier	 i Params
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
void	TokenNamevoid	
run	TokenNameIdentifier	 run
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
tfc	TokenNameIdentifier	 tfc
=	TokenNameEQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
r	TokenNameIdentifier	 r
,	TokenNameCOMMA	
tr	TokenNameIdentifier	 tr
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
Exception	TokenNameIdentifier	 Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** Utility method to add a document and facets to an index/taxonomy. */	TokenNameCOMMENT_JAVADOC	 Utility method to add a document and facets to an index/taxonomy. 
static	TokenNamestatic	
void	TokenNamevoid	
addFacets	TokenNameIdentifier	 add Facets
(	TokenNameLPAREN	
FacetIndexingParams	TokenNameIdentifier	 Facet Indexing Params
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
IndexWriter	TokenNameIdentifier	 Index Writer
iw	TokenNameIdentifier	 iw
,	TokenNameCOMMA	
TaxonomyWriter	TokenNameIdentifier	 Taxonomy Writer
tw	TokenNameIdentifier	 tw
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
...	TokenNameELLIPSIS	
strings	TokenNameIdentifier	 strings
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
CategoryPath	TokenNameIdentifier	 Category Path
>	TokenNameGREATER	
cps	TokenNameIdentifier	 cps
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
CategoryPath	TokenNameIdentifier	 Category Path
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
cps	TokenNameIdentifier	 cps
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
CategoryPath	TokenNameIdentifier	 Category Path
(	TokenNameLPAREN	
strings	TokenNameIdentifier	 strings
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
CategoryDocumentBuilder	TokenNameIdentifier	 Category Document Builder
builder	TokenNameIdentifier	 builder
=	TokenNameEQUAL	
new	TokenNamenew	
CategoryDocumentBuilder	TokenNameIdentifier	 Category Document Builder
(	TokenNameLPAREN	
tw	TokenNameIdentifier	 tw
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
iw	TokenNameIdentifier	 iw
.	TokenNameDOT	
addDocument	TokenNameIdentifier	 add Document
(	TokenNameLPAREN	
builder	TokenNameIdentifier	 builder
.	TokenNameDOT	
setCategoryPaths	TokenNameIdentifier	 set Category Paths
(	TokenNameLPAREN	
cps	TokenNameIdentifier	 cps
)	TokenNameRPAREN	
.	TokenNameDOT	
build	TokenNameIdentifier	 build
(	TokenNameLPAREN	
new	TokenNamenew	
Document	TokenNameIdentifier	 Document
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** Clears the cache and sets its size to one. */	TokenNameCOMMENT_JAVADOC	 Clears the cache and sets its size to one. 
static	TokenNamestatic	
void	TokenNamevoid	
initCache	TokenNameIdentifier	 init Cache
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
clear	TokenNameIdentifier	 clear
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
setCacheSize	TokenNameIdentifier	 set Cache Size
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Set to keep one in memory 	TokenNameCOMMENT_LINE	Set to keep one in memory 
}	TokenNameRBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
@	TokenNameAT	
Before	TokenNameIdentifier	 Before
public	TokenNamepublic	
void	TokenNamevoid	
setUp	TokenNameIdentifier	 set Up
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
super	TokenNamesuper	
.	TokenNameDOT	
setUp	TokenNameIdentifier	 set Up
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
initCache	TokenNameIdentifier	 init Cache
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** runs a few instances of {@link MultiCLSearcher} in parallel */	TokenNameCOMMENT_JAVADOC	 runs a few instances of {@link MultiCLSearcher} in parallel 
public	TokenNamepublic	
void	TokenNamevoid	
testGeneralSynchronization	TokenNameIdentifier	 test General Synchronization
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
int	TokenNameint	
numIters	TokenNameIdentifier	 num Iters
=	TokenNameEQUAL	
atLeast	TokenNameIdentifier	 at Least
(	TokenNameLPAREN	
2	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
numIters	TokenNameIdentifier	 num Iters
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
doTestGeneralSynchronization	TokenNameIdentifier	 do Test General Synchronization
(	TokenNameLPAREN	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
2	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
4	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
:	TokenNameCOLON	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
10	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
nextInt	TokenNameIdentifier	 next Int
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
3	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** * Run many instances of {@link MultiCLSearcher} in parallel, results should * be sane. Each instance has a random delay for reading bytes, to ensure * that threads finish in different order than started. */	TokenNameCOMMENT_JAVADOC	 Run many instances of {@link MultiCLSearcher} in parallel, results should be sane. Each instance has a random delay for reading bytes, to ensure that threads finish in different order than started. 
@	TokenNameAT	
Test	TokenNameIdentifier	 Test
@	TokenNameAT	
Nightly	TokenNameIdentifier	 Nightly
public	TokenNamepublic	
void	TokenNamevoid	
testGeneralSynchronizationBig	TokenNameIdentifier	 test General Synchronization Big
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
numThreads	TokenNameIdentifier	 num Threads
=	TokenNameEQUAL	
new	TokenNamenew	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
{	TokenNameLBRACE	
2	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
3	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
5	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
8	TokenNameIntegerLiteral	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
sleepMillis	TokenNameIdentifier	 sleep Millis
=	TokenNameEQUAL	
new	TokenNamenew	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
{	TokenNameLBRACE	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
20	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
33	TokenNameIntegerLiteral	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
cacheSize	TokenNameIdentifier	 cache Size
=	TokenNameEQUAL	
new	TokenNamenew	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
{	TokenNameLBRACE	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
2	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
3	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
5	TokenNameIntegerLiteral	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
size	TokenNameIdentifier	 size
:	TokenNameCOLON	
cacheSize	TokenNameIdentifier	 cache Size
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
sleep	TokenNameIdentifier	 sleep
:	TokenNameCOLON	
sleepMillis	TokenNameIdentifier	 sleep Millis
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
nThreads	TokenNameIdentifier	 n Threads
:	TokenNameCOLON	
numThreads	TokenNameIdentifier	 num Threads
)	TokenNameRPAREN	
{	TokenNameLBRACE	
doTestGeneralSynchronization	TokenNameIdentifier	 do Test General Synchronization
(	TokenNameLPAREN	
nThreads	TokenNameIdentifier	 n Threads
,	TokenNameCOMMA	
sleep	TokenNameIdentifier	 sleep
,	TokenNameCOMMA	
size	TokenNameIdentifier	 size
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
doTestGeneralSynchronization	TokenNameIdentifier	 do Test General Synchronization
(	TokenNameLPAREN	
int	TokenNameint	
numThreads	TokenNameIdentifier	 num Threads
,	TokenNameCOMMA	
int	TokenNameint	
sleepMillis	TokenNameIdentifier	 sleep Millis
,	TokenNameCOMMA	
int	TokenNameint	
cacheSize	TokenNameIdentifier	 cache Size
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
,	TokenNameCOMMA	
CorruptIndexException	TokenNameIdentifier	 Corrupt Index Exception
,	TokenNameCOMMA	
IOException	TokenNameIdentifier	 IO Exception
,	TokenNameCOMMA	
InterruptedException	TokenNameIdentifier	 Interrupted Exception
{	TokenNameLBRACE	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
setCacheSize	TokenNameIdentifier	 set Cache Size
(	TokenNameLPAREN	
cacheSize	TokenNameIdentifier	 cache Size
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
SlowRAMDirectory	TokenNameIdentifier	 Slow RAM Directory
slowIndexDir	TokenNameIdentifier	 slow Index Dir
=	TokenNameEQUAL	
new	TokenNamenew	
SlowRAMDirectory	TokenNameIdentifier	 Slow RAM Directory
(	TokenNameLPAREN	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
random	TokenNameIdentifier	 random
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
MockDirectoryWrapper	TokenNameIdentifier	 Mock Directory Wrapper
indexDir	TokenNameIdentifier	 index Dir
=	TokenNameEQUAL	
new	TokenNamenew	
MockDirectoryWrapper	TokenNameIdentifier	 Mock Directory Wrapper
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
slowIndexDir	TokenNameIdentifier	 slow Index Dir
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
SlowRAMDirectory	TokenNameIdentifier	 Slow RAM Directory
slowTaxoDir	TokenNameIdentifier	 slow Taxo Dir
=	TokenNameEQUAL	
new	TokenNamenew	
SlowRAMDirectory	TokenNameIdentifier	 Slow RAM Directory
(	TokenNameLPAREN	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
random	TokenNameIdentifier	 random
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
MockDirectoryWrapper	TokenNameIdentifier	 Mock Directory Wrapper
taxoDir	TokenNameIdentifier	 taxo Dir
=	TokenNameEQUAL	
new	TokenNamenew	
MockDirectoryWrapper	TokenNameIdentifier	 Mock Directory Wrapper
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
slowTaxoDir	TokenNameIdentifier	 slow Taxo Dir
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Index documents without the "slowness" 	TokenNameCOMMENT_LINE	Index documents without the "slowness" 
MultiCLIndexer	TokenNameIdentifier	 Multi CL Indexer
.	TokenNameDOT	
index	TokenNameIdentifier	 index
(	TokenNameLPAREN	
indexDir	TokenNameIdentifier	 index Dir
,	TokenNameCOMMA	
taxoDir	TokenNameIdentifier	 taxo Dir
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
slowIndexDir	TokenNameIdentifier	 slow Index Dir
.	TokenNameDOT	
setSleepMillis	TokenNameIdentifier	 set Sleep Millis
(	TokenNameLPAREN	
sleepMillis	TokenNameIdentifier	 sleep Millis
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
slowTaxoDir	TokenNameIdentifier	 slow Taxo Dir
.	TokenNameDOT	
setSleepMillis	TokenNameIdentifier	 set Sleep Millis
(	TokenNameLPAREN	
sleepMillis	TokenNameIdentifier	 sleep Millis
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Open the slow readers 	TokenNameCOMMENT_LINE	Open the slow readers 
IndexReader	TokenNameIdentifier	 Index Reader
slowIndexReader	TokenNameIdentifier	 slow Index Reader
=	TokenNameEQUAL	
IndexReader	TokenNameIdentifier	 Index Reader
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
indexDir	TokenNameIdentifier	 index Dir
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
TaxonomyReader	TokenNameIdentifier	 Taxonomy Reader
slowTaxoReader	TokenNameIdentifier	 slow Taxo Reader
=	TokenNameEQUAL	
new	TokenNamenew	
DirectoryTaxonomyReader	TokenNameIdentifier	 Directory Taxonomy Reader
(	TokenNameLPAREN	
taxoDir	TokenNameIdentifier	 taxo Dir
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Class to perform search and return results as threads 	TokenNameCOMMENT_LINE	Class to perform search and return results as threads 
class	TokenNameclass	
Multi	TokenNameIdentifier	 Multi
extends	TokenNameextends	
Thread	TokenNameIdentifier	 Thread
{	TokenNameLBRACE	
private	TokenNameprivate	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
FacetResult	TokenNameIdentifier	 Facet Result
>	TokenNameGREATER	
results	TokenNameIdentifier	 results
;	TokenNameSEMICOLON	
private	TokenNameprivate	
FacetIndexingParams	TokenNameIdentifier	 Facet Indexing Params
iParams	TokenNameIdentifier	 i Params
;	TokenNameSEMICOLON	
private	TokenNameprivate	
IndexReader	TokenNameIdentifier	 Index Reader
indexReader	TokenNameIdentifier	 index Reader
;	TokenNameSEMICOLON	
private	TokenNameprivate	
TaxonomyReader	TokenNameIdentifier	 Taxonomy Reader
taxoReader	TokenNameIdentifier	 taxo Reader
;	TokenNameSEMICOLON	
public	TokenNamepublic	
Multi	TokenNameIdentifier	 Multi
(	TokenNameLPAREN	
IndexReader	TokenNameIdentifier	 Index Reader
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
TaxonomyReader	TokenNameIdentifier	 Taxonomy Reader
taxoReader	TokenNameIdentifier	 taxo Reader
,	TokenNameCOMMA	
FacetIndexingParams	TokenNameIdentifier	 Facet Indexing Params
iParams	TokenNameIdentifier	 i Params
)	TokenNameRPAREN	
{	TokenNameLBRACE	
this	TokenNamethis	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
=	TokenNameEQUAL	
indexReader	TokenNameIdentifier	 index Reader
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
taxoReader	TokenNameIdentifier	 taxo Reader
=	TokenNameEQUAL	
taxoReader	TokenNameIdentifier	 taxo Reader
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
iParams	TokenNameIdentifier	 i Params
=	TokenNameEQUAL	
iParams	TokenNameIdentifier	 i Params
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
ExampleResult	TokenNameIdentifier	 Example Result
getResults	TokenNameIdentifier	 get Results
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
ExampleResult	TokenNameIdentifier	 Example Result
exampleRes	TokenNameIdentifier	 example Res
=	TokenNameEQUAL	
new	TokenNamenew	
ExampleResult	TokenNameIdentifier	 Example Result
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
exampleRes	TokenNameIdentifier	 example Res
.	TokenNameDOT	
setFacetResults	TokenNameIdentifier	 set Facet Results
(	TokenNameLPAREN	
results	TokenNameIdentifier	 results
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
exampleRes	TokenNameIdentifier	 example Res
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
void	TokenNamevoid	
run	TokenNameIdentifier	 run
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
results	TokenNameIdentifier	 results
=	TokenNameEQUAL	
MultiCLSearcher	TokenNameIdentifier	 Multi CL Searcher
.	TokenNameDOT	
searchWithFacets	TokenNameIdentifier	 search With Facets
(	TokenNameLPAREN	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
taxoReader	TokenNameIdentifier	 taxo Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
Exception	TokenNameIdentifier	 Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
// Instantiate threads, but do not start them 	TokenNameCOMMENT_LINE	Instantiate threads, but do not start them 
Multi	TokenNameIdentifier	 Multi
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
multis	TokenNameIdentifier	 multis
=	TokenNameEQUAL	
new	TokenNamenew	
Multi	TokenNameIdentifier	 Multi
[	TokenNameLBRACKET	
numThreads	TokenNameIdentifier	 num Threads
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
numThreads	TokenNameIdentifier	 num Threads
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
multis	TokenNameIdentifier	 multis
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
new	TokenNamenew	
Multi	TokenNameIdentifier	 Multi
(	TokenNameLPAREN	
slowIndexReader	TokenNameIdentifier	 slow Index Reader
,	TokenNameCOMMA	
slowTaxoReader	TokenNameIdentifier	 slow Taxo Reader
,	TokenNameCOMMA	
MultiCLIndexer	TokenNameIdentifier	 Multi CL Indexer
.	TokenNameDOT	
MULTI_IPARAMS	TokenNameIdentifier	 MULTI  IPARAMS
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// The last thread uses ONLY the DefaultFacetIndexingParams so that 	TokenNameCOMMENT_LINE	The last thread uses ONLY the DefaultFacetIndexingParams so that 
// it references a different TFC cache. This will still result 	TokenNameCOMMENT_LINE	it references a different TFC cache. This will still result 
// in valid results, but will only search one of the category lists 	TokenNameCOMMENT_LINE	in valid results, but will only search one of the category lists 
// instead of all of them. 	TokenNameCOMMENT_LINE	instead of all of them. 
multis	TokenNameIdentifier	 multis
[	TokenNameLBRACKET	
numThreads	TokenNameIdentifier	 num Threads
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
new	TokenNamenew	
Multi	TokenNameIdentifier	 Multi
(	TokenNameLPAREN	
slowIndexReader	TokenNameIdentifier	 slow Index Reader
,	TokenNameCOMMA	
slowTaxoReader	TokenNameIdentifier	 slow Taxo Reader
,	TokenNameCOMMA	
new	TokenNamenew	
DefaultFacetIndexingParams	TokenNameIdentifier	 Default Facet Indexing Params
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Gentleman, start your engines 	TokenNameCOMMENT_LINE	Gentleman, start your engines 
for	TokenNamefor	
(	TokenNameLPAREN	
Multi	TokenNameIdentifier	 Multi
m	TokenNameIdentifier	 m
:	TokenNameCOLON	
multis	TokenNameIdentifier	 multis
)	TokenNameRPAREN	
{	TokenNameLBRACE	
m	TokenNameIdentifier	 m
.	TokenNameDOT	
start	TokenNameIdentifier	 start
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Wait for threads and get results 	TokenNameCOMMENT_LINE	Wait for threads and get results 
ExampleResult	TokenNameIdentifier	 Example Result
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
multiResults	TokenNameIdentifier	 multi Results
=	TokenNameEQUAL	
new	TokenNamenew	
ExampleResult	TokenNameIdentifier	 Example Result
[	TokenNameLBRACKET	
numThreads	TokenNameIdentifier	 num Threads
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
numThreads	TokenNameIdentifier	 num Threads
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
multis	TokenNameIdentifier	 multis
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
.	TokenNameDOT	
join	TokenNameIdentifier	 join
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
multiResults	TokenNameIdentifier	 multi Results
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
multis	TokenNameIdentifier	 multis
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
.	TokenNameDOT	
getResults	TokenNameIdentifier	 get Results
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Each of the (numThreads-1) should have the same predictable 	TokenNameCOMMENT_LINE	Each of the (numThreads-1) should have the same predictable 
// results, which we test for here. 	TokenNameCOMMENT_LINE	results, which we test for here. 
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
numThreads	TokenNameIdentifier	 num Threads
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
ExampleResult	TokenNameIdentifier	 Example Result
eResults	TokenNameIdentifier	 e Results
=	TokenNameEQUAL	
multiResults	TokenNameIdentifier	 multi Results
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
TestMultiCLExample	TokenNameIdentifier	 Test Multi CL Example
.	TokenNameDOT	
assertCorrectMultiResults	TokenNameIdentifier	 assert Correct Multi Results
(	TokenNameLPAREN	
eResults	TokenNameIdentifier	 e Results
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// The last thread, which only searched over the 	TokenNameCOMMENT_LINE	The last thread, which only searched over the 
// DefaultFacetIndexingParams, 	TokenNameCOMMENT_LINE	DefaultFacetIndexingParams, 
// has its own results 	TokenNameCOMMENT_LINE	has its own results 
ExampleResult	TokenNameIdentifier	 Example Result
eResults	TokenNameIdentifier	 e Results
=	TokenNameEQUAL	
multiResults	TokenNameIdentifier	 multi Results
[	TokenNameLBRACKET	
numThreads	TokenNameIdentifier	 num Threads
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
FacetResult	TokenNameIdentifier	 Facet Result
>	TokenNameGREATER	
results	TokenNameIdentifier	 results
=	TokenNameEQUAL	
eResults	TokenNameIdentifier	 e Results
.	TokenNameDOT	
getFacetResults	TokenNameIdentifier	 get Facet Results
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
3	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
results	TokenNameIdentifier	 results
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
expLabels	TokenNameIdentifier	 exp Labels
=	TokenNameEQUAL	
new	TokenNamenew	
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
{	TokenNameLBRACE	
"5"	TokenNameStringLiteral	5
,	TokenNameCOMMA	
"5/5"	TokenNameStringLiteral	5/5
,	TokenNameCOMMA	
"6/2"	TokenNameStringLiteral	6/2
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
double	TokenNamedouble	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
expValues	TokenNameIdentifier	 exp Values
=	TokenNameEQUAL	
new	TokenNamenew	
double	TokenNamedouble	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
{	TokenNameLBRACE	
0.0	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
0.0	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
1.0	TokenNameDoubleLiteral	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
3	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
FacetResult	TokenNameIdentifier	 Facet Result
result	TokenNameIdentifier	 result
=	TokenNameEQUAL	
results	TokenNameIdentifier	 results
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertNotNull	TokenNameIdentifier	 assert Not Null
(	TokenNameLPAREN	
"Result should not be null"	TokenNameStringLiteral	Result should not be null
,	TokenNameCOMMA	
result	TokenNameIdentifier	 result
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
FacetResultNode	TokenNameIdentifier	 Facet Result Node
resNode	TokenNameIdentifier	 res Node
=	TokenNameEQUAL	
result	TokenNameIdentifier	 result
.	TokenNameDOT	
getFacetResultNode	TokenNameIdentifier	 get Facet Result Node
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"Invalid label"	TokenNameStringLiteral	Invalid label
,	TokenNameCOMMA	
expLabels	TokenNameIdentifier	 exp Labels
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
,	TokenNameCOMMA	
resNode	TokenNameIdentifier	 res Node
.	TokenNameDOT	
getLabel	TokenNameIdentifier	 get Label
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"Invalid value"	TokenNameStringLiteral	Invalid value
,	TokenNameCOMMA	
expValues	TokenNameIdentifier	 exp Values
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
,	TokenNameCOMMA	
resNode	TokenNameIdentifier	 res Node
.	TokenNameDOT	
getValue	TokenNameIdentifier	 get Value
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
0.0	TokenNameDoubleLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"Invalid number of subresults"	TokenNameStringLiteral	Invalid number of subresults
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
resNode	TokenNameIdentifier	 res Node
.	TokenNameDOT	
getNumSubResults	TokenNameIdentifier	 get Num Sub Results
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// we're done, close the index reader and the taxonomy. 	TokenNameCOMMENT_LINE	we're done, close the index reader and the taxonomy. 
slowIndexReader	TokenNameIdentifier	 slow Index Reader
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
slowTaxoReader	TokenNameIdentifier	 slow Taxo Reader
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
indexDir	TokenNameIdentifier	 index Dir
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
taxoDir	TokenNameIdentifier	 taxo Dir
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Simple test to make sure the TotalFacetCountsManager updates the * TotalFacetCounts array only when it is supposed to, and whether it * is recomputed or read from disk. */	TokenNameCOMMENT_JAVADOC	 Simple test to make sure the TotalFacetCountsManager updates the TotalFacetCounts array only when it is supposed to, and whether it is recomputed or read from disk. 
@	TokenNameAT	
Test	TokenNameIdentifier	 Test
public	TokenNamepublic	
void	TokenNamevoid	
testGenerationalConsistency	TokenNameIdentifier	 test Generational Consistency
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
// Create temporary RAMDirectories 	TokenNameCOMMENT_LINE	Create temporary RAMDirectories 
Directory	TokenNameIdentifier	 Directory
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
dirs	TokenNameIdentifier	 dirs
=	TokenNameEQUAL	
FacetTestUtils	TokenNameIdentifier	 Facet Test Utils
.	TokenNameDOT	
createIndexTaxonomyDirs	TokenNameIdentifier	 create Index Taxonomy Dirs
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Create our index/taxonomy writers 	TokenNameCOMMENT_LINE	Create our index/taxonomy writers 
IndexTaxonomyWriterPair	TokenNameIdentifier	 Index Taxonomy Writer Pair
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
writers	TokenNameIdentifier	 writers
=	TokenNameEQUAL	
FacetTestUtils	TokenNameIdentifier	 Facet Test Utils
.	TokenNameDOT	
createIndexTaxonomyWriterPair	TokenNameIdentifier	 create Index Taxonomy Writer Pair
(	TokenNameLPAREN	
dirs	TokenNameIdentifier	 dirs
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
DefaultFacetIndexingParams	TokenNameIdentifier	 Default Facet Indexing Params
iParams	TokenNameIdentifier	 i Params
=	TokenNameEQUAL	
new	TokenNamenew	
DefaultFacetIndexingParams	TokenNameIdentifier	 Default Facet Indexing Params
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Add a facet to the index 	TokenNameCOMMENT_LINE	Add a facet to the index 
addFacets	TokenNameIdentifier	 add Facets
(	TokenNameLPAREN	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexWriter	TokenNameIdentifier	 index Writer
,	TokenNameCOMMA	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxWriter	TokenNameIdentifier	 tax Writer
,	TokenNameCOMMA	
"a"	TokenNameStringLiteral	a
,	TokenNameCOMMA	
"b"	TokenNameStringLiteral	b
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Commit Changes 	TokenNameCOMMENT_LINE	Commit Changes 
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexWriter	TokenNameIdentifier	 index Writer
.	TokenNameDOT	
commit	TokenNameIdentifier	 commit
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxWriter	TokenNameIdentifier	 tax Writer
.	TokenNameDOT	
commit	TokenNameIdentifier	 commit
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Open readers 	TokenNameCOMMENT_LINE	Open readers 
IndexTaxonomyReaderPair	TokenNameIdentifier	 Index Taxonomy Reader Pair
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
readers	TokenNameIdentifier	 readers
=	TokenNameEQUAL	
FacetTestUtils	TokenNameIdentifier	 Facet Test Utils
.	TokenNameDOT	
createIndexTaxonomyReaderPair	TokenNameIdentifier	 create Index Taxonomy Reader Pair
(	TokenNameLPAREN	
dirs	TokenNameIdentifier	 dirs
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// As this is the first time we have invoked the TotalFacetCountsManager, 	TokenNameCOMMENT_LINE	As this is the first time we have invoked the TotalFacetCountsManager, 
// we should expect to compute and not read from disk. 	TokenNameCOMMENT_LINE	we should expect to compute and not read from disk. 
TotalFacetCounts	TokenNameIdentifier	 Total Facet Counts
totalCounts	TokenNameIdentifier	 total Counts
=	TokenNameEQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
int	TokenNameint	
prevGen	TokenNameIdentifier	 prev Gen
=	TokenNameEQUAL	
assertRecomputed	TokenNameIdentifier	 assert Recomputed
(	TokenNameLPAREN	
totalCounts	TokenNameIdentifier	 total Counts
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
"after first attempt to get it!"	TokenNameStringLiteral	after first attempt to get it!
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Repeating same operation should pull from the cache - not recomputed. 	TokenNameCOMMENT_LINE	Repeating same operation should pull from the cache - not recomputed. 
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
"Should be obtained from cache at 2nd attempt"	TokenNameStringLiteral	Should be obtained from cache at 2nd attempt
,	TokenNameCOMMA	
totalCounts	TokenNameIdentifier	 total Counts
==	TokenNameEQUAL_EQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Repeat the same operation as above. but clear first - now should recompute again 	TokenNameCOMMENT_LINE	Repeat the same operation as above. but clear first - now should recompute again 
initCache	TokenNameIdentifier	 init Cache
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
totalCounts	TokenNameIdentifier	 total Counts
=	TokenNameEQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
prevGen	TokenNameIdentifier	 prev Gen
=	TokenNameEQUAL	
assertRecomputed	TokenNameIdentifier	 assert Recomputed
(	TokenNameLPAREN	
totalCounts	TokenNameIdentifier	 total Counts
,	TokenNameCOMMA	
prevGen	TokenNameIdentifier	 prev Gen
,	TokenNameCOMMA	
"after cache clear, 3rd attempt to get it!"	TokenNameStringLiteral	after cache clear, 3rd attempt to get it!
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//store to file 	TokenNameCOMMENT_LINE	store to file 
File	TokenNameIdentifier	 File
outputFile	TokenNameIdentifier	 output File
=	TokenNameEQUAL	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
createTempFile	TokenNameIdentifier	 create Temp File
(	TokenNameLPAREN	
"test"	TokenNameStringLiteral	test
,	TokenNameCOMMA	
"tmp"	TokenNameStringLiteral	tmp
,	TokenNameCOMMA	
TEMP_DIR	TokenNameIdentifier	 TEMP  DIR
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
initCache	TokenNameIdentifier	 init Cache
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
store	TokenNameIdentifier	 store
(	TokenNameLPAREN	
outputFile	TokenNameIdentifier	 output File
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
totalCounts	TokenNameIdentifier	 total Counts
=	TokenNameEQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
prevGen	TokenNameIdentifier	 prev Gen
=	TokenNameEQUAL	
assertRecomputed	TokenNameIdentifier	 assert Recomputed
(	TokenNameLPAREN	
totalCounts	TokenNameIdentifier	 total Counts
,	TokenNameCOMMA	
prevGen	TokenNameIdentifier	 prev Gen
,	TokenNameCOMMA	
"after cache clear, 4th attempt to get it!"	TokenNameStringLiteral	after cache clear, 4th attempt to get it!
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//clear and load 	TokenNameCOMMENT_LINE	clear and load 
initCache	TokenNameIdentifier	 init Cache
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
load	TokenNameIdentifier	 load
(	TokenNameLPAREN	
outputFile	TokenNameIdentifier	 output File
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
totalCounts	TokenNameIdentifier	 total Counts
=	TokenNameEQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
prevGen	TokenNameIdentifier	 prev Gen
=	TokenNameEQUAL	
assertReadFromDisc	TokenNameIdentifier	 assert Read From Disc
(	TokenNameLPAREN	
totalCounts	TokenNameIdentifier	 total Counts
,	TokenNameCOMMA	
prevGen	TokenNameIdentifier	 prev Gen
,	TokenNameCOMMA	
"after 5th attempt to get it!"	TokenNameStringLiteral	after 5th attempt to get it!
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Add a new facet to the index, commit and refresh readers 	TokenNameCOMMENT_LINE	Add a new facet to the index, commit and refresh readers 
addFacets	TokenNameIdentifier	 add Facets
(	TokenNameLPAREN	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexWriter	TokenNameIdentifier	 index Writer
,	TokenNameCOMMA	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxWriter	TokenNameIdentifier	 tax Writer
,	TokenNameCOMMA	
"c"	TokenNameStringLiteral	c
,	TokenNameCOMMA	
"d"	TokenNameStringLiteral	d
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexWriter	TokenNameIdentifier	 index Writer
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxWriter	TokenNameIdentifier	 tax Writer
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
.	TokenNameDOT	
refresh	TokenNameIdentifier	 refresh
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IndexReader	TokenNameIdentifier	 Index Reader
r2	TokenNameIdentifier	 r2
=	TokenNameEQUAL	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
.	TokenNameDOT	
reopen	TokenNameIdentifier	 reopen
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Hold on to the 'original' reader so we can do some checks with it 	TokenNameCOMMENT_LINE	Hold on to the 'original' reader so we can do some checks with it 
IndexReader	TokenNameIdentifier	 Index Reader
origReader	TokenNameIdentifier	 orig Reader
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
"Reader must be updated!"	TokenNameStringLiteral	Reader must be updated!
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
!=	TokenNameNOT_EQUAL	
r2	TokenNameIdentifier	 r2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Set the 'original' reader 	TokenNameCOMMENT_LINE	Set the 'original' reader 
origReader	TokenNameIdentifier	 orig Reader
=	TokenNameEQUAL	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
;	TokenNameSEMICOLON	
// Set the new master index Reader 	TokenNameCOMMENT_LINE	Set the new master index Reader 
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
=	TokenNameEQUAL	
r2	TokenNameIdentifier	 r2
;	TokenNameSEMICOLON	
// Try to get total-counts the originalReader AGAIN, just for sanity. Should pull from the cache - not recomputed. 	TokenNameCOMMENT_LINE	Try to get total-counts the originalReader AGAIN, just for sanity. Should pull from the cache - not recomputed. 
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
"Should be obtained from cache at 6th attempt"	TokenNameStringLiteral	Should be obtained from cache at 6th attempt
,	TokenNameCOMMA	
totalCounts	TokenNameIdentifier	 total Counts
==	TokenNameEQUAL_EQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
origReader	TokenNameIdentifier	 orig Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// now use the new reader - should recompute 	TokenNameCOMMENT_LINE	now use the new reader - should recompute 
totalCounts	TokenNameIdentifier	 total Counts
=	TokenNameEQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
prevGen	TokenNameIdentifier	 prev Gen
=	TokenNameEQUAL	
assertRecomputed	TokenNameIdentifier	 assert Recomputed
(	TokenNameLPAREN	
totalCounts	TokenNameIdentifier	 total Counts
,	TokenNameCOMMA	
prevGen	TokenNameIdentifier	 prev Gen
,	TokenNameCOMMA	
"after updating the index - 7th attempt!"	TokenNameStringLiteral	after updating the index - 7th attempt!
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// try again - should not recompute 	TokenNameCOMMENT_LINE	try again - should not recompute 
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
"Should be obtained from cache at 8th attempt"	TokenNameStringLiteral	Should be obtained from cache at 8th attempt
,	TokenNameCOMMA	
totalCounts	TokenNameIdentifier	 total Counts
==	TokenNameEQUAL_EQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// delete a doc from the reader and commit - should recompute 	TokenNameCOMMENT_LINE	delete a doc from the reader and commit - should recompute 
origReader	TokenNameIdentifier	 orig Reader
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
origReader	TokenNameIdentifier	 orig Reader
=	TokenNameEQUAL	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
;	TokenNameSEMICOLON	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
=	TokenNameEQUAL	
IndexReader	TokenNameIdentifier	 Index Reader
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
origReader	TokenNameIdentifier	 orig Reader
.	TokenNameDOT	
directory	TokenNameIdentifier	 directory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
initCache	TokenNameIdentifier	 init Cache
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
totalCounts	TokenNameIdentifier	 total Counts
=	TokenNameEQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
prevGen	TokenNameIdentifier	 prev Gen
=	TokenNameEQUAL	
assertRecomputed	TokenNameIdentifier	 assert Recomputed
(	TokenNameLPAREN	
totalCounts	TokenNameIdentifier	 total Counts
,	TokenNameCOMMA	
prevGen	TokenNameIdentifier	 prev Gen
,	TokenNameCOMMA	
"after opening a writable reader - 9th attempt!"	TokenNameStringLiteral	after opening a writable reader - 9th attempt!
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// now do the delete 	TokenNameCOMMENT_LINE	now do the delete 
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
.	TokenNameDOT	
deleteDocument	TokenNameIdentifier	 delete Document
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
.	TokenNameDOT	
commit	TokenNameIdentifier	 commit
(	TokenNameLPAREN	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
totalCounts	TokenNameIdentifier	 total Counts
=	TokenNameEQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
prevGen	TokenNameIdentifier	 prev Gen
=	TokenNameEQUAL	
assertRecomputed	TokenNameIdentifier	 assert Recomputed
(	TokenNameLPAREN	
totalCounts	TokenNameIdentifier	 total Counts
,	TokenNameCOMMA	
prevGen	TokenNameIdentifier	 prev Gen
,	TokenNameCOMMA	
"after deleting docs the index - 10th attempt!"	TokenNameStringLiteral	after deleting docs the index - 10th attempt!
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
origReader	TokenNameIdentifier	 orig Reader
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
r2	TokenNameIdentifier	 r2
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
outputFile	TokenNameIdentifier	 output File
.	TokenNameDOT	
delete	TokenNameIdentifier	 delete
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IOUtils	TokenNameIdentifier	 IO Utils
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
dirs	TokenNameIdentifier	 dirs
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
int	TokenNameint	
assertReadFromDisc	TokenNameIdentifier	 assert Read From Disc
(	TokenNameLPAREN	
TotalFacetCounts	TokenNameIdentifier	 Total Facet Counts
totalCounts	TokenNameIdentifier	 total Counts
,	TokenNameCOMMA	
int	TokenNameint	
prevGen	TokenNameIdentifier	 prev Gen
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
errMsg	TokenNameIdentifier	 err Msg
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"should read from disk "	TokenNameStringLiteral	should read from disk 
+	TokenNamePLUS	
errMsg	TokenNameIdentifier	 err Msg
,	TokenNameCOMMA	
CreationType	TokenNameIdentifier	 Creation Type
.	TokenNameDOT	
Loaded	TokenNameIdentifier	 Loaded
,	TokenNameCOMMA	
totalCounts	TokenNameIdentifier	 total Counts
.	TokenNameDOT	
createType4test	TokenNameIdentifier	 create Type4test
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
int	TokenNameint	
gen4test	TokenNameIdentifier	 gen4test
=	TokenNameEQUAL	
totalCounts	TokenNameIdentifier	 total Counts
.	TokenNameDOT	
gen4test	TokenNameIdentifier	 gen4test
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
"should read from disk "	TokenNameStringLiteral	should read from disk 
+	TokenNamePLUS	
errMsg	TokenNameIdentifier	 err Msg
,	TokenNameCOMMA	
gen4test	TokenNameIdentifier	 gen4test
>	TokenNameGREATER	
prevGen	TokenNameIdentifier	 prev Gen
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
gen4test	TokenNameIdentifier	 gen4test
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
int	TokenNameint	
assertRecomputed	TokenNameIdentifier	 assert Recomputed
(	TokenNameLPAREN	
TotalFacetCounts	TokenNameIdentifier	 Total Facet Counts
totalCounts	TokenNameIdentifier	 total Counts
,	TokenNameCOMMA	
int	TokenNameint	
prevGen	TokenNameIdentifier	 prev Gen
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
errMsg	TokenNameIdentifier	 err Msg
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assertEquals	TokenNameIdentifier	 assert Equals
(	TokenNameLPAREN	
"should recompute "	TokenNameStringLiteral	should recompute 
+	TokenNamePLUS	
errMsg	TokenNameIdentifier	 err Msg
,	TokenNameCOMMA	
CreationType	TokenNameIdentifier	 Creation Type
.	TokenNameDOT	
Computed	TokenNameIdentifier	 Computed
,	TokenNameCOMMA	
totalCounts	TokenNameIdentifier	 total Counts
.	TokenNameDOT	
createType4test	TokenNameIdentifier	 create Type4test
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
int	TokenNameint	
gen4test	TokenNameIdentifier	 gen4test
=	TokenNameEQUAL	
totalCounts	TokenNameIdentifier	 total Counts
.	TokenNameDOT	
gen4test	TokenNameIdentifier	 gen4test
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
"should recompute "	TokenNameStringLiteral	should recompute 
+	TokenNamePLUS	
errMsg	TokenNameIdentifier	 err Msg
,	TokenNameCOMMA	
gen4test	TokenNameIdentifier	 gen4test
>	TokenNameGREATER	
prevGen	TokenNameIdentifier	 prev Gen
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
gen4test	TokenNameIdentifier	 gen4test
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * This test is to address a bug in a previous version. If a TFC cache is * written to disk, and then the taxonomy grows (but the index does not change), * and then the TFC cache is re-read from disk, there will be an exception * thrown, as the integers are read off of the disk according to taxonomy * size, which has changed. */	TokenNameCOMMENT_JAVADOC	 This test is to address a bug in a previous version. If a TFC cache is written to disk, and then the taxonomy grows (but the index does not change), and then the TFC cache is re-read from disk, there will be an exception thrown, as the integers are read off of the disk according to taxonomy size, which has changed. 
@	TokenNameAT	
Test	TokenNameIdentifier	 Test
public	TokenNamepublic	
void	TokenNamevoid	
testGrowingTaxonomy	TokenNameIdentifier	 test Growing Taxonomy
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
// Create temporary RAMDirectories 	TokenNameCOMMENT_LINE	Create temporary RAMDirectories 
Directory	TokenNameIdentifier	 Directory
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
dirs	TokenNameIdentifier	 dirs
=	TokenNameEQUAL	
FacetTestUtils	TokenNameIdentifier	 Facet Test Utils
.	TokenNameDOT	
createIndexTaxonomyDirs	TokenNameIdentifier	 create Index Taxonomy Dirs
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Create our index/taxonomy writers 	TokenNameCOMMENT_LINE	Create our index/taxonomy writers 
IndexTaxonomyWriterPair	TokenNameIdentifier	 Index Taxonomy Writer Pair
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
writers	TokenNameIdentifier	 writers
=	TokenNameEQUAL	
FacetTestUtils	TokenNameIdentifier	 Facet Test Utils
.	TokenNameDOT	
createIndexTaxonomyWriterPair	TokenNameIdentifier	 create Index Taxonomy Writer Pair
(	TokenNameLPAREN	
dirs	TokenNameIdentifier	 dirs
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
DefaultFacetIndexingParams	TokenNameIdentifier	 Default Facet Indexing Params
iParams	TokenNameIdentifier	 i Params
=	TokenNameEQUAL	
new	TokenNamenew	
DefaultFacetIndexingParams	TokenNameIdentifier	 Default Facet Indexing Params
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
protected	TokenNameprotected	
int	TokenNameint	
fixedPartitionSize	TokenNameIdentifier	 fixed Partition Size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
2	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
// Add a facet to the index 	TokenNameCOMMENT_LINE	Add a facet to the index 
addFacets	TokenNameIdentifier	 add Facets
(	TokenNameLPAREN	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexWriter	TokenNameIdentifier	 index Writer
,	TokenNameCOMMA	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxWriter	TokenNameIdentifier	 tax Writer
,	TokenNameCOMMA	
"a"	TokenNameStringLiteral	a
,	TokenNameCOMMA	
"b"	TokenNameStringLiteral	b
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Commit Changes 	TokenNameCOMMENT_LINE	Commit Changes 
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexWriter	TokenNameIdentifier	 index Writer
.	TokenNameDOT	
commit	TokenNameIdentifier	 commit
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxWriter	TokenNameIdentifier	 tax Writer
.	TokenNameDOT	
commit	TokenNameIdentifier	 commit
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IndexTaxonomyReaderPair	TokenNameIdentifier	 Index Taxonomy Reader Pair
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
readers	TokenNameIdentifier	 readers
=	TokenNameEQUAL	
FacetTestUtils	TokenNameIdentifier	 Facet Test Utils
.	TokenNameDOT	
createIndexTaxonomyReaderPair	TokenNameIdentifier	 create Index Taxonomy Reader Pair
(	TokenNameLPAREN	
dirs	TokenNameIdentifier	 dirs
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Create TFC and write cache to disk 	TokenNameCOMMENT_LINE	Create TFC and write cache to disk 
File	TokenNameIdentifier	 File
outputFile	TokenNameIdentifier	 output File
=	TokenNameEQUAL	
_TestUtil	TokenNameIdentifier	 Test Util
.	TokenNameDOT	
createTempFile	TokenNameIdentifier	 create Temp File
(	TokenNameLPAREN	
"test"	TokenNameStringLiteral	test
,	TokenNameCOMMA	
"tmp"	TokenNameStringLiteral	tmp
,	TokenNameCOMMA	
TEMP_DIR	TokenNameIdentifier	 TEMP  DIR
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
store	TokenNameIdentifier	 store
(	TokenNameLPAREN	
outputFile	TokenNameIdentifier	 output File
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Make the taxonomy grow without touching the index 	TokenNameCOMMENT_LINE	Make the taxonomy grow without touching the index 
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
10	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxWriter	TokenNameIdentifier	 tax Writer
.	TokenNameDOT	
addCategory	TokenNameIdentifier	 add Category
(	TokenNameLPAREN	
new	TokenNamenew	
CategoryPath	TokenNameIdentifier	 Category Path
(	TokenNameLPAREN	
"foo"	TokenNameStringLiteral	foo
,	TokenNameCOMMA	
Integer	TokenNameIdentifier	 Integer
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxWriter	TokenNameIdentifier	 tax Writer
.	TokenNameDOT	
commit	TokenNameIdentifier	 commit
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
.	TokenNameDOT	
refresh	TokenNameIdentifier	 refresh
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
initCache	TokenNameIdentifier	 init Cache
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// With the bug, this next call should result in an exception 	TokenNameCOMMENT_LINE	With the bug, this next call should result in an exception 
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
load	TokenNameIdentifier	 load
(	TokenNameLPAREN	
outputFile	TokenNameIdentifier	 output File
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
TotalFacetCounts	TokenNameIdentifier	 Total Facet Counts
totalCounts	TokenNameIdentifier	 total Counts
=	TokenNameEQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertReadFromDisc	TokenNameIdentifier	 assert Read From Disc
(	TokenNameLPAREN	
totalCounts	TokenNameIdentifier	 total Counts
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
"after reading from disk."	TokenNameStringLiteral	after reading from disk.
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
outputFile	TokenNameIdentifier	 output File
.	TokenNameDOT	
delete	TokenNameIdentifier	 delete
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IOUtils	TokenNameIdentifier	 IO Utils
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
dirs	TokenNameIdentifier	 dirs
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Test that a new TFC is only calculated and placed in memory (by two * threads who want it at the same time) only once. */	TokenNameCOMMENT_JAVADOC	 Test that a new TFC is only calculated and placed in memory (by two threads who want it at the same time) only once. 
@	TokenNameAT	
Test	TokenNameIdentifier	 Test
public	TokenNamepublic	
void	TokenNamevoid	
testMemoryCacheSynchronization	TokenNameIdentifier	 test Memory Cache Synchronization
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
SlowRAMDirectory	TokenNameIdentifier	 Slow RAM Directory
indexDir	TokenNameIdentifier	 index Dir
=	TokenNameEQUAL	
new	TokenNamenew	
SlowRAMDirectory	TokenNameIdentifier	 Slow RAM Directory
(	TokenNameLPAREN	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
SlowRAMDirectory	TokenNameIdentifier	 Slow RAM Directory
taxoDir	TokenNameIdentifier	 taxo Dir
=	TokenNameEQUAL	
new	TokenNamenew	
SlowRAMDirectory	TokenNameIdentifier	 Slow RAM Directory
(	TokenNameLPAREN	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Write index using 'normal' directories 	TokenNameCOMMENT_LINE	Write index using 'normal' directories 
IndexWriter	TokenNameIdentifier	 Index Writer
w	TokenNameIdentifier	 w
=	TokenNameEQUAL	
new	TokenNamenew	
IndexWriter	TokenNameIdentifier	 Index Writer
(	TokenNameLPAREN	
indexDir	TokenNameIdentifier	 index Dir
,	TokenNameCOMMA	
new	TokenNamenew	
IndexWriterConfig	TokenNameIdentifier	 Index Writer Config
(	TokenNameLPAREN	
TEST_VERSION_CURRENT	TokenNameIdentifier	 TEST  VERSION  CURRENT
,	TokenNameCOMMA	
new	TokenNamenew	
MockAnalyzer	TokenNameIdentifier	 Mock Analyzer
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
,	TokenNameCOMMA	
MockTokenizer	TokenNameIdentifier	 Mock Tokenizer
.	TokenNameDOT	
WHITESPACE	TokenNameIdentifier	 WHITESPACE
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
DirectoryTaxonomyWriter	TokenNameIdentifier	 Directory Taxonomy Writer
tw	TokenNameIdentifier	 tw
=	TokenNameEQUAL	
new	TokenNamenew	
DirectoryTaxonomyWriter	TokenNameIdentifier	 Directory Taxonomy Writer
(	TokenNameLPAREN	
taxoDir	TokenNameIdentifier	 taxo Dir
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
DefaultFacetIndexingParams	TokenNameIdentifier	 Default Facet Indexing Params
iParams	TokenNameIdentifier	 i Params
=	TokenNameEQUAL	
new	TokenNamenew	
DefaultFacetIndexingParams	TokenNameIdentifier	 Default Facet Indexing Params
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Add documents and facets 	TokenNameCOMMENT_LINE	Add documents and facets 
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
1000	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
addFacets	TokenNameIdentifier	 add Facets
(	TokenNameLPAREN	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
w	TokenNameIdentifier	 w
,	TokenNameCOMMA	
tw	TokenNameIdentifier	 tw
,	TokenNameCOMMA	
"facet"	TokenNameStringLiteral	facet
,	TokenNameCOMMA	
Integer	TokenNameIdentifier	 Integer
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
w	TokenNameIdentifier	 w
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
tw	TokenNameIdentifier	 tw
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
indexDir	TokenNameIdentifier	 index Dir
.	TokenNameDOT	
setSleepMillis	TokenNameIdentifier	 set Sleep Millis
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
taxoDir	TokenNameIdentifier	 taxo Dir
.	TokenNameDOT	
setSleepMillis	TokenNameIdentifier	 set Sleep Millis
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IndexReader	TokenNameIdentifier	 Index Reader
r	TokenNameIdentifier	 r
=	TokenNameEQUAL	
IndexReader	TokenNameIdentifier	 Index Reader
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
indexDir	TokenNameIdentifier	 index Dir
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
DirectoryTaxonomyReader	TokenNameIdentifier	 Directory Taxonomy Reader
tr	TokenNameIdentifier	 tr
=	TokenNameEQUAL	
new	TokenNamenew	
DirectoryTaxonomyReader	TokenNameIdentifier	 Directory Taxonomy Reader
(	TokenNameLPAREN	
taxoDir	TokenNameIdentifier	 taxo Dir
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Create and start threads. Thread1 should lock the cache and calculate 	TokenNameCOMMENT_LINE	Create and start threads. Thread1 should lock the cache and calculate 
// the TFC array. The second thread should block until the first is 	TokenNameCOMMENT_LINE	the TFC array. The second thread should block until the first is 
// done, then successfully retrieve from the cache without recalculating 	TokenNameCOMMENT_LINE	done, then successfully retrieve from the cache without recalculating 
// or reading from disk. 	TokenNameCOMMENT_LINE	or reading from disk. 
TFCThread	TokenNameIdentifier	 TFC Thread
tfcCalc1	TokenNameIdentifier	 tfc Calc1
=	TokenNameEQUAL	
new	TokenNamenew	
TFCThread	TokenNameIdentifier	 TFC Thread
(	TokenNameLPAREN	
r	TokenNameIdentifier	 r
,	TokenNameCOMMA	
tr	TokenNameIdentifier	 tr
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
TFCThread	TokenNameIdentifier	 TFC Thread
tfcCalc2	TokenNameIdentifier	 tfc Calc2
=	TokenNameEQUAL	
new	TokenNamenew	
TFCThread	TokenNameIdentifier	 TFC Thread
(	TokenNameLPAREN	
r	TokenNameIdentifier	 r
,	TokenNameCOMMA	
tr	TokenNameIdentifier	 tr
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
tfcCalc1	TokenNameIdentifier	 tfc Calc1
.	TokenNameDOT	
start	TokenNameIdentifier	 start
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Give thread 1 a head start to ensure correct sequencing for testing 	TokenNameCOMMENT_LINE	Give thread 1 a head start to ensure correct sequencing for testing 
Thread	TokenNameIdentifier	 Thread
.	TokenNameDOT	
sleep	TokenNameIdentifier	 sleep
(	TokenNameLPAREN	
5	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
tfcCalc2	TokenNameIdentifier	 tfc Calc2
.	TokenNameDOT	
start	TokenNameIdentifier	 start
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
tfcCalc1	TokenNameIdentifier	 tfc Calc1
.	TokenNameDOT	
join	TokenNameIdentifier	 join
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
tfcCalc2	TokenNameIdentifier	 tfc Calc2
.	TokenNameDOT	
join	TokenNameIdentifier	 join
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Since this test ends up with references to the same TFC object, we 	TokenNameCOMMENT_LINE	Since this test ends up with references to the same TFC object, we 
// can only test the times to make sure that they are the same. 	TokenNameCOMMENT_LINE	can only test the times to make sure that they are the same. 
assertRecomputed	TokenNameIdentifier	 assert Recomputed
(	TokenNameLPAREN	
tfcCalc1	TokenNameIdentifier	 tfc Calc1
.	TokenNameDOT	
tfc	TokenNameIdentifier	 tfc
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
"thread 1 should recompute"	TokenNameStringLiteral	thread 1 should recompute
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertRecomputed	TokenNameIdentifier	 assert Recomputed
(	TokenNameLPAREN	
tfcCalc2	TokenNameIdentifier	 tfc Calc2
.	TokenNameDOT	
tfc	TokenNameIdentifier	 tfc
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
"thread 2 should recompute"	TokenNameStringLiteral	thread 2 should recompute
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
"Both results should be the same (as their inputs are the same objects)"	TokenNameStringLiteral	Both results should be the same (as their inputs are the same objects)
,	TokenNameCOMMA	
tfcCalc1	TokenNameIdentifier	 tfc Calc1
.	TokenNameDOT	
tfc	TokenNameIdentifier	 tfc
==	TokenNameEQUAL_EQUAL	
tfcCalc2	TokenNameIdentifier	 tfc Calc2
.	TokenNameDOT	
tfc	TokenNameIdentifier	 tfc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
r	TokenNameIdentifier	 r
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
tr	TokenNameIdentifier	 tr
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Simple test to make sure the TotalFacetCountsManager updates the * TotalFacetCounts array only when it is supposed to, and whether it * is recomputed or read from disk, but this time with TWO different * TotalFacetCounts */	TokenNameCOMMENT_JAVADOC	 Simple test to make sure the TotalFacetCountsManager updates the TotalFacetCounts array only when it is supposed to, and whether it is recomputed or read from disk, but this time with TWO different TotalFacetCounts 
@	TokenNameAT	
Test	TokenNameIdentifier	 Test
public	TokenNamepublic	
void	TokenNamevoid	
testMultipleIndices	TokenNameIdentifier	 test Multiple Indices
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
// Create temporary RAMDirectories 	TokenNameCOMMENT_LINE	Create temporary RAMDirectories 
Directory	TokenNameIdentifier	 Directory
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
dirs	TokenNameIdentifier	 dirs
=	TokenNameEQUAL	
FacetTestUtils	TokenNameIdentifier	 Facet Test Utils
.	TokenNameDOT	
createIndexTaxonomyDirs	TokenNameIdentifier	 create Index Taxonomy Dirs
(	TokenNameLPAREN	
2	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Create our index/taxonomy writers 	TokenNameCOMMENT_LINE	Create our index/taxonomy writers 
IndexTaxonomyWriterPair	TokenNameIdentifier	 Index Taxonomy Writer Pair
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
writers	TokenNameIdentifier	 writers
=	TokenNameEQUAL	
FacetTestUtils	TokenNameIdentifier	 Facet Test Utils
.	TokenNameDOT	
createIndexTaxonomyWriterPair	TokenNameIdentifier	 create Index Taxonomy Writer Pair
(	TokenNameLPAREN	
dirs	TokenNameIdentifier	 dirs
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
DefaultFacetIndexingParams	TokenNameIdentifier	 Default Facet Indexing Params
iParams	TokenNameIdentifier	 i Params
=	TokenNameEQUAL	
new	TokenNamenew	
DefaultFacetIndexingParams	TokenNameIdentifier	 Default Facet Indexing Params
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Add a facet to the index 	TokenNameCOMMENT_LINE	Add a facet to the index 
addFacets	TokenNameIdentifier	 add Facets
(	TokenNameLPAREN	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexWriter	TokenNameIdentifier	 index Writer
,	TokenNameCOMMA	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxWriter	TokenNameIdentifier	 tax Writer
,	TokenNameCOMMA	
"a"	TokenNameStringLiteral	a
,	TokenNameCOMMA	
"b"	TokenNameStringLiteral	b
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addFacets	TokenNameIdentifier	 add Facets
(	TokenNameLPAREN	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexWriter	TokenNameIdentifier	 index Writer
,	TokenNameCOMMA	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxWriter	TokenNameIdentifier	 tax Writer
,	TokenNameCOMMA	
"d"	TokenNameStringLiteral	d
,	TokenNameCOMMA	
"e"	TokenNameStringLiteral	e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Commit Changes 	TokenNameCOMMENT_LINE	Commit Changes 
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexWriter	TokenNameIdentifier	 index Writer
.	TokenNameDOT	
commit	TokenNameIdentifier	 commit
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxWriter	TokenNameIdentifier	 tax Writer
.	TokenNameDOT	
commit	TokenNameIdentifier	 commit
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexWriter	TokenNameIdentifier	 index Writer
.	TokenNameDOT	
commit	TokenNameIdentifier	 commit
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxWriter	TokenNameIdentifier	 tax Writer
.	TokenNameDOT	
commit	TokenNameIdentifier	 commit
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Open two readers 	TokenNameCOMMENT_LINE	Open two readers 
IndexTaxonomyReaderPair	TokenNameIdentifier	 Index Taxonomy Reader Pair
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
readers	TokenNameIdentifier	 readers
=	TokenNameEQUAL	
FacetTestUtils	TokenNameIdentifier	 Facet Test Utils
.	TokenNameDOT	
createIndexTaxonomyReaderPair	TokenNameIdentifier	 create Index Taxonomy Reader Pair
(	TokenNameLPAREN	
dirs	TokenNameIdentifier	 dirs
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// As this is the first time we have invoked the TotalFacetCountsManager, we 	TokenNameCOMMENT_LINE	As this is the first time we have invoked the TotalFacetCountsManager, we 
// should expect to compute. 	TokenNameCOMMENT_LINE	should expect to compute. 
TotalFacetCounts	TokenNameIdentifier	 Total Facet Counts
totalCounts0	TokenNameIdentifier	 total Counts0
=	TokenNameEQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
int	TokenNameint	
prevGen	TokenNameIdentifier	 prev Gen
=	TokenNameEQUAL	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
prevGen	TokenNameIdentifier	 prev Gen
=	TokenNameEQUAL	
assertRecomputed	TokenNameIdentifier	 assert Recomputed
(	TokenNameLPAREN	
totalCounts0	TokenNameIdentifier	 total Counts0
,	TokenNameCOMMA	
prevGen	TokenNameIdentifier	 prev Gen
,	TokenNameCOMMA	
"after attempt 1"	TokenNameStringLiteral	after attempt 1
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
"attempt 1b for same input [0] shout find it in cache"	TokenNameStringLiteral	attempt 1b for same input [0] shout find it in cache
,	TokenNameCOMMA	
totalCounts0	TokenNameIdentifier	 total Counts0
==	TokenNameEQUAL_EQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// 2nd Reader - As this is the first time we have invoked the 	TokenNameCOMMENT_LINE	2nd Reader - As this is the first time we have invoked the 
// TotalFacetCountsManager, we should expect a state of NEW to be returned. 	TokenNameCOMMENT_LINE	TotalFacetCountsManager, we should expect a state of NEW to be returned. 
TotalFacetCounts	TokenNameIdentifier	 Total Facet Counts
totalCounts1	TokenNameIdentifier	 total Counts1
=	TokenNameEQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
prevGen	TokenNameIdentifier	 prev Gen
=	TokenNameEQUAL	
assertRecomputed	TokenNameIdentifier	 assert Recomputed
(	TokenNameLPAREN	
totalCounts1	TokenNameIdentifier	 total Counts1
,	TokenNameCOMMA	
prevGen	TokenNameIdentifier	 prev Gen
,	TokenNameCOMMA	
"after attempt 2"	TokenNameStringLiteral	after attempt 2
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
"attempt 2b for same input [1] shout find it in cache"	TokenNameStringLiteral	attempt 2b for same input [1] shout find it in cache
,	TokenNameCOMMA	
totalCounts1	TokenNameIdentifier	 total Counts1
==	TokenNameEQUAL_EQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Right now cache size is one, so first TFC is gone and should be recomputed 	TokenNameCOMMENT_LINE	Right now cache size is one, so first TFC is gone and should be recomputed 
totalCounts0	TokenNameIdentifier	 total Counts0
=	TokenNameEQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
prevGen	TokenNameIdentifier	 prev Gen
=	TokenNameEQUAL	
assertRecomputed	TokenNameIdentifier	 assert Recomputed
(	TokenNameLPAREN	
totalCounts0	TokenNameIdentifier	 total Counts0
,	TokenNameCOMMA	
prevGen	TokenNameIdentifier	 prev Gen
,	TokenNameCOMMA	
"after attempt 3"	TokenNameStringLiteral	after attempt 3
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Similarly will recompute the second result 	TokenNameCOMMENT_LINE	Similarly will recompute the second result 
totalCounts1	TokenNameIdentifier	 total Counts1
=	TokenNameEQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
prevGen	TokenNameIdentifier	 prev Gen
=	TokenNameEQUAL	
assertRecomputed	TokenNameIdentifier	 assert Recomputed
(	TokenNameLPAREN	
totalCounts1	TokenNameIdentifier	 total Counts1
,	TokenNameCOMMA	
prevGen	TokenNameIdentifier	 prev Gen
,	TokenNameCOMMA	
"after attempt 4"	TokenNameStringLiteral	after attempt 4
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Now we set the cache size to two, meaning both should exist in the 	TokenNameCOMMENT_LINE	Now we set the cache size to two, meaning both should exist in the 
// cache simultaneously 	TokenNameCOMMENT_LINE	cache simultaneously 
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
setCacheSize	TokenNameIdentifier	 set Cache Size
(	TokenNameLPAREN	
2	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Re-compute totalCounts0 (was evicted from the cache when the cache was smaller) 	TokenNameCOMMENT_LINE	Re-compute totalCounts0 (was evicted from the cache when the cache was smaller) 
totalCounts0	TokenNameIdentifier	 total Counts0
=	TokenNameEQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
prevGen	TokenNameIdentifier	 prev Gen
=	TokenNameEQUAL	
assertRecomputed	TokenNameIdentifier	 assert Recomputed
(	TokenNameLPAREN	
totalCounts0	TokenNameIdentifier	 total Counts0
,	TokenNameCOMMA	
prevGen	TokenNameIdentifier	 prev Gen
,	TokenNameCOMMA	
"after attempt 5"	TokenNameStringLiteral	after attempt 5
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// now both are in the larger cache and should not be recomputed 	TokenNameCOMMENT_LINE	now both are in the larger cache and should not be recomputed 
totalCounts1	TokenNameIdentifier	 total Counts1
=	TokenNameEQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
"with cache of size 2 res no. 0 should come from cache"	TokenNameStringLiteral	with cache of size 2 res no. 0 should come from cache
,	TokenNameCOMMA	
totalCounts0	TokenNameIdentifier	 total Counts0
==	TokenNameEQUAL_EQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
"with cache of size 2 res no. 1 should come from cache"	TokenNameStringLiteral	with cache of size 2 res no. 1 should come from cache
,	TokenNameCOMMA	
totalCounts1	TokenNameIdentifier	 total Counts1
==	TokenNameEQUAL_EQUAL	
TFC	TokenNameIdentifier	 TFC
.	TokenNameDOT	
getTotalCounts	TokenNameIdentifier	 get Total Counts
(	TokenNameLPAREN	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
taxReader	TokenNameIdentifier	 tax Reader
,	TokenNameCOMMA	
iParams	TokenNameIdentifier	 i Params
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
writers	TokenNameIdentifier	 writers
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
0	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
readers	TokenNameIdentifier	 readers
[	TokenNameLBRACKET	
1	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
Directory	TokenNameIdentifier	 Directory
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
dirset	TokenNameIdentifier	 dirset
:	TokenNameCOLON	
dirs	TokenNameIdentifier	 dirs
)	TokenNameRPAREN	
{	TokenNameLBRACE	
IOUtils	TokenNameIdentifier	 IO Utils
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
dirset	TokenNameIdentifier	 dirset
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
