package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
maven	TokenNameIdentifier	 maven
.	TokenNameDOT	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
legacy	TokenNameIdentifier	 legacy
;	TokenNameSEMICOLON	
/* * Licensed to the Apache Software Foundation (ASF) under one * or more contributor license agreements. See the NOTICE file * distributed with this work for additional information * regarding copyright ownership. The ASF licenses this file * to you under the Apache License, Version 2.0 (the * "License"); you may not use this file except in compliance * with the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, * software distributed under the License is distributed on an * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY * KIND, either express or implied. See the License for the * specific language governing permissions and limitations * under the License. */	TokenNameCOMMENT_BLOCK	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
File	TokenNameIdentifier	 File
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
IOException	TokenNameIdentifier	 IO Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
security	TokenNameIdentifier	 security
.	TokenNameDOT	
NoSuchAlgorithmException	TokenNameIdentifier	 No Such Algorithm Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
ArrayList	TokenNameIdentifier	 Array List
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
HashMap	TokenNameIdentifier	 Hash Map
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
List	TokenNameIdentifier	 List
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
Map	TokenNameIdentifier	 Map
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
maven	TokenNameIdentifier	 maven
.	TokenNameDOT	
artifact	TokenNameIdentifier	 artifact
.	TokenNameDOT	
Artifact	TokenNameIdentifier	 Artifact
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
maven	TokenNameIdentifier	 maven
.	TokenNameDOT	
artifact	TokenNameIdentifier	 artifact
.	TokenNameDOT	
metadata	TokenNameIdentifier	 metadata
.	TokenNameDOT	
ArtifactMetadata	TokenNameIdentifier	 Artifact Metadata
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
maven	TokenNameIdentifier	 maven
.	TokenNameDOT	
artifact	TokenNameIdentifier	 artifact
.	TokenNameDOT	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
ArtifactRepository	TokenNameIdentifier	 Artifact Repository
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
maven	TokenNameIdentifier	 maven
.	TokenNameDOT	
artifact	TokenNameIdentifier	 artifact
.	TokenNameDOT	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
ArtifactRepositoryPolicy	TokenNameIdentifier	 Artifact Repository Policy
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
maven	TokenNameIdentifier	 maven
.	TokenNameDOT	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
ConnectionException	TokenNameIdentifier	 Connection Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
maven	TokenNameIdentifier	 maven
.	TokenNameDOT	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
ResourceDoesNotExistException	TokenNameIdentifier	 Resource Does Not Exist Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
maven	TokenNameIdentifier	 maven
.	TokenNameDOT	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
maven	TokenNameIdentifier	 maven
.	TokenNameDOT	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
UnsupportedProtocolException	TokenNameIdentifier	 Unsupported Protocol Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
maven	TokenNameIdentifier	 maven
.	TokenNameDOT	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
Wagon	TokenNameIdentifier	 Wagon
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
maven	TokenNameIdentifier	 maven
.	TokenNameDOT	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
authentication	TokenNameIdentifier	 authentication
.	TokenNameDOT	
AuthenticationException	TokenNameIdentifier	 Authentication Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
maven	TokenNameIdentifier	 maven
.	TokenNameDOT	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
authentication	TokenNameIdentifier	 authentication
.	TokenNameDOT	
AuthenticationInfo	TokenNameIdentifier	 Authentication Info
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
maven	TokenNameIdentifier	 maven
.	TokenNameDOT	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
authorization	TokenNameIdentifier	 authorization
.	TokenNameDOT	
AuthorizationException	TokenNameIdentifier	 Authorization Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
maven	TokenNameIdentifier	 maven
.	TokenNameDOT	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
events	TokenNameIdentifier	 events
.	TokenNameDOT	
TransferListener	TokenNameIdentifier	 Transfer Listener
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
maven	TokenNameIdentifier	 maven
.	TokenNameDOT	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
observers	TokenNameIdentifier	 observers
.	TokenNameDOT	
ChecksumObserver	TokenNameIdentifier	 Checksum Observer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
maven	TokenNameIdentifier	 maven
.	TokenNameDOT	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
proxy	TokenNameIdentifier	 proxy
.	TokenNameDOT	
ProxyInfo	TokenNameIdentifier	 Proxy Info
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
maven	TokenNameIdentifier	 maven
.	TokenNameDOT	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
Repository	TokenNameIdentifier	 Repository
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
codehaus	TokenNameIdentifier	 codehaus
.	TokenNameDOT	
plexus	TokenNameIdentifier	 plexus
.	TokenNameDOT	
PlexusContainer	TokenNameIdentifier	 Plexus Container
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
codehaus	TokenNameIdentifier	 codehaus
.	TokenNameDOT	
plexus	TokenNameIdentifier	 plexus
.	TokenNameDOT	
component	TokenNameIdentifier	 component
.	TokenNameDOT	
annotations	TokenNameIdentifier	 annotations
.	TokenNameDOT	
Component	TokenNameIdentifier	 Component
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
codehaus	TokenNameIdentifier	 codehaus
.	TokenNameDOT	
plexus	TokenNameIdentifier	 plexus
.	TokenNameDOT	
component	TokenNameIdentifier	 component
.	TokenNameDOT	
annotations	TokenNameIdentifier	 annotations
.	TokenNameDOT	
Requirement	TokenNameIdentifier	 Requirement
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
codehaus	TokenNameIdentifier	 codehaus
.	TokenNameDOT	
plexus	TokenNameIdentifier	 plexus
.	TokenNameDOT	
component	TokenNameIdentifier	 component
.	TokenNameDOT	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
exception	TokenNameIdentifier	 exception
.	TokenNameDOT	
ComponentLifecycleException	TokenNameIdentifier	 Component Lifecycle Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
codehaus	TokenNameIdentifier	 codehaus
.	TokenNameDOT	
plexus	TokenNameIdentifier	 plexus
.	TokenNameDOT	
component	TokenNameIdentifier	 component
.	TokenNameDOT	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
exception	TokenNameIdentifier	 exception
.	TokenNameDOT	
ComponentLookupException	TokenNameIdentifier	 Component Lookup Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
codehaus	TokenNameIdentifier	 codehaus
.	TokenNameDOT	
plexus	TokenNameIdentifier	 plexus
.	TokenNameDOT	
logging	TokenNameIdentifier	 logging
.	TokenNameDOT	
Logger	TokenNameIdentifier	 Logger
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
codehaus	TokenNameIdentifier	 codehaus
.	TokenNameDOT	
plexus	TokenNameIdentifier	 plexus
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
FileUtils	TokenNameIdentifier	 File Utils
;	TokenNameSEMICOLON	
//TODO: remove the update check manager 	TokenNameCOMMENT_LINE	TODO: remove the update check manager 
//TODO: separate into retriever and publisher 	TokenNameCOMMENT_LINE	TODO: separate into retriever and publisher 
//TODO: remove hardcoding of checksum logic 	TokenNameCOMMENT_LINE	TODO: remove hardcoding of checksum logic 
@	TokenNameAT	
Component	TokenNameIdentifier	 Component
(	TokenNameLPAREN	
role	TokenNameIdentifier	 role
=	TokenNameEQUAL	
WagonManager	TokenNameIdentifier	 Wagon Manager
.	TokenNameDOT	
class	TokenNameclass	
)	TokenNameRPAREN	
public	TokenNamepublic	
class	TokenNameclass	
DefaultWagonManager	TokenNameIdentifier	 Default Wagon Manager
implements	TokenNameimplements	
WagonManager	TokenNameIdentifier	 Wagon Manager
{	TokenNameLBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
CHECKSUM_IDS	TokenNameIdentifier	 CHECKSUM  IDS
=	TokenNameEQUAL	
{	TokenNameLBRACE	
"md5"	TokenNameStringLiteral	md5
,	TokenNameCOMMA	
"sha1"	TokenNameStringLiteral	sha1
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
/** have to match the CHECKSUM_IDS */	TokenNameCOMMENT_JAVADOC	 have to match the CHECKSUM_IDS 
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
CHECKSUM_ALGORITHMS	TokenNameIdentifier	 CHECKSUM  ALGORITHMS
=	TokenNameEQUAL	
{	TokenNameLBRACE	
"MD5"	TokenNameStringLiteral	MD5
,	TokenNameCOMMA	
"SHA-1"	TokenNameStringLiteral	SHA-1
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
@	TokenNameAT	
Requirement	TokenNameIdentifier	 Requirement
private	TokenNameprivate	
Logger	TokenNameIdentifier	 Logger
logger	TokenNameIdentifier	 logger
;	TokenNameSEMICOLON	
@	TokenNameAT	
Requirement	TokenNameIdentifier	 Requirement
private	TokenNameprivate	
PlexusContainer	TokenNameIdentifier	 Plexus Container
container	TokenNameIdentifier	 container
;	TokenNameSEMICOLON	
@	TokenNameAT	
Requirement	TokenNameIdentifier	 Requirement
private	TokenNameprivate	
UpdateCheckManager	TokenNameIdentifier	 Update Check Manager
updateCheckManager	TokenNameIdentifier	 update Check Manager
;	TokenNameSEMICOLON	
// 	TokenNameCOMMENT_LINE	 
// Retriever 	TokenNameCOMMENT_LINE	Retriever 
// 	TokenNameCOMMENT_LINE	 
public	TokenNamepublic	
void	TokenNamevoid	
getArtifact	TokenNameIdentifier	 get Artifact
(	TokenNameLPAREN	
Artifact	TokenNameIdentifier	 Artifact
artifact	TokenNameIdentifier	 artifact
,	TokenNameCOMMA	
ArtifactRepository	TokenNameIdentifier	 Artifact Repository
repository	TokenNameIdentifier	 repository
,	TokenNameCOMMA	
TransferListener	TokenNameIdentifier	 Transfer Listener
downloadMonitor	TokenNameIdentifier	 download Monitor
,	TokenNameCOMMA	
boolean	TokenNameboolean	
force	TokenNameIdentifier	 force
)	TokenNameRPAREN	
throws	TokenNamethrows	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
,	TokenNameCOMMA	
ResourceDoesNotExistException	TokenNameIdentifier	 Resource Does Not Exist Exception
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
remotePath	TokenNameIdentifier	 remote Path
=	TokenNameEQUAL	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
pathOf	TokenNameIdentifier	 path Of
(	TokenNameLPAREN	
artifact	TokenNameIdentifier	 artifact
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ArtifactRepositoryPolicy	TokenNameIdentifier	 Artifact Repository Policy
policy	TokenNameIdentifier	 policy
=	TokenNameEQUAL	
artifact	TokenNameIdentifier	 artifact
.	TokenNameDOT	
isSnapshot	TokenNameIdentifier	 is Snapshot
(	TokenNameLPAREN	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getSnapshots	TokenNameIdentifier	 get Snapshots
(	TokenNameLPAREN	
)	TokenNameRPAREN	
:	TokenNameCOLON	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getReleases	TokenNameIdentifier	 get Releases
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
policy	TokenNameIdentifier	 policy
.	TokenNameDOT	
isEnabled	TokenNameIdentifier	 is Enabled
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"Skipping disabled repository "	TokenNameStringLiteral	Skipping disabled repository 
+	TokenNamePLUS	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getId	TokenNameIdentifier	 get Id
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
" for resolution of "	TokenNameStringLiteral	 for resolution of 
+	TokenNamePLUS	
artifact	TokenNameIdentifier	 artifact
.	TokenNameDOT	
getId	TokenNameIdentifier	 get Id
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
artifact	TokenNameIdentifier	 artifact
.	TokenNameDOT	
isSnapshot	TokenNameIdentifier	 is Snapshot
(	TokenNameLPAREN	
)	TokenNameRPAREN	
||	TokenNameOR_OR	
!	TokenNameNOT	
artifact	TokenNameIdentifier	 artifact
.	TokenNameDOT	
getFile	TokenNameIdentifier	 get File
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
exists	TokenNameIdentifier	 exists
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
force	TokenNameIdentifier	 force
||	TokenNameOR_OR	
updateCheckManager	TokenNameIdentifier	 update Check Manager
.	TokenNameDOT	
isUpdateRequired	TokenNameIdentifier	 is Update Required
(	TokenNameLPAREN	
artifact	TokenNameIdentifier	 artifact
,	TokenNameCOMMA	
repository	TokenNameIdentifier	 repository
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"Trying repository "	TokenNameStringLiteral	Trying repository 
+	TokenNamePLUS	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getId	TokenNameIdentifier	 get Id
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
" for resolution of "	TokenNameStringLiteral	 for resolution of 
+	TokenNamePLUS	
artifact	TokenNameIdentifier	 artifact
.	TokenNameDOT	
getId	TokenNameIdentifier	 get Id
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
" from "	TokenNameStringLiteral	 from 
+	TokenNamePLUS	
remotePath	TokenNameIdentifier	 remote Path
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
getRemoteFile	TokenNameIdentifier	 get Remote File
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
,	TokenNameCOMMA	
artifact	TokenNameIdentifier	 artifact
.	TokenNameDOT	
getFile	TokenNameIdentifier	 get File
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
remotePath	TokenNameIdentifier	 remote Path
,	TokenNameCOMMA	
downloadMonitor	TokenNameIdentifier	 download Monitor
,	TokenNameCOMMA	
policy	TokenNameIdentifier	 policy
.	TokenNameDOT	
getChecksumPolicy	TokenNameIdentifier	 get Checksum Policy
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
updateCheckManager	TokenNameIdentifier	 update Check Manager
.	TokenNameDOT	
touch	TokenNameIdentifier	 touch
(	TokenNameLPAREN	
artifact	TokenNameIdentifier	 artifact
,	TokenNameCOMMA	
repository	TokenNameIdentifier	 repository
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
ResourceDoesNotExistException	TokenNameIdentifier	 Resource Does Not Exist Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
updateCheckManager	TokenNameIdentifier	 update Check Manager
.	TokenNameDOT	
touch	TokenNameIdentifier	 touch
(	TokenNameLPAREN	
artifact	TokenNameIdentifier	 artifact
,	TokenNameCOMMA	
repository	TokenNameIdentifier	 repository
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
throw	TokenNamethrow	
e	TokenNameIdentifier	 e
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
error	TokenNameIdentifier	 error
=	TokenNameEQUAL	
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
:	TokenNameCOLON	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getClass	TokenNameIdentifier	 get Class
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getSimpleName	TokenNameIdentifier	 get Simple Name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
updateCheckManager	TokenNameIdentifier	 update Check Manager
.	TokenNameDOT	
touch	TokenNameIdentifier	 touch
(	TokenNameLPAREN	
artifact	TokenNameIdentifier	 artifact
,	TokenNameCOMMA	
repository	TokenNameIdentifier	 repository
,	TokenNameCOMMA	
error	TokenNameIdentifier	 error
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
throw	TokenNamethrow	
e	TokenNameIdentifier	 e
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
" Artifact "	TokenNameStringLiteral	 Artifact 
+	TokenNamePLUS	
artifact	TokenNameIdentifier	 artifact
.	TokenNameDOT	
getId	TokenNameIdentifier	 get Id
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
" resolved to "	TokenNameStringLiteral	 resolved to 
+	TokenNamePLUS	
artifact	TokenNameIdentifier	 artifact
.	TokenNameDOT	
getFile	TokenNameIdentifier	 get File
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
artifact	TokenNameIdentifier	 artifact
.	TokenNameDOT	
setResolved	TokenNameIdentifier	 set Resolved
(	TokenNameLPAREN	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
artifact	TokenNameIdentifier	 artifact
.	TokenNameDOT	
getFile	TokenNameIdentifier	 get File
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
exists	TokenNameIdentifier	 exists
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
error	TokenNameIdentifier	 error
=	TokenNameEQUAL	
updateCheckManager	TokenNameIdentifier	 update Check Manager
.	TokenNameDOT	
getError	TokenNameIdentifier	 get Error
(	TokenNameLPAREN	
artifact	TokenNameIdentifier	 artifact
,	TokenNameCOMMA	
repository	TokenNameIdentifier	 repository
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
error	TokenNameIdentifier	 error
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
(	TokenNameLPAREN	
"Failure to resolve "	TokenNameStringLiteral	Failure to resolve 
+	TokenNamePLUS	
remotePath	TokenNameIdentifier	 remote Path
+	TokenNamePLUS	
" from "	TokenNameStringLiteral	 from 
+	TokenNamePLUS	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getUrl	TokenNameIdentifier	 get Url
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
" was cached in the local repository. "	TokenNameStringLiteral	 was cached in the local repository. 
+	TokenNamePLUS	
"Resolution will not be reattempted until the update interval of "	TokenNameStringLiteral	Resolution will not be reattempted until the update interval of 
+	TokenNamePLUS	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getId	TokenNameIdentifier	 get Id
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
" has elapsed or updates are forced. Original error: "	TokenNameStringLiteral	 has elapsed or updates are forced. Original error: 
+	TokenNamePLUS	
error	TokenNameIdentifier	 error
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
ResourceDoesNotExistException	TokenNameIdentifier	 Resource Does Not Exist Exception
(	TokenNameLPAREN	
"Failure to resolve "	TokenNameStringLiteral	Failure to resolve 
+	TokenNamePLUS	
remotePath	TokenNameIdentifier	 remote Path
+	TokenNamePLUS	
" from "	TokenNameStringLiteral	 from 
+	TokenNamePLUS	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getUrl	TokenNameIdentifier	 get Url
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
" was cached in the local repository. "	TokenNameStringLiteral	 was cached in the local repository. 
+	TokenNamePLUS	
"Resolution will not be reattempted until the update interval of "	TokenNameStringLiteral	Resolution will not be reattempted until the update interval of 
+	TokenNamePLUS	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getId	TokenNameIdentifier	 get Id
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
" has elapsed or updates are forced."	TokenNameStringLiteral	 has elapsed or updates are forced.
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
getArtifact	TokenNameIdentifier	 get Artifact
(	TokenNameLPAREN	
Artifact	TokenNameIdentifier	 Artifact
artifact	TokenNameIdentifier	 artifact
,	TokenNameCOMMA	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
ArtifactRepository	TokenNameIdentifier	 Artifact Repository
>	TokenNameGREATER	
remoteRepositories	TokenNameIdentifier	 remote Repositories
,	TokenNameCOMMA	
TransferListener	TokenNameIdentifier	 Transfer Listener
downloadMonitor	TokenNameIdentifier	 download Monitor
,	TokenNameCOMMA	
boolean	TokenNameboolean	
force	TokenNameIdentifier	 force
)	TokenNameRPAREN	
throws	TokenNamethrows	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
,	TokenNameCOMMA	
ResourceDoesNotExistException	TokenNameIdentifier	 Resource Does Not Exist Exception
{	TokenNameLBRACE	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
tfe	TokenNameIdentifier	 tfe
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
ArtifactRepository	TokenNameIdentifier	 Artifact Repository
repository	TokenNameIdentifier	 repository
:	TokenNameCOLON	
remoteRepositories	TokenNameIdentifier	 remote Repositories
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
getArtifact	TokenNameIdentifier	 get Artifact
(	TokenNameLPAREN	
artifact	TokenNameIdentifier	 artifact
,	TokenNameCOMMA	
repository	TokenNameIdentifier	 repository
,	TokenNameCOMMA	
downloadMonitor	TokenNameIdentifier	 download Monitor
,	TokenNameCOMMA	
force	TokenNameIdentifier	 force
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
artifact	TokenNameIdentifier	 artifact
.	TokenNameDOT	
isResolved	TokenNameIdentifier	 is Resolved
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
artifact	TokenNameIdentifier	 artifact
.	TokenNameDOT	
setRepository	TokenNameIdentifier	 set Repository
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
break	TokenNamebreak	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
ResourceDoesNotExistException	TokenNameIdentifier	 Resource Does Not Exist Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// This one we will eat when looking through remote repositories 	TokenNameCOMMENT_LINE	This one we will eat when looking through remote repositories 
// because we want to cycle through them all before squawking. 	TokenNameCOMMENT_LINE	because we want to cycle through them all before squawking. 
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"Unable to find artifact "	TokenNameStringLiteral	Unable to find artifact 
+	TokenNamePLUS	
artifact	TokenNameIdentifier	 artifact
.	TokenNameDOT	
getId	TokenNameIdentifier	 get Id
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
" in repository "	TokenNameStringLiteral	 in repository 
+	TokenNamePLUS	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getId	TokenNameIdentifier	 get Id
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
" ("	TokenNameStringLiteral	 (
+	TokenNamePLUS	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getUrl	TokenNameIdentifier	 get Url
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
")"	TokenNameStringLiteral	)
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
tfe	TokenNameIdentifier	 tfe
=	TokenNameEQUAL	
e	TokenNameIdentifier	 e
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
msg	TokenNameIdentifier	 msg
=	TokenNameEQUAL	
"Unable to get artifact "	TokenNameStringLiteral	Unable to get artifact 
+	TokenNamePLUS	
artifact	TokenNameIdentifier	 artifact
.	TokenNameDOT	
getId	TokenNameIdentifier	 get Id
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
" from repository "	TokenNameStringLiteral	 from repository 
+	TokenNamePLUS	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getId	TokenNameIdentifier	 get Id
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
" ("	TokenNameStringLiteral	 (
+	TokenNamePLUS	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getUrl	TokenNameIdentifier	 get Url
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
"): "	TokenNameStringLiteral	): 
+	TokenNamePLUS	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
isDebugEnabled	TokenNameIdentifier	 is Debug Enabled
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
warn	TokenNameIdentifier	 warn
(	TokenNameLPAREN	
msg	TokenNameIdentifier	 msg
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
warn	TokenNameIdentifier	 warn
(	TokenNameLPAREN	
msg	TokenNameIdentifier	 msg
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
// if it already exists locally we were just trying to force it - ignore the update 	TokenNameCOMMENT_LINE	if it already exists locally we were just trying to force it - ignore the update 
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
artifact	TokenNameIdentifier	 artifact
.	TokenNameDOT	
getFile	TokenNameIdentifier	 get File
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
exists	TokenNameIdentifier	 exists
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
tfe	TokenNameIdentifier	 tfe
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
tfe	TokenNameIdentifier	 tfe
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
ResourceDoesNotExistException	TokenNameIdentifier	 Resource Does Not Exist Exception
(	TokenNameLPAREN	
"Unable to download the artifact from any repository"	TokenNameStringLiteral	Unable to download the artifact from any repository
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
getArtifactMetadata	TokenNameIdentifier	 get Artifact Metadata
(	TokenNameLPAREN	
ArtifactMetadata	TokenNameIdentifier	 Artifact Metadata
metadata	TokenNameIdentifier	 metadata
,	TokenNameCOMMA	
ArtifactRepository	TokenNameIdentifier	 Artifact Repository
repository	TokenNameIdentifier	 repository
,	TokenNameCOMMA	
File	TokenNameIdentifier	 File
destination	TokenNameIdentifier	 destination
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
checksumPolicy	TokenNameIdentifier	 checksum Policy
)	TokenNameRPAREN	
throws	TokenNamethrows	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
,	TokenNameCOMMA	
ResourceDoesNotExistException	TokenNameIdentifier	 Resource Does Not Exist Exception
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
remotePath	TokenNameIdentifier	 remote Path
=	TokenNameEQUAL	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
pathOfRemoteRepositoryMetadata	TokenNameIdentifier	 path Of Remote Repository Metadata
(	TokenNameLPAREN	
metadata	TokenNameIdentifier	 metadata
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
getRemoteFile	TokenNameIdentifier	 get Remote File
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
,	TokenNameCOMMA	
destination	TokenNameIdentifier	 destination
,	TokenNameCOMMA	
remotePath	TokenNameIdentifier	 remote Path
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
checksumPolicy	TokenNameIdentifier	 checksum Policy
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
getArtifactMetadataFromDeploymentRepository	TokenNameIdentifier	 get Artifact Metadata From Deployment Repository
(	TokenNameLPAREN	
ArtifactMetadata	TokenNameIdentifier	 Artifact Metadata
metadata	TokenNameIdentifier	 metadata
,	TokenNameCOMMA	
ArtifactRepository	TokenNameIdentifier	 Artifact Repository
repository	TokenNameIdentifier	 repository
,	TokenNameCOMMA	
File	TokenNameIdentifier	 File
destination	TokenNameIdentifier	 destination
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
checksumPolicy	TokenNameIdentifier	 checksum Policy
)	TokenNameRPAREN	
throws	TokenNamethrows	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
,	TokenNameCOMMA	
ResourceDoesNotExistException	TokenNameIdentifier	 Resource Does Not Exist Exception
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
remotePath	TokenNameIdentifier	 remote Path
=	TokenNameEQUAL	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
pathOfRemoteRepositoryMetadata	TokenNameIdentifier	 path Of Remote Repository Metadata
(	TokenNameLPAREN	
metadata	TokenNameIdentifier	 metadata
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
getRemoteFile	TokenNameIdentifier	 get Remote File
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
,	TokenNameCOMMA	
destination	TokenNameIdentifier	 destination
,	TokenNameCOMMA	
remotePath	TokenNameIdentifier	 remote Path
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
checksumPolicy	TokenNameIdentifier	 checksum Policy
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Deal with connecting to a wagon repository taking into account authentication and proxies. * * @param wagon * @param repository * @throws ConnectionException * @throws AuthenticationException */	TokenNameCOMMENT_JAVADOC	 Deal with connecting to a wagon repository taking into account authentication and proxies. * @param wagon @param repository @throws ConnectionException @throws AuthenticationException 
private	TokenNameprivate	
void	TokenNamevoid	
connectWagon	TokenNameIdentifier	 connect Wagon
(	TokenNameLPAREN	
Wagon	TokenNameIdentifier	 Wagon
wagon	TokenNameIdentifier	 wagon
,	TokenNameCOMMA	
ArtifactRepository	TokenNameIdentifier	 Artifact Repository
repository	TokenNameIdentifier	 repository
)	TokenNameRPAREN	
throws	TokenNamethrows	
ConnectionException	TokenNameIdentifier	 Connection Exception
,	TokenNameCOMMA	
AuthenticationException	TokenNameIdentifier	 Authentication Exception
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getProxy	TokenNameIdentifier	 get Proxy
(	TokenNameLPAREN	
)	TokenNameRPAREN	
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
&&	TokenNameAND_AND	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
isDebugEnabled	TokenNameIdentifier	 is Debug Enabled
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"Using proxy "	TokenNameStringLiteral	Using proxy 
+	TokenNamePLUS	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getProxy	TokenNameIdentifier	 get Proxy
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getHost	TokenNameIdentifier	 get Host
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
":"	TokenNameStringLiteral	:
+	TokenNamePLUS	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getProxy	TokenNameIdentifier	 get Proxy
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getPort	TokenNameIdentifier	 get Port
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
" for "	TokenNameStringLiteral	 for 
+	TokenNamePLUS	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getUrl	TokenNameIdentifier	 get Url
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getAuthentication	TokenNameIdentifier	 get Authentication
(	TokenNameLPAREN	
)	TokenNameRPAREN	
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
&&	TokenNameAND_AND	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getProxy	TokenNameIdentifier	 get Proxy
(	TokenNameLPAREN	
)	TokenNameRPAREN	
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
connect	TokenNameIdentifier	 connect
(	TokenNameLPAREN	
new	TokenNamenew	
Repository	TokenNameIdentifier	 Repository
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getId	TokenNameIdentifier	 get Id
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getUrl	TokenNameIdentifier	 get Url
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
authenticationInfo	TokenNameIdentifier	 authentication Info
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
)	TokenNameRPAREN	
,	TokenNameCOMMA	
proxyInfo	TokenNameIdentifier	 proxy Info
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getAuthentication	TokenNameIdentifier	 get Authentication
(	TokenNameLPAREN	
)	TokenNameRPAREN	
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
connect	TokenNameIdentifier	 connect
(	TokenNameLPAREN	
new	TokenNamenew	
Repository	TokenNameIdentifier	 Repository
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getId	TokenNameIdentifier	 get Id
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getUrl	TokenNameIdentifier	 get Url
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
authenticationInfo	TokenNameIdentifier	 authentication Info
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getProxy	TokenNameIdentifier	 get Proxy
(	TokenNameLPAREN	
)	TokenNameRPAREN	
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
connect	TokenNameIdentifier	 connect
(	TokenNameLPAREN	
new	TokenNamenew	
Repository	TokenNameIdentifier	 Repository
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getId	TokenNameIdentifier	 get Id
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getUrl	TokenNameIdentifier	 get Url
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
proxyInfo	TokenNameIdentifier	 proxy Info
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
connect	TokenNameIdentifier	 connect
(	TokenNameLPAREN	
new	TokenNamenew	
Repository	TokenNameIdentifier	 Repository
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getId	TokenNameIdentifier	 get Id
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getUrl	TokenNameIdentifier	 get Url
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
AuthenticationInfo	TokenNameIdentifier	 Authentication Info
authenticationInfo	TokenNameIdentifier	 authentication Info
(	TokenNameLPAREN	
ArtifactRepository	TokenNameIdentifier	 Artifact Repository
repository	TokenNameIdentifier	 repository
)	TokenNameRPAREN	
{	TokenNameLBRACE	
AuthenticationInfo	TokenNameIdentifier	 Authentication Info
ai	TokenNameIdentifier	 ai
=	TokenNameEQUAL	
new	TokenNamenew	
AuthenticationInfo	TokenNameIdentifier	 Authentication Info
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ai	TokenNameIdentifier	 ai
.	TokenNameDOT	
setUserName	TokenNameIdentifier	 set User Name
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getAuthentication	TokenNameIdentifier	 get Authentication
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getUsername	TokenNameIdentifier	 get Username
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ai	TokenNameIdentifier	 ai
.	TokenNameDOT	
setPassword	TokenNameIdentifier	 set Password
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getAuthentication	TokenNameIdentifier	 get Authentication
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getPassword	TokenNameIdentifier	 get Password
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
ai	TokenNameIdentifier	 ai
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
ProxyInfo	TokenNameIdentifier	 Proxy Info
proxyInfo	TokenNameIdentifier	 proxy Info
(	TokenNameLPAREN	
ArtifactRepository	TokenNameIdentifier	 Artifact Repository
repository	TokenNameIdentifier	 repository
)	TokenNameRPAREN	
{	TokenNameLBRACE	
ProxyInfo	TokenNameIdentifier	 Proxy Info
proxyInfo	TokenNameIdentifier	 proxy Info
=	TokenNameEQUAL	
new	TokenNamenew	
ProxyInfo	TokenNameIdentifier	 Proxy Info
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
proxyInfo	TokenNameIdentifier	 proxy Info
.	TokenNameDOT	
setHost	TokenNameIdentifier	 set Host
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getProxy	TokenNameIdentifier	 get Proxy
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getHost	TokenNameIdentifier	 get Host
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
proxyInfo	TokenNameIdentifier	 proxy Info
.	TokenNameDOT	
setType	TokenNameIdentifier	 set Type
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getProxy	TokenNameIdentifier	 get Proxy
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getProtocol	TokenNameIdentifier	 get Protocol
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
proxyInfo	TokenNameIdentifier	 proxy Info
.	TokenNameDOT	
setPort	TokenNameIdentifier	 set Port
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getProxy	TokenNameIdentifier	 get Proxy
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getPort	TokenNameIdentifier	 get Port
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
proxyInfo	TokenNameIdentifier	 proxy Info
.	TokenNameDOT	
setNonProxyHosts	TokenNameIdentifier	 set Non Proxy Hosts
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getProxy	TokenNameIdentifier	 get Proxy
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getNonProxyHosts	TokenNameIdentifier	 get Non Proxy Hosts
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
proxyInfo	TokenNameIdentifier	 proxy Info
.	TokenNameDOT	
setUserName	TokenNameIdentifier	 set User Name
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getProxy	TokenNameIdentifier	 get Proxy
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getUserName	TokenNameIdentifier	 get User Name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
proxyInfo	TokenNameIdentifier	 proxy Info
.	TokenNameDOT	
setPassword	TokenNameIdentifier	 set Password
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getProxy	TokenNameIdentifier	 get Proxy
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getPassword	TokenNameIdentifier	 get Password
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
proxyInfo	TokenNameIdentifier	 proxy Info
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
getRemoteFile	TokenNameIdentifier	 get Remote File
(	TokenNameLPAREN	
ArtifactRepository	TokenNameIdentifier	 Artifact Repository
repository	TokenNameIdentifier	 repository
,	TokenNameCOMMA	
File	TokenNameIdentifier	 File
destination	TokenNameIdentifier	 destination
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
remotePath	TokenNameIdentifier	 remote Path
,	TokenNameCOMMA	
TransferListener	TokenNameIdentifier	 Transfer Listener
downloadMonitor	TokenNameIdentifier	 download Monitor
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
checksumPolicy	TokenNameIdentifier	 checksum Policy
,	TokenNameCOMMA	
boolean	TokenNameboolean	
force	TokenNameIdentifier	 force
)	TokenNameRPAREN	
throws	TokenNamethrows	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
,	TokenNameCOMMA	
ResourceDoesNotExistException	TokenNameIdentifier	 Resource Does Not Exist Exception
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
protocol	TokenNameIdentifier	 protocol
=	TokenNameEQUAL	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getProtocol	TokenNameIdentifier	 get Protocol
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Wagon	TokenNameIdentifier	 Wagon
wagon	TokenNameIdentifier	 wagon
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
wagon	TokenNameIdentifier	 wagon
=	TokenNameEQUAL	
getWagon	TokenNameIdentifier	 get Wagon
(	TokenNameLPAREN	
protocol	TokenNameIdentifier	 protocol
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
UnsupportedProtocolException	TokenNameIdentifier	 Unsupported Protocol Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
(	TokenNameLPAREN	
"Unsupported Protocol: '"	TokenNameStringLiteral	Unsupported Protocol: '
+	TokenNamePLUS	
protocol	TokenNameIdentifier	 protocol
+	TokenNamePLUS	
"': "	TokenNameStringLiteral	': 
+	TokenNamePLUS	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
downloadMonitor	TokenNameIdentifier	 download Monitor
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
addTransferListener	TokenNameIdentifier	 add Transfer Listener
(	TokenNameLPAREN	
downloadMonitor	TokenNameIdentifier	 download Monitor
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
File	TokenNameIdentifier	 File
temp	TokenNameIdentifier	 temp
=	TokenNameEQUAL	
new	TokenNamenew	
File	TokenNameIdentifier	 File
(	TokenNameLPAREN	
destination	TokenNameIdentifier	 destination
+	TokenNamePLUS	
".tmp"	TokenNameStringLiteral	.tmp
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
temp	TokenNameIdentifier	 temp
.	TokenNameDOT	
deleteOnExit	TokenNameIdentifier	 delete On Exit
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
boolean	TokenNameboolean	
downloaded	TokenNameIdentifier	 downloaded
=	TokenNameEQUAL	
false	TokenNamefalse	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
connectWagon	TokenNameIdentifier	 connect Wagon
(	TokenNameLPAREN	
wagon	TokenNameIdentifier	 wagon
,	TokenNameCOMMA	
repository	TokenNameIdentifier	 repository
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
boolean	TokenNameboolean	
firstRun	TokenNameIdentifier	 first Run
=	TokenNameEQUAL	
true	TokenNametrue	
;	TokenNameSEMICOLON	
boolean	TokenNameboolean	
retry	TokenNameIdentifier	 retry
=	TokenNameEQUAL	
true	TokenNametrue	
;	TokenNameSEMICOLON	
// this will run at most twice. The first time, the firstRun flag is turned off, and if the retry flag 	TokenNameCOMMENT_LINE	this will run at most twice. The first time, the firstRun flag is turned off, and if the retry flag 
// is set on the first run, it will be turned off and not re-set on the second try. This is because the 	TokenNameCOMMENT_LINE	is set on the first run, it will be turned off and not re-set on the second try. This is because the 
// only way the retry flag can be set is if ( firstRun == true ). 	TokenNameCOMMENT_LINE	only way the retry flag can be set is if ( firstRun == true ). 
while	TokenNamewhile	
(	TokenNameLPAREN	
firstRun	TokenNameIdentifier	 first Run
||	TokenNameOR_OR	
retry	TokenNameIdentifier	 retry
)	TokenNameRPAREN	
{	TokenNameLBRACE	
ChecksumObserver	TokenNameIdentifier	 Checksum Observer
md5ChecksumObserver	TokenNameIdentifier	 md5 Checksum Observer
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
ChecksumObserver	TokenNameIdentifier	 Checksum Observer
sha1ChecksumObserver	TokenNameIdentifier	 sha1 Checksum Observer
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
// TODO: configure on repository 	TokenNameCOMMENT_LINE	TODO: configure on repository 
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
md5ChecksumObserver	TokenNameIdentifier	 md5 Checksum Observer
=	TokenNameEQUAL	
addChecksumObserver	TokenNameIdentifier	 add Checksum Observer
(	TokenNameLPAREN	
wagon	TokenNameIdentifier	 wagon
,	TokenNameCOMMA	
CHECKSUM_ALGORITHMS	TokenNameIdentifier	 CHECKSUM  ALGORITHMS
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sha1ChecksumObserver	TokenNameIdentifier	 sha1 Checksum Observer
=	TokenNameEQUAL	
addChecksumObserver	TokenNameIdentifier	 add Checksum Observer
(	TokenNameLPAREN	
wagon	TokenNameIdentifier	 wagon
,	TokenNameCOMMA	
CHECKSUM_ALGORITHMS	TokenNameIdentifier	 CHECKSUM  ALGORITHMS
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// reset the retry flag. 	TokenNameCOMMENT_LINE	reset the retry flag. 
retry	TokenNameIdentifier	 retry
=	TokenNameEQUAL	
false	TokenNamefalse	
;	TokenNameSEMICOLON	
// This should take care of creating destination directory now on 	TokenNameCOMMENT_LINE	This should take care of creating destination directory now on 
if	TokenNameif	
(	TokenNameLPAREN	
destination	TokenNameIdentifier	 destination
.	TokenNameDOT	
exists	TokenNameIdentifier	 exists
(	TokenNameLPAREN	
)	TokenNameRPAREN	
&&	TokenNameAND_AND	
!	TokenNameNOT	
force	TokenNameIdentifier	 force
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
downloaded	TokenNameIdentifier	 downloaded
=	TokenNameEQUAL	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
getIfNewer	TokenNameIdentifier	 get If Newer
(	TokenNameLPAREN	
remotePath	TokenNameIdentifier	 remote Path
,	TokenNameCOMMA	
temp	TokenNameIdentifier	 temp
,	TokenNameCOMMA	
destination	TokenNameIdentifier	 destination
.	TokenNameDOT	
lastModified	TokenNameIdentifier	 last Modified
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
downloaded	TokenNameIdentifier	 downloaded
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// prevent additional checks of this artifact until it expires again 	TokenNameCOMMENT_LINE	prevent additional checks of this artifact until it expires again 
destination	TokenNameIdentifier	 destination
.	TokenNameDOT	
setLastModified	TokenNameIdentifier	 set Last Modified
(	TokenNameLPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
currentTimeMillis	TokenNameIdentifier	 current Time Millis
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
UnsupportedOperationException	TokenNameIdentifier	 Unsupported Operation Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// older wagons throw this. Just get() instead 	TokenNameCOMMENT_LINE	older wagons throw this. Just get() instead 
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
remotePath	TokenNameIdentifier	 remote Path
,	TokenNameCOMMA	
temp	TokenNameIdentifier	 temp
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
downloaded	TokenNameIdentifier	 downloaded
=	TokenNameEQUAL	
true	TokenNametrue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
remotePath	TokenNameIdentifier	 remote Path
,	TokenNameCOMMA	
temp	TokenNameIdentifier	 temp
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
downloaded	TokenNameIdentifier	 downloaded
=	TokenNameEQUAL	
true	TokenNametrue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
finally	TokenNamefinally	
{	TokenNameLBRACE	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
removeTransferListener	TokenNameIdentifier	 remove Transfer Listener
(	TokenNameLPAREN	
md5ChecksumObserver	TokenNameIdentifier	 md5 Checksum Observer
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
removeTransferListener	TokenNameIdentifier	 remove Transfer Listener
(	TokenNameLPAREN	
sha1ChecksumObserver	TokenNameIdentifier	 sha1 Checksum Observer
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
downloaded	TokenNameIdentifier	 downloaded
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// keep the checksum files from showing up on the download monitor... 	TokenNameCOMMENT_LINE	keep the checksum files from showing up on the download monitor... 
if	TokenNameif	
(	TokenNameLPAREN	
downloadMonitor	TokenNameIdentifier	 download Monitor
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
removeTransferListener	TokenNameIdentifier	 remove Transfer Listener
(	TokenNameLPAREN	
downloadMonitor	TokenNameIdentifier	 download Monitor
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// try to verify the SHA-1 checksum for this file. 	TokenNameCOMMENT_LINE	try to verify the SHA-1 checksum for this file. 
try	TokenNametry	
{	TokenNameLBRACE	
verifyChecksum	TokenNameIdentifier	 verify Checksum
(	TokenNameLPAREN	
sha1ChecksumObserver	TokenNameIdentifier	 sha1 Checksum Observer
,	TokenNameCOMMA	
destination	TokenNameIdentifier	 destination
,	TokenNameCOMMA	
temp	TokenNameIdentifier	 temp
,	TokenNameCOMMA	
remotePath	TokenNameIdentifier	 remote Path
,	TokenNameCOMMA	
".sha1"	TokenNameStringLiteral	.sha1
,	TokenNameCOMMA	
wagon	TokenNameIdentifier	 wagon
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
ChecksumFailedException	TokenNameIdentifier	 Checksum Failed Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// if we catch a ChecksumFailedException, it means the transfer/read succeeded, but the checksum 	TokenNameCOMMENT_LINE	if we catch a ChecksumFailedException, it means the transfer/read succeeded, but the checksum 
// doesn't match. This could be a problem with the server (ibiblio HTTP-200 error page), so we'll 	TokenNameCOMMENT_LINE	doesn't match. This could be a problem with the server (ibiblio HTTP-200 error page), so we'll 
// try this up to two times. On the second try, we'll handle it as a bona-fide error, based on the 	TokenNameCOMMENT_LINE	try this up to two times. On the second try, we'll handle it as a bona-fide error, based on the 
// repository's checksum checking policy. 	TokenNameCOMMENT_LINE	repository's checksum checking policy. 
if	TokenNameif	
(	TokenNameLPAREN	
firstRun	TokenNameIdentifier	 first Run
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
warn	TokenNameIdentifier	 warn
(	TokenNameLPAREN	
"*** CHECKSUM FAILED - "	TokenNameStringLiteral	*** CHECKSUM FAILED - 
+	TokenNamePLUS	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
" - RETRYING"	TokenNameStringLiteral	 - RETRYING
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
retry	TokenNameIdentifier	 retry
=	TokenNameEQUAL	
true	TokenNametrue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
handleChecksumFailure	TokenNameIdentifier	 handle Checksum Failure
(	TokenNameLPAREN	
checksumPolicy	TokenNameIdentifier	 checksum Policy
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getCause	TokenNameIdentifier	 get Cause
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
ResourceDoesNotExistException	TokenNameIdentifier	 Resource Does Not Exist Exception
sha1TryException	TokenNameIdentifier	 sha1 Try Exception
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"SHA1 not found, trying MD5: "	TokenNameStringLiteral	SHA1 not found, trying MD5: 
+	TokenNamePLUS	
sha1TryException	TokenNameIdentifier	 sha1 Try Exception
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// if this IS NOT a ChecksumFailedException, it was a problem with transfer/read of the checksum 	TokenNameCOMMENT_LINE	if this IS NOT a ChecksumFailedException, it was a problem with transfer/read of the checksum 
// file...we'll try again with the MD5 checksum. 	TokenNameCOMMENT_LINE	file...we'll try again with the MD5 checksum. 
try	TokenNametry	
{	TokenNameLBRACE	
verifyChecksum	TokenNameIdentifier	 verify Checksum
(	TokenNameLPAREN	
md5ChecksumObserver	TokenNameIdentifier	 md5 Checksum Observer
,	TokenNameCOMMA	
destination	TokenNameIdentifier	 destination
,	TokenNameCOMMA	
temp	TokenNameIdentifier	 temp
,	TokenNameCOMMA	
remotePath	TokenNameIdentifier	 remote Path
,	TokenNameCOMMA	
".md5"	TokenNameStringLiteral	.md5
,	TokenNameCOMMA	
wagon	TokenNameIdentifier	 wagon
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
ChecksumFailedException	TokenNameIdentifier	 Checksum Failed Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// if we also fail to verify based on the MD5 checksum, and the checksum transfer/read 	TokenNameCOMMENT_LINE	if we also fail to verify based on the MD5 checksum, and the checksum transfer/read 
// succeeded, then we need to determine whether to retry or handle it as a failure. 	TokenNameCOMMENT_LINE	succeeded, then we need to determine whether to retry or handle it as a failure. 
if	TokenNameif	
(	TokenNameLPAREN	
firstRun	TokenNameIdentifier	 first Run
)	TokenNameRPAREN	
{	TokenNameLBRACE	
retry	TokenNameIdentifier	 retry
=	TokenNameEQUAL	
true	TokenNametrue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
handleChecksumFailure	TokenNameIdentifier	 handle Checksum Failure
(	TokenNameLPAREN	
checksumPolicy	TokenNameIdentifier	 checksum Policy
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getCause	TokenNameIdentifier	 get Cause
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
ResourceDoesNotExistException	TokenNameIdentifier	 Resource Does Not Exist Exception
md5TryException	TokenNameIdentifier	 md5 Try Exception
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// this was a failed transfer, and we don't want to retry. 	TokenNameCOMMENT_LINE	this was a failed transfer, and we don't want to retry. 
handleChecksumFailure	TokenNameIdentifier	 handle Checksum Failure
(	TokenNameLPAREN	
checksumPolicy	TokenNameIdentifier	 checksum Policy
,	TokenNameCOMMA	
"Error retrieving checksum file for "	TokenNameStringLiteral	Error retrieving checksum file for 
+	TokenNamePLUS	
remotePath	TokenNameIdentifier	 remote Path
,	TokenNameCOMMA	
md5TryException	TokenNameIdentifier	 md5 Try Exception
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
// reinstate the download monitor... 	TokenNameCOMMENT_LINE	reinstate the download monitor... 
if	TokenNameif	
(	TokenNameLPAREN	
downloadMonitor	TokenNameIdentifier	 download Monitor
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
addTransferListener	TokenNameIdentifier	 add Transfer Listener
(	TokenNameLPAREN	
downloadMonitor	TokenNameIdentifier	 download Monitor
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
// unset the firstRun flag, so we don't get caught in an infinite loop... 	TokenNameCOMMENT_LINE	unset the firstRun flag, so we don't get caught in an infinite loop... 
firstRun	TokenNameIdentifier	 first Run
=	TokenNameEQUAL	
false	TokenNamefalse	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
ConnectionException	TokenNameIdentifier	 Connection Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
(	TokenNameLPAREN	
"Connection failed: "	TokenNameStringLiteral	Connection failed: 
+	TokenNamePLUS	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
AuthenticationException	TokenNameIdentifier	 Authentication Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
(	TokenNameLPAREN	
"Authentication failed: "	TokenNameStringLiteral	Authentication failed: 
+	TokenNamePLUS	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
AuthorizationException	TokenNameIdentifier	 Authorization Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
(	TokenNameLPAREN	
"Authorization failed: "	TokenNameStringLiteral	Authorization failed: 
+	TokenNamePLUS	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
finally	TokenNamefinally	
{	TokenNameLBRACE	
// Remove remaining TransferListener instances (checksum handlers removed in above finally clause) 	TokenNameCOMMENT_LINE	Remove remaining TransferListener instances (checksum handlers removed in above finally clause) 
if	TokenNameif	
(	TokenNameLPAREN	
downloadMonitor	TokenNameIdentifier	 download Monitor
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
removeTransferListener	TokenNameIdentifier	 remove Transfer Listener
(	TokenNameLPAREN	
downloadMonitor	TokenNameIdentifier	 download Monitor
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
disconnectWagon	TokenNameIdentifier	 disconnect Wagon
(	TokenNameLPAREN	
wagon	TokenNameIdentifier	 wagon
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
releaseWagon	TokenNameIdentifier	 release Wagon
(	TokenNameLPAREN	
protocol	TokenNameIdentifier	 protocol
,	TokenNameCOMMA	
wagon	TokenNameIdentifier	 wagon
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
downloaded	TokenNameIdentifier	 downloaded
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
temp	TokenNameIdentifier	 temp
.	TokenNameDOT	
exists	TokenNameIdentifier	 exists
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
ResourceDoesNotExistException	TokenNameIdentifier	 Resource Does Not Exist Exception
(	TokenNameLPAREN	
"Downloaded file does not exist: "	TokenNameStringLiteral	Downloaded file does not exist: 
+	TokenNamePLUS	
temp	TokenNameIdentifier	 temp
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// The temporary file is named destination + ".tmp" and is done this way to ensure 	TokenNameCOMMENT_LINE	The temporary file is named destination + ".tmp" and is done this way to ensure 
// that the temporary file is in the same file system as the destination because the 	TokenNameCOMMENT_LINE	that the temporary file is in the same file system as the destination because the 
// File.renameTo operation doesn't really work across file systems. 	TokenNameCOMMENT_LINE	File.renameTo operation doesn't really work across file systems. 
// So we will attempt to do a File.renameTo for efficiency and atomicity, if this fails 	TokenNameCOMMENT_LINE	So we will attempt to do a File.renameTo for efficiency and atomicity, if this fails 
// then we will use a brute force copy and delete the temporary file. 	TokenNameCOMMENT_LINE	then we will use a brute force copy and delete the temporary file. 
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
temp	TokenNameIdentifier	 temp
.	TokenNameDOT	
renameTo	TokenNameIdentifier	 rename To
(	TokenNameLPAREN	
destination	TokenNameIdentifier	 destination
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
FileUtils	TokenNameIdentifier	 File Utils
.	TokenNameDOT	
copyFile	TokenNameIdentifier	 copy File
(	TokenNameLPAREN	
temp	TokenNameIdentifier	 temp
,	TokenNameCOMMA	
destination	TokenNameIdentifier	 destination
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
temp	TokenNameIdentifier	 temp
.	TokenNameDOT	
delete	TokenNameIdentifier	 delete
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
IOException	TokenNameIdentifier	 IO Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
(	TokenNameLPAREN	
"Error copying temporary file to the final destination: "	TokenNameStringLiteral	Error copying temporary file to the final destination: 
+	TokenNamePLUS	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
// 	TokenNameCOMMENT_LINE	 
// Publisher 	TokenNameCOMMENT_LINE	Publisher 
// 	TokenNameCOMMENT_LINE	 
public	TokenNamepublic	
void	TokenNamevoid	
putArtifact	TokenNameIdentifier	 put Artifact
(	TokenNameLPAREN	
File	TokenNameIdentifier	 File
source	TokenNameIdentifier	 source
,	TokenNameCOMMA	
Artifact	TokenNameIdentifier	 Artifact
artifact	TokenNameIdentifier	 artifact
,	TokenNameCOMMA	
ArtifactRepository	TokenNameIdentifier	 Artifact Repository
deploymentRepository	TokenNameIdentifier	 deployment Repository
,	TokenNameCOMMA	
TransferListener	TokenNameIdentifier	 Transfer Listener
downloadMonitor	TokenNameIdentifier	 download Monitor
)	TokenNameRPAREN	
throws	TokenNamethrows	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
{	TokenNameLBRACE	
putRemoteFile	TokenNameIdentifier	 put Remote File
(	TokenNameLPAREN	
deploymentRepository	TokenNameIdentifier	 deployment Repository
,	TokenNameCOMMA	
source	TokenNameIdentifier	 source
,	TokenNameCOMMA	
deploymentRepository	TokenNameIdentifier	 deployment Repository
.	TokenNameDOT	
pathOf	TokenNameIdentifier	 path Of
(	TokenNameLPAREN	
artifact	TokenNameIdentifier	 artifact
)	TokenNameRPAREN	
,	TokenNameCOMMA	
downloadMonitor	TokenNameIdentifier	 download Monitor
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
putArtifactMetadata	TokenNameIdentifier	 put Artifact Metadata
(	TokenNameLPAREN	
File	TokenNameIdentifier	 File
source	TokenNameIdentifier	 source
,	TokenNameCOMMA	
ArtifactMetadata	TokenNameIdentifier	 Artifact Metadata
artifactMetadata	TokenNameIdentifier	 artifact Metadata
,	TokenNameCOMMA	
ArtifactRepository	TokenNameIdentifier	 Artifact Repository
repository	TokenNameIdentifier	 repository
)	TokenNameRPAREN	
throws	TokenNamethrows	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
info	TokenNameIdentifier	 info
(	TokenNameLPAREN	
"Uploading "	TokenNameStringLiteral	Uploading 
+	TokenNamePLUS	
artifactMetadata	TokenNameIdentifier	 artifact Metadata
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
putRemoteFile	TokenNameIdentifier	 put Remote File
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
,	TokenNameCOMMA	
source	TokenNameIdentifier	 source
,	TokenNameCOMMA	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
pathOfRemoteRepositoryMetadata	TokenNameIdentifier	 path Of Remote Repository Metadata
(	TokenNameLPAREN	
artifactMetadata	TokenNameIdentifier	 artifact Metadata
)	TokenNameRPAREN	
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
putRemoteFile	TokenNameIdentifier	 put Remote File
(	TokenNameLPAREN	
ArtifactRepository	TokenNameIdentifier	 Artifact Repository
repository	TokenNameIdentifier	 repository
,	TokenNameCOMMA	
File	TokenNameIdentifier	 File
source	TokenNameIdentifier	 source
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
remotePath	TokenNameIdentifier	 remote Path
,	TokenNameCOMMA	
TransferListener	TokenNameIdentifier	 Transfer Listener
downloadMonitor	TokenNameIdentifier	 download Monitor
)	TokenNameRPAREN	
throws	TokenNamethrows	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
protocol	TokenNameIdentifier	 protocol
=	TokenNameEQUAL	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getProtocol	TokenNameIdentifier	 get Protocol
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Wagon	TokenNameIdentifier	 Wagon
wagon	TokenNameIdentifier	 wagon
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
wagon	TokenNameIdentifier	 wagon
=	TokenNameEQUAL	
getWagon	TokenNameIdentifier	 get Wagon
(	TokenNameLPAREN	
protocol	TokenNameIdentifier	 protocol
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
UnsupportedProtocolException	TokenNameIdentifier	 Unsupported Protocol Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
(	TokenNameLPAREN	
"Unsupported Protocol: '"	TokenNameStringLiteral	Unsupported Protocol: '
+	TokenNamePLUS	
protocol	TokenNameIdentifier	 protocol
+	TokenNamePLUS	
"': "	TokenNameStringLiteral	': 
+	TokenNamePLUS	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
downloadMonitor	TokenNameIdentifier	 download Monitor
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
addTransferListener	TokenNameIdentifier	 add Transfer Listener
(	TokenNameLPAREN	
downloadMonitor	TokenNameIdentifier	 download Monitor
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
ChecksumObserver	TokenNameIdentifier	 Checksum Observer
>	TokenNameGREATER	
checksums	TokenNameIdentifier	 checksums
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
ChecksumObserver	TokenNameIdentifier	 Checksum Observer
>	TokenNameGREATER	
(	TokenNameLPAREN	
2	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
sums	TokenNameIdentifier	 sums
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
(	TokenNameLPAREN	
2	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// TODO: configure these on the repository 	TokenNameCOMMENT_LINE	TODO: configure these on the repository 
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
CHECKSUM_IDS	TokenNameIdentifier	 CHECKSUM  IDS
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
checksums	TokenNameIdentifier	 checksums
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
CHECKSUM_IDS	TokenNameIdentifier	 CHECKSUM  IDS
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
,	TokenNameCOMMA	
addChecksumObserver	TokenNameIdentifier	 add Checksum Observer
(	TokenNameLPAREN	
wagon	TokenNameIdentifier	 wagon
,	TokenNameCOMMA	
CHECKSUM_ALGORITHMS	TokenNameIdentifier	 CHECKSUM  ALGORITHMS
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
File	TokenNameIdentifier	 File
>	TokenNameGREATER	
temporaryFiles	TokenNameIdentifier	 temporary Files
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
File	TokenNameIdentifier	 File
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
connectWagon	TokenNameIdentifier	 connect Wagon
(	TokenNameLPAREN	
wagon	TokenNameIdentifier	 wagon
,	TokenNameCOMMA	
repository	TokenNameIdentifier	 repository
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
source	TokenNameIdentifier	 source
,	TokenNameCOMMA	
remotePath	TokenNameIdentifier	 remote Path
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
finally	TokenNamefinally	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
downloadMonitor	TokenNameIdentifier	 download Monitor
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
removeTransferListener	TokenNameIdentifier	 remove Transfer Listener
(	TokenNameLPAREN	
downloadMonitor	TokenNameIdentifier	 download Monitor
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
// Pre-store the checksums as any future puts will overwrite them 	TokenNameCOMMENT_LINE	Pre-store the checksums as any future puts will overwrite them 
for	TokenNamefor	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
extension	TokenNameIdentifier	 extension
:	TokenNameCOLON	
checksums	TokenNameIdentifier	 checksums
.	TokenNameDOT	
keySet	TokenNameIdentifier	 key Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
ChecksumObserver	TokenNameIdentifier	 Checksum Observer
observer	TokenNameIdentifier	 observer
=	TokenNameEQUAL	
checksums	TokenNameIdentifier	 checksums
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
extension	TokenNameIdentifier	 extension
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sums	TokenNameIdentifier	 sums
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
extension	TokenNameIdentifier	 extension
,	TokenNameCOMMA	
observer	TokenNameIdentifier	 observer
.	TokenNameDOT	
getActualChecksum	TokenNameIdentifier	 get Actual Checksum
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// We do this in here so we can checksum the artifact metadata too, otherwise it could be metadata itself 	TokenNameCOMMENT_LINE	We do this in here so we can checksum the artifact metadata too, otherwise it could be metadata itself 
for	TokenNamefor	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
extension	TokenNameIdentifier	 extension
:	TokenNameCOLON	
checksums	TokenNameIdentifier	 checksums
.	TokenNameDOT	
keySet	TokenNameIdentifier	 key Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// TODO: shouldn't need a file intermediatary - improve wagon to take a stream 	TokenNameCOMMENT_LINE	TODO: shouldn't need a file intermediatary - improve wagon to take a stream 
File	TokenNameIdentifier	 File
temp	TokenNameIdentifier	 temp
=	TokenNameEQUAL	
File	TokenNameIdentifier	 File
.	TokenNameDOT	
createTempFile	TokenNameIdentifier	 create Temp File
(	TokenNameLPAREN	
"maven-artifact"	TokenNameStringLiteral	maven-artifact
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
temp	TokenNameIdentifier	 temp
.	TokenNameDOT	
deleteOnExit	TokenNameIdentifier	 delete On Exit
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
FileUtils	TokenNameIdentifier	 File Utils
.	TokenNameDOT	
fileWrite	TokenNameIdentifier	 file Write
(	TokenNameLPAREN	
temp	TokenNameIdentifier	 temp
.	TokenNameDOT	
getAbsolutePath	TokenNameIdentifier	 get Absolute Path
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
"UTF-8"	TokenNameStringLiteral	UTF-8
,	TokenNameCOMMA	
sums	TokenNameIdentifier	 sums
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
extension	TokenNameIdentifier	 extension
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
temporaryFiles	TokenNameIdentifier	 temporary Files
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
temp	TokenNameIdentifier	 temp
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
temp	TokenNameIdentifier	 temp
,	TokenNameCOMMA	
remotePath	TokenNameIdentifier	 remote Path
+	TokenNamePLUS	
"."	TokenNameStringLiteral	.
+	TokenNamePLUS	
extension	TokenNameIdentifier	 extension
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
ConnectionException	TokenNameIdentifier	 Connection Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
(	TokenNameLPAREN	
"Connection failed: "	TokenNameStringLiteral	Connection failed: 
+	TokenNamePLUS	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
AuthenticationException	TokenNameIdentifier	 Authentication Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
(	TokenNameLPAREN	
"Authentication failed: "	TokenNameStringLiteral	Authentication failed: 
+	TokenNamePLUS	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
AuthorizationException	TokenNameIdentifier	 Authorization Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
(	TokenNameLPAREN	
"Authorization failed: "	TokenNameStringLiteral	Authorization failed: 
+	TokenNamePLUS	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
ResourceDoesNotExistException	TokenNameIdentifier	 Resource Does Not Exist Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
(	TokenNameLPAREN	
"Resource to deploy not found: "	TokenNameStringLiteral	Resource to deploy not found: 
+	TokenNamePLUS	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
IOException	TokenNameIdentifier	 IO Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
(	TokenNameLPAREN	
"Error creating temporary file for deployment: "	TokenNameStringLiteral	Error creating temporary file for deployment: 
+	TokenNamePLUS	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
finally	TokenNamefinally	
{	TokenNameLBRACE	
// MNG-4543 	TokenNameCOMMENT_LINE	MNG-4543 
cleanupTemporaryFiles	TokenNameIdentifier	 cleanup Temporary Files
(	TokenNameLPAREN	
temporaryFiles	TokenNameIdentifier	 temporary Files
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Remove every checksum listener 	TokenNameCOMMENT_LINE	Remove every checksum listener 
for	TokenNamefor	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
aCHECKSUM_IDS	TokenNameIdentifier	 a CHECKSUM  IDS
:	TokenNameCOLON	
CHECKSUM_IDS	TokenNameIdentifier	 CHECKSUM  IDS
)	TokenNameRPAREN	
{	TokenNameLBRACE	
TransferListener	TokenNameIdentifier	 Transfer Listener
checksumListener	TokenNameIdentifier	 checksum Listener
=	TokenNameEQUAL	
checksums	TokenNameIdentifier	 checksums
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
aCHECKSUM_IDS	TokenNameIdentifier	 a CHECKSUM  IDS
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
checksumListener	TokenNameIdentifier	 checksum Listener
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
removeTransferListener	TokenNameIdentifier	 remove Transfer Listener
(	TokenNameLPAREN	
checksumListener	TokenNameIdentifier	 checksum Listener
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
disconnectWagon	TokenNameIdentifier	 disconnect Wagon
(	TokenNameLPAREN	
wagon	TokenNameIdentifier	 wagon
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
releaseWagon	TokenNameIdentifier	 release Wagon
(	TokenNameLPAREN	
protocol	TokenNameIdentifier	 protocol
,	TokenNameCOMMA	
wagon	TokenNameIdentifier	 wagon
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
cleanupTemporaryFiles	TokenNameIdentifier	 cleanup Temporary Files
(	TokenNameLPAREN	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
File	TokenNameIdentifier	 File
>	TokenNameGREATER	
files	TokenNameIdentifier	 files
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
File	TokenNameIdentifier	 File
file	TokenNameIdentifier	 file
:	TokenNameCOLON	
files	TokenNameIdentifier	 files
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// really don't care if it failed here only log warning 	TokenNameCOMMENT_LINE	really don't care if it failed here only log warning 
try	TokenNametry	
{	TokenNameLBRACE	
file	TokenNameIdentifier	 file
.	TokenNameDOT	
delete	TokenNameIdentifier	 delete
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
Exception	TokenNameIdentifier	 Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
warn	TokenNameIdentifier	 warn
(	TokenNameLPAREN	
"skip failed to delete temporary file : "	TokenNameStringLiteral	skip failed to delete temporary file : 
+	TokenNamePLUS	
file	TokenNameIdentifier	 file
.	TokenNameDOT	
getAbsolutePath	TokenNameIdentifier	 get Absolute Path
(	TokenNameLPAREN	
)	TokenNameRPAREN	
+	TokenNamePLUS	
" , message "	TokenNameStringLiteral	 , message 
+	TokenNamePLUS	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
ChecksumObserver	TokenNameIdentifier	 Checksum Observer
addChecksumObserver	TokenNameIdentifier	 add Checksum Observer
(	TokenNameLPAREN	
Wagon	TokenNameIdentifier	 Wagon
wagon	TokenNameIdentifier	 wagon
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
algorithm	TokenNameIdentifier	 algorithm
)	TokenNameRPAREN	
throws	TokenNamethrows	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
ChecksumObserver	TokenNameIdentifier	 Checksum Observer
checksumObserver	TokenNameIdentifier	 checksum Observer
=	TokenNameEQUAL	
new	TokenNamenew	
ChecksumObserver	TokenNameIdentifier	 Checksum Observer
(	TokenNameLPAREN	
algorithm	TokenNameIdentifier	 algorithm
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
addTransferListener	TokenNameIdentifier	 add Transfer Listener
(	TokenNameLPAREN	
checksumObserver	TokenNameIdentifier	 checksum Observer
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
checksumObserver	TokenNameIdentifier	 checksum Observer
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
NoSuchAlgorithmException	TokenNameIdentifier	 No Such Algorithm Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
(	TokenNameLPAREN	
"Unable to add checksum for unsupported algorithm "	TokenNameStringLiteral	Unable to add checksum for unsupported algorithm 
+	TokenNamePLUS	
algorithm	TokenNameIdentifier	 algorithm
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
handleChecksumFailure	TokenNameIdentifier	 handle Checksum Failure
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
checksumPolicy	TokenNameIdentifier	 checksum Policy
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
message	TokenNameIdentifier	 message
,	TokenNameCOMMA	
Throwable	TokenNameIdentifier	 Throwable
cause	TokenNameIdentifier	 cause
)	TokenNameRPAREN	
throws	TokenNamethrows	
ChecksumFailedException	TokenNameIdentifier	 Checksum Failed Exception
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
ArtifactRepositoryPolicy	TokenNameIdentifier	 Artifact Repository Policy
.	TokenNameDOT	
CHECKSUM_POLICY_FAIL	TokenNameIdentifier	 CHECKSUM  POLICY  FAIL
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
checksumPolicy	TokenNameIdentifier	 checksum Policy
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
ChecksumFailedException	TokenNameIdentifier	 Checksum Failed Exception
(	TokenNameLPAREN	
message	TokenNameIdentifier	 message
,	TokenNameCOMMA	
cause	TokenNameIdentifier	 cause
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
ArtifactRepositoryPolicy	TokenNameIdentifier	 Artifact Repository Policy
.	TokenNameDOT	
CHECKSUM_POLICY_IGNORE	TokenNameIdentifier	 CHECKSUM  POLICY  IGNORE
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
checksumPolicy	TokenNameIdentifier	 checksum Policy
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// warn if it is set to anything other than ignore 	TokenNameCOMMENT_LINE	warn if it is set to anything other than ignore 
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
warn	TokenNameIdentifier	 warn
(	TokenNameLPAREN	
"*** CHECKSUM FAILED - "	TokenNameStringLiteral	*** CHECKSUM FAILED - 
+	TokenNamePLUS	
message	TokenNameIdentifier	 message
+	TokenNamePLUS	
" - IGNORING"	TokenNameStringLiteral	 - IGNORING
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// otherwise it is ignore 	TokenNameCOMMENT_LINE	otherwise it is ignore 
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
verifyChecksum	TokenNameIdentifier	 verify Checksum
(	TokenNameLPAREN	
ChecksumObserver	TokenNameIdentifier	 Checksum Observer
checksumObserver	TokenNameIdentifier	 checksum Observer
,	TokenNameCOMMA	
File	TokenNameIdentifier	 File
destination	TokenNameIdentifier	 destination
,	TokenNameCOMMA	
File	TokenNameIdentifier	 File
tempDestination	TokenNameIdentifier	 temp Destination
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
remotePath	TokenNameIdentifier	 remote Path
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
checksumFileExtension	TokenNameIdentifier	 checksum File Extension
,	TokenNameCOMMA	
Wagon	TokenNameIdentifier	 Wagon
wagon	TokenNameIdentifier	 wagon
)	TokenNameRPAREN	
throws	TokenNamethrows	
ResourceDoesNotExistException	TokenNameIdentifier	 Resource Does Not Exist Exception
,	TokenNameCOMMA	
TransferFailedException	TokenNameIdentifier	 Transfer Failed Exception
,	TokenNameCOMMA	
AuthorizationException	TokenNameIdentifier	 Authorization Exception
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
// grab it first, because it's about to change... 	TokenNameCOMMENT_LINE	grab it first, because it's about to change... 
String	TokenNameIdentifier	 String
actualChecksum	TokenNameIdentifier	 actual Checksum
=	TokenNameEQUAL	
checksumObserver	TokenNameIdentifier	 checksum Observer
.	TokenNameDOT	
getActualChecksum	TokenNameIdentifier	 get Actual Checksum
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
File	TokenNameIdentifier	 File
tempChecksumFile	TokenNameIdentifier	 temp Checksum File
=	TokenNameEQUAL	
new	TokenNamenew	
File	TokenNameIdentifier	 File
(	TokenNameLPAREN	
tempDestination	TokenNameIdentifier	 temp Destination
+	TokenNamePLUS	
checksumFileExtension	TokenNameIdentifier	 checksum File Extension
+	TokenNamePLUS	
".tmp"	TokenNameStringLiteral	.tmp
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
tempChecksumFile	TokenNameIdentifier	 temp Checksum File
.	TokenNameDOT	
deleteOnExit	TokenNameIdentifier	 delete On Exit
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
remotePath	TokenNameIdentifier	 remote Path
+	TokenNamePLUS	
checksumFileExtension	TokenNameIdentifier	 checksum File Extension
,	TokenNameCOMMA	
tempChecksumFile	TokenNameIdentifier	 temp Checksum File
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
expectedChecksum	TokenNameIdentifier	 expected Checksum
=	TokenNameEQUAL	
FileUtils	TokenNameIdentifier	 File Utils
.	TokenNameDOT	
fileRead	TokenNameIdentifier	 file Read
(	TokenNameLPAREN	
tempChecksumFile	TokenNameIdentifier	 temp Checksum File
,	TokenNameCOMMA	
"UTF-8"	TokenNameStringLiteral	UTF-8
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// remove whitespaces at the end 	TokenNameCOMMENT_LINE	remove whitespaces at the end 
expectedChecksum	TokenNameIdentifier	 expected Checksum
=	TokenNameEQUAL	
expectedChecksum	TokenNameIdentifier	 expected Checksum
.	TokenNameDOT	
trim	TokenNameIdentifier	 trim
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// check for 'ALGO (name) = CHECKSUM' like used by openssl 	TokenNameCOMMENT_LINE	check for 'ALGO (name) = CHECKSUM' like used by openssl 
if	TokenNameif	
(	TokenNameLPAREN	
expectedChecksum	TokenNameIdentifier	 expected Checksum
.	TokenNameDOT	
regionMatches	TokenNameIdentifier	 region Matches
(	TokenNameLPAREN	
true	TokenNametrue	
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
"MD"	TokenNameStringLiteral	MD
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
2	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
||	TokenNameOR_OR	
expectedChecksum	TokenNameIdentifier	 expected Checksum
.	TokenNameDOT	
regionMatches	TokenNameIdentifier	 region Matches
(	TokenNameLPAREN	
true	TokenNametrue	
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
"SHA"	TokenNameStringLiteral	SHA
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
3	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
int	TokenNameint	
lastSpacePos	TokenNameIdentifier	 last Space Pos
=	TokenNameEQUAL	
expectedChecksum	TokenNameIdentifier	 expected Checksum
.	TokenNameDOT	
lastIndexOf	TokenNameIdentifier	 last Index Of
(	TokenNameLPAREN	
' '	TokenNameCharacterLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
expectedChecksum	TokenNameIdentifier	 expected Checksum
=	TokenNameEQUAL	
expectedChecksum	TokenNameIdentifier	 expected Checksum
.	TokenNameDOT	
substring	TokenNameIdentifier	 substring
(	TokenNameLPAREN	
lastSpacePos	TokenNameIdentifier	 last Space Pos
+	TokenNamePLUS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
// remove everything after the first space (if available) 	TokenNameCOMMENT_LINE	remove everything after the first space (if available) 
int	TokenNameint	
spacePos	TokenNameIdentifier	 space Pos
=	TokenNameEQUAL	
expectedChecksum	TokenNameIdentifier	 expected Checksum
.	TokenNameDOT	
indexOf	TokenNameIdentifier	 index Of
(	TokenNameLPAREN	
' '	TokenNameCharacterLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
spacePos	TokenNameIdentifier	 space Pos
!=	TokenNameNOT_EQUAL	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
expectedChecksum	TokenNameIdentifier	 expected Checksum
=	TokenNameEQUAL	
expectedChecksum	TokenNameIdentifier	 expected Checksum
.	TokenNameDOT	
substring	TokenNameIdentifier	 substring
(	TokenNameLPAREN	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
spacePos	TokenNameIdentifier	 space Pos
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
expectedChecksum	TokenNameIdentifier	 expected Checksum
.	TokenNameDOT	
equalsIgnoreCase	TokenNameIdentifier	 equals Ignore Case
(	TokenNameLPAREN	
actualChecksum	TokenNameIdentifier	 actual Checksum
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
File	TokenNameIdentifier	 File
checksumFile	TokenNameIdentifier	 checksum File
=	TokenNameEQUAL	
new	TokenNamenew	
File	TokenNameIdentifier	 File
(	TokenNameLPAREN	
destination	TokenNameIdentifier	 destination
+	TokenNamePLUS	
checksumFileExtension	TokenNameIdentifier	 checksum File Extension
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
checksumFile	TokenNameIdentifier	 checksum File
.	TokenNameDOT	
exists	TokenNameIdentifier	 exists
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
checksumFile	TokenNameIdentifier	 checksum File
.	TokenNameDOT	
delete	TokenNameIdentifier	 delete
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
FileUtils	TokenNameIdentifier	 File Utils
.	TokenNameDOT	
copyFile	TokenNameIdentifier	 copy File
(	TokenNameLPAREN	
tempChecksumFile	TokenNameIdentifier	 temp Checksum File
,	TokenNameCOMMA	
checksumFile	TokenNameIdentifier	 checksum File
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
tempChecksumFile	TokenNameIdentifier	 temp Checksum File
.	TokenNameDOT	
delete	TokenNameIdentifier	 delete
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
ChecksumFailedException	TokenNameIdentifier	 Checksum Failed Exception
(	TokenNameLPAREN	
"Checksum failed on download: local = '"	TokenNameStringLiteral	Checksum failed on download: local = '
+	TokenNamePLUS	
actualChecksum	TokenNameIdentifier	 actual Checksum
+	TokenNamePLUS	
"'; remote = '"	TokenNameStringLiteral	'; remote = '
+	TokenNamePLUS	
expectedChecksum	TokenNameIdentifier	 expected Checksum
+	TokenNamePLUS	
"'"	TokenNameStringLiteral	'
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
IOException	TokenNameIdentifier	 IO Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
ChecksumFailedException	TokenNameIdentifier	 Checksum Failed Exception
(	TokenNameLPAREN	
"Invalid checksum file"	TokenNameStringLiteral	Invalid checksum file
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
disconnectWagon	TokenNameIdentifier	 disconnect Wagon
(	TokenNameLPAREN	
Wagon	TokenNameIdentifier	 Wagon
wagon	TokenNameIdentifier	 wagon
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
wagon	TokenNameIdentifier	 wagon
.	TokenNameDOT	
disconnect	TokenNameIdentifier	 disconnect
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
ConnectionException	TokenNameIdentifier	 Connection Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
error	TokenNameIdentifier	 error
(	TokenNameLPAREN	
"Problem disconnecting from wagon - ignoring: "	TokenNameStringLiteral	Problem disconnecting from wagon - ignoring: 
+	TokenNamePLUS	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
releaseWagon	TokenNameIdentifier	 release Wagon
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
protocol	TokenNameIdentifier	 protocol
,	TokenNameCOMMA	
Wagon	TokenNameIdentifier	 Wagon
wagon	TokenNameIdentifier	 wagon
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
container	TokenNameIdentifier	 container
.	TokenNameDOT	
release	TokenNameIdentifier	 release
(	TokenNameLPAREN	
wagon	TokenNameIdentifier	 wagon
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
ComponentLifecycleException	TokenNameIdentifier	 Component Lifecycle Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
error	TokenNameIdentifier	 error
(	TokenNameLPAREN	
"Problem releasing wagon - ignoring: "	TokenNameStringLiteral	Problem releasing wagon - ignoring: 
+	TokenNamePLUS	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
""	TokenNameStringLiteral	 
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
@	TokenNameAT	
Deprecated	TokenNameIdentifier	 Deprecated
public	TokenNamepublic	
Wagon	TokenNameIdentifier	 Wagon
getWagon	TokenNameIdentifier	 get Wagon
(	TokenNameLPAREN	
Repository	TokenNameIdentifier	 Repository
repository	TokenNameIdentifier	 repository
)	TokenNameRPAREN	
throws	TokenNamethrows	
UnsupportedProtocolException	TokenNameIdentifier	 Unsupported Protocol Exception
{	TokenNameLBRACE	
return	TokenNamereturn	
getWagon	TokenNameIdentifier	 get Wagon
(	TokenNameLPAREN	
repository	TokenNameIdentifier	 repository
.	TokenNameDOT	
getProtocol	TokenNameIdentifier	 get Protocol
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
@	TokenNameAT	
Deprecated	TokenNameIdentifier	 Deprecated
public	TokenNamepublic	
Wagon	TokenNameIdentifier	 Wagon
getWagon	TokenNameIdentifier	 get Wagon
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
protocol	TokenNameIdentifier	 protocol
)	TokenNameRPAREN	
throws	TokenNamethrows	
UnsupportedProtocolException	TokenNameIdentifier	 Unsupported Protocol Exception
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
protocol	TokenNameIdentifier	 protocol
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
UnsupportedProtocolException	TokenNameIdentifier	 Unsupported Protocol Exception
(	TokenNameLPAREN	
"Unspecified protocol"	TokenNameStringLiteral	Unspecified protocol
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
String	TokenNameIdentifier	 String
hint	TokenNameIdentifier	 hint
=	TokenNameEQUAL	
protocol	TokenNameIdentifier	 protocol
.	TokenNameDOT	
toLowerCase	TokenNameIdentifier	 to Lower Case
(	TokenNameLPAREN	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
Locale	TokenNameIdentifier	 Locale
.	TokenNameDOT	
ENGLISH	TokenNameIdentifier	 ENGLISH
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Wagon	TokenNameIdentifier	 Wagon
wagon	TokenNameIdentifier	 wagon
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
wagon	TokenNameIdentifier	 wagon
=	TokenNameEQUAL	
container	TokenNameIdentifier	 container
.	TokenNameDOT	
lookup	TokenNameIdentifier	 lookup
(	TokenNameLPAREN	
Wagon	TokenNameIdentifier	 Wagon
.	TokenNameDOT	
class	TokenNameclass	
,	TokenNameCOMMA	
hint	TokenNameIdentifier	 hint
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
ComponentLookupException	TokenNameIdentifier	 Component Lookup Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
UnsupportedProtocolException	TokenNameIdentifier	 Unsupported Protocol Exception
(	TokenNameLPAREN	
"Cannot find wagon which supports the requested protocol: "	TokenNameStringLiteral	Cannot find wagon which supports the requested protocol: 
+	TokenNamePLUS	
protocol	TokenNameIdentifier	 protocol
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
wagon	TokenNameIdentifier	 wagon
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
