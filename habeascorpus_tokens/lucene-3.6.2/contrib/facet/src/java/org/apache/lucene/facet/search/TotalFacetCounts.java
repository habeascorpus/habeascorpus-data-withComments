package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
search	TokenNameIdentifier	 search
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
BufferedInputStream	TokenNameIdentifier	 Buffered Input Stream
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
BufferedOutputStream	TokenNameIdentifier	 Buffered Output Stream
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
DataInputStream	TokenNameIdentifier	 Data Input Stream
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
DataOutputStream	TokenNameIdentifier	 Data Output Stream
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
File	TokenNameIdentifier	 File
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
FileInputStream	TokenNameIdentifier	 File Input Stream
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
FileOutputStream	TokenNameIdentifier	 File Output Stream
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
IOException	TokenNameIdentifier	 IO Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
HashMap	TokenNameIdentifier	 Hash Map
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
atomic	TokenNameIdentifier	 atomic
.	TokenNameDOT	
AtomicInteger	TokenNameIdentifier	 Atomic Integer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
IndexReader	TokenNameIdentifier	 Index Reader
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
store	TokenNameIdentifier	 store
.	TokenNameDOT	
LockObtainFailedException	TokenNameIdentifier	 Lock Obtain Failed Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
params	TokenNameIdentifier	 params
.	TokenNameDOT	
CategoryListParams	TokenNameIdentifier	 Category List Params
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
params	TokenNameIdentifier	 params
.	TokenNameDOT	
FacetIndexingParams	TokenNameIdentifier	 Facet Indexing Params
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
aggregator	TokenNameIdentifier	 aggregator
.	TokenNameDOT	
Aggregator	TokenNameIdentifier	 Aggregator
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
aggregator	TokenNameIdentifier	 aggregator
.	TokenNameDOT	
CountingAggregator	TokenNameIdentifier	 Counting Aggregator
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
cache	TokenNameIdentifier	 cache
.	TokenNameDOT	
CategoryListCache	TokenNameIdentifier	 Category List Cache
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
cache	TokenNameIdentifier	 cache
.	TokenNameDOT	
CategoryListData	TokenNameIdentifier	 Category List Data
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
params	TokenNameIdentifier	 params
.	TokenNameDOT	
FacetSearchParams	TokenNameIdentifier	 Facet Search Params
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
taxonomy	TokenNameIdentifier	 taxonomy
.	TokenNameDOT	
TaxonomyReader	TokenNameIdentifier	 Taxonomy Reader
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
PartitionsUtils	TokenNameIdentifier	 Partitions Utils
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
ScoredDocIdsUtils	TokenNameIdentifier	 Scored Doc Ids Utils
;	TokenNameSEMICOLON	
/** * Licensed to the Apache Software Foundation (ASF) under one or more * contributor license agreements. See the NOTICE file distributed with * this work for additional information regarding copyright ownership. * The ASF licenses this file to You under the Apache License, Version 2.0 * (the "License"); you may not use this file except in compliance with * the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */	TokenNameCOMMENT_JAVADOC	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
/** * Maintain Total Facet Counts per partition, for given parameters: * <ul> * <li>Index reader of an index</li> * <li>Taxonomy index reader</li> * <li>Facet indexing params (and particularly the category list params)</li> * <li></li> * </ul> * The total facet counts are maintained as an array of arrays of integers, * where a separate array is kept for each partition. * * @lucene.experimental */	TokenNameCOMMENT_JAVADOC	 Maintain Total Facet Counts per partition, for given parameters: <ul> <li>Index reader of an index</li> <li>Taxonomy index reader</li> <li>Facet indexing params (and particularly the category list params)</li> <li></li> </ul> The total facet counts are maintained as an array of arrays of integers, where a separate array is kept for each partition. * @lucene.experimental 
public	TokenNamepublic	
class	TokenNameclass	
TotalFacetCounts	TokenNameIdentifier	 Total Facet Counts
{	TokenNameLBRACE	
/** total facet counts per partition: totalCounts[partition][ordinal%partitionLength] */	TokenNameCOMMENT_JAVADOC	 total facet counts per partition: totalCounts[partition][ordinal%partitionLength] 
private	TokenNameprivate	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
totalCounts	TokenNameIdentifier	 total Counts
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
TaxonomyReader	TokenNameIdentifier	 Taxonomy Reader
taxonomy	TokenNameIdentifier	 taxonomy
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
FacetIndexingParams	TokenNameIdentifier	 Facet Indexing Params
facetIndexingParams	TokenNameIdentifier	 facet Indexing Params
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
static	TokenNamestatic	
AtomicInteger	TokenNameIdentifier	 Atomic Integer
atomicGen4Test	TokenNameIdentifier	 atomic Gen4 Test
=	TokenNameEQUAL	
new	TokenNamenew	
AtomicInteger	TokenNameIdentifier	 Atomic Integer
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
/** Creation type for test purposes */	TokenNameCOMMENT_JAVADOC	 Creation type for test purposes 
enum	TokenNameenum	
CreationType	TokenNameIdentifier	 Creation Type
{	TokenNameLBRACE	
Computed	TokenNameIdentifier	 Computed
,	TokenNameCOMMA	
Loaded	TokenNameIdentifier	 Loaded
}	TokenNameRBRACE	
// for testing 	TokenNameCOMMENT_LINE	for testing 
final	TokenNamefinal	
int	TokenNameint	
gen4test	TokenNameIdentifier	 gen4test
;	TokenNameSEMICOLON	
final	TokenNamefinal	
CreationType	TokenNameIdentifier	 Creation Type
createType4test	TokenNameIdentifier	 create Type4test
;	TokenNameSEMICOLON	
/** * Construct by key - from index Directory or by recomputing. * @param key the key mapping of this total facet counts (index, taxonomy, category lists...) */	TokenNameCOMMENT_JAVADOC	 Construct by key - from index Directory or by recomputing. @param key the key mapping of this total facet counts (index, taxonomy, category lists...) 
private	TokenNameprivate	
TotalFacetCounts	TokenNameIdentifier	 Total Facet Counts
(	TokenNameLPAREN	
TaxonomyReader	TokenNameIdentifier	 Taxonomy Reader
taxonomy	TokenNameIdentifier	 taxonomy
,	TokenNameCOMMA	
FacetIndexingParams	TokenNameIdentifier	 Facet Indexing Params
facetIndexingParams	TokenNameIdentifier	 facet Indexing Params
,	TokenNameCOMMA	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
counts	TokenNameIdentifier	 counts
,	TokenNameCOMMA	
CreationType	TokenNameIdentifier	 Creation Type
createType4Test	TokenNameIdentifier	 create Type4 Test
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
,	TokenNameCOMMA	
LockObtainFailedException	TokenNameIdentifier	 Lock Obtain Failed Exception
{	TokenNameLBRACE	
this	TokenNamethis	
.	TokenNameDOT	
taxonomy	TokenNameIdentifier	 taxonomy
=	TokenNameEQUAL	
taxonomy	TokenNameIdentifier	 taxonomy
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
facetIndexingParams	TokenNameIdentifier	 facet Indexing Params
=	TokenNameEQUAL	
facetIndexingParams	TokenNameIdentifier	 facet Indexing Params
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
totalCounts	TokenNameIdentifier	 total Counts
=	TokenNameEQUAL	
counts	TokenNameIdentifier	 counts
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
createType4test	TokenNameIdentifier	 create Type4test
=	TokenNameEQUAL	
createType4Test	TokenNameIdentifier	 create Type4 Test
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
gen4test	TokenNameIdentifier	 gen4test
=	TokenNameEQUAL	
atomicGen4Test	TokenNameIdentifier	 atomic Gen4 Test
.	TokenNameDOT	
incrementAndGet	TokenNameIdentifier	 increment And Get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Fill a partition's array with the TotalCountsArray values. * @param partitionArray array to fill * @param partition number of required partition */	TokenNameCOMMENT_JAVADOC	 Fill a partition's array with the TotalCountsArray values. @param partitionArray array to fill @param partition number of required partition 
public	TokenNamepublic	
void	TokenNamevoid	
fillTotalCountsForPartition	TokenNameIdentifier	 fill Total Counts For Partition
(	TokenNameLPAREN	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
partitionArray	TokenNameIdentifier	 partition Array
,	TokenNameCOMMA	
int	TokenNameint	
partition	TokenNameIdentifier	 partition
)	TokenNameRPAREN	
{	TokenNameLBRACE	
int	TokenNameint	
partitionSize	TokenNameIdentifier	 partition Size
=	TokenNameEQUAL	
partitionArray	TokenNameIdentifier	 partition Array
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
countArray	TokenNameIdentifier	 count Array
=	TokenNameEQUAL	
totalCounts	TokenNameIdentifier	 total Counts
[	TokenNameLBRACKET	
partition	TokenNameIdentifier	 partition
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
countArray	TokenNameIdentifier	 count Array
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
countArray	TokenNameIdentifier	 count Array
=	TokenNameEQUAL	
new	TokenNamenew	
int	TokenNameint	
[	TokenNameLBRACKET	
partitionSize	TokenNameIdentifier	 partition Size
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
totalCounts	TokenNameIdentifier	 total Counts
[	TokenNameLBRACKET	
partition	TokenNameIdentifier	 partition
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
countArray	TokenNameIdentifier	 count Array
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
int	TokenNameint	
length	TokenNameIdentifier	 length
=	TokenNameEQUAL	
Math	TokenNameIdentifier	 Math
.	TokenNameDOT	
min	TokenNameIdentifier	 min
(	TokenNameLPAREN	
partitionSize	TokenNameIdentifier	 partition Size
,	TokenNameCOMMA	
countArray	TokenNameIdentifier	 count Array
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
arraycopy	TokenNameIdentifier	 arraycopy
(	TokenNameLPAREN	
countArray	TokenNameIdentifier	 count Array
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
partitionArray	TokenNameIdentifier	 partition Array
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Return the total count of an input category * @param ordinal ordinal of category whose total count is required */	TokenNameCOMMENT_JAVADOC	 Return the total count of an input category @param ordinal ordinal of category whose total count is required 
public	TokenNamepublic	
int	TokenNameint	
getTotalCount	TokenNameIdentifier	 get Total Count
(	TokenNameLPAREN	
int	TokenNameint	
ordinal	TokenNameIdentifier	 ordinal
)	TokenNameRPAREN	
{	TokenNameLBRACE	
int	TokenNameint	
partition	TokenNameIdentifier	 partition
=	TokenNameEQUAL	
PartitionsUtils	TokenNameIdentifier	 Partitions Utils
.	TokenNameDOT	
partitionNumber	TokenNameIdentifier	 partition Number
(	TokenNameLPAREN	
facetIndexingParams	TokenNameIdentifier	 facet Indexing Params
,	TokenNameCOMMA	
ordinal	TokenNameIdentifier	 ordinal
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
int	TokenNameint	
offset	TokenNameIdentifier	 offset
=	TokenNameEQUAL	
ordinal	TokenNameIdentifier	 ordinal
%	TokenNameREMAINDER	
PartitionsUtils	TokenNameIdentifier	 Partitions Utils
.	TokenNameDOT	
partitionSize	TokenNameIdentifier	 partition Size
(	TokenNameLPAREN	
facetIndexingParams	TokenNameIdentifier	 facet Indexing Params
,	TokenNameCOMMA	
taxonomy	TokenNameIdentifier	 taxonomy
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
totalCounts	TokenNameIdentifier	 total Counts
[	TokenNameLBRACKET	
partition	TokenNameIdentifier	 partition
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
offset	TokenNameIdentifier	 offset
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
static	TokenNamestatic	
TotalFacetCounts	TokenNameIdentifier	 Total Facet Counts
loadFromFile	TokenNameIdentifier	 load From File
(	TokenNameLPAREN	
File	TokenNameIdentifier	 File
inputFile	TokenNameIdentifier	 input File
,	TokenNameCOMMA	
TaxonomyReader	TokenNameIdentifier	 Taxonomy Reader
taxonomy	TokenNameIdentifier	 taxonomy
,	TokenNameCOMMA	
FacetIndexingParams	TokenNameIdentifier	 Facet Indexing Params
facetIndexingParams	TokenNameIdentifier	 facet Indexing Params
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
DataInputStream	TokenNameIdentifier	 Data Input Stream
dis	TokenNameIdentifier	 dis
=	TokenNameEQUAL	
new	TokenNamenew	
DataInputStream	TokenNameIdentifier	 Data Input Stream
(	TokenNameLPAREN	
new	TokenNamenew	
BufferedInputStream	TokenNameIdentifier	 Buffered Input Stream
(	TokenNameLPAREN	
new	TokenNamenew	
FileInputStream	TokenNameIdentifier	 File Input Stream
(	TokenNameLPAREN	
inputFile	TokenNameIdentifier	 input File
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
counts	TokenNameIdentifier	 counts
=	TokenNameEQUAL	
new	TokenNamenew	
int	TokenNameint	
[	TokenNameLBRACKET	
dis	TokenNameIdentifier	 dis
.	TokenNameDOT	
readInt	TokenNameIdentifier	 read Int
(	TokenNameLPAREN	
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
<	TokenNameLESS	
counts	TokenNameIdentifier	 counts
.	TokenNameDOT	
length	TokenNameIdentifier	 length
;	TokenNameSEMICOLON	
i	TokenNameIdentifier	 i
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
int	TokenNameint	
size	TokenNameIdentifier	 size
=	TokenNameEQUAL	
dis	TokenNameIdentifier	 dis
.	TokenNameDOT	
readInt	TokenNameIdentifier	 read Int
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
size	TokenNameIdentifier	 size
<	TokenNameLESS	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
counts	TokenNameIdentifier	 counts
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
counts	TokenNameIdentifier	 counts
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
new	TokenNamenew	
int	TokenNameint	
[	TokenNameLBRACKET	
size	TokenNameIdentifier	 size
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
j	TokenNameIdentifier	 j
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
j	TokenNameIdentifier	 j
<	TokenNameLESS	
size	TokenNameIdentifier	 size
;	TokenNameSEMICOLON	
j	TokenNameIdentifier	 j
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
counts	TokenNameIdentifier	 counts
[	TokenNameLBRACKET	
i	TokenNameIdentifier	 i
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
j	TokenNameIdentifier	 j
]	TokenNameRBRACKET	
=	TokenNameEQUAL	
dis	TokenNameIdentifier	 dis
.	TokenNameDOT	
readInt	TokenNameIdentifier	 read Int
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
return	TokenNamereturn	
new	TokenNamenew	
TotalFacetCounts	TokenNameIdentifier	 Total Facet Counts
(	TokenNameLPAREN	
taxonomy	TokenNameIdentifier	 taxonomy
,	TokenNameCOMMA	
facetIndexingParams	TokenNameIdentifier	 facet Indexing Params
,	TokenNameCOMMA	
counts	TokenNameIdentifier	 counts
,	TokenNameCOMMA	
CreationType	TokenNameIdentifier	 Creation Type
.	TokenNameDOT	
Loaded	TokenNameIdentifier	 Loaded
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
finally	TokenNamefinally	
{	TokenNameLBRACE	
dis	TokenNameIdentifier	 dis
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
static	TokenNamestatic	
void	TokenNamevoid	
storeToFile	TokenNameIdentifier	 store To File
(	TokenNameLPAREN	
File	TokenNameIdentifier	 File
outputFile	TokenNameIdentifier	 output File
,	TokenNameCOMMA	
TotalFacetCounts	TokenNameIdentifier	 Total Facet Counts
tfc	TokenNameIdentifier	 tfc
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
DataOutputStream	TokenNameIdentifier	 Data Output Stream
dos	TokenNameIdentifier	 dos
=	TokenNameEQUAL	
new	TokenNamenew	
DataOutputStream	TokenNameIdentifier	 Data Output Stream
(	TokenNameLPAREN	
new	TokenNamenew	
BufferedOutputStream	TokenNameIdentifier	 Buffered Output Stream
(	TokenNameLPAREN	
new	TokenNamenew	
FileOutputStream	TokenNameIdentifier	 File Output Stream
(	TokenNameLPAREN	
outputFile	TokenNameIdentifier	 output File
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
dos	TokenNameIdentifier	 dos
.	TokenNameDOT	
writeInt	TokenNameIdentifier	 write Int
(	TokenNameLPAREN	
tfc	TokenNameIdentifier	 tfc
.	TokenNameDOT	
totalCounts	TokenNameIdentifier	 total Counts
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
counts	TokenNameIdentifier	 counts
:	TokenNameCOLON	
tfc	TokenNameIdentifier	 tfc
.	TokenNameDOT	
totalCounts	TokenNameIdentifier	 total Counts
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
counts	TokenNameIdentifier	 counts
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
dos	TokenNameIdentifier	 dos
.	TokenNameDOT	
writeInt	TokenNameIdentifier	 write Int
(	TokenNameLPAREN	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
{	TokenNameLBRACE	
dos	TokenNameIdentifier	 dos
.	TokenNameDOT	
writeInt	TokenNameIdentifier	 write Int
(	TokenNameLPAREN	
counts	TokenNameIdentifier	 counts
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
i	TokenNameIdentifier	 i
:	TokenNameCOLON	
counts	TokenNameIdentifier	 counts
)	TokenNameRPAREN	
{	TokenNameLBRACE	
dos	TokenNameIdentifier	 dos
.	TokenNameDOT	
writeInt	TokenNameIdentifier	 write Int
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
finally	TokenNamefinally	
{	TokenNameLBRACE	
dos	TokenNameIdentifier	 dos
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
static	TokenNamestatic	
TotalFacetCounts	TokenNameIdentifier	 Total Facet Counts
compute	TokenNameIdentifier	 compute
(	TokenNameLPAREN	
final	TokenNamefinal	
IndexReader	TokenNameIdentifier	 Index Reader
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
final	TokenNamefinal	
TaxonomyReader	TokenNameIdentifier	 Taxonomy Reader
taxonomy	TokenNameIdentifier	 taxonomy
,	TokenNameCOMMA	
final	TokenNamefinal	
FacetIndexingParams	TokenNameIdentifier	 Facet Indexing Params
facetIndexingParams	TokenNameIdentifier	 facet Indexing Params
,	TokenNameCOMMA	
final	TokenNamefinal	
CategoryListCache	TokenNameIdentifier	 Category List Cache
clCache	TokenNameIdentifier	 cl Cache
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
int	TokenNameint	
partitionSize	TokenNameIdentifier	 partition Size
=	TokenNameEQUAL	
PartitionsUtils	TokenNameIdentifier	 Partitions Utils
.	TokenNameDOT	
partitionSize	TokenNameIdentifier	 partition Size
(	TokenNameLPAREN	
facetIndexingParams	TokenNameIdentifier	 facet Indexing Params
,	TokenNameCOMMA	
taxonomy	TokenNameIdentifier	 taxonomy
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
counts	TokenNameIdentifier	 counts
=	TokenNameEQUAL	
new	TokenNamenew	
int	TokenNameint	
[	TokenNameLBRACKET	
(	TokenNameLPAREN	
int	TokenNameint	
)	TokenNameRPAREN	
Math	TokenNameIdentifier	 Math
.	TokenNameDOT	
ceil	TokenNameIdentifier	 ceil
(	TokenNameLPAREN	
taxonomy	TokenNameIdentifier	 taxonomy
.	TokenNameDOT	
getSize	TokenNameIdentifier	 get Size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
/	TokenNameDIVIDE	
(	TokenNameLPAREN	
float	TokenNamefloat	
)	TokenNameRPAREN	
partitionSize	TokenNameIdentifier	 partition Size
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
[	TokenNameLBRACKET	
partitionSize	TokenNameIdentifier	 partition Size
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
FacetSearchParams	TokenNameIdentifier	 Facet Search Params
newSearchParams	TokenNameIdentifier	 new Search Params
=	TokenNameEQUAL	
new	TokenNamenew	
FacetSearchParams	TokenNameIdentifier	 Facet Search Params
(	TokenNameLPAREN	
facetIndexingParams	TokenNameIdentifier	 facet Indexing Params
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//createAllListsSearchParams(facetIndexingParams, this.totalCounts); 	TokenNameCOMMENT_LINE	createAllListsSearchParams(facetIndexingParams, this.totalCounts); 
FacetsAccumulator	TokenNameIdentifier	 Facets Accumulator
fe	TokenNameIdentifier	 fe
=	TokenNameEQUAL	
new	TokenNamenew	
StandardFacetsAccumulator	TokenNameIdentifier	 Standard Facets Accumulator
(	TokenNameLPAREN	
newSearchParams	TokenNameIdentifier	 new Search Params
,	TokenNameCOMMA	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
taxonomy	TokenNameIdentifier	 taxonomy
)	TokenNameRPAREN	
{	TokenNameLBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
protected	TokenNameprotected	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
CategoryListIterator	TokenNameIdentifier	 Category List Iterator
,	TokenNameCOMMA	
Aggregator	TokenNameIdentifier	 Aggregator
>	TokenNameGREATER	
getCategoryListMap	TokenNameIdentifier	 get Category List Map
(	TokenNameLPAREN	
FacetArrays	TokenNameIdentifier	 Facet Arrays
facetArrays	TokenNameIdentifier	 facet Arrays
,	TokenNameCOMMA	
int	TokenNameint	
partition	TokenNameIdentifier	 partition
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
Aggregator	TokenNameIdentifier	 Aggregator
aggregator	TokenNameIdentifier	 aggregator
=	TokenNameEQUAL	
new	TokenNamenew	
CountingAggregator	TokenNameIdentifier	 Counting Aggregator
(	TokenNameLPAREN	
counts	TokenNameIdentifier	 counts
[	TokenNameLBRACKET	
partition	TokenNameIdentifier	 partition
]	TokenNameRBRACKET	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
CategoryListIterator	TokenNameIdentifier	 Category List Iterator
,	TokenNameCOMMA	
Aggregator	TokenNameIdentifier	 Aggregator
>	TokenNameGREATER	
map	TokenNameIdentifier	 map
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
CategoryListIterator	TokenNameIdentifier	 Category List Iterator
,	TokenNameCOMMA	
Aggregator	TokenNameIdentifier	 Aggregator
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
CategoryListParams	TokenNameIdentifier	 Category List Params
clp	TokenNameIdentifier	 clp
:	TokenNameCOLON	
facetIndexingParams	TokenNameIdentifier	 facet Indexing Params
.	TokenNameDOT	
getAllCategoryListParams	TokenNameIdentifier	 get All Category List Params
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
final	TokenNamefinal	
CategoryListIterator	TokenNameIdentifier	 Category List Iterator
cli	TokenNameIdentifier	 cli
=	TokenNameEQUAL	
clIteraor	TokenNameIdentifier	 cl Iteraor
(	TokenNameLPAREN	
clCache	TokenNameIdentifier	 cl Cache
,	TokenNameCOMMA	
clp	TokenNameIdentifier	 clp
,	TokenNameCOMMA	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
partition	TokenNameIdentifier	 partition
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
map	TokenNameIdentifier	 map
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
cli	TokenNameIdentifier	 cli
,	TokenNameCOMMA	
aggregator	TokenNameIdentifier	 aggregator
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
map	TokenNameIdentifier	 map
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
fe	TokenNameIdentifier	 fe
.	TokenNameDOT	
setComplementThreshold	TokenNameIdentifier	 set Complement Threshold
(	TokenNameLPAREN	
FacetsAccumulator	TokenNameIdentifier	 Facets Accumulator
.	TokenNameDOT	
DISABLE_COMPLEMENT	TokenNameIdentifier	 DISABLE  COMPLEMENT
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
fe	TokenNameIdentifier	 fe
.	TokenNameDOT	
accumulate	TokenNameIdentifier	 accumulate
(	TokenNameLPAREN	
ScoredDocIdsUtils	TokenNameIdentifier	 Scored Doc Ids Utils
.	TokenNameDOT	
createAllDocsScoredDocIDs	TokenNameIdentifier	 create All Docs Scored Doc I Ds
(	TokenNameLPAREN	
indexReader	TokenNameIdentifier	 index Reader
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
new	TokenNamenew	
TotalFacetCounts	TokenNameIdentifier	 Total Facet Counts
(	TokenNameLPAREN	
taxonomy	TokenNameIdentifier	 taxonomy
,	TokenNameCOMMA	
facetIndexingParams	TokenNameIdentifier	 facet Indexing Params
,	TokenNameCOMMA	
counts	TokenNameIdentifier	 counts
,	TokenNameCOMMA	
CreationType	TokenNameIdentifier	 Creation Type
.	TokenNameDOT	
Computed	TokenNameIdentifier	 Computed
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
static	TokenNamestatic	
CategoryListIterator	TokenNameIdentifier	 Category List Iterator
clIteraor	TokenNameIdentifier	 cl Iteraor
(	TokenNameLPAREN	
CategoryListCache	TokenNameIdentifier	 Category List Cache
clCache	TokenNameIdentifier	 cl Cache
,	TokenNameCOMMA	
CategoryListParams	TokenNameIdentifier	 Category List Params
clp	TokenNameIdentifier	 clp
,	TokenNameCOMMA	
IndexReader	TokenNameIdentifier	 Index Reader
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
int	TokenNameint	
partition	TokenNameIdentifier	 partition
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
clCache	TokenNameIdentifier	 cl Cache
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
CategoryListData	TokenNameIdentifier	 Category List Data
cld	TokenNameIdentifier	 cld
=	TokenNameEQUAL	
clCache	TokenNameIdentifier	 cl Cache
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
clp	TokenNameIdentifier	 clp
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
cld	TokenNameIdentifier	 cld
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
cld	TokenNameIdentifier	 cld
.	TokenNameDOT	
iterator	TokenNameIdentifier	 iterator
(	TokenNameLPAREN	
partition	TokenNameIdentifier	 partition
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
return	TokenNamereturn	
clp	TokenNameIdentifier	 clp
.	TokenNameDOT	
createCategoryListIterator	TokenNameIdentifier	 create Category List Iterator
(	TokenNameLPAREN	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
partition	TokenNameIdentifier	 partition
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
