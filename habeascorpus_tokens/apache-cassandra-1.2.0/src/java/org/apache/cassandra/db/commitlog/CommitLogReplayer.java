/* * Licensed to the Apache Software Foundation (ASF) under one * or more contributor license agreements. See the NOTICE file * distributed with this work for additional information * regarding copyright ownership. The ASF licenses this file * to you under the Apache License, Version 2.0 (the * "License"); you may not use this file except in compliance * with the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, * software distributed under the License is distributed on an * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY * KIND, either express or implied. See the License for the * specific language governing permissions and limitations * under the License. */	TokenNameCOMMENT_BLOCK	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
commitlog	TokenNameIdentifier	 commitlog
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
DataInputStream	TokenNameIdentifier	 Data Input Stream
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
EOFException	TokenNameIdentifier	 EOF Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
File	TokenNameIdentifier	 File
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
IOException	TokenNameIdentifier	 IO Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
Future	TokenNameIdentifier	 Future
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
atomic	TokenNameIdentifier	 atomic
.	TokenNameDOT	
AtomicInteger	TokenNameIdentifier	 Atomic Integer
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
zip	TokenNameIdentifier	 zip
.	TokenNameDOT	
Checksum	TokenNameIdentifier	 Checksum
;	TokenNameSEMICOLON	
import	TokenNameimport	
com	TokenNameIdentifier	 com
.	TokenNameDOT	
google	TokenNameIdentifier	 google
.	TokenNameDOT	
common	TokenNameIdentifier	 common
.	TokenNameDOT	
collect	TokenNameIdentifier	 collect
.	TokenNameDOT	
Ordering	TokenNameIdentifier	 Ordering
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
commons	TokenNameIdentifier	 commons
.	TokenNameDOT	
lang	TokenNameIdentifier	 lang
.	TokenNameDOT	
StringUtils	TokenNameIdentifier	 String Utils
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
Logger	TokenNameIdentifier	 Logger
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
LoggerFactory	TokenNameIdentifier	 Logger Factory
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
Stage	TokenNameIdentifier	 Stage
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
StageManager	TokenNameIdentifier	 Stage Manager
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
config	TokenNameIdentifier	 config
.	TokenNameDOT	
Schema	TokenNameIdentifier	 Schema
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
IColumnSerializer	TokenNameIdentifier	 I Column Serializer
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
FastByteArrayInputStream	TokenNameIdentifier	 Fast Byte Array Input Stream
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
FileUtils	TokenNameIdentifier	 File Utils
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
RandomAccessReader	TokenNameIdentifier	 Random Access Reader
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
FBUtilities	TokenNameIdentifier	 FB Utilities
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
PureJavaCrc32	TokenNameIdentifier	 Pure Java Crc32
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
WrappedRunnable	TokenNameIdentifier	 Wrapped Runnable
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
cliffc	TokenNameIdentifier	 cliffc
.	TokenNameDOT	
high_scale_lib	TokenNameIdentifier	 high scale lib
.	TokenNameDOT	
NonBlockingHashSet	TokenNameIdentifier	 Non Blocking Hash Set
;	TokenNameSEMICOLON	
public	TokenNamepublic	
class	TokenNameclass	
CommitLogReplayer	TokenNameIdentifier	 Commit Log Replayer
{	TokenNameLBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
Logger	TokenNameIdentifier	 Logger
logger	TokenNameIdentifier	 logger
=	TokenNameEQUAL	
LoggerFactory	TokenNameIdentifier	 Logger Factory
.	TokenNameDOT	
getLogger	TokenNameIdentifier	 get Logger
(	TokenNameLPAREN	
CommitLogReplayer	TokenNameIdentifier	 Commit Log Replayer
.	TokenNameDOT	
class	TokenNameclass	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
int	TokenNameint	
MAX_OUTSTANDING_REPLAY_COUNT	TokenNameIdentifier	 MAX  OUTSTANDING  REPLAY  COUNT
=	TokenNameEQUAL	
1024	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
Table	TokenNameIdentifier	 Table
>	TokenNameGREATER	
tablesRecovered	TokenNameIdentifier	 tables Recovered
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Future	TokenNameIdentifier	 Future
<	TokenNameLESS	
?	TokenNameQUESTION	
>>	TokenNameRIGHT_SHIFT	
futures	TokenNameIdentifier	 futures
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
UUID	TokenNameIdentifier	 UUID
,	TokenNameCOMMA	
AtomicInteger	TokenNameIdentifier	 Atomic Integer
>	TokenNameGREATER	
invalidMutations	TokenNameIdentifier	 invalid Mutations
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
AtomicInteger	TokenNameIdentifier	 Atomic Integer
replayedCount	TokenNameIdentifier	 replayed Count
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
UUID	TokenNameIdentifier	 UUID
,	TokenNameCOMMA	
ReplayPosition	TokenNameIdentifier	 Replay Position
>	TokenNameGREATER	
cfPositions	TokenNameIdentifier	 cf Positions
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
ReplayPosition	TokenNameIdentifier	 Replay Position
globalPosition	TokenNameIdentifier	 global Position
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
Checksum	TokenNameIdentifier	 Checksum
checksum	TokenNameIdentifier	 checksum
;	TokenNameSEMICOLON	
private	TokenNameprivate	
byte	TokenNamebyte	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
buffer	TokenNameIdentifier	 buffer
;	TokenNameSEMICOLON	
public	TokenNamepublic	
CommitLogReplayer	TokenNameIdentifier	 Commit Log Replayer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
this	TokenNamethis	
.	TokenNameDOT	
tablesRecovered	TokenNameIdentifier	 tables Recovered
=	TokenNameEQUAL	
new	TokenNamenew	
NonBlockingHashSet	TokenNameIdentifier	 Non Blocking Hash Set
<	TokenNameLESS	
Table	TokenNameIdentifier	 Table
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
futures	TokenNameIdentifier	 futures
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
Future	TokenNameIdentifier	 Future
<	TokenNameLESS	
?	TokenNameQUESTION	
>>	TokenNameRIGHT_SHIFT	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
buffer	TokenNameIdentifier	 buffer
=	TokenNameEQUAL	
new	TokenNamenew	
byte	TokenNamebyte	
[	TokenNameLBRACKET	
4096	TokenNameIntegerLiteral	
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
invalidMutations	TokenNameIdentifier	 invalid Mutations
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
UUID	TokenNameIdentifier	 UUID
,	TokenNameCOMMA	
AtomicInteger	TokenNameIdentifier	 Atomic Integer
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// count the number of replayed mutation. We don't really care about atomicity, but we need it to be a reference. 	TokenNameCOMMENT_LINE	count the number of replayed mutation. We don't really care about atomicity, but we need it to be a reference. 
this	TokenNamethis	
.	TokenNameDOT	
replayedCount	TokenNameIdentifier	 replayed Count
=	TokenNameEQUAL	
new	TokenNamenew	
AtomicInteger	TokenNameIdentifier	 Atomic Integer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
checksum	TokenNameIdentifier	 checksum
=	TokenNameEQUAL	
new	TokenNamenew	
PureJavaCrc32	TokenNameIdentifier	 Pure Java Crc32
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// compute per-CF and global replay positions 	TokenNameCOMMENT_LINE	compute per-CF and global replay positions 
cfPositions	TokenNameIdentifier	 cf Positions
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
UUID	TokenNameIdentifier	 UUID
,	TokenNameCOMMA	
ReplayPosition	TokenNameIdentifier	 Replay Position
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Ordering	TokenNameIdentifier	 Ordering
<	TokenNameLESS	
ReplayPosition	TokenNameIdentifier	 Replay Position
>	TokenNameGREATER	
replayPositionOrdering	TokenNameIdentifier	 replay Position Ordering
=	TokenNameEQUAL	
Ordering	TokenNameIdentifier	 Ordering
.	TokenNameDOT	
from	TokenNameIdentifier	 from
(	TokenNameLPAREN	
ReplayPosition	TokenNameIdentifier	 Replay Position
.	TokenNameDOT	
comparator	TokenNameIdentifier	 comparator
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
UUID	TokenNameIdentifier	 UUID
,	TokenNameCOMMA	
ReplayPosition	TokenNameIdentifier	 Replay Position
>	TokenNameGREATER	
truncationPositions	TokenNameIdentifier	 truncation Positions
=	TokenNameEQUAL	
SystemTable	TokenNameIdentifier	 System Table
.	TokenNameDOT	
getTruncationPositions	TokenNameIdentifier	 get Truncation Positions
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
cfs	TokenNameIdentifier	 cfs
:	TokenNameCOLON	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
.	TokenNameDOT	
all	TokenNameIdentifier	 all
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// it's important to call RP.gRP per-cf, before aggregating all the positions w/ the Ordering.min call 	TokenNameCOMMENT_LINE	it's important to call RP.gRP per-cf, before aggregating all the positions w/ the Ordering.min call 
// below: gRP will return NONE if there are no flushed sstables, which is important to have in the 	TokenNameCOMMENT_LINE	below: gRP will return NONE if there are no flushed sstables, which is important to have in the 
// list (otherwise we'll just start replay from the first flush position that we do have, which is not correct). 	TokenNameCOMMENT_LINE	list (otherwise we'll just start replay from the first flush position that we do have, which is not correct). 
ReplayPosition	TokenNameIdentifier	 Replay Position
rp	TokenNameIdentifier	 rp
=	TokenNameEQUAL	
ReplayPosition	TokenNameIdentifier	 Replay Position
.	TokenNameDOT	
getReplayPosition	TokenNameIdentifier	 get Replay Position
(	TokenNameLPAREN	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
getSSTables	TokenNameIdentifier	 get SS Tables
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// but, if we've truncted the cf in question, then we need to need to start replay after the truncation 	TokenNameCOMMENT_LINE	but, if we've truncted the cf in question, then we need to need to start replay after the truncation 
ReplayPosition	TokenNameIdentifier	 Replay Position
truncatedAt	TokenNameIdentifier	 truncated At
=	TokenNameEQUAL	
truncationPositions	TokenNameIdentifier	 truncation Positions
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
metadata	TokenNameIdentifier	 metadata
.	TokenNameDOT	
cfId	TokenNameIdentifier	 cf Id
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
truncatedAt	TokenNameIdentifier	 truncated At
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
rp	TokenNameIdentifier	 rp
=	TokenNameEQUAL	
replayPositionOrdering	TokenNameIdentifier	 replay Position Ordering
.	TokenNameDOT	
max	TokenNameIdentifier	 max
(	TokenNameLPAREN	
Arrays	TokenNameIdentifier	 Arrays
.	TokenNameDOT	
asList	TokenNameIdentifier	 as List
(	TokenNameLPAREN	
rp	TokenNameIdentifier	 rp
,	TokenNameCOMMA	
truncatedAt	TokenNameIdentifier	 truncated At
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
cfPositions	TokenNameIdentifier	 cf Positions
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
cfs	TokenNameIdentifier	 cfs
.	TokenNameDOT	
metadata	TokenNameIdentifier	 metadata
.	TokenNameDOT	
cfId	TokenNameIdentifier	 cf Id
,	TokenNameCOMMA	
rp	TokenNameIdentifier	 rp
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
globalPosition	TokenNameIdentifier	 global Position
=	TokenNameEQUAL	
replayPositionOrdering	TokenNameIdentifier	 replay Position Ordering
.	TokenNameDOT	
min	TokenNameIdentifier	 min
(	TokenNameLPAREN	
cfPositions	TokenNameIdentifier	 cf Positions
.	TokenNameDOT	
values	TokenNameIdentifier	 values
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
recover	TokenNameIdentifier	 recover
(	TokenNameLPAREN	
File	TokenNameIdentifier	 File
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
clogs	TokenNameIdentifier	 clogs
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
final	TokenNamefinal	
File	TokenNameIdentifier	 File
file	TokenNameIdentifier	 file
:	TokenNameCOLON	
clogs	TokenNameIdentifier	 clogs
)	TokenNameRPAREN	
recover	TokenNameIdentifier	 recover
(	TokenNameLPAREN	
file	TokenNameIdentifier	 file
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
int	TokenNameint	
blockForWrites	TokenNameIdentifier	 block For Writes
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
Map	TokenNameIdentifier	 Map
.	TokenNameDOT	
Entry	TokenNameIdentifier	 Entry
<	TokenNameLESS	
UUID	TokenNameIdentifier	 UUID
,	TokenNameCOMMA	
AtomicInteger	TokenNameIdentifier	 Atomic Integer
>	TokenNameGREATER	
entry	TokenNameIdentifier	 entry
:	TokenNameCOLON	
invalidMutations	TokenNameIdentifier	 invalid Mutations
.	TokenNameDOT	
entrySet	TokenNameIdentifier	 entry Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
info	TokenNameIdentifier	 info
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"Skipped %d mutations from unknown (probably removed) CF with id %s"	TokenNameStringLiteral	Skipped %d mutations from unknown (probably removed) CF with id %s
,	TokenNameCOMMA	
entry	TokenNameIdentifier	 entry
.	TokenNameDOT	
getValue	TokenNameIdentifier	 get Value
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
intValue	TokenNameIdentifier	 int Value
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
entry	TokenNameIdentifier	 entry
.	TokenNameDOT	
getKey	TokenNameIdentifier	 get Key
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// wait for all the writes to finish on the mutation stage 	TokenNameCOMMENT_LINE	wait for all the writes to finish on the mutation stage 
FBUtilities	TokenNameIdentifier	 FB Utilities
.	TokenNameDOT	
waitOnFutures	TokenNameIdentifier	 wait On Futures
(	TokenNameLPAREN	
futures	TokenNameIdentifier	 futures
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"Finished waiting on mutations from recovery"	TokenNameStringLiteral	Finished waiting on mutations from recovery
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// flush replayed tables 	TokenNameCOMMENT_LINE	flush replayed tables 
futures	TokenNameIdentifier	 futures
.	TokenNameDOT	
clear	TokenNameIdentifier	 clear
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
Table	TokenNameIdentifier	 Table
table	TokenNameIdentifier	 table
:	TokenNameCOLON	
tablesRecovered	TokenNameIdentifier	 tables Recovered
)	TokenNameRPAREN	
futures	TokenNameIdentifier	 futures
.	TokenNameDOT	
addAll	TokenNameIdentifier	 add All
(	TokenNameLPAREN	
table	TokenNameIdentifier	 table
.	TokenNameDOT	
flush	TokenNameIdentifier	 flush
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
FBUtilities	TokenNameIdentifier	 FB Utilities
.	TokenNameDOT	
waitOnFutures	TokenNameIdentifier	 wait On Futures
(	TokenNameLPAREN	
futures	TokenNameIdentifier	 futures
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
replayedCount	TokenNameIdentifier	 replayed Count
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
recover	TokenNameIdentifier	 recover
(	TokenNameLPAREN	
File	TokenNameIdentifier	 File
file	TokenNameIdentifier	 file
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
info	TokenNameIdentifier	 info
(	TokenNameLPAREN	
"Replaying "	TokenNameStringLiteral	Replaying 
+	TokenNamePLUS	
file	TokenNameIdentifier	 file
.	TokenNameDOT	
getPath	TokenNameIdentifier	 get Path
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
CommitLogDescriptor	TokenNameIdentifier	 Commit Log Descriptor
desc	TokenNameIdentifier	 desc
=	TokenNameEQUAL	
CommitLogDescriptor	TokenNameIdentifier	 Commit Log Descriptor
.	TokenNameDOT	
fromFileName	TokenNameIdentifier	 from File Name
(	TokenNameLPAREN	
file	TokenNameIdentifier	 file
.	TokenNameDOT	
getName	TokenNameIdentifier	 get Name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
long	TokenNamelong	
segment	TokenNameIdentifier	 segment
=	TokenNameEQUAL	
desc	TokenNameIdentifier	 desc
.	TokenNameDOT	
id	TokenNameIdentifier	 id
;	TokenNameSEMICOLON	
int	TokenNameint	
version	TokenNameIdentifier	 version
=	TokenNameEQUAL	
desc	TokenNameIdentifier	 desc
.	TokenNameDOT	
getMessagingVersion	TokenNameIdentifier	 get Messaging Version
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
RandomAccessReader	TokenNameIdentifier	 Random Access Reader
reader	TokenNameIdentifier	 reader
=	TokenNameEQUAL	
RandomAccessReader	TokenNameIdentifier	 Random Access Reader
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
new	TokenNamenew	
File	TokenNameIdentifier	 File
(	TokenNameLPAREN	
file	TokenNameIdentifier	 file
.	TokenNameDOT	
getAbsolutePath	TokenNameIdentifier	 get Absolute Path
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
assert	TokenNameassert	
reader	TokenNameIdentifier	 reader
.	TokenNameDOT	
length	TokenNameIdentifier	 length
(	TokenNameLPAREN	
)	TokenNameRPAREN	
<=	TokenNameLESS_EQUAL	
Integer	TokenNameIdentifier	 Integer
.	TokenNameDOT	
MAX_VALUE	TokenNameIdentifier	 MAX  VALUE
;	TokenNameSEMICOLON	
int	TokenNameint	
replayPosition	TokenNameIdentifier	 replay Position
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
globalPosition	TokenNameIdentifier	 global Position
.	TokenNameDOT	
segment	TokenNameIdentifier	 segment
<	TokenNameLESS	
segment	TokenNameIdentifier	 segment
)	TokenNameRPAREN	
replayPosition	TokenNameIdentifier	 replay Position
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
globalPosition	TokenNameIdentifier	 global Position
.	TokenNameDOT	
segment	TokenNameIdentifier	 segment
==	TokenNameEQUAL_EQUAL	
segment	TokenNameIdentifier	 segment
)	TokenNameRPAREN	
replayPosition	TokenNameIdentifier	 replay Position
=	TokenNameEQUAL	
globalPosition	TokenNameIdentifier	 global Position
.	TokenNameDOT	
position	TokenNameIdentifier	 position
;	TokenNameSEMICOLON	
else	TokenNameelse	
replayPosition	TokenNameIdentifier	 replay Position
=	TokenNameEQUAL	
(	TokenNameLPAREN	
int	TokenNameint	
)	TokenNameRPAREN	
reader	TokenNameIdentifier	 reader
.	TokenNameDOT	
length	TokenNameIdentifier	 length
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
replayPosition	TokenNameIdentifier	 replay Position
<	TokenNameLESS	
0	TokenNameIntegerLiteral	
||	TokenNameOR_OR	
replayPosition	TokenNameIdentifier	 replay Position
>=	TokenNameGREATER_EQUAL	
reader	TokenNameIdentifier	 reader
.	TokenNameDOT	
length	TokenNameIdentifier	 length
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// replayPosition > reader.length() can happen if some data gets flushed before it is written to the commitlog 	TokenNameCOMMENT_LINE	replayPosition > reader.length() can happen if some data gets flushed before it is written to the commitlog 
// (see https://issues.apache.org/jira/browse/CASSANDRA-2285) 	TokenNameCOMMENT_LINE	(see https://issues.apache.org/jira/browse/CASSANDRA-2285) 
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"skipping replay of fully-flushed {}"	TokenNameStringLiteral	skipping replay of fully-flushed {}
,	TokenNameCOMMA	
file	TokenNameIdentifier	 file
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
reader	TokenNameIdentifier	 reader
.	TokenNameDOT	
seek	TokenNameIdentifier	 seek
(	TokenNameLPAREN	
replayPosition	TokenNameIdentifier	 replay Position
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
isDebugEnabled	TokenNameIdentifier	 is Debug Enabled
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"Replaying "	TokenNameStringLiteral	Replaying 
+	TokenNamePLUS	
file	TokenNameIdentifier	 file
+	TokenNamePLUS	
" starting at "	TokenNameStringLiteral	 starting at 
+	TokenNamePLUS	
reader	TokenNameIdentifier	 reader
.	TokenNameDOT	
getFilePointer	TokenNameIdentifier	 get File Pointer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
/* read the logs populate RowMutation and apply */	TokenNameCOMMENT_BLOCK	 read the logs populate RowMutation and apply 
while	TokenNamewhile	
(	TokenNameLPAREN	
!	TokenNameNOT	
reader	TokenNameIdentifier	 reader
.	TokenNameDOT	
isEOF	TokenNameIdentifier	 is EOF
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
isDebugEnabled	TokenNameIdentifier	 is Debug Enabled
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"Reading mutation at "	TokenNameStringLiteral	Reading mutation at 
+	TokenNamePLUS	
reader	TokenNameIdentifier	 reader
.	TokenNameDOT	
getFilePointer	TokenNameIdentifier	 get File Pointer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
long	TokenNamelong	
claimedCRC32	TokenNameIdentifier	 claimed CR C32
;	TokenNameSEMICOLON	
int	TokenNameint	
serializedSize	TokenNameIdentifier	 serialized Size
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
// any of the reads may hit EOF 	TokenNameCOMMENT_LINE	any of the reads may hit EOF 
serializedSize	TokenNameIdentifier	 serialized Size
=	TokenNameEQUAL	
reader	TokenNameIdentifier	 reader
.	TokenNameDOT	
readInt	TokenNameIdentifier	 read Int
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
serializedSize	TokenNameIdentifier	 serialized Size
==	TokenNameEQUAL_EQUAL	
CommitLog	TokenNameIdentifier	 Commit Log
.	TokenNameDOT	
END_OF_SEGMENT_MARKER	TokenNameIdentifier	 END  OF  SEGMENT  MARKER
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"Encountered end of segment marker at "	TokenNameStringLiteral	Encountered end of segment marker at 
+	TokenNamePLUS	
reader	TokenNameIdentifier	 reader
.	TokenNameDOT	
getFilePointer	TokenNameIdentifier	 get File Pointer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
break	TokenNamebreak	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// RowMutation must be at LEAST 10 bytes: 	TokenNameCOMMENT_LINE	RowMutation must be at LEAST 10 bytes: 
// 3 each for a non-empty Table and Key (including the 	TokenNameCOMMENT_LINE	3 each for a non-empty Table and Key (including the 
// 2-byte length from writeUTF/writeWithShortLength) and 4 bytes for column count. 	TokenNameCOMMENT_LINE	2-byte length from writeUTF/writeWithShortLength) and 4 bytes for column count. 
// This prevents CRC by being fooled by special-case garbage in the file; see CASSANDRA-2128 	TokenNameCOMMENT_LINE	This prevents CRC by being fooled by special-case garbage in the file; see CASSANDRA-2128 
if	TokenNameif	
(	TokenNameLPAREN	
serializedSize	TokenNameIdentifier	 serialized Size
<	TokenNameLESS	
10	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
break	TokenNamebreak	
;	TokenNameSEMICOLON	
long	TokenNamelong	
claimedSizeChecksum	TokenNameIdentifier	 claimed Size Checksum
=	TokenNameEQUAL	
reader	TokenNameIdentifier	 reader
.	TokenNameDOT	
readLong	TokenNameIdentifier	 read Long
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
checksum	TokenNameIdentifier	 checksum
.	TokenNameDOT	
reset	TokenNameIdentifier	 reset
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
checksum	TokenNameIdentifier	 checksum
.	TokenNameDOT	
update	TokenNameIdentifier	 update
(	TokenNameLPAREN	
serializedSize	TokenNameIdentifier	 serialized Size
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
checksum	TokenNameIdentifier	 checksum
.	TokenNameDOT	
getValue	TokenNameIdentifier	 get Value
(	TokenNameLPAREN	
)	TokenNameRPAREN	
!=	TokenNameNOT_EQUAL	
claimedSizeChecksum	TokenNameIdentifier	 claimed Size Checksum
)	TokenNameRPAREN	
break	TokenNamebreak	
;	TokenNameSEMICOLON	
// entry wasn't synced correctly/fully. that's 	TokenNameCOMMENT_LINE	entry wasn't synced correctly/fully. that's 
// ok. 	TokenNameCOMMENT_LINE	ok. 
if	TokenNameif	
(	TokenNameLPAREN	
serializedSize	TokenNameIdentifier	 serialized Size
>	TokenNameGREATER	
buffer	TokenNameIdentifier	 buffer
.	TokenNameDOT	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
buffer	TokenNameIdentifier	 buffer
=	TokenNameEQUAL	
new	TokenNamenew	
byte	TokenNamebyte	
[	TokenNameLBRACKET	
(	TokenNameLPAREN	
int	TokenNameint	
)	TokenNameRPAREN	
(	TokenNameLPAREN	
1.2	TokenNameDoubleLiteral	
*	TokenNameMULTIPLY	
serializedSize	TokenNameIdentifier	 serialized Size
)	TokenNameRPAREN	
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
reader	TokenNameIdentifier	 reader
.	TokenNameDOT	
readFully	TokenNameIdentifier	 read Fully
(	TokenNameLPAREN	
buffer	TokenNameIdentifier	 buffer
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
serializedSize	TokenNameIdentifier	 serialized Size
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
claimedCRC32	TokenNameIdentifier	 claimed CR C32
=	TokenNameEQUAL	
reader	TokenNameIdentifier	 reader
.	TokenNameDOT	
readLong	TokenNameIdentifier	 read Long
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
EOFException	TokenNameIdentifier	 EOF Exception
eof	TokenNameIdentifier	 eof
)	TokenNameRPAREN	
{	TokenNameLBRACE	
break	TokenNamebreak	
;	TokenNameSEMICOLON	
// last CL entry didn't get completely written. that's ok. 	TokenNameCOMMENT_LINE	last CL entry didn't get completely written. that's ok. 
}	TokenNameRBRACE	
checksum	TokenNameIdentifier	 checksum
.	TokenNameDOT	
update	TokenNameIdentifier	 update
(	TokenNameLPAREN	
buffer	TokenNameIdentifier	 buffer
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
serializedSize	TokenNameIdentifier	 serialized Size
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
claimedCRC32	TokenNameIdentifier	 claimed CR C32
!=	TokenNameNOT_EQUAL	
checksum	TokenNameIdentifier	 checksum
.	TokenNameDOT	
getValue	TokenNameIdentifier	 get Value
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// this entry must not have been fsynced. probably the rest is bad too, 	TokenNameCOMMENT_LINE	this entry must not have been fsynced. probably the rest is bad too, 
// but just in case there is no harm in trying them (since we still read on an entry boundary) 	TokenNameCOMMENT_LINE	but just in case there is no harm in trying them (since we still read on an entry boundary) 
continue	TokenNamecontinue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/* deserialize the commit log entry */	TokenNameCOMMENT_BLOCK	 deserialize the commit log entry 
FastByteArrayInputStream	TokenNameIdentifier	 Fast Byte Array Input Stream
bufIn	TokenNameIdentifier	 buf In
=	TokenNameEQUAL	
new	TokenNamenew	
FastByteArrayInputStream	TokenNameIdentifier	 Fast Byte Array Input Stream
(	TokenNameLPAREN	
buffer	TokenNameIdentifier	 buffer
,	TokenNameCOMMA	
0	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
serializedSize	TokenNameIdentifier	 serialized Size
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
RowMutation	TokenNameIdentifier	 Row Mutation
rm	TokenNameIdentifier	 rm
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
// assuming version here. We've gone to lengths to make sure what gets written to the CL is in 	TokenNameCOMMENT_LINE	assuming version here. We've gone to lengths to make sure what gets written to the CL is in 
// the current version. so do make sure the CL is drained prior to upgrading a node. 	TokenNameCOMMENT_LINE	the current version. so do make sure the CL is drained prior to upgrading a node. 
rm	TokenNameIdentifier	 rm
=	TokenNameEQUAL	
RowMutation	TokenNameIdentifier	 Row Mutation
.	TokenNameDOT	
serializer	TokenNameIdentifier	 serializer
.	TokenNameDOT	
deserialize	TokenNameIdentifier	 deserialize
(	TokenNameLPAREN	
new	TokenNamenew	
DataInputStream	TokenNameIdentifier	 Data Input Stream
(	TokenNameLPAREN	
bufIn	TokenNameIdentifier	 buf In
)	TokenNameRPAREN	
,	TokenNameCOMMA	
version	TokenNameIdentifier	 version
,	TokenNameCOMMA	
IColumnSerializer	TokenNameIdentifier	 I Column Serializer
.	TokenNameDOT	
Flag	TokenNameIdentifier	 Flag
.	TokenNameDOT	
LOCAL	TokenNameIdentifier	 LOCAL
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
UnknownColumnFamilyException	TokenNameIdentifier	 Unknown Column Family Exception
ex	TokenNameIdentifier	 ex
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
ex	TokenNameIdentifier	 ex
.	TokenNameDOT	
cfId	TokenNameIdentifier	 cf Id
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
continue	TokenNamecontinue	
;	TokenNameSEMICOLON	
AtomicInteger	TokenNameIdentifier	 Atomic Integer
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
invalidMutations	TokenNameIdentifier	 invalid Mutations
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
ex	TokenNameIdentifier	 ex
.	TokenNameDOT	
cfId	TokenNameIdentifier	 cf Id
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
i	TokenNameIdentifier	 i
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
i	TokenNameIdentifier	 i
=	TokenNameEQUAL	
new	TokenNamenew	
AtomicInteger	TokenNameIdentifier	 Atomic Integer
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
invalidMutations	TokenNameIdentifier	 invalid Mutations
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
ex	TokenNameIdentifier	 ex
.	TokenNameDOT	
cfId	TokenNameIdentifier	 cf Id
,	TokenNameCOMMA	
i	TokenNameIdentifier	 i
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
i	TokenNameIdentifier	 i
.	TokenNameDOT	
incrementAndGet	TokenNameIdentifier	 increment And Get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
continue	TokenNamecontinue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
isDebugEnabled	TokenNameIdentifier	 is Debug Enabled
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"replaying mutation for %s.%s: %s"	TokenNameStringLiteral	replaying mutation for %s.%s: %s
,	TokenNameCOMMA	
rm	TokenNameIdentifier	 rm
.	TokenNameDOT	
getTable	TokenNameIdentifier	 get Table
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
bytesToHex	TokenNameIdentifier	 bytes To Hex
(	TokenNameLPAREN	
rm	TokenNameIdentifier	 rm
.	TokenNameDOT	
key	TokenNameIdentifier	 key
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
"{"	TokenNameStringLiteral	{
+	TokenNamePLUS	
StringUtils	TokenNameIdentifier	 String Utils
.	TokenNameDOT	
join	TokenNameIdentifier	 join
(	TokenNameLPAREN	
rm	TokenNameIdentifier	 rm
.	TokenNameDOT	
getColumnFamilies	TokenNameIdentifier	 get Column Families
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
iterator	TokenNameIdentifier	 iterator
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
", "	TokenNameStringLiteral	, 
)	TokenNameRPAREN	
+	TokenNamePLUS	
"}"	TokenNameStringLiteral	}
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
long	TokenNamelong	
entryLocation	TokenNameIdentifier	 entry Location
=	TokenNameEQUAL	
reader	TokenNameIdentifier	 reader
.	TokenNameDOT	
getFilePointer	TokenNameIdentifier	 get File Pointer
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
RowMutation	TokenNameIdentifier	 Row Mutation
frm	TokenNameIdentifier	 frm
=	TokenNameEQUAL	
rm	TokenNameIdentifier	 rm
;	TokenNameSEMICOLON	
Runnable	TokenNameIdentifier	 Runnable
runnable	TokenNameIdentifier	 runnable
=	TokenNameEQUAL	
new	TokenNamenew	
WrappedRunnable	TokenNameIdentifier	 Wrapped Runnable
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
runMayThrow	TokenNameIdentifier	 run May Throw
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
Schema	TokenNameIdentifier	 Schema
.	TokenNameDOT	
instance	TokenNameIdentifier	 instance
.	TokenNameDOT	
getKSMetaData	TokenNameIdentifier	 get KS Meta Data
(	TokenNameLPAREN	
frm	TokenNameIdentifier	 frm
.	TokenNameDOT	
getTable	TokenNameIdentifier	 get Table
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
return	TokenNamereturn	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
pointInTimeExceeded	TokenNameIdentifier	 point In Time Exceeded
(	TokenNameLPAREN	
frm	TokenNameIdentifier	 frm
)	TokenNameRPAREN	
)	TokenNameRPAREN	
return	TokenNamereturn	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
Table	TokenNameIdentifier	 Table
table	TokenNameIdentifier	 table
=	TokenNameEQUAL	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
frm	TokenNameIdentifier	 frm
.	TokenNameDOT	
getTable	TokenNameIdentifier	 get Table
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
RowMutation	TokenNameIdentifier	 Row Mutation
newRm	TokenNameIdentifier	 new Rm
=	TokenNameEQUAL	
new	TokenNamenew	
RowMutation	TokenNameIdentifier	 Row Mutation
(	TokenNameLPAREN	
frm	TokenNameIdentifier	 frm
.	TokenNameDOT	
getTable	TokenNameIdentifier	 get Table
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
frm	TokenNameIdentifier	 frm
.	TokenNameDOT	
key	TokenNameIdentifier	 key
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Rebuild the row mutation, omitting column families that 	TokenNameCOMMENT_LINE	Rebuild the row mutation, omitting column families that 
// a) have already been flushed, 	TokenNameCOMMENT_LINE	a) have already been flushed, 
// b) are part of a cf that was dropped. Keep in mind that the cf.name() is suspect. do every thing based on the cfid instead. 	TokenNameCOMMENT_LINE	b) are part of a cf that was dropped. Keep in mind that the cf.name() is suspect. do every thing based on the cfid instead. 
for	TokenNamefor	
(	TokenNameLPAREN	
ColumnFamily	TokenNameIdentifier	 Column Family
columnFamily	TokenNameIdentifier	 column Family
:	TokenNameCOLON	
frm	TokenNameIdentifier	 frm
.	TokenNameDOT	
getColumnFamilies	TokenNameIdentifier	 get Column Families
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
Schema	TokenNameIdentifier	 Schema
.	TokenNameDOT	
instance	TokenNameIdentifier	 instance
.	TokenNameDOT	
getCF	TokenNameIdentifier	 get CF
(	TokenNameLPAREN	
columnFamily	TokenNameIdentifier	 column Family
.	TokenNameDOT	
id	TokenNameIdentifier	 id
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
// null means the cf has been dropped 	TokenNameCOMMENT_LINE	null means the cf has been dropped 
continue	TokenNamecontinue	
;	TokenNameSEMICOLON	
ReplayPosition	TokenNameIdentifier	 Replay Position
rp	TokenNameIdentifier	 rp
=	TokenNameEQUAL	
cfPositions	TokenNameIdentifier	 cf Positions
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
columnFamily	TokenNameIdentifier	 column Family
.	TokenNameDOT	
id	TokenNameIdentifier	 id
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// replay if current segment is newer than last flushed one or, 	TokenNameCOMMENT_LINE	replay if current segment is newer than last flushed one or, 
// if it is the last known segment, if we are after the replay position 	TokenNameCOMMENT_LINE	if it is the last known segment, if we are after the replay position 
if	TokenNameif	
(	TokenNameLPAREN	
segment	TokenNameIdentifier	 segment
>	TokenNameGREATER	
rp	TokenNameIdentifier	 rp
.	TokenNameDOT	
segment	TokenNameIdentifier	 segment
||	TokenNameOR_OR	
(	TokenNameLPAREN	
segment	TokenNameIdentifier	 segment
==	TokenNameEQUAL_EQUAL	
rp	TokenNameIdentifier	 rp
.	TokenNameDOT	
segment	TokenNameIdentifier	 segment
&&	TokenNameAND_AND	
entryLocation	TokenNameIdentifier	 entry Location
>	TokenNameGREATER	
rp	TokenNameIdentifier	 rp
.	TokenNameDOT	
position	TokenNameIdentifier	 position
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
newRm	TokenNameIdentifier	 new Rm
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
columnFamily	TokenNameIdentifier	 column Family
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
replayedCount	TokenNameIdentifier	 replayed Count
.	TokenNameDOT	
incrementAndGet	TokenNameIdentifier	 increment And Get
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
newRm	TokenNameIdentifier	 new Rm
.	TokenNameDOT	
isEmpty	TokenNameIdentifier	 is Empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Table	TokenNameIdentifier	 Table
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
newRm	TokenNameIdentifier	 new Rm
.	TokenNameDOT	
getTable	TokenNameIdentifier	 get Table
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
apply	TokenNameIdentifier	 apply
(	TokenNameLPAREN	
newRm	TokenNameIdentifier	 new Rm
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
tablesRecovered	TokenNameIdentifier	 tables Recovered
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
table	TokenNameIdentifier	 table
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
futures	TokenNameIdentifier	 futures
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
StageManager	TokenNameIdentifier	 Stage Manager
.	TokenNameDOT	
getStage	TokenNameIdentifier	 get Stage
(	TokenNameLPAREN	
Stage	TokenNameIdentifier	 Stage
.	TokenNameDOT	
MUTATION	TokenNameIdentifier	 MUTATION
)	TokenNameRPAREN	
.	TokenNameDOT	
submit	TokenNameIdentifier	 submit
(	TokenNameLPAREN	
runnable	TokenNameIdentifier	 runnable
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
futures	TokenNameIdentifier	 futures
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
>	TokenNameGREATER	
MAX_OUTSTANDING_REPLAY_COUNT	TokenNameIdentifier	 MAX  OUTSTANDING  REPLAY  COUNT
)	TokenNameRPAREN	
{	TokenNameLBRACE	
FBUtilities	TokenNameIdentifier	 FB Utilities
.	TokenNameDOT	
waitOnFutures	TokenNameIdentifier	 wait On Futures
(	TokenNameLPAREN	
futures	TokenNameIdentifier	 futures
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
futures	TokenNameIdentifier	 futures
.	TokenNameDOT	
clear	TokenNameIdentifier	 clear
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
finally	TokenNamefinally	
{	TokenNameLBRACE	
FileUtils	TokenNameIdentifier	 File Utils
.	TokenNameDOT	
closeQuietly	TokenNameIdentifier	 close Quietly
(	TokenNameLPAREN	
reader	TokenNameIdentifier	 reader
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
info	TokenNameIdentifier	 info
(	TokenNameLPAREN	
"Finished reading "	TokenNameStringLiteral	Finished reading 
+	TokenNamePLUS	
file	TokenNameIdentifier	 file
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
protected	TokenNameprotected	
boolean	TokenNameboolean	
pointInTimeExceeded	TokenNameIdentifier	 point In Time Exceeded
(	TokenNameLPAREN	
RowMutation	TokenNameIdentifier	 Row Mutation
frm	TokenNameIdentifier	 frm
)	TokenNameRPAREN	
{	TokenNameLBRACE	
long	TokenNamelong	
restoreTarget	TokenNameIdentifier	 restore Target
=	TokenNameEQUAL	
CommitLog	TokenNameIdentifier	 Commit Log
.	TokenNameDOT	
instance	TokenNameIdentifier	 instance
.	TokenNameDOT	
archiver	TokenNameIdentifier	 archiver
.	TokenNameDOT	
restorePointInTime	TokenNameIdentifier	 restore Point In Time
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
ColumnFamily	TokenNameIdentifier	 Column Family
families	TokenNameIdentifier	 families
:	TokenNameCOLON	
frm	TokenNameIdentifier	 frm
.	TokenNameDOT	
getColumnFamilies	TokenNameIdentifier	 get Column Families
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
families	TokenNameIdentifier	 families
.	TokenNameDOT	
maxTimestamp	TokenNameIdentifier	 max Timestamp
(	TokenNameLPAREN	
)	TokenNameRPAREN	
>	TokenNameGREATER	
restoreTarget	TokenNameIdentifier	 restore Target
)	TokenNameRPAREN	
return	TokenNamereturn	
true	TokenNametrue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
false	TokenNamefalse	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
