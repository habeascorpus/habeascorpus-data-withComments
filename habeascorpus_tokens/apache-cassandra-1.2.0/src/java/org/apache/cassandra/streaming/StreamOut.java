/* * Licensed to the Apache Software Foundation (ASF) under one * or more contributor license agreements. See the NOTICE file * distributed with this work for additional information * regarding copyright ownership. The ASF licenses this file * to you under the Apache License, Version 2.0 (the * "License"); you may not use this file except in compliance * with the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */	TokenNameCOMMENT_BLOCK	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
streaming	TokenNameIdentifier	 streaming
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
net	TokenNameIdentifier	 net
.	TokenNameDOT	
InetAddress	TokenNameIdentifier	 Inet Address
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
concurrent	TokenNameIdentifier	 concurrent
.	TokenNameDOT	
Future	TokenNameIdentifier	 Future
;	TokenNameSEMICOLON	
import	TokenNameimport	
com	TokenNameIdentifier	 com
.	TokenNameDOT	
google	TokenNameIdentifier	 google
.	TokenNameDOT	
common	TokenNameIdentifier	 common
.	TokenNameDOT	
collect	TokenNameIdentifier	 collect
.	TokenNameDOT	
Iterables	TokenNameIdentifier	 Iterables
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
commons	TokenNameIdentifier	 commons
.	TokenNameDOT	
lang	TokenNameIdentifier	 lang
.	TokenNameDOT	
StringUtils	TokenNameIdentifier	 String Utils
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
Logger	TokenNameIdentifier	 Logger
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
LoggerFactory	TokenNameIdentifier	 Logger Factory
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
Table	TokenNameIdentifier	 Table
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
dht	TokenNameIdentifier	 dht
.	TokenNameDOT	
Range	TokenNameIdentifier	 Range
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
dht	TokenNameIdentifier	 dht
.	TokenNameDOT	
Token	TokenNameIdentifier	 Token
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
Descriptor	TokenNameIdentifier	 Descriptor
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
SSTable	TokenNameIdentifier	 SS Table
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
SSTableReader	TokenNameIdentifier	 SS Table Reader
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
streaming	TokenNameIdentifier	 streaming
.	TokenNameDOT	
compress	TokenNameIdentifier	 compress
.	TokenNameDOT	
CompressionInfo	TokenNameIdentifier	 Compression Info
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
FBUtilities	TokenNameIdentifier	 FB Utilities
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
Pair	TokenNameIdentifier	 Pair
;	TokenNameSEMICOLON	
/** * This class handles streaming data from one node to another. * * The source node [the Out side] is always in charge of the streaming session. Streams may * be initiated either directly by the source via the methods in this class, * or on demand from the target (via StreamRequest). * * Files to stream are grouped into sessions, which can have callbacks associated * with them so that (for instance) we can mark a new node a full member of the * cluster after all the data it needs has been streamed. * * The source begins a session by sending * a Message with the stream bit flag in the Header turned on. Part of that Message * will include a StreamHeader that includes the files that will be streamed as part * of that session, as well as the first file-to-be-streamed. (Combining session list * and first file like this is inconvenient, but not as inconvenient as the old * three-part send-file-list, wait-for-ack, start-first-file dance.) * * This is done over a separate TCP connection to avoid blocking ordinary intra-node * traffic during the stream. So there is no Handler for the main stream of data -- * when a connection sets the Stream bit, IncomingTcpConnection knows what to expect * without any further Messages. * * After each file, the target node [the In side] will send a StreamReply indicating success * (FILE_FINISHED) or failure (FILE_RETRY). * * When all files have been successfully transferred and integrated the target will * send an additional SESSION_FINISHED reply and the session is complete. * * For Stream requests (for bootstrap), one subtlety is that we always have to * create at least one stream reply, even if the list of files is empty, otherwise the * target has no way to know that it can stop waiting for an answer. * */	TokenNameCOMMENT_JAVADOC	 This class handles streaming data from one node to another. * The source node [the Out side] is always in charge of the streaming session. Streams may be initiated either directly by the source via the methods in this class, or on demand from the target (via StreamRequest). * Files to stream are grouped into sessions, which can have callbacks associated with them so that (for instance) we can mark a new node a full member of the cluster after all the data it needs has been streamed. * The source begins a session by sending a Message with the stream bit flag in the Header turned on. Part of that Message will include a StreamHeader that includes the files that will be streamed as part of that session, as well as the first file-to-be-streamed. (Combining session list and first file like this is inconvenient, but not as inconvenient as the old three-part send-file-list, wait-for-ack, start-first-file dance.) * This is done over a separate TCP connection to avoid blocking ordinary intra-node traffic during the stream. So there is no Handler for the main stream of data -- when a connection sets the Stream bit, IncomingTcpConnection knows what to expect without any further Messages. * After each file, the target node [the In side] will send a StreamReply indicating success (FILE_FINISHED) or failure (FILE_RETRY). * When all files have been successfully transferred and integrated the target will send an additional SESSION_FINISHED reply and the session is complete. * For Stream requests (for bootstrap), one subtlety is that we always have to create at least one stream reply, even if the list of files is empty, otherwise the target has no way to know that it can stop waiting for an answer. 
public	TokenNamepublic	
class	TokenNameclass	
StreamOut	TokenNameIdentifier	 Stream Out
{	TokenNameLBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
Logger	TokenNameIdentifier	 Logger
logger	TokenNameIdentifier	 logger
=	TokenNameEQUAL	
LoggerFactory	TokenNameIdentifier	 Logger Factory
.	TokenNameDOT	
getLogger	TokenNameIdentifier	 get Logger
(	TokenNameLPAREN	
StreamOut	TokenNameIdentifier	 Stream Out
.	TokenNameDOT	
class	TokenNameclass	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
/** * Stream the given ranges to the target endpoint from each CF in the given keyspace. */	TokenNameCOMMENT_JAVADOC	 Stream the given ranges to the target endpoint from each CF in the given keyspace. 
public	TokenNamepublic	
static	TokenNamestatic	
void	TokenNamevoid	
transferRanges	TokenNameIdentifier	 transfer Ranges
(	TokenNameLPAREN	
InetAddress	TokenNameIdentifier	 Inet Address
target	TokenNameIdentifier	 target
,	TokenNameCOMMA	
Table	TokenNameIdentifier	 Table
table	TokenNameIdentifier	 table
,	TokenNameCOMMA	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
Range	TokenNameIdentifier	 Range
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>>	TokenNameRIGHT_SHIFT	
ranges	TokenNameIdentifier	 ranges
,	TokenNameCOMMA	
IStreamCallback	TokenNameIdentifier	 I Stream Callback
callback	TokenNameIdentifier	 callback
,	TokenNameCOMMA	
OperationType	TokenNameIdentifier	 Operation Type
type	TokenNameIdentifier	 type
)	TokenNameRPAREN	
{	TokenNameLBRACE	
StreamOutSession	TokenNameIdentifier	 Stream Out Session
session	TokenNameIdentifier	 session
=	TokenNameEQUAL	
StreamOutSession	TokenNameIdentifier	 Stream Out Session
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
table	TokenNameIdentifier	 table
.	TokenNameDOT	
name	TokenNameIdentifier	 name
,	TokenNameCOMMA	
target	TokenNameIdentifier	 target
,	TokenNameCOMMA	
callback	TokenNameIdentifier	 callback
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
transferRanges	TokenNameIdentifier	 transfer Ranges
(	TokenNameLPAREN	
session	TokenNameIdentifier	 session
,	TokenNameCOMMA	
table	TokenNameIdentifier	 table
.	TokenNameDOT	
getColumnFamilyStores	TokenNameIdentifier	 get Column Family Stores
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
ranges	TokenNameIdentifier	 ranges
,	TokenNameCOMMA	
type	TokenNameIdentifier	 type
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Flushes matching column families from the given keyspace, or all columnFamilies * if the cf list is empty. */	TokenNameCOMMENT_JAVADOC	 Flushes matching column families from the given keyspace, or all columnFamilies if the cf list is empty. 
private	TokenNameprivate	
static	TokenNamestatic	
void	TokenNamevoid	
flushSSTables	TokenNameIdentifier	 flush SS Tables
(	TokenNameLPAREN	
Iterable	TokenNameIdentifier	 Iterable
<	TokenNameLESS	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
>	TokenNameGREATER	
stores	TokenNameIdentifier	 stores
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
info	TokenNameIdentifier	 info
(	TokenNameLPAREN	
"Flushing memtables for {}..."	TokenNameStringLiteral	Flushing memtables for {}...
,	TokenNameCOMMA	
stores	TokenNameIdentifier	 stores
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Future	TokenNameIdentifier	 Future
<	TokenNameLESS	
?	TokenNameQUESTION	
>>	TokenNameRIGHT_SHIFT	
flushes	TokenNameIdentifier	 flushes
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
Future	TokenNameIdentifier	 Future
<	TokenNameLESS	
?	TokenNameQUESTION	
>>	TokenNameRIGHT_SHIFT	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
cfstore	TokenNameIdentifier	 cfstore
:	TokenNameCOLON	
stores	TokenNameIdentifier	 stores
)	TokenNameRPAREN	
flushes	TokenNameIdentifier	 flushes
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
cfstore	TokenNameIdentifier	 cfstore
.	TokenNameDOT	
forceFlush	TokenNameIdentifier	 force Flush
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
FBUtilities	TokenNameIdentifier	 FB Utilities
.	TokenNameDOT	
waitOnFutures	TokenNameIdentifier	 wait On Futures
(	TokenNameLPAREN	
flushes	TokenNameIdentifier	 flushes
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Stream the given ranges to the target endpoint from each of the given CFs. */	TokenNameCOMMENT_JAVADOC	 Stream the given ranges to the target endpoint from each of the given CFs. 
public	TokenNamepublic	
static	TokenNamestatic	
void	TokenNamevoid	
transferRanges	TokenNameIdentifier	 transfer Ranges
(	TokenNameLPAREN	
StreamOutSession	TokenNameIdentifier	 Stream Out Session
session	TokenNameIdentifier	 session
,	TokenNameCOMMA	
Iterable	TokenNameIdentifier	 Iterable
<	TokenNameLESS	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
>	TokenNameGREATER	
cfses	TokenNameIdentifier	 cfses
,	TokenNameCOMMA	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
Range	TokenNameIdentifier	 Range
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>>	TokenNameRIGHT_SHIFT	
ranges	TokenNameIdentifier	 ranges
,	TokenNameCOMMA	
OperationType	TokenNameIdentifier	 Operation Type
type	TokenNameIdentifier	 type
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assert	TokenNameassert	
ranges	TokenNameIdentifier	 ranges
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
>	TokenNameGREATER	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
info	TokenNameIdentifier	 info
(	TokenNameLPAREN	
"Beginning transfer to {}"	TokenNameStringLiteral	Beginning transfer to {}
,	TokenNameCOMMA	
session	TokenNameIdentifier	 session
.	TokenNameDOT	
getHost	TokenNameIdentifier	 get Host
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"Ranges are {}"	TokenNameStringLiteral	Ranges are {}
,	TokenNameCOMMA	
StringUtils	TokenNameIdentifier	 String Utils
.	TokenNameDOT	
join	TokenNameIdentifier	 join
(	TokenNameLPAREN	
ranges	TokenNameIdentifier	 ranges
,	TokenNameCOMMA	
","	TokenNameStringLiteral	,
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
flushSSTables	TokenNameIdentifier	 flush SS Tables
(	TokenNameLPAREN	
cfses	TokenNameIdentifier	 cfses
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Iterable	TokenNameIdentifier	 Iterable
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
sstables	TokenNameIdentifier	 sstables
=	TokenNameEQUAL	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
emptyList	TokenNameIdentifier	 empty List
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
cfStore	TokenNameIdentifier	 cf Store
:	TokenNameCOLON	
cfses	TokenNameIdentifier	 cfses
)	TokenNameRPAREN	
sstables	TokenNameIdentifier	 sstables
=	TokenNameEQUAL	
Iterables	TokenNameIdentifier	 Iterables
.	TokenNameDOT	
concat	TokenNameIdentifier	 concat
(	TokenNameLPAREN	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
cfStore	TokenNameIdentifier	 cf Store
.	TokenNameDOT	
markCurrentSSTablesReferenced	TokenNameIdentifier	 mark Current SS Tables Referenced
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
transferSSTables	TokenNameIdentifier	 transfer SS Tables
(	TokenNameLPAREN	
session	TokenNameIdentifier	 session
,	TokenNameCOMMA	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
ranges	TokenNameIdentifier	 ranges
,	TokenNameCOMMA	
type	TokenNameIdentifier	 type
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Low-level transfer of matching portions of a group of sstables from a single table to the target endpoint. * You should probably call transferRanges instead. This moreover assumes that references have been acquired on the sstables. */	TokenNameCOMMENT_JAVADOC	 Low-level transfer of matching portions of a group of sstables from a single table to the target endpoint. You should probably call transferRanges instead. This moreover assumes that references have been acquired on the sstables. 
public	TokenNamepublic	
static	TokenNamestatic	
void	TokenNamevoid	
transferSSTables	TokenNameIdentifier	 transfer SS Tables
(	TokenNameLPAREN	
StreamOutSession	TokenNameIdentifier	 Stream Out Session
session	TokenNameIdentifier	 session
,	TokenNameCOMMA	
Iterable	TokenNameIdentifier	 Iterable
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
Range	TokenNameIdentifier	 Range
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>>	TokenNameRIGHT_SHIFT	
ranges	TokenNameIdentifier	 ranges
,	TokenNameCOMMA	
OperationType	TokenNameIdentifier	 Operation Type
type	TokenNameIdentifier	 type
)	TokenNameRPAREN	
{	TokenNameLBRACE	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
PendingFile	TokenNameIdentifier	 Pending File
>	TokenNameGREATER	
pending	TokenNameIdentifier	 pending
=	TokenNameEQUAL	
createPendingFiles	TokenNameIdentifier	 create Pending Files
(	TokenNameLPAREN	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
ranges	TokenNameIdentifier	 ranges
,	TokenNameCOMMA	
type	TokenNameIdentifier	 type
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Even if the list of pending files is empty, we need to initiate the transfer otherwise 	TokenNameCOMMENT_LINE	Even if the list of pending files is empty, we need to initiate the transfer otherwise 
// the remote end will hang in cases where this was a requested transfer. 	TokenNameCOMMENT_LINE	the remote end will hang in cases where this was a requested transfer. 
session	TokenNameIdentifier	 session
.	TokenNameDOT	
addFilesToStream	TokenNameIdentifier	 add Files To Stream
(	TokenNameLPAREN	
pending	TokenNameIdentifier	 pending
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
session	TokenNameIdentifier	 session
.	TokenNameDOT	
begin	TokenNameIdentifier	 begin
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// called prior to sending anything. 	TokenNameCOMMENT_LINE	called prior to sending anything. 
private	TokenNameprivate	
static	TokenNamestatic	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
PendingFile	TokenNameIdentifier	 Pending File
>	TokenNameGREATER	
createPendingFiles	TokenNameIdentifier	 create Pending Files
(	TokenNameLPAREN	
Iterable	TokenNameIdentifier	 Iterable
<	TokenNameLESS	
SSTableReader	TokenNameIdentifier	 SS Table Reader
>	TokenNameGREATER	
sstables	TokenNameIdentifier	 sstables
,	TokenNameCOMMA	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
Range	TokenNameIdentifier	 Range
<	TokenNameLESS	
Token	TokenNameIdentifier	 Token
>>	TokenNameRIGHT_SHIFT	
ranges	TokenNameIdentifier	 ranges
,	TokenNameCOMMA	
OperationType	TokenNameIdentifier	 Operation Type
type	TokenNameIdentifier	 type
)	TokenNameRPAREN	
{	TokenNameLBRACE	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
PendingFile	TokenNameIdentifier	 Pending File
>	TokenNameGREATER	
pending	TokenNameIdentifier	 pending
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
PendingFile	TokenNameIdentifier	 Pending File
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
SSTableReader	TokenNameIdentifier	 SS Table Reader
sstable	TokenNameIdentifier	 sstable
:	TokenNameCOLON	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Descriptor	TokenNameIdentifier	 Descriptor
desc	TokenNameIdentifier	 desc
=	TokenNameEQUAL	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
descriptor	TokenNameIdentifier	 descriptor
;	TokenNameSEMICOLON	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Pair	TokenNameIdentifier	 Pair
<	TokenNameLESS	
Long	TokenNameIdentifier	 Long
,	TokenNameCOMMA	
Long	TokenNameIdentifier	 Long
>>	TokenNameRIGHT_SHIFT	
sections	TokenNameIdentifier	 sections
=	TokenNameEQUAL	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
getPositionsForRanges	TokenNameIdentifier	 get Positions For Ranges
(	TokenNameLPAREN	
ranges	TokenNameIdentifier	 ranges
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
sections	TokenNameIdentifier	 sections
.	TokenNameDOT	
isEmpty	TokenNameIdentifier	 is Empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// A reference was acquired on the sstable and we won't stream it 	TokenNameCOMMENT_LINE	A reference was acquired on the sstable and we won't stream it 
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
releaseReference	TokenNameIdentifier	 release Reference
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
continue	TokenNamecontinue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
CompressionInfo	TokenNameIdentifier	 Compression Info
compression	TokenNameIdentifier	 compression
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
compression	TokenNameIdentifier	 compression
)	TokenNameRPAREN	
{	TokenNameLBRACE	
compression	TokenNameIdentifier	 compression
=	TokenNameEQUAL	
new	TokenNamenew	
CompressionInfo	TokenNameIdentifier	 Compression Info
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
getCompressionMetadata	TokenNameIdentifier	 get Compression Metadata
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getChunksForSections	TokenNameIdentifier	 get Chunks For Sections
(	TokenNameLPAREN	
sections	TokenNameIdentifier	 sections
)	TokenNameRPAREN	
,	TokenNameCOMMA	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
getCompressionMetadata	TokenNameIdentifier	 get Compression Metadata
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
parameters	TokenNameIdentifier	 parameters
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
pending	TokenNameIdentifier	 pending
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
new	TokenNamenew	
PendingFile	TokenNameIdentifier	 Pending File
(	TokenNameLPAREN	
sstable	TokenNameIdentifier	 sstable
,	TokenNameCOMMA	
desc	TokenNameIdentifier	 desc
,	TokenNameCOMMA	
SSTable	TokenNameIdentifier	 SS Table
.	TokenNameDOT	
COMPONENT_DATA	TokenNameIdentifier	 COMPONENT  DATA
,	TokenNameCOMMA	
sections	TokenNameIdentifier	 sections
,	TokenNameCOMMA	
type	TokenNameIdentifier	 type
,	TokenNameCOMMA	
sstable	TokenNameIdentifier	 sstable
.	TokenNameDOT	
estimatedKeysForRanges	TokenNameIdentifier	 estimated Keys For Ranges
(	TokenNameLPAREN	
ranges	TokenNameIdentifier	 ranges
)	TokenNameRPAREN	
,	TokenNameCOMMA	
compression	TokenNameIdentifier	 compression
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
info	TokenNameIdentifier	 info
(	TokenNameLPAREN	
"Stream context metadata {}, {} sstables."	TokenNameStringLiteral	Stream context metadata {}, {} sstables.
,	TokenNameCOMMA	
pending	TokenNameIdentifier	 pending
,	TokenNameCOMMA	
Iterables	TokenNameIdentifier	 Iterables
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
sstables	TokenNameIdentifier	 sstables
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
pending	TokenNameIdentifier	 pending
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
