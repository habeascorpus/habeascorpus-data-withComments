package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
tools	TokenNameIdentifier	 tools
;	TokenNameSEMICOLON	
/* * * Licensed to the Apache Software Foundation (ASF) under one * or more contributor license agreements. See the NOTICE file * distributed with this work for additional information * regarding copyright ownership. The ASF licenses this file * to you under the Apache License, Version 2.0 (the * "License"); you may not use this file except in compliance * with the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, * software distributed under the License is distributed on an * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY * KIND, either express or implied. See the License for the * specific language governing permissions and limitations * under the License. * */	TokenNameCOMMENT_BLOCK	 * Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
Closeable	TokenNameIdentifier	 Closeable
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
IOException	TokenNameIdentifier	 IO Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
net	TokenNameIdentifier	 net
.	TokenNameDOT	
UnknownHostException	TokenNameIdentifier	 Unknown Host Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
nio	TokenNameIdentifier	 nio
.	TokenNameDOT	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
ArrayList	TokenNameIdentifier	 Array List
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
Arrays	TokenNameIdentifier	 Arrays
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
Collection	TokenNameIdentifier	 Collection
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
Collections	TokenNameIdentifier	 Collections
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
Date	TokenNameIdentifier	 Date
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
HashMap	TokenNameIdentifier	 Hash Map
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
HashSet	TokenNameIdentifier	 Hash Set
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
Iterator	TokenNameIdentifier	 Iterator
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
List	TokenNameIdentifier	 List
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
Map	TokenNameIdentifier	 Map
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
Random	TokenNameIdentifier	 Random
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
Set	TokenNameIdentifier	 Set
;	TokenNameSEMICOLON	
import	TokenNameimport	
javax	TokenNameIdentifier	 javax
.	TokenNameDOT	
management	TokenNameIdentifier	 management
.	TokenNameDOT	
JMX	TokenNameIdentifier	 JMX
;	TokenNameSEMICOLON	
import	TokenNameimport	
javax	TokenNameIdentifier	 javax
.	TokenNameDOT	
management	TokenNameIdentifier	 management
.	TokenNameDOT	
MBeanServerConnection	TokenNameIdentifier	 M Bean Server Connection
;	TokenNameSEMICOLON	
import	TokenNameimport	
javax	TokenNameIdentifier	 javax
.	TokenNameDOT	
management	TokenNameIdentifier	 management
.	TokenNameDOT	
MalformedObjectNameException	TokenNameIdentifier	 Malformed Object Name Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
javax	TokenNameIdentifier	 javax
.	TokenNameDOT	
management	TokenNameIdentifier	 management
.	TokenNameDOT	
ObjectName	TokenNameIdentifier	 Object Name
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
cql	TokenNameIdentifier	 cql
.	TokenNameDOT	
jdbc	TokenNameIdentifier	 jdbc
.	TokenNameDOT	
JdbcDate	TokenNameIdentifier	 Jdbc Date
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
dht	TokenNameIdentifier	 dht
.	TokenNameDOT	
IPartitioner	TokenNameIdentifier	 I Partitioner
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
dht	TokenNameIdentifier	 dht
.	TokenNameDOT	
Token	TokenNameIdentifier	 Token
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
locator	TokenNameIdentifier	 locator
.	TokenNameDOT	
EndpointSnitchInfoMBean	TokenNameIdentifier	 Endpoint Snitch Info M Bean
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
service	TokenNameIdentifier	 service
.	TokenNameDOT	
StorageServiceMBean	TokenNameIdentifier	 Storage Service M Bean
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
Cassandra	TokenNameIdentifier	 Cassandra
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
Compression	TokenNameIdentifier	 Compression
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
ConsistencyLevel	TokenNameIdentifier	 Consistency Level
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
CqlResult	TokenNameIdentifier	 Cql Result
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
CqlRow	TokenNameIdentifier	 Cql Row
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
InvalidRequestException	TokenNameIdentifier	 Invalid Request Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
TimedOutException	TokenNameIdentifier	 Timed Out Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
TokenRange	TokenNameIdentifier	 Token Range
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
UnavailableException	TokenNameIdentifier	 Unavailable Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
commons	TokenNameIdentifier	 commons
.	TokenNameDOT	
cli	TokenNameIdentifier	 cli
.	TokenNameDOT	
CommandLine	TokenNameIdentifier	 Command Line
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
commons	TokenNameIdentifier	 commons
.	TokenNameDOT	
cli	TokenNameIdentifier	 cli
.	TokenNameDOT	
MissingArgumentException	TokenNameIdentifier	 Missing Argument Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
TException	TokenNameIdentifier	 T Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
protocol	TokenNameIdentifier	 protocol
.	TokenNameDOT	
TBinaryProtocol	TokenNameIdentifier	 T Binary Protocol
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
transport	TokenNameIdentifier	 transport
.	TokenNameDOT	
TFastFramedTransport	TokenNameIdentifier	 T Fast Framed Transport
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
transport	TokenNameIdentifier	 transport
.	TokenNameDOT	
TSocket	TokenNameIdentifier	 T Socket
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
transport	TokenNameIdentifier	 transport
.	TokenNameDOT	
TTransport	TokenNameIdentifier	 T Transport
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
transport	TokenNameIdentifier	 transport
.	TokenNameDOT	
TTransportException	TokenNameIdentifier	 T Transport Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
com	TokenNameIdentifier	 com
.	TokenNameDOT	
google	TokenNameIdentifier	 google
.	TokenNameDOT	
common	TokenNameIdentifier	 common
.	TokenNameDOT	
collect	TokenNameIdentifier	 collect
.	TokenNameDOT	
HashMultimap	TokenNameIdentifier	 Hash Multimap
;	TokenNameSEMICOLON	
import	TokenNameimport	
com	TokenNameIdentifier	 com
.	TokenNameDOT	
google	TokenNameIdentifier	 google
.	TokenNameDOT	
common	TokenNameIdentifier	 common
.	TokenNameDOT	
collect	TokenNameIdentifier	 collect
.	TokenNameDOT	
Multimap	TokenNameIdentifier	 Multimap
;	TokenNameSEMICOLON	
public	TokenNamepublic	
class	TokenNameclass	
Shuffle	TokenNameIdentifier	 Shuffle
extends	TokenNameextends	
AbstractJmxClient	TokenNameIdentifier	 Abstract Jmx Client
{	TokenNameLBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
ssObjName	TokenNameIdentifier	 ss Obj Name
=	TokenNameEQUAL	
"org.apache.cassandra.db:type=StorageService"	TokenNameStringLiteral	org.apache.cassandra.db:type=StorageService
;	TokenNameSEMICOLON	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
epSnitchObjName	TokenNameIdentifier	 ep Snitch Obj Name
=	TokenNameEQUAL	
"org.apache.cassandra.db:type=EndpointSnitchInfo"	TokenNameStringLiteral	org.apache.cassandra.db:type=EndpointSnitchInfo
;	TokenNameSEMICOLON	
private	TokenNameprivate	
StorageServiceMBean	TokenNameIdentifier	 Storage Service M Bean
ssProxy	TokenNameIdentifier	 ss Proxy
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
private	TokenNameprivate	
Random	TokenNameIdentifier	 Random
rand	TokenNameIdentifier	 rand
=	TokenNameEQUAL	
new	TokenNamenew	
Random	TokenNameIdentifier	 Random
(	TokenNameLPAREN	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
currentTimeMillis	TokenNameIdentifier	 current Time Millis
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
String	TokenNameIdentifier	 String
thriftHost	TokenNameIdentifier	 thrift Host
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
int	TokenNameint	
thriftPort	TokenNameIdentifier	 thrift Port
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
boolean	TokenNameboolean	
thriftFramed	TokenNameIdentifier	 thrift Framed
;	TokenNameSEMICOLON	
static	TokenNamestatic	
{	TokenNameLBRACE	
addCmdOption	TokenNameIdentifier	 add Cmd Option
(	TokenNameLPAREN	
"th"	TokenNameStringLiteral	th
,	TokenNameCOMMA	
"thrift-host"	TokenNameStringLiteral	thrift-host
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
"Thrift hostname or IP address (Default: JMX host)"	TokenNameStringLiteral	Thrift hostname or IP address (Default: JMX host)
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addCmdOption	TokenNameIdentifier	 add Cmd Option
(	TokenNameLPAREN	
"tp"	TokenNameStringLiteral	tp
,	TokenNameCOMMA	
"thrift-port"	TokenNameStringLiteral	thrift-port
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
"Thrift port number (Default: 9160)"	TokenNameStringLiteral	Thrift port number (Default: 9160)
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addCmdOption	TokenNameIdentifier	 add Cmd Option
(	TokenNameLPAREN	
"tf"	TokenNameStringLiteral	tf
,	TokenNameCOMMA	
"thrift-framed"	TokenNameStringLiteral	thrift-framed
,	TokenNameCOMMA	
false	TokenNamefalse	
,	TokenNameCOMMA	
"Enable framed transport for Thrift (Default: false)"	TokenNameStringLiteral	Enable framed transport for Thrift (Default: false)
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addCmdOption	TokenNameIdentifier	 add Cmd Option
(	TokenNameLPAREN	
"en"	TokenNameStringLiteral	en
,	TokenNameCOMMA	
"and-enable"	TokenNameStringLiteral	and-enable
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
"Immediately enable shuffling (create only)"	TokenNameStringLiteral	Immediately enable shuffling (create only)
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
addCmdOption	TokenNameIdentifier	 add Cmd Option
(	TokenNameLPAREN	
"dc"	TokenNameStringLiteral	dc
,	TokenNameCOMMA	
"only-dc"	TokenNameStringLiteral	only-dc
,	TokenNameCOMMA	
true	TokenNametrue	
,	TokenNameCOMMA	
"Apply only to named DC (create only)"	TokenNameStringLiteral	Apply only to named DC (create only)
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
Shuffle	TokenNameIdentifier	 Shuffle
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
host	TokenNameIdentifier	 host
,	TokenNameCOMMA	
int	TokenNameint	
port	TokenNameIdentifier	 port
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
this	TokenNamethis	
(	TokenNameLPAREN	
host	TokenNameIdentifier	 host
,	TokenNameCOMMA	
port	TokenNameIdentifier	 port
,	TokenNameCOMMA	
host	TokenNameIdentifier	 host
,	TokenNameCOMMA	
9160	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
false	TokenNamefalse	
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
Shuffle	TokenNameIdentifier	 Shuffle
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
host	TokenNameIdentifier	 host
,	TokenNameCOMMA	
int	TokenNameint	
port	TokenNameIdentifier	 port
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
thriftHost	TokenNameIdentifier	 thrift Host
,	TokenNameCOMMA	
int	TokenNameint	
thriftPort	TokenNameIdentifier	 thrift Port
,	TokenNameCOMMA	
boolean	TokenNameboolean	
thriftFramed	TokenNameIdentifier	 thrift Framed
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
username	TokenNameIdentifier	 username
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
password	TokenNameIdentifier	 password
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
super	TokenNamesuper	
(	TokenNameLPAREN	
host	TokenNameIdentifier	 host
,	TokenNameCOMMA	
port	TokenNameIdentifier	 port
,	TokenNameCOMMA	
username	TokenNameIdentifier	 username
,	TokenNameCOMMA	
password	TokenNameIdentifier	 password
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
thriftHost	TokenNameIdentifier	 thrift Host
=	TokenNameEQUAL	
thriftHost	TokenNameIdentifier	 thrift Host
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
thriftPort	TokenNameIdentifier	 thrift Port
=	TokenNameEQUAL	
thriftPort	TokenNameIdentifier	 thrift Port
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
thriftFramed	TokenNameIdentifier	 thrift Framed
=	TokenNameEQUAL	
thriftFramed	TokenNameIdentifier	 thrift Framed
;	TokenNameSEMICOLON	
// Setup the StorageService proxy. 	TokenNameCOMMENT_LINE	Setup the StorageService proxy. 
ssProxy	TokenNameIdentifier	 ss Proxy
=	TokenNameEQUAL	
getSSProxy	TokenNameIdentifier	 get SS Proxy
(	TokenNameLPAREN	
jmxConn	TokenNameIdentifier	 jmx Conn
.	TokenNameDOT	
getMbeanServerConn	TokenNameIdentifier	 get Mbean Server Conn
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
StorageServiceMBean	TokenNameIdentifier	 Storage Service M Bean
getSSProxy	TokenNameIdentifier	 get SS Proxy
(	TokenNameLPAREN	
MBeanServerConnection	TokenNameIdentifier	 M Bean Server Connection
mbeanConn	TokenNameIdentifier	 mbean Conn
)	TokenNameRPAREN	
{	TokenNameLBRACE	
StorageServiceMBean	TokenNameIdentifier	 Storage Service M Bean
proxy	TokenNameIdentifier	 proxy
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
ObjectName	TokenNameIdentifier	 Object Name
name	TokenNameIdentifier	 name
=	TokenNameEQUAL	
new	TokenNamenew	
ObjectName	TokenNameIdentifier	 Object Name
(	TokenNameLPAREN	
ssObjName	TokenNameIdentifier	 ss Obj Name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
proxy	TokenNameIdentifier	 proxy
=	TokenNameEQUAL	
JMX	TokenNameIdentifier	 JMX
.	TokenNameDOT	
newMBeanProxy	TokenNameIdentifier	 new M Bean Proxy
(	TokenNameLPAREN	
mbeanConn	TokenNameIdentifier	 mbean Conn
,	TokenNameCOMMA	
name	TokenNameIdentifier	 name
,	TokenNameCOMMA	
StorageServiceMBean	TokenNameIdentifier	 Storage Service M Bean
.	TokenNameDOT	
class	TokenNameclass	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
MalformedObjectNameException	TokenNameIdentifier	 Malformed Object Name Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
proxy	TokenNameIdentifier	 proxy
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
EndpointSnitchInfoMBean	TokenNameIdentifier	 Endpoint Snitch Info M Bean
getEpSnitchProxy	TokenNameIdentifier	 get Ep Snitch Proxy
(	TokenNameLPAREN	
MBeanServerConnection	TokenNameIdentifier	 M Bean Server Connection
mbeanConn	TokenNameIdentifier	 mbean Conn
)	TokenNameRPAREN	
{	TokenNameLBRACE	
EndpointSnitchInfoMBean	TokenNameIdentifier	 Endpoint Snitch Info M Bean
proxy	TokenNameIdentifier	 proxy
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
ObjectName	TokenNameIdentifier	 Object Name
name	TokenNameIdentifier	 name
=	TokenNameEQUAL	
new	TokenNamenew	
ObjectName	TokenNameIdentifier	 Object Name
(	TokenNameLPAREN	
epSnitchObjName	TokenNameIdentifier	 ep Snitch Obj Name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
proxy	TokenNameIdentifier	 proxy
=	TokenNameEQUAL	
JMX	TokenNameIdentifier	 JMX
.	TokenNameDOT	
newMBeanProxy	TokenNameIdentifier	 new M Bean Proxy
(	TokenNameLPAREN	
mbeanConn	TokenNameIdentifier	 mbean Conn
,	TokenNameCOMMA	
name	TokenNameIdentifier	 name
,	TokenNameCOMMA	
EndpointSnitchInfoMBean	TokenNameIdentifier	 Endpoint Snitch Info M Bean
.	TokenNameDOT	
class	TokenNameclass	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
MalformedObjectNameException	TokenNameIdentifier	 Malformed Object Name Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
proxy	TokenNameIdentifier	 proxy
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Given a Multimap of endpoint to tokens, return a new randomized mapping. * * @param endpointMap current mapping of endpoint to tokens * @return a new mapping of endpoint to tokens */	TokenNameCOMMENT_JAVADOC	 Given a Multimap of endpoint to tokens, return a new randomized mapping. * @param endpointMap current mapping of endpoint to tokens @return a new mapping of endpoint to tokens 
public	TokenNamepublic	
Multimap	TokenNameIdentifier	 Multimap
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
calculateRelocations	TokenNameIdentifier	 calculate Relocations
(	TokenNameLPAREN	
Multimap	TokenNameIdentifier	 Multimap
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
endpointMap	TokenNameIdentifier	 endpoint Map
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Multimap	TokenNameIdentifier	 Multimap
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
relocations	TokenNameIdentifier	 relocations
=	TokenNameEQUAL	
HashMultimap	TokenNameIdentifier	 Hash Multimap
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
endpoints	TokenNameIdentifier	 endpoints
=	TokenNameEQUAL	
new	TokenNamenew	
HashSet	TokenNameIdentifier	 Hash Set
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
(	TokenNameLPAREN	
endpointMap	TokenNameIdentifier	 endpoint Map
.	TokenNameDOT	
keySet	TokenNameIdentifier	 key Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
Integer	TokenNameIdentifier	 Integer
>	TokenNameGREATER	
endpointToNumTokens	TokenNameIdentifier	 endpoint To Num Tokens
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
Integer	TokenNameIdentifier	 Integer
>	TokenNameGREATER	
(	TokenNameLPAREN	
endpoints	TokenNameIdentifier	 endpoints
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
Iterator	TokenNameIdentifier	 Iterator
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>>	TokenNameRIGHT_SHIFT	
iterMap	TokenNameIdentifier	 iter Map
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
Iterator	TokenNameIdentifier	 Iterator
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>>	TokenNameRIGHT_SHIFT	
(	TokenNameLPAREN	
endpoints	TokenNameIdentifier	 endpoints
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Create maps of endpoint to token iterators, and endpoint to number of tokens. 	TokenNameCOMMENT_LINE	Create maps of endpoint to token iterators, and endpoint to number of tokens. 
for	TokenNamefor	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
endpoint	TokenNameIdentifier	 endpoint
:	TokenNameCOLON	
endpoints	TokenNameIdentifier	 endpoints
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
endpointToNumTokens	TokenNameIdentifier	 endpoint To Num Tokens
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
endpoint	TokenNameIdentifier	 endpoint
,	TokenNameCOMMA	
ssProxy	TokenNameIdentifier	 ss Proxy
.	TokenNameDOT	
getTokens	TokenNameIdentifier	 get Tokens
(	TokenNameLPAREN	
endpoint	TokenNameIdentifier	 endpoint
)	TokenNameRPAREN	
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
UnknownHostException	TokenNameIdentifier	 Unknown Host Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
"What that...?"	TokenNameStringLiteral	What that...?
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
iterMap	TokenNameIdentifier	 iter Map
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
endpoint	TokenNameIdentifier	 endpoint
,	TokenNameCOMMA	
endpointMap	TokenNameIdentifier	 endpoint Map
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
endpoint	TokenNameIdentifier	 endpoint
)	TokenNameRPAREN	
.	TokenNameDOT	
iterator	TokenNameIdentifier	 iterator
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
int	TokenNameint	
epsToComplete	TokenNameIdentifier	 eps To Complete
=	TokenNameEQUAL	
endpoints	TokenNameIdentifier	 endpoints
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
endpointsCompleted	TokenNameIdentifier	 endpoints Completed
=	TokenNameEQUAL	
new	TokenNamenew	
HashSet	TokenNameIdentifier	 Hash Set
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
outer	TokenNameIdentifier	 outer
:	TokenNameCOLON	
while	TokenNamewhile	
(	TokenNameLPAREN	
true	TokenNametrue	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
endpoints	TokenNameIdentifier	 endpoints
.	TokenNameDOT	
removeAll	TokenNameIdentifier	 remove All
(	TokenNameLPAREN	
endpointsCompleted	TokenNameIdentifier	 endpoints Completed
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
endpoint	TokenNameIdentifier	 endpoint
:	TokenNameCOLON	
endpoints	TokenNameIdentifier	 endpoints
)	TokenNameRPAREN	
{	TokenNameLBRACE	
boolean	TokenNameboolean	
choiceMade	TokenNameIdentifier	 choice Made
=	TokenNameEQUAL	
false	TokenNamefalse	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
iterMap	TokenNameIdentifier	 iter Map
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
endpoint	TokenNameIdentifier	 endpoint
)	TokenNameRPAREN	
.	TokenNameDOT	
hasNext	TokenNameIdentifier	 has Next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
endpointsCompleted	TokenNameIdentifier	 endpoints Completed
.	TokenNameDOT	
add	TokenNameIdentifier	 add
(	TokenNameLPAREN	
endpoint	TokenNameIdentifier	 endpoint
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
continue	TokenNamecontinue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
String	TokenNameIdentifier	 String
token	TokenNameIdentifier	 token
=	TokenNameEQUAL	
iterMap	TokenNameIdentifier	 iter Map
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
endpoint	TokenNameIdentifier	 endpoint
)	TokenNameRPAREN	
.	TokenNameDOT	
next	TokenNameIdentifier	 next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
subSet	TokenNameIdentifier	 sub Set
=	TokenNameEQUAL	
new	TokenNamenew	
ArrayList	TokenNameIdentifier	 Array List
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
(	TokenNameLPAREN	
endpoints	TokenNameIdentifier	 endpoints
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
subSet	TokenNameIdentifier	 sub Set
.	TokenNameDOT	
remove	TokenNameIdentifier	 remove
(	TokenNameLPAREN	
endpoint	TokenNameIdentifier	 endpoint
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Collections	TokenNameIdentifier	 Collections
.	TokenNameDOT	
shuffle	TokenNameIdentifier	 shuffle
(	TokenNameLPAREN	
subSet	TokenNameIdentifier	 sub Set
,	TokenNameCOMMA	
rand	TokenNameIdentifier	 rand
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
choice	TokenNameIdentifier	 choice
:	TokenNameCOLON	
subSet	TokenNameIdentifier	 sub Set
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
relocations	TokenNameIdentifier	 relocations
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
choice	TokenNameIdentifier	 choice
)	TokenNameRPAREN	
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
<	TokenNameLESS	
endpointToNumTokens	TokenNameIdentifier	 endpoint To Num Tokens
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
choice	TokenNameIdentifier	 choice
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
relocations	TokenNameIdentifier	 relocations
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
choice	TokenNameIdentifier	 choice
,	TokenNameCOMMA	
token	TokenNameIdentifier	 token
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
choiceMade	TokenNameIdentifier	 choice Made
=	TokenNameEQUAL	
true	TokenNametrue	
;	TokenNameSEMICOLON	
break	TokenNamebreak	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
choiceMade	TokenNameIdentifier	 choice Made
)	TokenNameRPAREN	
relocations	TokenNameIdentifier	 relocations
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
endpoint	TokenNameIdentifier	 endpoint
,	TokenNameCOMMA	
token	TokenNameIdentifier	 token
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// We're done when we've exhausted all of the token iterators 	TokenNameCOMMENT_LINE	We're done when we've exhausted all of the token iterators 
if	TokenNameif	
(	TokenNameLPAREN	
endpointsCompleted	TokenNameIdentifier	 endpoints Completed
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
epsToComplete	TokenNameIdentifier	 eps To Complete
)	TokenNameRPAREN	
break	TokenNamebreak	
outer	TokenNameIdentifier	 outer
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
relocations	TokenNameIdentifier	 relocations
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Enable relocations. * * @param endpoints sequence of hostname or IP strings */	TokenNameCOMMENT_JAVADOC	 Enable relocations. * @param endpoints sequence of hostname or IP strings 
public	TokenNamepublic	
void	TokenNamevoid	
enableRelocations	TokenNameIdentifier	 enable Relocations
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
...	TokenNameELLIPSIS	
endpoints	TokenNameIdentifier	 endpoints
)	TokenNameRPAREN	
{	TokenNameLBRACE	
enableRelocations	TokenNameIdentifier	 enable Relocations
(	TokenNameLPAREN	
Arrays	TokenNameIdentifier	 Arrays
.	TokenNameDOT	
asList	TokenNameIdentifier	 as List
(	TokenNameLPAREN	
endpoints	TokenNameIdentifier	 endpoints
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Enable relocations. * * @param endpoints Collection of hostname or IP strings */	TokenNameCOMMENT_JAVADOC	 Enable relocations. * @param endpoints Collection of hostname or IP strings 
public	TokenNamepublic	
void	TokenNamevoid	
enableRelocations	TokenNameIdentifier	 enable Relocations
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
endpoints	TokenNameIdentifier	 endpoints
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
endpoint	TokenNameIdentifier	 endpoint
:	TokenNameCOLON	
endpoints	TokenNameIdentifier	 endpoints
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
JMXConnection	TokenNameIdentifier	 JMX Connection
conn	TokenNameIdentifier	 conn
=	TokenNameEQUAL	
new	TokenNamenew	
JMXConnection	TokenNameIdentifier	 JMX Connection
(	TokenNameLPAREN	
endpoint	TokenNameIdentifier	 endpoint
,	TokenNameCOMMA	
port	TokenNameIdentifier	 port
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
getSSProxy	TokenNameIdentifier	 get SS Proxy
(	TokenNameLPAREN	
conn	TokenNameIdentifier	 conn
.	TokenNameDOT	
getMbeanServerConn	TokenNameIdentifier	 get Mbean Server Conn
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
enableScheduledRangeXfers	TokenNameIdentifier	 enable Scheduled Range Xfers
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
conn	TokenNameIdentifier	 conn
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
IOException	TokenNameIdentifier	 IO Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
writeln	TokenNameIdentifier	 writeln
(	TokenNameLPAREN	
"Failed to enable shuffling on %s!"	TokenNameStringLiteral	Failed to enable shuffling on %s!
,	TokenNameCOMMA	
endpoint	TokenNameIdentifier	 endpoint
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** * Disable relocations. * * @param endpoints sequence of hostname or IP strings */	TokenNameCOMMENT_JAVADOC	 Disable relocations. * @param endpoints sequence of hostname or IP strings 
public	TokenNamepublic	
void	TokenNamevoid	
disableRelocations	TokenNameIdentifier	 disable Relocations
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
...	TokenNameELLIPSIS	
endpoints	TokenNameIdentifier	 endpoints
)	TokenNameRPAREN	
{	TokenNameLBRACE	
disableRelocations	TokenNameIdentifier	 disable Relocations
(	TokenNameLPAREN	
Arrays	TokenNameIdentifier	 Arrays
.	TokenNameDOT	
asList	TokenNameIdentifier	 as List
(	TokenNameLPAREN	
endpoints	TokenNameIdentifier	 endpoints
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Disable relocations. * * @param endpoints Collection of hostname or IP strings */	TokenNameCOMMENT_JAVADOC	 Disable relocations. * @param endpoints Collection of hostname or IP strings 
public	TokenNamepublic	
void	TokenNamevoid	
disableRelocations	TokenNameIdentifier	 disable Relocations
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
endpoints	TokenNameIdentifier	 endpoints
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
endpoint	TokenNameIdentifier	 endpoint
:	TokenNameCOLON	
endpoints	TokenNameIdentifier	 endpoints
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
JMXConnection	TokenNameIdentifier	 JMX Connection
conn	TokenNameIdentifier	 conn
=	TokenNameEQUAL	
new	TokenNamenew	
JMXConnection	TokenNameIdentifier	 JMX Connection
(	TokenNameLPAREN	
endpoint	TokenNameIdentifier	 endpoint
,	TokenNameCOMMA	
port	TokenNameIdentifier	 port
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
getSSProxy	TokenNameIdentifier	 get SS Proxy
(	TokenNameLPAREN	
conn	TokenNameIdentifier	 conn
.	TokenNameDOT	
getMbeanServerConn	TokenNameIdentifier	 get Mbean Server Conn
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
disableScheduledRangeXfers	TokenNameIdentifier	 disable Scheduled Range Xfers
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
conn	TokenNameIdentifier	 conn
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
IOException	TokenNameIdentifier	 IO Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
writeln	TokenNameIdentifier	 writeln
(	TokenNameLPAREN	
"Failed to enable shuffling on %s!"	TokenNameStringLiteral	Failed to enable shuffling on %s!
,	TokenNameCOMMA	
endpoint	TokenNameIdentifier	 endpoint
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** * Return a list of the live nodes (using JMX). * * @return String endpoint names * @throws ShuffleError */	TokenNameCOMMENT_JAVADOC	 Return a list of the live nodes (using JMX). * @return String endpoint names @throws ShuffleError 
public	TokenNamepublic	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
getLiveNodes	TokenNameIdentifier	 get Live Nodes
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
ShuffleError	TokenNameIdentifier	 Shuffle Error
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
JMXConnection	TokenNameIdentifier	 JMX Connection
conn	TokenNameIdentifier	 conn
=	TokenNameEQUAL	
new	TokenNamenew	
JMXConnection	TokenNameIdentifier	 JMX Connection
(	TokenNameLPAREN	
host	TokenNameIdentifier	 host
,	TokenNameCOMMA	
port	TokenNameIdentifier	 port
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
getSSProxy	TokenNameIdentifier	 get SS Proxy
(	TokenNameLPAREN	
conn	TokenNameIdentifier	 conn
.	TokenNameDOT	
getMbeanServerConn	TokenNameIdentifier	 get Mbean Server Conn
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getLiveNodes	TokenNameIdentifier	 get Live Nodes
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
IOException	TokenNameIdentifier	 IO Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
ShuffleError	TokenNameIdentifier	 Shuffle Error
(	TokenNameLPAREN	
"Error retrieving list of nodes from JMX interface"	TokenNameStringLiteral	Error retrieving list of nodes from JMX interface
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** * Create and distribute a new, randomized token to endpoint mapping. * * @throws ShuffleError on handled exceptions */	TokenNameCOMMENT_JAVADOC	 Create and distribute a new, randomized token to endpoint mapping. * @throws ShuffleError on handled exceptions 
public	TokenNamepublic	
void	TokenNamevoid	
shuffle	TokenNameIdentifier	 shuffle
(	TokenNameLPAREN	
boolean	TokenNameboolean	
enable	TokenNameIdentifier	 enable
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
onlyDc	TokenNameIdentifier	 only Dc
)	TokenNameRPAREN	
throws	TokenNamethrows	
ShuffleError	TokenNameIdentifier	 Shuffle Error
{	TokenNameLBRACE	
CassandraClient	TokenNameIdentifier	 Cassandra Client
seedClient	TokenNameIdentifier	 seed Client
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
tokenMap	TokenNameIdentifier	 token Map
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
IPartitioner	TokenNameIdentifier	 I Partitioner
<	TokenNameLESS	
?	TokenNameQUESTION	
>	TokenNameGREATER	
partitioner	TokenNameIdentifier	 partitioner
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
Multimap	TokenNameIdentifier	 Multimap
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
endpointMap	TokenNameIdentifier	 endpoint Map
=	TokenNameEQUAL	
HashMultimap	TokenNameIdentifier	 Hash Multimap
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
EndpointSnitchInfoMBean	TokenNameIdentifier	 Endpoint Snitch Info M Bean
epSnitchProxy	TokenNameIdentifier	 ep Snitch Proxy
=	TokenNameEQUAL	
getEpSnitchProxy	TokenNameIdentifier	 get Ep Snitch Proxy
(	TokenNameLPAREN	
jmxConn	TokenNameIdentifier	 jmx Conn
.	TokenNameDOT	
getMbeanServerConn	TokenNameIdentifier	 get Mbean Server Conn
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
seedClient	TokenNameIdentifier	 seed Client
=	TokenNameEQUAL	
getThriftClient	TokenNameIdentifier	 get Thrift Client
(	TokenNameLPAREN	
thriftHost	TokenNameIdentifier	 thrift Host
,	TokenNameCOMMA	
thriftPort	TokenNameIdentifier	 thrift Port
,	TokenNameCOMMA	
thriftFramed	TokenNameIdentifier	 thrift Framed
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
tokenMap	TokenNameIdentifier	 token Map
=	TokenNameEQUAL	
seedClient	TokenNameIdentifier	 seed Client
.	TokenNameDOT	
describe_token_map	TokenNameIdentifier	 describe token map
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
Map	TokenNameIdentifier	 Map
.	TokenNameDOT	
Entry	TokenNameIdentifier	 Entry
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
entry	TokenNameIdentifier	 entry
:	TokenNameCOLON	
tokenMap	TokenNameIdentifier	 token Map
.	TokenNameDOT	
entrySet	TokenNameIdentifier	 entry Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
endpoint	TokenNameIdentifier	 endpoint
=	TokenNameEQUAL	
entry	TokenNameIdentifier	 entry
.	TokenNameDOT	
getValue	TokenNameIdentifier	 get Value
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
token	TokenNameIdentifier	 token
=	TokenNameEQUAL	
entry	TokenNameIdentifier	 entry
.	TokenNameDOT	
getKey	TokenNameIdentifier	 get Key
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
onlyDc	TokenNameIdentifier	 only Dc
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
onlyDc	TokenNameIdentifier	 only Dc
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
epSnitchProxy	TokenNameIdentifier	 ep Snitch Proxy
.	TokenNameDOT	
getDatacenter	TokenNameIdentifier	 get Datacenter
(	TokenNameLPAREN	
endpoint	TokenNameIdentifier	 endpoint
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
endpointMap	TokenNameIdentifier	 endpoint Map
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
endpoint	TokenNameIdentifier	 endpoint
,	TokenNameCOMMA	
token	TokenNameIdentifier	 token
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
endpointMap	TokenNameIdentifier	 endpoint Map
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
endpoint	TokenNameIdentifier	 endpoint
,	TokenNameCOMMA	
token	TokenNameIdentifier	 token
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
UnknownHostException	TokenNameIdentifier	 Unknown Host Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
writeln	TokenNameIdentifier	 writeln
(	TokenNameLPAREN	
"Warning: %s unknown to EndpointSnitch!"	TokenNameStringLiteral	Warning: %s unknown to EndpointSnitch!
,	TokenNameCOMMA	
endpoint	TokenNameIdentifier	 endpoint
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
InvalidRequestException	TokenNameIdentifier	 Invalid Request Exception
ire	TokenNameIdentifier	 ire
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
"What that...?"	TokenNameStringLiteral	What that...?
,	TokenNameCOMMA	
ire	TokenNameIdentifier	 ire
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
TException	TokenNameIdentifier	 T Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
ShuffleError	TokenNameIdentifier	 Shuffle Error
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"Thrift request to %s:%d failed: %s"	TokenNameStringLiteral	Thrift request to %s:%d failed: %s
,	TokenNameCOMMA	
thriftHost	TokenNameIdentifier	 thrift Host
,	TokenNameCOMMA	
thriftPort	TokenNameIdentifier	 thrift Port
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
partitioner	TokenNameIdentifier	 partitioner
=	TokenNameEQUAL	
getPartitioner	TokenNameIdentifier	 get Partitioner
(	TokenNameLPAREN	
thriftHost	TokenNameIdentifier	 thrift Host
,	TokenNameCOMMA	
thriftPort	TokenNameIdentifier	 thrift Port
,	TokenNameCOMMA	
thriftFramed	TokenNameIdentifier	 thrift Framed
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Multimap	TokenNameIdentifier	 Multimap
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
relocations	TokenNameIdentifier	 relocations
=	TokenNameEQUAL	
calculateRelocations	TokenNameIdentifier	 calculate Relocations
(	TokenNameLPAREN	
endpointMap	TokenNameIdentifier	 endpoint Map
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
writeln	TokenNameIdentifier	 writeln
(	TokenNameLPAREN	
"%-42s %-15s %-15s"	TokenNameStringLiteral	%-42s %-15s %-15s
,	TokenNameCOMMA	
"Token"	TokenNameStringLiteral	Token
,	TokenNameCOMMA	
"From"	TokenNameStringLiteral	From
,	TokenNameCOMMA	
"To"	TokenNameStringLiteral	To
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
writeln	TokenNameIdentifier	 writeln
(	TokenNameLPAREN	
"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~+~~~~~~~~~~~~~~~+~~~~~~~~~~~~~~~"	TokenNameStringLiteral	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~+~~~~~~~~~~~~~~~+~~~~~~~~~~~~~~~
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Store relocations on remote nodes. 	TokenNameCOMMENT_LINE	Store relocations on remote nodes. 
for	TokenNamefor	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
endpoint	TokenNameIdentifier	 endpoint
:	TokenNameCOLON	
relocations	TokenNameIdentifier	 relocations
.	TokenNameDOT	
keySet	TokenNameIdentifier	 key Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
tok	TokenNameIdentifier	 tok
:	TokenNameCOLON	
relocations	TokenNameIdentifier	 relocations
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
endpoint	TokenNameIdentifier	 endpoint
)	TokenNameRPAREN	
)	TokenNameRPAREN	
writeln	TokenNameIdentifier	 writeln
(	TokenNameLPAREN	
"%-42s %-15s %-15s"	TokenNameStringLiteral	%-42s %-15s %-15s
,	TokenNameCOMMA	
tok	TokenNameIdentifier	 tok
,	TokenNameCOMMA	
tokenMap	TokenNameIdentifier	 token Map
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
tok	TokenNameIdentifier	 tok
)	TokenNameRPAREN	
,	TokenNameCOMMA	
endpoint	TokenNameIdentifier	 endpoint
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
cqlQuery	TokenNameIdentifier	 cql Query
=	TokenNameEQUAL	
createShuffleBatchInsert	TokenNameIdentifier	 create Shuffle Batch Insert
(	TokenNameLPAREN	
relocations	TokenNameIdentifier	 relocations
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
endpoint	TokenNameIdentifier	 endpoint
)	TokenNameRPAREN	
,	TokenNameCOMMA	
partitioner	TokenNameIdentifier	 partitioner
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
executeCqlQuery	TokenNameIdentifier	 execute Cql Query
(	TokenNameLPAREN	
endpoint	TokenNameIdentifier	 endpoint
,	TokenNameCOMMA	
thriftPort	TokenNameIdentifier	 thrift Port
,	TokenNameCOMMA	
thriftFramed	TokenNameIdentifier	 thrift Framed
,	TokenNameCOMMA	
cqlQuery	TokenNameIdentifier	 cql Query
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
enable	TokenNameIdentifier	 enable
)	TokenNameRPAREN	
enableRelocations	TokenNameIdentifier	 enable Relocations
(	TokenNameLPAREN	
relocations	TokenNameIdentifier	 relocations
.	TokenNameDOT	
keySet	TokenNameIdentifier	 key Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Print a list of pending token relocations for all nodes. * * @throws ShuffleError */	TokenNameCOMMENT_JAVADOC	 Print a list of pending token relocations for all nodes. * @throws ShuffleError 
public	TokenNamepublic	
void	TokenNamevoid	
ls	TokenNameIdentifier	 ls
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
ShuffleError	TokenNameIdentifier	 Shuffle Error
{	TokenNameLBRACE	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
CqlRow	TokenNameIdentifier	 Cql Row
>>	TokenNameRIGHT_SHIFT	
queuedRelocations	TokenNameIdentifier	 queued Relocations
=	TokenNameEQUAL	
listRelocations	TokenNameIdentifier	 list Relocations
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IPartitioner	TokenNameIdentifier	 I Partitioner
<	TokenNameLESS	
?	TokenNameQUESTION	
>	TokenNameGREATER	
partitioner	TokenNameIdentifier	 partitioner
=	TokenNameEQUAL	
getPartitioner	TokenNameIdentifier	 get Partitioner
(	TokenNameLPAREN	
thriftHost	TokenNameIdentifier	 thrift Host
,	TokenNameCOMMA	
thriftPort	TokenNameIdentifier	 thrift Port
,	TokenNameCOMMA	
thriftFramed	TokenNameIdentifier	 thrift Framed
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
boolean	TokenNameboolean	
justOnce	TokenNameIdentifier	 just Once
=	TokenNameEQUAL	
false	TokenNamefalse	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
host	TokenNameIdentifier	 host
:	TokenNameCOLON	
queuedRelocations	TokenNameIdentifier	 queued Relocations
.	TokenNameDOT	
keySet	TokenNameIdentifier	 key Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
CqlRow	TokenNameIdentifier	 Cql Row
row	TokenNameIdentifier	 row
:	TokenNameCOLON	
queuedRelocations	TokenNameIdentifier	 queued Relocations
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
host	TokenNameIdentifier	 host
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assert	TokenNameassert	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
getColumns	TokenNameIdentifier	 get Columns
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
2	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
justOnce	TokenNameIdentifier	 just Once
)	TokenNameRPAREN	
{	TokenNameLBRACE	
writeln	TokenNameIdentifier	 writeln
(	TokenNameLPAREN	
"%-42s %-15s %s"	TokenNameStringLiteral	%-42s %-15s %s
,	TokenNameCOMMA	
"Token"	TokenNameStringLiteral	Token
,	TokenNameCOMMA	
"Endpoint"	TokenNameStringLiteral	Endpoint
,	TokenNameCOMMA	
"Requested at"	TokenNameStringLiteral	Requested at
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
writeln	TokenNameIdentifier	 writeln
(	TokenNameLPAREN	
"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~+~~~~~~~~~~~~~~~+~~~~~~~~~~~~~~~~~~~~~~~~~~~~"	TokenNameStringLiteral	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~+~~~~~~~~~~~~~~~+~~~~~~~~~~~~~~~~~~~~~~~~~~~~
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
justOnce	TokenNameIdentifier	 just Once
=	TokenNameEQUAL	
true	TokenNametrue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
tokenBytes	TokenNameIdentifier	 token Bytes
=	TokenNameEQUAL	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
.	TokenNameDOT	
wrap	TokenNameIdentifier	 wrap
(	TokenNameLPAREN	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
getColumns	TokenNameIdentifier	 get Columns
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
.	TokenNameDOT	
getValue	TokenNameIdentifier	 get Value
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
requestedAt	TokenNameIdentifier	 requested At
=	TokenNameEQUAL	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
.	TokenNameDOT	
wrap	TokenNameIdentifier	 wrap
(	TokenNameLPAREN	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
getColumns	TokenNameIdentifier	 get Columns
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
.	TokenNameDOT	
getValue	TokenNameIdentifier	 get Value
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Date	TokenNameIdentifier	 Date
time	TokenNameIdentifier	 time
=	TokenNameEQUAL	
JdbcDate	TokenNameIdentifier	 Jdbc Date
.	TokenNameDOT	
instance	TokenNameIdentifier	 instance
.	TokenNameDOT	
compose	TokenNameIdentifier	 compose
(	TokenNameLPAREN	
requestedAt	TokenNameIdentifier	 requested At
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
Token	TokenNameIdentifier	 Token
<	TokenNameLESS	
?	TokenNameQUESTION	
>	TokenNameGREATER	
token	TokenNameIdentifier	 token
=	TokenNameEQUAL	
partitioner	TokenNameIdentifier	 partitioner
.	TokenNameDOT	
getTokenFactory	TokenNameIdentifier	 get Token Factory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
fromByteArray	TokenNameIdentifier	 from Byte Array
(	TokenNameLPAREN	
tokenBytes	TokenNameIdentifier	 token Bytes
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
writeln	TokenNameIdentifier	 writeln
(	TokenNameLPAREN	
"%-42s %-15s %s"	TokenNameStringLiteral	%-42s %-15s %s
,	TokenNameCOMMA	
token	TokenNameIdentifier	 token
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
host	TokenNameIdentifier	 host
,	TokenNameCOMMA	
time	TokenNameIdentifier	 time
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** * List pending token relocations for all nodes. * * @return * @throws ShuffleError */	TokenNameCOMMENT_JAVADOC	 List pending token relocations for all nodes. * @return @throws ShuffleError 
private	TokenNameprivate	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
CqlRow	TokenNameIdentifier	 Cql Row
>>	TokenNameRIGHT_SHIFT	
listRelocations	TokenNameIdentifier	 list Relocations
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
ShuffleError	TokenNameIdentifier	 Shuffle Error
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
cqlQuery	TokenNameIdentifier	 cql Query
=	TokenNameEQUAL	
"SELECT token_bytes,requested_at FROM system.range_xfers"	TokenNameStringLiteral	SELECT token_bytes,requested_at FROM system.range_xfers
;	TokenNameSEMICOLON	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
CqlRow	TokenNameIdentifier	 Cql Row
>>	TokenNameRIGHT_SHIFT	
results	TokenNameIdentifier	 results
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
CqlRow	TokenNameIdentifier	 Cql Row
>>	TokenNameRIGHT_SHIFT	
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
host	TokenNameIdentifier	 host
:	TokenNameCOLON	
getLiveNodes	TokenNameIdentifier	 get Live Nodes
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
CqlResult	TokenNameIdentifier	 Cql Result
result	TokenNameIdentifier	 result
=	TokenNameEQUAL	
executeCqlQuery	TokenNameIdentifier	 execute Cql Query
(	TokenNameLPAREN	
host	TokenNameIdentifier	 host
,	TokenNameCOMMA	
thriftPort	TokenNameIdentifier	 thrift Port
,	TokenNameCOMMA	
thriftFramed	TokenNameIdentifier	 thrift Framed
,	TokenNameCOMMA	
cqlQuery	TokenNameIdentifier	 cql Query
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
results	TokenNameIdentifier	 results
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
host	TokenNameIdentifier	 host
,	TokenNameCOMMA	
result	TokenNameIdentifier	 result
.	TokenNameDOT	
getRows	TokenNameIdentifier	 get Rows
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
results	TokenNameIdentifier	 results
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Clear pending token relocations on all nodes. * * @throws ShuffleError */	TokenNameCOMMENT_JAVADOC	 Clear pending token relocations on all nodes. * @throws ShuffleError 
public	TokenNamepublic	
void	TokenNamevoid	
clear	TokenNameIdentifier	 clear
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
ShuffleError	TokenNameIdentifier	 Shuffle Error
{	TokenNameLBRACE	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
CqlRow	TokenNameIdentifier	 Cql Row
>>	TokenNameRIGHT_SHIFT	
queuedRelocations	TokenNameIdentifier	 queued Relocations
=	TokenNameEQUAL	
listRelocations	TokenNameIdentifier	 list Relocations
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
host	TokenNameIdentifier	 host
:	TokenNameCOLON	
queuedRelocations	TokenNameIdentifier	 queued Relocations
.	TokenNameDOT	
keySet	TokenNameIdentifier	 key Set
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
for	TokenNamefor	
(	TokenNameLPAREN	
CqlRow	TokenNameIdentifier	 Cql Row
row	TokenNameIdentifier	 row
:	TokenNameCOLON	
queuedRelocations	TokenNameIdentifier	 queued Relocations
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
host	TokenNameIdentifier	 host
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assert	TokenNameassert	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
getColumns	TokenNameIdentifier	 get Columns
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
==	TokenNameEQUAL_EQUAL	
2	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
tokenBytes	TokenNameIdentifier	 token Bytes
=	TokenNameEQUAL	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
.	TokenNameDOT	
wrap	TokenNameIdentifier	 wrap
(	TokenNameLPAREN	
row	TokenNameIdentifier	 row
.	TokenNameDOT	
getColumns	TokenNameIdentifier	 get Columns
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
.	TokenNameDOT	
getValue	TokenNameIdentifier	 get Value
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
query	TokenNameIdentifier	 query
=	TokenNameEQUAL	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"DELETE FROM system.range_xfers WHERE token_bytes = '%s'"	TokenNameStringLiteral	DELETE FROM system.range_xfers WHERE token_bytes = '%s'
,	TokenNameCOMMA	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
bytesToHex	TokenNameIdentifier	 bytes To Hex
(	TokenNameLPAREN	
tokenBytes	TokenNameIdentifier	 token Bytes
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
executeCqlQuery	TokenNameIdentifier	 execute Cql Query
(	TokenNameLPAREN	
host	TokenNameIdentifier	 host
,	TokenNameCOMMA	
thriftPort	TokenNameIdentifier	 thrift Port
,	TokenNameCOMMA	
thriftFramed	TokenNameIdentifier	 thrift Framed
,	TokenNameCOMMA	
query	TokenNameIdentifier	 query
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** * Enable shuffling on all nodes in the cluster. * * @throws ShuffleError */	TokenNameCOMMENT_JAVADOC	 Enable shuffling on all nodes in the cluster. * @throws ShuffleError 
public	TokenNamepublic	
void	TokenNamevoid	
enable	TokenNameIdentifier	 enable
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
ShuffleError	TokenNameIdentifier	 Shuffle Error
{	TokenNameLBRACE	
enableRelocations	TokenNameIdentifier	 enable Relocations
(	TokenNameLPAREN	
getLiveNodes	TokenNameIdentifier	 get Live Nodes
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Disable shuffling on all nodes in the cluster. * * @throws ShuffleError */	TokenNameCOMMENT_JAVADOC	 Disable shuffling on all nodes in the cluster. * @throws ShuffleError 
public	TokenNamepublic	
void	TokenNamevoid	
disable	TokenNameIdentifier	 disable
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
ShuffleError	TokenNameIdentifier	 Shuffle Error
{	TokenNameLBRACE	
disableRelocations	TokenNameIdentifier	 disable Relocations
(	TokenNameLPAREN	
getLiveNodes	TokenNameIdentifier	 get Live Nodes
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Setup and return a new Thrift RPC connection. * * @param hostName hostname or address to connect to * @param port port number to connect to * @param framed wrap with framed transport if true * @return a CassandraClient instance * @throws ShuffleError */	TokenNameCOMMENT_JAVADOC	 Setup and return a new Thrift RPC connection. * @param hostName hostname or address to connect to @param port port number to connect to @param framed wrap with framed transport if true @return a CassandraClient instance @throws ShuffleError 
public	TokenNamepublic	
static	TokenNamestatic	
CassandraClient	TokenNameIdentifier	 Cassandra Client
getThriftClient	TokenNameIdentifier	 get Thrift Client
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
hostName	TokenNameIdentifier	 host Name
,	TokenNameCOMMA	
int	TokenNameint	
port	TokenNameIdentifier	 port
,	TokenNameCOMMA	
boolean	TokenNameboolean	
framed	TokenNameIdentifier	 framed
)	TokenNameRPAREN	
throws	TokenNamethrows	
ShuffleError	TokenNameIdentifier	 Shuffle Error
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
return	TokenNamereturn	
new	TokenNamenew	
CassandraClient	TokenNameIdentifier	 Cassandra Client
(	TokenNameLPAREN	
hostName	TokenNameIdentifier	 host Name
,	TokenNameCOMMA	
port	TokenNameIdentifier	 port
,	TokenNameCOMMA	
framed	TokenNameIdentifier	 framed
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
TTransportException	TokenNameIdentifier	 T Transport Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
ShuffleError	TokenNameIdentifier	 Shuffle Error
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"Unable to connect to %s/%d: %s"	TokenNameStringLiteral	Unable to connect to %s/%d: %s
,	TokenNameCOMMA	
hostName	TokenNameIdentifier	 host Name
,	TokenNameCOMMA	
port	TokenNameIdentifier	 port
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** * Execute a CQL v3 query. * * @param hostName hostname or address to connect to * @param port port number to connect to * @param isFramed wrap with framed transport if true * @param cqlQuery CQL query string * @return a Thrift CqlResult instance * @throws ShuffleError */	TokenNameCOMMENT_JAVADOC	 Execute a CQL v3 query. * @param hostName hostname or address to connect to @param port port number to connect to @param isFramed wrap with framed transport if true @param cqlQuery CQL query string @return a Thrift CqlResult instance @throws ShuffleError 
public	TokenNamepublic	
static	TokenNamestatic	
CqlResult	TokenNameIdentifier	 Cql Result
executeCqlQuery	TokenNameIdentifier	 execute Cql Query
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
hostName	TokenNameIdentifier	 host Name
,	TokenNameCOMMA	
int	TokenNameint	
port	TokenNameIdentifier	 port
,	TokenNameCOMMA	
boolean	TokenNameboolean	
isFramed	TokenNameIdentifier	 is Framed
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
cqlQuery	TokenNameIdentifier	 cql Query
)	TokenNameRPAREN	
throws	TokenNamethrows	
ShuffleError	TokenNameIdentifier	 Shuffle Error
{	TokenNameLBRACE	
CassandraClient	TokenNameIdentifier	 Cassandra Client
client	TokenNameIdentifier	 client
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
client	TokenNameIdentifier	 client
=	TokenNameEQUAL	
getThriftClient	TokenNameIdentifier	 get Thrift Client
(	TokenNameLPAREN	
hostName	TokenNameIdentifier	 host Name
,	TokenNameCOMMA	
port	TokenNameIdentifier	 port
,	TokenNameCOMMA	
isFramed	TokenNameIdentifier	 is Framed
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
client	TokenNameIdentifier	 client
.	TokenNameDOT	
execute_cql_query	TokenNameIdentifier	 execute cql query
(	TokenNameLPAREN	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
.	TokenNameDOT	
wrap	TokenNameIdentifier	 wrap
(	TokenNameLPAREN	
cqlQuery	TokenNameIdentifier	 cql Query
.	TokenNameDOT	
getBytes	TokenNameIdentifier	 get Bytes
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
Compression	TokenNameIdentifier	 Compression
.	TokenNameDOT	
NONE	TokenNameIdentifier	 NONE
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
UnavailableException	TokenNameIdentifier	 Unavailable Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
ShuffleError	TokenNameIdentifier	 Shuffle Error
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"Unable to write shuffle entries to %s. Reason: UnavailableException"	TokenNameStringLiteral	Unable to write shuffle entries to %s. Reason: UnavailableException
,	TokenNameCOMMA	
hostName	TokenNameIdentifier	 host Name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
TimedOutException	TokenNameIdentifier	 Timed Out Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
ShuffleError	TokenNameIdentifier	 Shuffle Error
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"Unable to write shuffle entries to %s. Reason: TimedOutException"	TokenNameStringLiteral	Unable to write shuffle entries to %s. Reason: TimedOutException
,	TokenNameCOMMA	
hostName	TokenNameIdentifier	 host Name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
Exception	TokenNameIdentifier	 Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
finally	TokenNamefinally	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
client	TokenNameIdentifier	 client
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
client	TokenNameIdentifier	 client
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** * Return a partitioner instance for remote host. * * @param hostName hostname or address to connect to * @param port port number to connect to * @param framed wrap with framed transport if true * @return an IPartitioner instance * @throws ShuffleError */	TokenNameCOMMENT_JAVADOC	 Return a partitioner instance for remote host. * @param hostName hostname or address to connect to @param port port number to connect to @param framed wrap with framed transport if true @return an IPartitioner instance @throws ShuffleError 
public	TokenNamepublic	
static	TokenNamestatic	
IPartitioner	TokenNameIdentifier	 I Partitioner
<	TokenNameLESS	
?	TokenNameQUESTION	
>	TokenNameGREATER	
getPartitioner	TokenNameIdentifier	 get Partitioner
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
hostName	TokenNameIdentifier	 host Name
,	TokenNameCOMMA	
int	TokenNameint	
port	TokenNameIdentifier	 port
,	TokenNameCOMMA	
boolean	TokenNameboolean	
framed	TokenNameIdentifier	 framed
)	TokenNameRPAREN	
throws	TokenNamethrows	
ShuffleError	TokenNameIdentifier	 Shuffle Error
{	TokenNameLBRACE	
String	TokenNameIdentifier	 String
partitionerName	TokenNameIdentifier	 partitioner Name
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
partitionerName	TokenNameIdentifier	 partitioner Name
=	TokenNameEQUAL	
getThriftClient	TokenNameIdentifier	 get Thrift Client
(	TokenNameLPAREN	
hostName	TokenNameIdentifier	 host Name
,	TokenNameCOMMA	
port	TokenNameIdentifier	 port
,	TokenNameCOMMA	
framed	TokenNameIdentifier	 framed
)	TokenNameRPAREN	
.	TokenNameDOT	
describe_partitioner	TokenNameIdentifier	 describe partitioner
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
TException	TokenNameIdentifier	 T Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
ShuffleError	TokenNameIdentifier	 Shuffle Error
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"Thrift request to %s:%d failed: %s"	TokenNameStringLiteral	Thrift request to %s:%d failed: %s
,	TokenNameCOMMA	
hostName	TokenNameIdentifier	 host Name
,	TokenNameCOMMA	
port	TokenNameIdentifier	 port
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
InvalidRequestException	TokenNameIdentifier	 Invalid Request Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
"Error calling describe_partitioner() defies explanation"	TokenNameStringLiteral	Error calling describe_partitioner() defies explanation
,	TokenNameCOMMA	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
Class	TokenNameIdentifier	 Class
<	TokenNameLESS	
?	TokenNameQUESTION	
>	TokenNameGREATER	
partitionerClass	TokenNameIdentifier	 partitioner Class
=	TokenNameEQUAL	
Class	TokenNameIdentifier	 Class
.	TokenNameDOT	
forName	TokenNameIdentifier	 for Name
(	TokenNameLPAREN	
partitionerName	TokenNameIdentifier	 partitioner Name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
(	TokenNameLPAREN	
IPartitioner	TokenNameIdentifier	 I Partitioner
<	TokenNameLESS	
?	TokenNameQUESTION	
>	TokenNameGREATER	
)	TokenNameRPAREN	
partitionerClass	TokenNameIdentifier	 partitioner Class
.	TokenNameDOT	
newInstance	TokenNameIdentifier	 new Instance
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
ClassNotFoundException	TokenNameIdentifier	 Class Not Found Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
ShuffleError	TokenNameIdentifier	 Shuffle Error
(	TokenNameLPAREN	
"Unable to locate class for partitioner: "	TokenNameStringLiteral	Unable to locate class for partitioner: 
+	TokenNamePLUS	
partitionerName	TokenNameIdentifier	 partitioner Name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
Exception	TokenNameIdentifier	 Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** * Create and return a CQL batch insert statement for a set of token relocations. * * @param tokens tokens to be relocated * @param partitioner an instance of the IPartitioner in use * @return a query string */	TokenNameCOMMENT_JAVADOC	 Create and return a CQL batch insert statement for a set of token relocations. * @param tokens tokens to be relocated @param partitioner an instance of the IPartitioner in use @return a query string 
public	TokenNamepublic	
static	TokenNamestatic	
String	TokenNameIdentifier	 String
createShuffleBatchInsert	TokenNameIdentifier	 create Shuffle Batch Insert
(	TokenNameLPAREN	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
tokens	TokenNameIdentifier	 tokens
,	TokenNameCOMMA	
IPartitioner	TokenNameIdentifier	 I Partitioner
<	TokenNameLESS	
?	TokenNameQUESTION	
>	TokenNameGREATER	
partitioner	TokenNameIdentifier	 partitioner
)	TokenNameRPAREN	
{	TokenNameLBRACE	
StringBuilder	TokenNameIdentifier	 String Builder
query	TokenNameIdentifier	 query
=	TokenNameEQUAL	
new	TokenNamenew	
StringBuilder	TokenNameIdentifier	 String Builder
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
query	TokenNameIdentifier	 query
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
"BEGIN BATCH"	TokenNameStringLiteral	BEGIN BATCH
)	TokenNameRPAREN	
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
" "	TokenNameStringLiteral	 
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
tokenStr	TokenNameIdentifier	 token Str
:	TokenNameCOLON	
tokens	TokenNameIdentifier	 tokens
)	TokenNameRPAREN	
{	TokenNameLBRACE	
Token	TokenNameIdentifier	 Token
<	TokenNameLESS	
?	TokenNameQUESTION	
>	TokenNameGREATER	
token	TokenNameIdentifier	 token
=	TokenNameEQUAL	
partitioner	TokenNameIdentifier	 partitioner
.	TokenNameDOT	
getTokenFactory	TokenNameIdentifier	 get Token Factory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
fromString	TokenNameIdentifier	 from String
(	TokenNameLPAREN	
tokenStr	TokenNameIdentifier	 token Str
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
hexToken	TokenNameIdentifier	 hex Token
=	TokenNameEQUAL	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
bytesToHex	TokenNameIdentifier	 bytes To Hex
(	TokenNameLPAREN	
partitioner	TokenNameIdentifier	 partitioner
.	TokenNameDOT	
getTokenFactory	TokenNameIdentifier	 get Token Factory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
toByteArray	TokenNameIdentifier	 to Byte Array
(	TokenNameLPAREN	
token	TokenNameIdentifier	 token
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
query	TokenNameIdentifier	 query
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
"INSERT INTO system.range_xfers (token_bytes, requested_at) "	TokenNameStringLiteral	INSERT INTO system.range_xfers (token_bytes, requested_at) 
)	TokenNameRPAREN	
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
"VALUES ('"	TokenNameStringLiteral	VALUES ('
)	TokenNameRPAREN	
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
hexToken	TokenNameIdentifier	 hex Token
)	TokenNameRPAREN	
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
"', 'now');"	TokenNameStringLiteral	', 'now');
)	TokenNameRPAREN	
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
" "	TokenNameStringLiteral	 
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
query	TokenNameIdentifier	 query
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
"APPLY BATCH"	TokenNameStringLiteral	APPLY BATCH
)	TokenNameRPAREN	
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
" "	TokenNameStringLiteral	 
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
query	TokenNameIdentifier	 query
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** Print usage information. */	TokenNameCOMMENT_JAVADOC	 Print usage information. 
private	TokenNameprivate	
static	TokenNamestatic	
void	TokenNamevoid	
printShuffleHelp	TokenNameIdentifier	 print Shuffle Help
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
StringBuilder	TokenNameIdentifier	 String Builder
sb	TokenNameIdentifier	 sb
=	TokenNameEQUAL	
new	TokenNamenew	
StringBuilder	TokenNameIdentifier	 String Builder
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
"Sub-commands:"	TokenNameStringLiteral	Sub-commands:
)	TokenNameRPAREN	
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"%n"	TokenNameStringLiteral	%n
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
" create Initialize a new shuffle operation"	TokenNameStringLiteral	 create Initialize a new shuffle operation
)	TokenNameRPAREN	
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"%n"	TokenNameStringLiteral	%n
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
" ls List pending relocations"	TokenNameStringLiteral	 ls List pending relocations
)	TokenNameRPAREN	
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"%n"	TokenNameStringLiteral	%n
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
" clear Clear pending relocations"	TokenNameStringLiteral	 clear Clear pending relocations
)	TokenNameRPAREN	
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"%n"	TokenNameStringLiteral	%n
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
" en[able] Enable shuffling"	TokenNameStringLiteral	 en[able] Enable shuffling
)	TokenNameRPAREN	
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"%n"	TokenNameStringLiteral	%n
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
" dis[able] Disable shuffling"	TokenNameStringLiteral	 dis[able] Disable shuffling
)	TokenNameRPAREN	
.	TokenNameDOT	
append	TokenNameIdentifier	 append
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
.	TokenNameDOT	
format	TokenNameIdentifier	 format
(	TokenNameLPAREN	
"%n%n"	TokenNameStringLiteral	%n%n
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
printHelp	TokenNameIdentifier	 print Help
(	TokenNameLPAREN	
"shuffle [options] <sub-command>"	TokenNameStringLiteral	shuffle [options] <sub-command>
,	TokenNameCOMMA	
sb	TokenNameIdentifier	 sb
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
/** * Execute. * * @param args arguments passed on the command line * @throws Exception when face meets palm */	TokenNameCOMMENT_JAVADOC	 Execute. * @param args arguments passed on the command line @throws Exception when face meets palm 
public	TokenNamepublic	
static	TokenNamestatic	
void	TokenNamevoid	
main	TokenNameIdentifier	 main
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
args	TokenNameIdentifier	 args
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
CommandLine	TokenNameIdentifier	 Command Line
cmd	TokenNameIdentifier	 cmd
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
cmd	TokenNameIdentifier	 cmd
=	TokenNameEQUAL	
processArguments	TokenNameIdentifier	 process Arguments
(	TokenNameLPAREN	
args	TokenNameIdentifier	 args
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
MissingArgumentException	TokenNameIdentifier	 Missing Argument Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
err	TokenNameIdentifier	 err
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
.	TokenNameDOT	
getMessage	TokenNameIdentifier	 get Message
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
exit	TokenNameIdentifier	 exit
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
// Sub command argument. 	TokenNameCOMMENT_LINE	Sub command argument. 
if	TokenNameif	
(	TokenNameLPAREN	
cmd	TokenNameIdentifier	 cmd
.	TokenNameDOT	
getArgList	TokenNameIdentifier	 get Arg List
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
<	TokenNameLESS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
err	TokenNameIdentifier	 err
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Missing sub-command argument."	TokenNameStringLiteral	Missing sub-command argument.
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
printShuffleHelp	TokenNameIdentifier	 print Shuffle Help
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
exit	TokenNameIdentifier	 exit
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
String	TokenNameIdentifier	 String
subCommand	TokenNameIdentifier	 sub Command
=	TokenNameEQUAL	
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
)	TokenNameRPAREN	
(	TokenNameLPAREN	
cmd	TokenNameIdentifier	 cmd
.	TokenNameDOT	
getArgList	TokenNameIdentifier	 get Arg List
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
hostName	TokenNameIdentifier	 host Name
=	TokenNameEQUAL	
(	TokenNameLPAREN	
cmd	TokenNameIdentifier	 cmd
.	TokenNameDOT	
getOptionValue	TokenNameIdentifier	 get Option Value
(	TokenNameLPAREN	
"host"	TokenNameStringLiteral	host
)	TokenNameRPAREN	
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
cmd	TokenNameIdentifier	 cmd
.	TokenNameDOT	
getOptionValue	TokenNameIdentifier	 get Option Value
(	TokenNameLPAREN	
"host"	TokenNameStringLiteral	host
)	TokenNameRPAREN	
:	TokenNameCOLON	
DEFAULT_HOST	TokenNameIdentifier	 DEFAULT  HOST
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
port	TokenNameIdentifier	 port
=	TokenNameEQUAL	
(	TokenNameLPAREN	
cmd	TokenNameIdentifier	 cmd
.	TokenNameDOT	
getOptionValue	TokenNameIdentifier	 get Option Value
(	TokenNameLPAREN	
"port"	TokenNameStringLiteral	port
)	TokenNameRPAREN	
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
cmd	TokenNameIdentifier	 cmd
.	TokenNameDOT	
getOptionValue	TokenNameIdentifier	 get Option Value
(	TokenNameLPAREN	
"port"	TokenNameStringLiteral	port
)	TokenNameRPAREN	
:	TokenNameCOLON	
Integer	TokenNameIdentifier	 Integer
.	TokenNameDOT	
toString	TokenNameIdentifier	 to String
(	TokenNameLPAREN	
DEFAULT_JMX_PORT	TokenNameIdentifier	 DEFAULT  JMX  PORT
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
thriftHost	TokenNameIdentifier	 thrift Host
=	TokenNameEQUAL	
(	TokenNameLPAREN	
cmd	TokenNameIdentifier	 cmd
.	TokenNameDOT	
getOptionValue	TokenNameIdentifier	 get Option Value
(	TokenNameLPAREN	
"thrift-host"	TokenNameStringLiteral	thrift-host
)	TokenNameRPAREN	
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
cmd	TokenNameIdentifier	 cmd
.	TokenNameDOT	
getOptionValue	TokenNameIdentifier	 get Option Value
(	TokenNameLPAREN	
"thrift-host"	TokenNameStringLiteral	thrift-host
)	TokenNameRPAREN	
:	TokenNameCOLON	
hostName	TokenNameIdentifier	 host Name
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
thriftPort	TokenNameIdentifier	 thrift Port
=	TokenNameEQUAL	
(	TokenNameLPAREN	
cmd	TokenNameIdentifier	 cmd
.	TokenNameDOT	
getOptionValue	TokenNameIdentifier	 get Option Value
(	TokenNameLPAREN	
"thrift-port"	TokenNameStringLiteral	thrift-port
)	TokenNameRPAREN	
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
cmd	TokenNameIdentifier	 cmd
.	TokenNameDOT	
getOptionValue	TokenNameIdentifier	 get Option Value
(	TokenNameLPAREN	
"thrift-port"	TokenNameStringLiteral	thrift-port
)	TokenNameRPAREN	
:	TokenNameCOLON	
"9160"	TokenNameStringLiteral	9160
;	TokenNameSEMICOLON	
String	TokenNameIdentifier	 String
onlyDc	TokenNameIdentifier	 only Dc
=	TokenNameEQUAL	
cmd	TokenNameIdentifier	 cmd
.	TokenNameDOT	
getOptionValue	TokenNameIdentifier	 get Option Value
(	TokenNameLPAREN	
"only-dc"	TokenNameStringLiteral	only-dc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
boolean	TokenNameboolean	
thriftFramed	TokenNameIdentifier	 thrift Framed
=	TokenNameEQUAL	
cmd	TokenNameIdentifier	 cmd
.	TokenNameDOT	
hasOption	TokenNameIdentifier	 has Option
(	TokenNameLPAREN	
"thrift-framed"	TokenNameStringLiteral	thrift-framed
)	TokenNameRPAREN	
?	TokenNameQUESTION	
true	TokenNametrue	
:	TokenNameCOLON	
false	TokenNamefalse	
;	TokenNameSEMICOLON	
boolean	TokenNameboolean	
andEnable	TokenNameIdentifier	 and Enable
=	TokenNameEQUAL	
cmd	TokenNameIdentifier	 cmd
.	TokenNameDOT	
hasOption	TokenNameIdentifier	 has Option
(	TokenNameLPAREN	
"and-enable"	TokenNameStringLiteral	and-enable
)	TokenNameRPAREN	
?	TokenNameQUESTION	
true	TokenNametrue	
:	TokenNameCOLON	
false	TokenNamefalse	
;	TokenNameSEMICOLON	
int	TokenNameint	
portNum	TokenNameIdentifier	 port Num
=	TokenNameEQUAL	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
,	TokenNameCOMMA	
thriftPortNum	TokenNameIdentifier	 thrift Port Num
=	TokenNameEQUAL	
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
// Parse JMX port number 	TokenNameCOMMENT_LINE	Parse JMX port number 
if	TokenNameif	
(	TokenNameLPAREN	
port	TokenNameIdentifier	 port
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
portNum	TokenNameIdentifier	 port Num
=	TokenNameEQUAL	
Integer	TokenNameIdentifier	 Integer
.	TokenNameDOT	
parseInt	TokenNameIdentifier	 parse Int
(	TokenNameLPAREN	
port	TokenNameIdentifier	 port
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
NumberFormatException	TokenNameIdentifier	 Number Format Exception
ferr	TokenNameIdentifier	 ferr
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
err	TokenNameIdentifier	 err
.	TokenNameDOT	
printf	TokenNameIdentifier	 printf
(	TokenNameLPAREN	
"%s is not a valid JMX port number.%n"	TokenNameStringLiteral	%s is not a valid JMX port number.%n
,	TokenNameCOMMA	
port	TokenNameIdentifier	 port
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
exit	TokenNameIdentifier	 exit
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
else	TokenNameelse	
portNum	TokenNameIdentifier	 port Num
=	TokenNameEQUAL	
DEFAULT_JMX_PORT	TokenNameIdentifier	 DEFAULT  JMX  PORT
;	TokenNameSEMICOLON	
// Parse Thrift port number 	TokenNameCOMMENT_LINE	Parse Thrift port number 
if	TokenNameif	
(	TokenNameLPAREN	
thriftPort	TokenNameIdentifier	 thrift Port
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
thriftPortNum	TokenNameIdentifier	 thrift Port Num
=	TokenNameEQUAL	
Integer	TokenNameIdentifier	 Integer
.	TokenNameDOT	
parseInt	TokenNameIdentifier	 parse Int
(	TokenNameLPAREN	
thriftPort	TokenNameIdentifier	 thrift Port
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
NumberFormatException	TokenNameIdentifier	 Number Format Exception
ferr	TokenNameIdentifier	 ferr
)	TokenNameRPAREN	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
err	TokenNameIdentifier	 err
.	TokenNameDOT	
printf	TokenNameIdentifier	 printf
(	TokenNameLPAREN	
"%s is not a valid port number.%n"	TokenNameStringLiteral	%s is not a valid port number.%n
,	TokenNameCOMMA	
thriftPort	TokenNameIdentifier	 thrift Port
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
exit	TokenNameIdentifier	 exit
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
else	TokenNameelse	
thriftPortNum	TokenNameIdentifier	 thrift Port Num
=	TokenNameEQUAL	
9160	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
Shuffle	TokenNameIdentifier	 Shuffle
shuffler	TokenNameIdentifier	 shuffler
=	TokenNameEQUAL	
new	TokenNamenew	
Shuffle	TokenNameIdentifier	 Shuffle
(	TokenNameLPAREN	
hostName	TokenNameIdentifier	 host Name
,	TokenNameCOMMA	
portNum	TokenNameIdentifier	 port Num
,	TokenNameCOMMA	
thriftHost	TokenNameIdentifier	 thrift Host
,	TokenNameCOMMA	
thriftPortNum	TokenNameIdentifier	 thrift Port Num
,	TokenNameCOMMA	
thriftFramed	TokenNameIdentifier	 thrift Framed
,	TokenNameCOMMA	
null	TokenNamenull	
,	TokenNameCOMMA	
null	TokenNamenull	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
subCommand	TokenNameIdentifier	 sub Command
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
"create"	TokenNameStringLiteral	create
)	TokenNameRPAREN	
)	TokenNameRPAREN	
shuffler	TokenNameIdentifier	 shuffler
.	TokenNameDOT	
shuffle	TokenNameIdentifier	 shuffle
(	TokenNameLPAREN	
andEnable	TokenNameIdentifier	 and Enable
,	TokenNameCOMMA	
onlyDc	TokenNameIdentifier	 only Dc
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
subCommand	TokenNameIdentifier	 sub Command
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
"ls"	TokenNameStringLiteral	ls
)	TokenNameRPAREN	
)	TokenNameRPAREN	
shuffler	TokenNameIdentifier	 shuffler
.	TokenNameDOT	
ls	TokenNameIdentifier	 ls
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
subCommand	TokenNameIdentifier	 sub Command
.	TokenNameDOT	
startsWith	TokenNameIdentifier	 starts With
(	TokenNameLPAREN	
"en"	TokenNameStringLiteral	en
)	TokenNameRPAREN	
)	TokenNameRPAREN	
shuffler	TokenNameIdentifier	 shuffler
.	TokenNameDOT	
enable	TokenNameIdentifier	 enable
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
subCommand	TokenNameIdentifier	 sub Command
.	TokenNameDOT	
startsWith	TokenNameIdentifier	 starts With
(	TokenNameLPAREN	
"dis"	TokenNameStringLiteral	dis
)	TokenNameRPAREN	
)	TokenNameRPAREN	
shuffler	TokenNameIdentifier	 shuffler
.	TokenNameDOT	
disable	TokenNameIdentifier	 disable
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
subCommand	TokenNameIdentifier	 sub Command
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
"clear"	TokenNameStringLiteral	clear
)	TokenNameRPAREN	
)	TokenNameRPAREN	
shuffler	TokenNameIdentifier	 shuffler
.	TokenNameDOT	
clear	TokenNameIdentifier	 clear
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
else	TokenNameelse	
{	TokenNameLBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
err	TokenNameIdentifier	 err
.	TokenNameDOT	
println	TokenNameIdentifier	 println
(	TokenNameLPAREN	
"Unknown subcommand: "	TokenNameStringLiteral	Unknown subcommand: 
+	TokenNamePLUS	
subCommand	TokenNameIdentifier	 sub Command
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
printShuffleHelp	TokenNameIdentifier	 print Shuffle Help
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
exit	TokenNameIdentifier	 exit
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
ShuffleError	TokenNameIdentifier	 Shuffle Error
err	TokenNameIdentifier	 err
)	TokenNameRPAREN	
{	TokenNameLBRACE	
shuffler	TokenNameIdentifier	 shuffler
.	TokenNameDOT	
writeln	TokenNameIdentifier	 writeln
(	TokenNameLPAREN	
err	TokenNameIdentifier	 err
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
exit	TokenNameIdentifier	 exit
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
finally	TokenNamefinally	
{	TokenNameLBRACE	
shuffler	TokenNameIdentifier	 shuffler
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
System	TokenNameIdentifier	 System
.	TokenNameDOT	
exit	TokenNameIdentifier	 exit
(	TokenNameLPAREN	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** A self-contained Cassandra.Client; Closeable. */	TokenNameCOMMENT_JAVADOC	 A self-contained Cassandra.Client; Closeable. 
class	TokenNameclass	
CassandraClient	TokenNameIdentifier	 Cassandra Client
implements	TokenNameimplements	
Closeable	TokenNameIdentifier	 Closeable
{	TokenNameLBRACE	
TTransport	TokenNameIdentifier	 T Transport
transport	TokenNameIdentifier	 transport
;	TokenNameSEMICOLON	
Cassandra	TokenNameIdentifier	 Cassandra
.	TokenNameDOT	
Client	TokenNameIdentifier	 Client
client	TokenNameIdentifier	 client
;	TokenNameSEMICOLON	
CassandraClient	TokenNameIdentifier	 Cassandra Client
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
hostName	TokenNameIdentifier	 host Name
,	TokenNameCOMMA	
int	TokenNameint	
port	TokenNameIdentifier	 port
,	TokenNameCOMMA	
boolean	TokenNameboolean	
framed	TokenNameIdentifier	 framed
)	TokenNameRPAREN	
throws	TokenNamethrows	
TTransportException	TokenNameIdentifier	 T Transport Exception
{	TokenNameLBRACE	
TSocket	TokenNameIdentifier	 T Socket
socket	TokenNameIdentifier	 socket
=	TokenNameEQUAL	
new	TokenNamenew	
TSocket	TokenNameIdentifier	 T Socket
(	TokenNameLPAREN	
hostName	TokenNameIdentifier	 host Name
,	TokenNameCOMMA	
port	TokenNameIdentifier	 port
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
transport	TokenNameIdentifier	 transport
=	TokenNameEQUAL	
(	TokenNameLPAREN	
framed	TokenNameIdentifier	 framed
)	TokenNameRPAREN	
?	TokenNameQUESTION	
socket	TokenNameIdentifier	 socket
:	TokenNameCOLON	
new	TokenNamenew	
TFastFramedTransport	TokenNameIdentifier	 T Fast Framed Transport
(	TokenNameLPAREN	
socket	TokenNameIdentifier	 socket
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
transport	TokenNameIdentifier	 transport
.	TokenNameDOT	
open	TokenNameIdentifier	 open
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
client	TokenNameIdentifier	 client
=	TokenNameEQUAL	
new	TokenNamenew	
Cassandra	TokenNameIdentifier	 Cassandra
.	TokenNameDOT	
Client	TokenNameIdentifier	 Client
(	TokenNameLPAREN	
new	TokenNamenew	
TBinaryProtocol	TokenNameIdentifier	 T Binary Protocol
(	TokenNameLPAREN	
transport	TokenNameIdentifier	 transport
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
try	TokenNametry	
{	TokenNameLBRACE	
client	TokenNameIdentifier	 client
.	TokenNameDOT	
set_cql_version	TokenNameIdentifier	 set cql version
(	TokenNameLPAREN	
"3.0.0"	TokenNameStringLiteral	3.0.0
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
Exception	TokenNameIdentifier	 Exception
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
new	TokenNamenew	
RuntimeException	TokenNameIdentifier	 Runtime Exception
(	TokenNameLPAREN	
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
CqlResult	TokenNameIdentifier	 Cql Result
execute_cql_query	TokenNameIdentifier	 execute cql query
(	TokenNameLPAREN	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
cqlQuery	TokenNameIdentifier	 cql Query
,	TokenNameCOMMA	
Compression	TokenNameIdentifier	 Compression
compression	TokenNameIdentifier	 compression
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
return	TokenNamereturn	
client	TokenNameIdentifier	 client
.	TokenNameDOT	
execute_cql3_query	TokenNameIdentifier	 execute cql3 query
(	TokenNameLPAREN	
cqlQuery	TokenNameIdentifier	 cql Query
,	TokenNameCOMMA	
compression	TokenNameIdentifier	 compression
,	TokenNameCOMMA	
ConsistencyLevel	TokenNameIdentifier	 Consistency Level
.	TokenNameDOT	
ONE	TokenNameIdentifier	 ONE
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
String	TokenNameIdentifier	 String
describe_partitioner	TokenNameIdentifier	 describe partitioner
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
TException	TokenNameIdentifier	 T Exception
,	TokenNameCOMMA	
InvalidRequestException	TokenNameIdentifier	 Invalid Request Exception
{	TokenNameLBRACE	
return	TokenNamereturn	
client	TokenNameIdentifier	 client
.	TokenNameDOT	
describe_partitioner	TokenNameIdentifier	 describe partitioner
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
TokenRange	TokenNameIdentifier	 Token Range
>	TokenNameGREATER	
describe_ring	TokenNameIdentifier	 describe ring
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
keyspace	TokenNameIdentifier	 keyspace
)	TokenNameRPAREN	
throws	TokenNamethrows	
InvalidRequestException	TokenNameIdentifier	 Invalid Request Exception
,	TokenNameCOMMA	
TException	TokenNameIdentifier	 T Exception
{	TokenNameLBRACE	
return	TokenNamereturn	
client	TokenNameIdentifier	 client
.	TokenNameDOT	
describe_ring	TokenNameIdentifier	 describe ring
(	TokenNameLPAREN	
keyspace	TokenNameIdentifier	 keyspace
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
String	TokenNameIdentifier	 String
,	TokenNameCOMMA	
String	TokenNameIdentifier	 String
>	TokenNameGREATER	
describe_token_map	TokenNameIdentifier	 describe token map
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
InvalidRequestException	TokenNameIdentifier	 Invalid Request Exception
,	TokenNameCOMMA	
TException	TokenNameIdentifier	 T Exception
{	TokenNameLBRACE	
return	TokenNamereturn	
client	TokenNameIdentifier	 client
.	TokenNameDOT	
describe_token_map	TokenNameIdentifier	 describe token map
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
transport	TokenNameIdentifier	 transport
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
@	TokenNameAT	
SuppressWarnings	TokenNameIdentifier	 Suppress Warnings
(	TokenNameLPAREN	
"serial"	TokenNameStringLiteral	serial
)	TokenNameRPAREN	
class	TokenNameclass	
ShuffleError	TokenNameIdentifier	 Shuffle Error
extends	TokenNameextends	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
ShuffleError	TokenNameIdentifier	 Shuffle Error
(	TokenNameLPAREN	
String	TokenNameIdentifier	 String
msg	TokenNameIdentifier	 msg
)	TokenNameRPAREN	
{	TokenNameLBRACE	
super	TokenNamesuper	
(	TokenNameLPAREN	
msg	TokenNameIdentifier	 msg
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
