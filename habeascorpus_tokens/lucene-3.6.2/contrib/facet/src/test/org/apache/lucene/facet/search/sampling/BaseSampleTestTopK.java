package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
sampling	TokenNameIdentifier	 sampling
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
IOException	TokenNameIdentifier	 IO Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
List	TokenNameIdentifier	 List
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
Random	TokenNameIdentifier	 Random
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
IndexReader	TokenNameIdentifier	 Index Reader
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
Term	TokenNameIdentifier	 Term
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
Query	TokenNameIdentifier	 Query
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
TermQuery	TokenNameIdentifier	 Term Query
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
MultiCollector	TokenNameIdentifier	 Multi Collector
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
BaseTestTopK	TokenNameIdentifier	 Base Test Top K
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
FacetsAccumulator	TokenNameIdentifier	 Facets Accumulator
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
FacetsCollector	TokenNameIdentifier	 Facets Collector
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
ScoredDocIDs	TokenNameIdentifier	 Scored Doc I Ds
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
ScoredDocIdCollector	TokenNameIdentifier	 Scored Doc Id Collector
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
params	TokenNameIdentifier	 params
.	TokenNameDOT	
FacetSearchParams	TokenNameIdentifier	 Facet Search Params
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
search	TokenNameIdentifier	 search
.	TokenNameDOT	
results	TokenNameIdentifier	 results
.	TokenNameDOT	
FacetResult	TokenNameIdentifier	 Facet Result
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
taxonomy	TokenNameIdentifier	 taxonomy
.	TokenNameDOT	
TaxonomyReader	TokenNameIdentifier	 Taxonomy Reader
;	TokenNameSEMICOLON	
/** * Licensed to the Apache Software Foundation (ASF) under one or more * contributor license agreements. See the NOTICE file distributed with * this work for additional information regarding copyright ownership. * The ASF licenses this file to You under the Apache License, Version 2.0 * (the "License"); you may not use this file except in compliance with * the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */	TokenNameCOMMENT_JAVADOC	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
public	TokenNamepublic	
abstract	TokenNameabstract	
class	TokenNameclass	
BaseSampleTestTopK	TokenNameIdentifier	 Base Sample Test Top K
extends	TokenNameextends	
BaseTestTopK	TokenNameIdentifier	 Base Test Top K
{	TokenNameLBRACE	
/** Number of top results */	TokenNameCOMMENT_JAVADOC	 Number of top results 
protected	TokenNameprotected	
static	TokenNamestatic	
final	TokenNamefinal	
int	TokenNameint	
K	TokenNameIdentifier	 K
=	TokenNameEQUAL	
2	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
/** since there is a chance that this test would fail even if the code is correct, retry the sampling */	TokenNameCOMMENT_JAVADOC	 since there is a chance that this test would fail even if the code is correct, retry the sampling 
protected	TokenNameprotected	
static	TokenNamestatic	
final	TokenNamefinal	
int	TokenNameint	
RETRIES	TokenNameIdentifier	 RETRIES
=	TokenNameEQUAL	
10	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
protected	TokenNameprotected	
abstract	TokenNameabstract	
FacetsAccumulator	TokenNameIdentifier	 Facets Accumulator
getSamplingAccumulator	TokenNameIdentifier	 get Sampling Accumulator
(	TokenNameLPAREN	
Sampler	TokenNameIdentifier	 Sampler
sampler	TokenNameIdentifier	 sampler
,	TokenNameCOMMA	
TaxonomyReader	TokenNameIdentifier	 Taxonomy Reader
taxoReader	TokenNameIdentifier	 taxo Reader
,	TokenNameCOMMA	
IndexReader	TokenNameIdentifier	 Index Reader
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
FacetSearchParams	TokenNameIdentifier	 Facet Search Params
searchParams	TokenNameIdentifier	 search Params
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
/** * Try out faceted search with sampling enabled and complements either disabled or enforced * Lots of randomly generated data is being indexed, and later on a "90% docs" faceted search * is performed. The results are compared to non-sampled ones. */	TokenNameCOMMENT_JAVADOC	 Try out faceted search with sampling enabled and complements either disabled or enforced Lots of randomly generated data is being indexed, and later on a "90% docs" faceted search is performed. The results are compared to non-sampled ones. 
public	TokenNamepublic	
void	TokenNamevoid	
testCountUsingSamping	TokenNameIdentifier	 test Count Using Samping
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
,	TokenNameCOMMA	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
boolean	TokenNameboolean	
useRandomSampler	TokenNameIdentifier	 use Random Sampler
=	TokenNameEQUAL	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextBoolean	TokenNameIdentifier	 next Boolean
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
partitionSize	TokenNameIdentifier	 partition Size
:	TokenNameCOLON	
partitionSizes	TokenNameIdentifier	 partition Sizes
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
initIndex	TokenNameIdentifier	 init Index
(	TokenNameLPAREN	
partitionSize	TokenNameIdentifier	 partition Size
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Get all of the documents and run the query, then do different 	TokenNameCOMMENT_LINE	Get all of the documents and run the query, then do different 
// facet counts and compare to control 	TokenNameCOMMENT_LINE	facet counts and compare to control 
Query	TokenNameIdentifier	 Query
q	TokenNameIdentifier	 q
=	TokenNameEQUAL	
new	TokenNamenew	
TermQuery	TokenNameIdentifier	 Term Query
(	TokenNameLPAREN	
new	TokenNamenew	
Term	TokenNameIdentifier	 Term
(	TokenNameLPAREN	
CONTENT_FIELD	TokenNameIdentifier	 CONTENT  FIELD
,	TokenNameCOMMA	
BETA	TokenNameIdentifier	 BETA
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// 90% of the docs 	TokenNameCOMMENT_LINE	90% of the docs 
ScoredDocIdCollector	TokenNameIdentifier	 Scored Doc Id Collector
docCollector	TokenNameIdentifier	 doc Collector
=	TokenNameEQUAL	
ScoredDocIdCollector	TokenNameIdentifier	 Scored Doc Id Collector
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
searcher	TokenNameIdentifier	 searcher
.	TokenNameDOT	
maxDoc	TokenNameIdentifier	 max Doc
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
FacetSearchParams	TokenNameIdentifier	 Facet Search Params
expectedSearchParams	TokenNameIdentifier	 expected Search Params
=	TokenNameEQUAL	
searchParamsWithRequests	TokenNameIdentifier	 search Params With Requests
(	TokenNameLPAREN	
K	TokenNameIdentifier	 K
,	TokenNameCOMMA	
partitionSize	TokenNameIdentifier	 partition Size
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
FacetsCollector	TokenNameIdentifier	 Facets Collector
fc	TokenNameIdentifier	 fc
=	TokenNameEQUAL	
new	TokenNamenew	
FacetsCollector	TokenNameIdentifier	 Facets Collector
(	TokenNameLPAREN	
expectedSearchParams	TokenNameIdentifier	 expected Search Params
,	TokenNameCOMMA	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
taxoReader	TokenNameIdentifier	 taxo Reader
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
searcher	TokenNameIdentifier	 searcher
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
q	TokenNameIdentifier	 q
,	TokenNameCOMMA	
MultiCollector	TokenNameIdentifier	 Multi Collector
.	TokenNameDOT	
wrap	TokenNameIdentifier	 wrap
(	TokenNameLPAREN	
docCollector	TokenNameIdentifier	 doc Collector
,	TokenNameCOMMA	
fc	TokenNameIdentifier	 fc
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
FacetResult	TokenNameIdentifier	 Facet Result
>	TokenNameGREATER	
expectedResults	TokenNameIdentifier	 expected Results
=	TokenNameEQUAL	
fc	TokenNameIdentifier	 fc
.	TokenNameDOT	
getFacetResults	TokenNameIdentifier	 get Facet Results
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
FacetSearchParams	TokenNameIdentifier	 Facet Search Params
samplingSearchParams	TokenNameIdentifier	 sampling Search Params
=	TokenNameEQUAL	
searchParamsWithRequests	TokenNameIdentifier	 search Params With Requests
(	TokenNameLPAREN	
K	TokenNameIdentifier	 K
,	TokenNameCOMMA	
partitionSize	TokenNameIdentifier	 partition Size
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// try several times in case of failure, because the test has a chance to fail 	TokenNameCOMMENT_LINE	try several times in case of failure, because the test has a chance to fail 
// if the top K facets are not sufficiently common with the sample set 	TokenNameCOMMENT_LINE	if the top K facets are not sufficiently common with the sample set 
for	TokenNamefor	
(	TokenNameLPAREN	
int	TokenNameint	
nTrial	TokenNameIdentifier	 n Trial
=	TokenNameEQUAL	
0	TokenNameIntegerLiteral	
;	TokenNameSEMICOLON	
nTrial	TokenNameIdentifier	 n Trial
<	TokenNameLESS	
RETRIES	TokenNameIdentifier	 RETRIES
;	TokenNameSEMICOLON	
nTrial	TokenNameIdentifier	 n Trial
++	TokenNamePLUS_PLUS	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
try	TokenNametry	
{	TokenNameLBRACE	
// complement with sampling! 	TokenNameCOMMENT_LINE	complement with sampling! 
final	TokenNamefinal	
Sampler	TokenNameIdentifier	 Sampler
sampler	TokenNameIdentifier	 sampler
=	TokenNameEQUAL	
createSampler	TokenNameIdentifier	 create Sampler
(	TokenNameLPAREN	
nTrial	TokenNameIdentifier	 n Trial
,	TokenNameCOMMA	
docCollector	TokenNameIdentifier	 doc Collector
.	TokenNameDOT	
getScoredDocIDs	TokenNameIdentifier	 get Scored Doc I Ds
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
useRandomSampler	TokenNameIdentifier	 use Random Sampler
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertSampling	TokenNameIdentifier	 assert Sampling
(	TokenNameLPAREN	
expectedResults	TokenNameIdentifier	 expected Results
,	TokenNameCOMMA	
q	TokenNameIdentifier	 q
,	TokenNameCOMMA	
sampler	TokenNameIdentifier	 sampler
,	TokenNameCOMMA	
samplingSearchParams	TokenNameIdentifier	 sampling Search Params
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertSampling	TokenNameIdentifier	 assert Sampling
(	TokenNameLPAREN	
expectedResults	TokenNameIdentifier	 expected Results
,	TokenNameCOMMA	
q	TokenNameIdentifier	 q
,	TokenNameCOMMA	
sampler	TokenNameIdentifier	 sampler
,	TokenNameCOMMA	
samplingSearchParams	TokenNameIdentifier	 sampling Search Params
,	TokenNameCOMMA	
true	TokenNametrue	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
break	TokenNamebreak	
;	TokenNameSEMICOLON	
// succeeded 	TokenNameCOMMENT_LINE	succeeded 
}	TokenNameRBRACE	
catch	TokenNamecatch	
(	TokenNameLPAREN	
NotSameResultError	TokenNameIdentifier	 Not Same Result Error
e	TokenNameIdentifier	 e
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
nTrial	TokenNameIdentifier	 n Trial
>=	TokenNameGREATER_EQUAL	
RETRIES	TokenNameIdentifier	 RETRIES
-	TokenNameMINUS	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
throw	TokenNamethrow	
e	TokenNameIdentifier	 e
;	TokenNameSEMICOLON	
// no more retries allowed, must fail 	TokenNameCOMMENT_LINE	no more retries allowed, must fail 
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
finally	TokenNamefinally	
{	TokenNameLBRACE	
closeAll	TokenNameIdentifier	 close All
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
private	TokenNameprivate	
void	TokenNamevoid	
assertSampling	TokenNameIdentifier	 assert Sampling
(	TokenNameLPAREN	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
FacetResult	TokenNameIdentifier	 Facet Result
>	TokenNameGREATER	
expected	TokenNameIdentifier	 expected
,	TokenNameCOMMA	
Query	TokenNameIdentifier	 Query
q	TokenNameIdentifier	 q
,	TokenNameCOMMA	
Sampler	TokenNameIdentifier	 Sampler
sampler	TokenNameIdentifier	 sampler
,	TokenNameCOMMA	
FacetSearchParams	TokenNameIdentifier	 Facet Search Params
params	TokenNameIdentifier	 params
,	TokenNameCOMMA	
boolean	TokenNameboolean	
complement	TokenNameIdentifier	 complement
)	TokenNameRPAREN	
throws	TokenNamethrows	
Exception	TokenNameIdentifier	 Exception
{	TokenNameLBRACE	
FacetsCollector	TokenNameIdentifier	 Facets Collector
samplingFC	TokenNameIdentifier	 sampling FC
=	TokenNameEQUAL	
samplingCollector	TokenNameIdentifier	 sampling Collector
(	TokenNameLPAREN	
complement	TokenNameIdentifier	 complement
,	TokenNameCOMMA	
sampler	TokenNameIdentifier	 sampler
,	TokenNameCOMMA	
params	TokenNameIdentifier	 params
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
searcher	TokenNameIdentifier	 searcher
.	TokenNameDOT	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
q	TokenNameIdentifier	 q
,	TokenNameCOMMA	
samplingFC	TokenNameIdentifier	 sampling FC
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
FacetResult	TokenNameIdentifier	 Facet Result
>	TokenNameGREATER	
sampledResults	TokenNameIdentifier	 sampled Results
=	TokenNameEQUAL	
samplingFC	TokenNameIdentifier	 sampling FC
.	TokenNameDOT	
getFacetResults	TokenNameIdentifier	 get Facet Results
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertSameResults	TokenNameIdentifier	 assert Same Results
(	TokenNameLPAREN	
expected	TokenNameIdentifier	 expected
,	TokenNameCOMMA	
sampledResults	TokenNameIdentifier	 sampled Results
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
FacetsCollector	TokenNameIdentifier	 Facets Collector
samplingCollector	TokenNameIdentifier	 sampling Collector
(	TokenNameLPAREN	
final	TokenNamefinal	
boolean	TokenNameboolean	
complement	TokenNameIdentifier	 complement
,	TokenNameCOMMA	
final	TokenNamefinal	
Sampler	TokenNameIdentifier	 Sampler
sampler	TokenNameIdentifier	 sampler
,	TokenNameCOMMA	
FacetSearchParams	TokenNameIdentifier	 Facet Search Params
samplingSearchParams	TokenNameIdentifier	 sampling Search Params
)	TokenNameRPAREN	
{	TokenNameLBRACE	
FacetsCollector	TokenNameIdentifier	 Facets Collector
samplingFC	TokenNameIdentifier	 sampling FC
=	TokenNameEQUAL	
new	TokenNamenew	
FacetsCollector	TokenNameIdentifier	 Facets Collector
(	TokenNameLPAREN	
samplingSearchParams	TokenNameIdentifier	 sampling Search Params
,	TokenNameCOMMA	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
taxoReader	TokenNameIdentifier	 taxo Reader
)	TokenNameRPAREN	
{	TokenNameLBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
protected	TokenNameprotected	
FacetsAccumulator	TokenNameIdentifier	 Facets Accumulator
initFacetsAccumulator	TokenNameIdentifier	 init Facets Accumulator
(	TokenNameLPAREN	
FacetSearchParams	TokenNameIdentifier	 Facet Search Params
facetSearchParams	TokenNameIdentifier	 facet Search Params
,	TokenNameCOMMA	
IndexReader	TokenNameIdentifier	 Index Reader
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
TaxonomyReader	TokenNameIdentifier	 Taxonomy Reader
taxonomyReader	TokenNameIdentifier	 taxonomy Reader
)	TokenNameRPAREN	
{	TokenNameLBRACE	
FacetsAccumulator	TokenNameIdentifier	 Facets Accumulator
acc	TokenNameIdentifier	 acc
=	TokenNameEQUAL	
getSamplingAccumulator	TokenNameIdentifier	 get Sampling Accumulator
(	TokenNameLPAREN	
sampler	TokenNameIdentifier	 sampler
,	TokenNameCOMMA	
taxonomyReader	TokenNameIdentifier	 taxonomy Reader
,	TokenNameCOMMA	
indexReader	TokenNameIdentifier	 index Reader
,	TokenNameCOMMA	
facetSearchParams	TokenNameIdentifier	 facet Search Params
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
acc	TokenNameIdentifier	 acc
.	TokenNameDOT	
setComplementThreshold	TokenNameIdentifier	 set Complement Threshold
(	TokenNameLPAREN	
complement	TokenNameIdentifier	 complement
?	TokenNameQUESTION	
FacetsAccumulator	TokenNameIdentifier	 Facets Accumulator
.	TokenNameDOT	
FORCE_COMPLEMENT	TokenNameIdentifier	 FORCE  COMPLEMENT
:	TokenNameCOLON	
FacetsAccumulator	TokenNameIdentifier	 Facets Accumulator
.	TokenNameDOT	
DISABLE_COMPLEMENT	TokenNameIdentifier	 DISABLE  COMPLEMENT
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
acc	TokenNameIdentifier	 acc
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
samplingFC	TokenNameIdentifier	 sampling FC
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
Sampler	TokenNameIdentifier	 Sampler
createSampler	TokenNameIdentifier	 create Sampler
(	TokenNameLPAREN	
int	TokenNameint	
nTrial	TokenNameIdentifier	 n Trial
,	TokenNameCOMMA	
ScoredDocIDs	TokenNameIdentifier	 Scored Doc I Ds
scoredDocIDs	TokenNameIdentifier	 scored Doc I Ds
,	TokenNameCOMMA	
boolean	TokenNameboolean	
useRandomSampler	TokenNameIdentifier	 use Random Sampler
)	TokenNameRPAREN	
{	TokenNameLBRACE	
SamplingParams	TokenNameIdentifier	 Sampling Params
samplingParams	TokenNameIdentifier	 sampling Params
=	TokenNameEQUAL	
new	TokenNamenew	
SamplingParams	TokenNameIdentifier	 Sampling Params
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
double	TokenNamedouble	
retryFactor	TokenNameIdentifier	 retry Factor
=	TokenNameEQUAL	
Math	TokenNameIdentifier	 Math
.	TokenNameDOT	
pow	TokenNameIdentifier	 pow
(	TokenNameLPAREN	
1.01	TokenNameDoubleLiteral	
,	TokenNameCOMMA	
nTrial	TokenNameIdentifier	 n Trial
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
samplingParams	TokenNameIdentifier	 sampling Params
.	TokenNameDOT	
setSampleRatio	TokenNameIdentifier	 set Sample Ratio
(	TokenNameLPAREN	
0.8	TokenNameDoubleLiteral	
*	TokenNameMULTIPLY	
retryFactor	TokenNameIdentifier	 retry Factor
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
samplingParams	TokenNameIdentifier	 sampling Params
.	TokenNameDOT	
setMinSampleSize	TokenNameIdentifier	 set Min Sample Size
(	TokenNameLPAREN	
(	TokenNameLPAREN	
int	TokenNameint	
)	TokenNameRPAREN	
(	TokenNameLPAREN	
100	TokenNameIntegerLiteral	
*	TokenNameMULTIPLY	
retryFactor	TokenNameIdentifier	 retry Factor
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
samplingParams	TokenNameIdentifier	 sampling Params
.	TokenNameDOT	
setMaxSampleSize	TokenNameIdentifier	 set Max Sample Size
(	TokenNameLPAREN	
(	TokenNameLPAREN	
int	TokenNameint	
)	TokenNameRPAREN	
(	TokenNameLPAREN	
10000	TokenNameIntegerLiteral	
*	TokenNameMULTIPLY	
retryFactor	TokenNameIdentifier	 retry Factor
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
samplingParams	TokenNameIdentifier	 sampling Params
.	TokenNameDOT	
setOversampleFactor	TokenNameIdentifier	 set Oversample Factor
(	TokenNameLPAREN	
5.0	TokenNameDoubleLiteral	
*	TokenNameMULTIPLY	
retryFactor	TokenNameIdentifier	 retry Factor
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
samplingParams	TokenNameIdentifier	 sampling Params
.	TokenNameDOT	
setSampingThreshold	TokenNameIdentifier	 set Samping Threshold
(	TokenNameLPAREN	
11000	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
//force sampling 	TokenNameCOMMENT_LINE	force sampling 
Sampler	TokenNameIdentifier	 Sampler
sampler	TokenNameIdentifier	 sampler
=	TokenNameEQUAL	
useRandomSampler	TokenNameIdentifier	 use Random Sampler
?	TokenNameQUESTION	
new	TokenNamenew	
RandomSampler	TokenNameIdentifier	 Random Sampler
(	TokenNameLPAREN	
samplingParams	TokenNameIdentifier	 sampling Params
,	TokenNameCOMMA	
new	TokenNamenew	
Random	TokenNameIdentifier	 Random
(	TokenNameLPAREN	
random	TokenNameIdentifier	 random
.	TokenNameDOT	
nextLong	TokenNameIdentifier	 next Long
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
:	TokenNameCOLON	
new	TokenNamenew	
RepeatableSampler	TokenNameIdentifier	 Repeatable Sampler
(	TokenNameLPAREN	
samplingParams	TokenNameIdentifier	 sampling Params
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assertTrue	TokenNameIdentifier	 assert True
(	TokenNameLPAREN	
"must enable sampling for this test!"	TokenNameStringLiteral	must enable sampling for this test!
,	TokenNameCOMMA	
sampler	TokenNameIdentifier	 sampler
.	TokenNameDOT	
shouldSample	TokenNameIdentifier	 should Sample
(	TokenNameLPAREN	
scoredDocIDs	TokenNameIdentifier	 scored Doc I Ds
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
sampler	TokenNameIdentifier	 sampler
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
