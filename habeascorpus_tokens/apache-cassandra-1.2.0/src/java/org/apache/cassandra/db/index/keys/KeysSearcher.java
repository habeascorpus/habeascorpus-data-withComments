/* * Licensed to the Apache Software Foundation (ASF) under one * or more contributor license agreements. See the NOTICE file * distributed with this work for additional information * regarding copyright ownership. The ASF licenses this file * to you under the Apache License, Version 2.0 (the * "License"); you may not use this file except in compliance * with the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */	TokenNameCOMMENT_BLOCK	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
keys	TokenNameIdentifier	 keys
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
IOException	TokenNameIdentifier	 IO Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
nio	TokenNameIdentifier	 nio
.	TokenNameDOT	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
filter	TokenNameIdentifier	 filter
.	TokenNameDOT	
*	TokenNameMULTIPLY	
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
AbstractSimplePerColumnSecondaryIndex	TokenNameIdentifier	 Abstract Simple Per Column Secondary Index
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
PerColumnSecondaryIndex	TokenNameIdentifier	 Per Column Secondary Index
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
SecondaryIndex	TokenNameIdentifier	 Secondary Index
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
SecondaryIndexManager	TokenNameIdentifier	 Secondary Index Manager
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
db	TokenNameIdentifier	 db
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
SecondaryIndexSearcher	TokenNameIdentifier	 Secondary Index Searcher
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
dht	TokenNameIdentifier	 dht
.	TokenNameDOT	
AbstractBounds	TokenNameIdentifier	 Abstract Bounds
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
dht	TokenNameIdentifier	 dht
.	TokenNameDOT	
Range	TokenNameIdentifier	 Range
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
IndexExpression	TokenNameIdentifier	 Index Expression
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
thrift	TokenNameIdentifier	 thrift
.	TokenNameDOT	
IndexOperator	TokenNameIdentifier	 Index Operator
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
cassandra	TokenNameIdentifier	 cassandra
.	TokenNameDOT	
utils	TokenNameIdentifier	 utils
.	TokenNameDOT	
HeapAllocator	TokenNameIdentifier	 Heap Allocator
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
Logger	TokenNameIdentifier	 Logger
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
slf4j	TokenNameIdentifier	 slf4j
.	TokenNameDOT	
LoggerFactory	TokenNameIdentifier	 Logger Factory
;	TokenNameSEMICOLON	
public	TokenNamepublic	
class	TokenNameclass	
KeysSearcher	TokenNameIdentifier	 Keys Searcher
extends	TokenNameextends	
SecondaryIndexSearcher	TokenNameIdentifier	 Secondary Index Searcher
{	TokenNameLBRACE	
private	TokenNameprivate	
static	TokenNamestatic	
final	TokenNamefinal	
Logger	TokenNameIdentifier	 Logger
logger	TokenNameIdentifier	 logger
=	TokenNameEQUAL	
LoggerFactory	TokenNameIdentifier	 Logger Factory
.	TokenNameDOT	
getLogger	TokenNameIdentifier	 get Logger
(	TokenNameLPAREN	
KeysSearcher	TokenNameIdentifier	 Keys Searcher
.	TokenNameDOT	
class	TokenNameclass	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
public	TokenNamepublic	
KeysSearcher	TokenNameIdentifier	 Keys Searcher
(	TokenNameLPAREN	
SecondaryIndexManager	TokenNameIdentifier	 Secondary Index Manager
indexManager	TokenNameIdentifier	 index Manager
,	TokenNameCOMMA	
Set	TokenNameIdentifier	 Set
<	TokenNameLESS	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
>	TokenNameGREATER	
columns	TokenNameIdentifier	 columns
)	TokenNameRPAREN	
{	TokenNameLBRACE	
super	TokenNamesuper	
(	TokenNameLPAREN	
indexManager	TokenNameIdentifier	 index Manager
,	TokenNameCOMMA	
columns	TokenNameIdentifier	 columns
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
private	TokenNameprivate	
IndexExpression	TokenNameIdentifier	 Index Expression
highestSelectivityPredicate	TokenNameIdentifier	 highest Selectivity Predicate
(	TokenNameLPAREN	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
IndexExpression	TokenNameIdentifier	 Index Expression
>	TokenNameGREATER	
clause	TokenNameIdentifier	 clause
)	TokenNameRPAREN	
{	TokenNameLBRACE	
IndexExpression	TokenNameIdentifier	 Index Expression
best	TokenNameIdentifier	 best
=	TokenNameEQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
int	TokenNameint	
bestMeanCount	TokenNameIdentifier	 best Mean Count
=	TokenNameEQUAL	
Integer	TokenNameIdentifier	 Integer
.	TokenNameDOT	
MAX_VALUE	TokenNameIdentifier	 MAX  VALUE
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
IndexExpression	TokenNameIdentifier	 Index Expression
expression	TokenNameIdentifier	 expression
:	TokenNameCOLON	
clause	TokenNameIdentifier	 clause
)	TokenNameRPAREN	
{	TokenNameLBRACE	
//skip columns belonging to a different index type 	TokenNameCOMMENT_LINE	skip columns belonging to a different index type 
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
columns	TokenNameIdentifier	 columns
.	TokenNameDOT	
contains	TokenNameIdentifier	 contains
(	TokenNameLPAREN	
expression	TokenNameIdentifier	 expression
.	TokenNameDOT	
column_name	TokenNameIdentifier	 column name
)	TokenNameRPAREN	
)	TokenNameRPAREN	
continue	TokenNamecontinue	
;	TokenNameSEMICOLON	
SecondaryIndex	TokenNameIdentifier	 Secondary Index
index	TokenNameIdentifier	 index
=	TokenNameEQUAL	
indexManager	TokenNameIdentifier	 index Manager
.	TokenNameDOT	
getIndexForColumn	TokenNameIdentifier	 get Index For Column
(	TokenNameLPAREN	
expression	TokenNameIdentifier	 expression
.	TokenNameDOT	
column_name	TokenNameIdentifier	 column name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
index	TokenNameIdentifier	 index
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
||	TokenNameOR_OR	
(	TokenNameLPAREN	
expression	TokenNameIdentifier	 expression
.	TokenNameDOT	
op	TokenNameIdentifier	 op
!=	TokenNameNOT_EQUAL	
IndexOperator	TokenNameIdentifier	 Index Operator
.	TokenNameDOT	
EQ	TokenNameIdentifier	 EQ
)	TokenNameRPAREN	
)	TokenNameRPAREN	
continue	TokenNamecontinue	
;	TokenNameSEMICOLON	
int	TokenNameint	
columns	TokenNameIdentifier	 columns
=	TokenNameEQUAL	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
getIndexCfs	TokenNameIdentifier	 get Index Cfs
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getMeanColumns	TokenNameIdentifier	 get Mean Columns
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
columns	TokenNameIdentifier	 columns
<	TokenNameLESS	
bestMeanCount	TokenNameIdentifier	 best Mean Count
)	TokenNameRPAREN	
{	TokenNameLBRACE	
best	TokenNameIdentifier	 best
=	TokenNameEQUAL	
expression	TokenNameIdentifier	 expression
;	TokenNameSEMICOLON	
bestMeanCount	TokenNameIdentifier	 best Mean Count
=	TokenNameEQUAL	
columns	TokenNameIdentifier	 columns
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
return	TokenNamereturn	
best	TokenNameIdentifier	 best
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
boolean	TokenNameboolean	
isIndexing	TokenNameIdentifier	 is Indexing
(	TokenNameLPAREN	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
IndexExpression	TokenNameIdentifier	 Index Expression
>	TokenNameGREATER	
clause	TokenNameIdentifier	 clause
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
highestSelectivityPredicate	TokenNameIdentifier	 highest Selectivity Predicate
(	TokenNameLPAREN	
clause	TokenNameIdentifier	 clause
)	TokenNameRPAREN	
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
Row	TokenNameIdentifier	 Row
>	TokenNameGREATER	
search	TokenNameIdentifier	 search
(	TokenNameLPAREN	
List	TokenNameIdentifier	 List
<	TokenNameLESS	
IndexExpression	TokenNameIdentifier	 Index Expression
>	TokenNameGREATER	
clause	TokenNameIdentifier	 clause
,	TokenNameCOMMA	
AbstractBounds	TokenNameIdentifier	 Abstract Bounds
<	TokenNameLESS	
RowPosition	TokenNameIdentifier	 Row Position
>	TokenNameGREATER	
range	TokenNameIdentifier	 range
,	TokenNameCOMMA	
int	TokenNameint	
maxResults	TokenNameIdentifier	 max Results
,	TokenNameCOMMA	
IDiskAtomFilter	TokenNameIdentifier	 I Disk Atom Filter
dataFilter	TokenNameIdentifier	 data Filter
,	TokenNameCOMMA	
boolean	TokenNameboolean	
countCQL3Rows	TokenNameIdentifier	 count CQ L3 Rows
)	TokenNameRPAREN	
{	TokenNameLBRACE	
assert	TokenNameassert	
clause	TokenNameIdentifier	 clause
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
&&	TokenNameAND_AND	
!	TokenNameNOT	
clause	TokenNameIdentifier	 clause
.	TokenNameDOT	
isEmpty	TokenNameIdentifier	 is Empty
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ExtendedFilter	TokenNameIdentifier	 Extended Filter
filter	TokenNameIdentifier	 filter
=	TokenNameEQUAL	
ExtendedFilter	TokenNameIdentifier	 Extended Filter
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
baseCfs	TokenNameIdentifier	 base Cfs
,	TokenNameCOMMA	
dataFilter	TokenNameIdentifier	 data Filter
,	TokenNameCOMMA	
clause	TokenNameIdentifier	 clause
,	TokenNameCOMMA	
maxResults	TokenNameIdentifier	 max Results
,	TokenNameCOMMA	
countCQL3Rows	TokenNameIdentifier	 count CQ L3 Rows
,	TokenNameCOMMA	
false	TokenNamefalse	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
baseCfs	TokenNameIdentifier	 base Cfs
.	TokenNameDOT	
filter	TokenNameIdentifier	 filter
(	TokenNameLPAREN	
getIndexedIterator	TokenNameIdentifier	 get Indexed Iterator
(	TokenNameLPAREN	
range	TokenNameIdentifier	 range
,	TokenNameCOMMA	
filter	TokenNameIdentifier	 filter
)	TokenNameRPAREN	
,	TokenNameCOMMA	
filter	TokenNameIdentifier	 filter
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
.	TokenNameDOT	
AbstractScanIterator	TokenNameIdentifier	 Abstract Scan Iterator
getIndexedIterator	TokenNameIdentifier	 get Indexed Iterator
(	TokenNameLPAREN	
final	TokenNamefinal	
AbstractBounds	TokenNameIdentifier	 Abstract Bounds
<	TokenNameLESS	
RowPosition	TokenNameIdentifier	 Row Position
>	TokenNameGREATER	
range	TokenNameIdentifier	 range
,	TokenNameCOMMA	
final	TokenNamefinal	
ExtendedFilter	TokenNameIdentifier	 Extended Filter
filter	TokenNameIdentifier	 filter
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// Start with the most-restrictive indexed clause, then apply remaining clauses 	TokenNameCOMMENT_LINE	Start with the most-restrictive indexed clause, then apply remaining clauses 
// to each row matching that clause. 	TokenNameCOMMENT_LINE	to each row matching that clause. 
// TODO: allow merge join instead of just one index + loop 	TokenNameCOMMENT_LINE	TODO: allow merge join instead of just one index + loop 
final	TokenNamefinal	
IndexExpression	TokenNameIdentifier	 Index Expression
primary	TokenNameIdentifier	 primary
=	TokenNameEQUAL	
highestSelectivityPredicate	TokenNameIdentifier	 highest Selectivity Predicate
(	TokenNameLPAREN	
filter	TokenNameIdentifier	 filter
.	TokenNameDOT	
getClause	TokenNameIdentifier	 get Clause
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
SecondaryIndex	TokenNameIdentifier	 Secondary Index
index	TokenNameIdentifier	 index
=	TokenNameEQUAL	
indexManager	TokenNameIdentifier	 index Manager
.	TokenNameDOT	
getIndexForColumn	TokenNameIdentifier	 get Index For Column
(	TokenNameLPAREN	
primary	TokenNameIdentifier	 primary
.	TokenNameDOT	
column_name	TokenNameIdentifier	 column name
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
assert	TokenNameassert	
index	TokenNameIdentifier	 index
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
;	TokenNameSEMICOLON	
final	TokenNamefinal	
DecoratedKey	TokenNameIdentifier	 Decorated Key
indexKey	TokenNameIdentifier	 index Key
=	TokenNameEQUAL	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
getIndexKeyFor	TokenNameIdentifier	 get Index Key For
(	TokenNameLPAREN	
primary	TokenNameIdentifier	 primary
.	TokenNameDOT	
value	TokenNameIdentifier	 value
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
isDebugEnabled	TokenNameIdentifier	 is Debug Enabled
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
debug	TokenNameIdentifier	 debug
(	TokenNameLPAREN	
"Most-selective indexed predicate is {}"	TokenNameStringLiteral	Most-selective indexed predicate is {}
,	TokenNameCOMMA	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
AbstractSimplePerColumnSecondaryIndex	TokenNameIdentifier	 Abstract Simple Per Column Secondary Index
)	TokenNameRPAREN	
index	TokenNameIdentifier	 index
)	TokenNameRPAREN	
.	TokenNameDOT	
expressionString	TokenNameIdentifier	 expression String
(	TokenNameLPAREN	
primary	TokenNameIdentifier	 primary
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
/* * XXX: If the range requested is a token range, we'll have to start at the beginning (and stop at the end) of * the indexed row unfortunately (which will be inefficient), because we have not way to intuit the small * possible key having a given token. A fix would be to actually store the token along the key in the * indexed row. */	TokenNameCOMMENT_BLOCK	 XXX: If the range requested is a token range, we'll have to start at the beginning (and stop at the end) of the indexed row unfortunately (which will be inefficient), because we have not way to intuit the small possible key having a given token. A fix would be to actually store the token along the key in the indexed row. 
final	TokenNamefinal	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
startKey	TokenNameIdentifier	 start Key
=	TokenNameEQUAL	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
left	TokenNameIdentifier	 left
instanceof	TokenNameinstanceof	
DecoratedKey	TokenNameIdentifier	 Decorated Key
?	TokenNameQUESTION	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
DecoratedKey	TokenNameIdentifier	 Decorated Key
)	TokenNameRPAREN	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
left	TokenNameIdentifier	 left
)	TokenNameRPAREN	
.	TokenNameDOT	
key	TokenNameIdentifier	 key
:	TokenNameCOLON	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
EMPTY_BYTE_BUFFER	TokenNameIdentifier	 EMPTY  BYTE  BUFFER
;	TokenNameSEMICOLON	
final	TokenNamefinal	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
endKey	TokenNameIdentifier	 end Key
=	TokenNameEQUAL	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
right	TokenNameIdentifier	 right
instanceof	TokenNameinstanceof	
DecoratedKey	TokenNameIdentifier	 Decorated Key
?	TokenNameQUESTION	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
DecoratedKey	TokenNameIdentifier	 Decorated Key
)	TokenNameRPAREN	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
right	TokenNameIdentifier	 right
)	TokenNameRPAREN	
.	TokenNameDOT	
key	TokenNameIdentifier	 key
:	TokenNameCOLON	
ByteBufferUtil	TokenNameIdentifier	 Byte Buffer Util
.	TokenNameDOT	
EMPTY_BYTE_BUFFER	TokenNameIdentifier	 EMPTY  BYTE  BUFFER
;	TokenNameSEMICOLON	
return	TokenNamereturn	
new	TokenNamenew	
ColumnFamilyStore	TokenNameIdentifier	 Column Family Store
.	TokenNameDOT	
AbstractScanIterator	TokenNameIdentifier	 Abstract Scan Iterator
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
private	TokenNameprivate	
ByteBuffer	TokenNameIdentifier	 Byte Buffer
lastSeenKey	TokenNameIdentifier	 last Seen Key
=	TokenNameEQUAL	
startKey	TokenNameIdentifier	 start Key
;	TokenNameSEMICOLON	
private	TokenNameprivate	
Iterator	TokenNameIdentifier	 Iterator
<	TokenNameLESS	
IColumn	TokenNameIdentifier	 I Column
>	TokenNameGREATER	
indexColumns	TokenNameIdentifier	 index Columns
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
QueryPath	TokenNameIdentifier	 Query Path
path	TokenNameIdentifier	 path
=	TokenNameEQUAL	
new	TokenNamenew	
QueryPath	TokenNameIdentifier	 Query Path
(	TokenNameLPAREN	
baseCfs	TokenNameIdentifier	 base Cfs
.	TokenNameDOT	
columnFamily	TokenNameIdentifier	 column Family
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
private	TokenNameprivate	
int	TokenNameint	
columnsRead	TokenNameIdentifier	 columns Read
=	TokenNameEQUAL	
Integer	TokenNameIdentifier	 Integer
.	TokenNameDOT	
MAX_VALUE	TokenNameIdentifier	 MAX  VALUE
;	TokenNameSEMICOLON	
protected	TokenNameprotected	
Row	TokenNameIdentifier	 Row
computeNext	TokenNameIdentifier	 compute Next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
int	TokenNameint	
meanColumns	TokenNameIdentifier	 mean Columns
=	TokenNameEQUAL	
Math	TokenNameIdentifier	 Math
.	TokenNameDOT	
max	TokenNameIdentifier	 max
(	TokenNameLPAREN	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
getIndexCfs	TokenNameIdentifier	 get Index Cfs
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getMeanColumns	TokenNameIdentifier	 get Mean Columns
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// We shouldn't fetch only 1 row as this provides buggy paging in case the first row doesn't satisfy all clauses 	TokenNameCOMMENT_LINE	We shouldn't fetch only 1 row as this provides buggy paging in case the first row doesn't satisfy all clauses 
int	TokenNameint	
rowsPerQuery	TokenNameIdentifier	 rows Per Query
=	TokenNameEQUAL	
Math	TokenNameIdentifier	 Math
.	TokenNameDOT	
max	TokenNameIdentifier	 max
(	TokenNameLPAREN	
Math	TokenNameIdentifier	 Math
.	TokenNameDOT	
min	TokenNameIdentifier	 min
(	TokenNameLPAREN	
filter	TokenNameIdentifier	 filter
.	TokenNameDOT	
maxRows	TokenNameIdentifier	 max Rows
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
filter	TokenNameIdentifier	 filter
.	TokenNameDOT	
maxColumns	TokenNameIdentifier	 max Columns
(	TokenNameLPAREN	
)	TokenNameRPAREN	
/	TokenNameDIVIDE	
meanColumns	TokenNameIdentifier	 mean Columns
)	TokenNameRPAREN	
,	TokenNameCOMMA	
2	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
while	TokenNamewhile	
(	TokenNameLPAREN	
true	TokenNametrue	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
indexColumns	TokenNameIdentifier	 index Columns
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
||	TokenNameOR_OR	
!	TokenNameNOT	
indexColumns	TokenNameIdentifier	 index Columns
.	TokenNameDOT	
hasNext	TokenNameIdentifier	 has Next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
columnsRead	TokenNameIdentifier	 columns Read
<	TokenNameLESS	
rowsPerQuery	TokenNameIdentifier	 rows Per Query
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
trace	TokenNameIdentifier	 trace
(	TokenNameLPAREN	
"Read only {} (< {}) last page through, must be done"	TokenNameStringLiteral	Read only {} (< {}) last page through, must be done
,	TokenNameCOMMA	
columnsRead	TokenNameIdentifier	 columns Read
,	TokenNameCOMMA	
rowsPerQuery	TokenNameIdentifier	 rows Per Query
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
endOfData	TokenNameIdentifier	 end Of Data
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
isTraceEnabled	TokenNameIdentifier	 is Trace Enabled
(	TokenNameLPAREN	
)	TokenNameRPAREN	
&&	TokenNameAND_AND	
(	TokenNameLPAREN	
index	TokenNameIdentifier	 index
instanceof	TokenNameinstanceof	
AbstractSimplePerColumnSecondaryIndex	TokenNameIdentifier	 Abstract Simple Per Column Secondary Index
)	TokenNameRPAREN	
)	TokenNameRPAREN	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
trace	TokenNameIdentifier	 trace
(	TokenNameLPAREN	
"Scanning index {} starting with {}"	TokenNameStringLiteral	Scanning index {} starting with {}
,	TokenNameCOMMA	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
AbstractSimplePerColumnSecondaryIndex	TokenNameIdentifier	 Abstract Simple Per Column Secondary Index
)	TokenNameRPAREN	
index	TokenNameIdentifier	 index
)	TokenNameRPAREN	
.	TokenNameDOT	
expressionString	TokenNameIdentifier	 expression String
(	TokenNameLPAREN	
primary	TokenNameIdentifier	 primary
)	TokenNameRPAREN	
,	TokenNameCOMMA	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
getBaseCfs	TokenNameIdentifier	 get Base Cfs
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
metadata	TokenNameIdentifier	 metadata
.	TokenNameDOT	
getKeyValidator	TokenNameIdentifier	 get Key Validator
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getString	TokenNameIdentifier	 get String
(	TokenNameLPAREN	
startKey	TokenNameIdentifier	 start Key
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
QueryFilter	TokenNameIdentifier	 Query Filter
indexFilter	TokenNameIdentifier	 index Filter
=	TokenNameEQUAL	
QueryFilter	TokenNameIdentifier	 Query Filter
.	TokenNameDOT	
getSliceFilter	TokenNameIdentifier	 get Slice Filter
(	TokenNameLPAREN	
indexKey	TokenNameIdentifier	 index Key
,	TokenNameCOMMA	
new	TokenNamenew	
QueryPath	TokenNameIdentifier	 Query Path
(	TokenNameLPAREN	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
getIndexCfs	TokenNameIdentifier	 get Index Cfs
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getColumnFamilyName	TokenNameIdentifier	 get Column Family Name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
lastSeenKey	TokenNameIdentifier	 last Seen Key
,	TokenNameCOMMA	
endKey	TokenNameIdentifier	 end Key
,	TokenNameCOMMA	
false	TokenNamefalse	
,	TokenNameCOMMA	
rowsPerQuery	TokenNameIdentifier	 rows Per Query
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ColumnFamily	TokenNameIdentifier	 Column Family
indexRow	TokenNameIdentifier	 index Row
=	TokenNameEQUAL	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
getIndexCfs	TokenNameIdentifier	 get Index Cfs
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getColumnFamily	TokenNameIdentifier	 get Column Family
(	TokenNameLPAREN	
indexFilter	TokenNameIdentifier	 index Filter
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
trace	TokenNameIdentifier	 trace
(	TokenNameLPAREN	
"fetched {}"	TokenNameStringLiteral	fetched {}
,	TokenNameCOMMA	
indexRow	TokenNameIdentifier	 index Row
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
indexRow	TokenNameIdentifier	 index Row
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
trace	TokenNameIdentifier	 trace
(	TokenNameLPAREN	
"no data, all done"	TokenNameStringLiteral	no data, all done
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
endOfData	TokenNameIdentifier	 end Of Data
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
Collection	TokenNameIdentifier	 Collection
<	TokenNameLESS	
IColumn	TokenNameIdentifier	 I Column
>	TokenNameGREATER	
sortedColumns	TokenNameIdentifier	 sorted Columns
=	TokenNameEQUAL	
indexRow	TokenNameIdentifier	 index Row
.	TokenNameDOT	
getSortedColumns	TokenNameIdentifier	 get Sorted Columns
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
columnsRead	TokenNameIdentifier	 columns Read
=	TokenNameEQUAL	
sortedColumns	TokenNameIdentifier	 sorted Columns
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
indexColumns	TokenNameIdentifier	 index Columns
=	TokenNameEQUAL	
sortedColumns	TokenNameIdentifier	 sorted Columns
.	TokenNameDOT	
iterator	TokenNameIdentifier	 iterator
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
IColumn	TokenNameIdentifier	 I Column
firstColumn	TokenNameIdentifier	 first Column
=	TokenNameEQUAL	
sortedColumns	TokenNameIdentifier	 sorted Columns
.	TokenNameDOT	
iterator	TokenNameIdentifier	 iterator
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
next	TokenNameIdentifier	 next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// Paging is racy, so it is possible the first column of a page is not the last seen one. 	TokenNameCOMMENT_LINE	Paging is racy, so it is possible the first column of a page is not the last seen one. 
if	TokenNameif	
(	TokenNameLPAREN	
lastSeenKey	TokenNameIdentifier	 last Seen Key
!=	TokenNameNOT_EQUAL	
startKey	TokenNameIdentifier	 start Key
&&	TokenNameAND_AND	
lastSeenKey	TokenNameIdentifier	 last Seen Key
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
firstColumn	TokenNameIdentifier	 first Column
.	TokenNameDOT	
name	TokenNameIdentifier	 name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// skip the row we already saw w/ the last page of results 	TokenNameCOMMENT_LINE	skip the row we already saw w/ the last page of results 
indexColumns	TokenNameIdentifier	 index Columns
.	TokenNameDOT	
next	TokenNameIdentifier	 next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
trace	TokenNameIdentifier	 trace
(	TokenNameLPAREN	
"Skipping {}"	TokenNameStringLiteral	Skipping {}
,	TokenNameCOMMA	
baseCfs	TokenNameIdentifier	 base Cfs
.	TokenNameDOT	
metadata	TokenNameIdentifier	 metadata
.	TokenNameDOT	
getKeyValidator	TokenNameIdentifier	 get Key Validator
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
getString	TokenNameIdentifier	 get String
(	TokenNameLPAREN	
firstColumn	TokenNameIdentifier	 first Column
.	TokenNameDOT	
name	TokenNameIdentifier	 name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
else	TokenNameelse	
if	TokenNameif	
(	TokenNameLPAREN	
range	TokenNameIdentifier	 range
instanceof	TokenNameinstanceof	
Range	TokenNameIdentifier	 Range
&&	TokenNameAND_AND	
indexColumns	TokenNameIdentifier	 index Columns
.	TokenNameDOT	
hasNext	TokenNameIdentifier	 has Next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
&&	TokenNameAND_AND	
firstColumn	TokenNameIdentifier	 first Column
.	TokenNameDOT	
name	TokenNameIdentifier	 name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
.	TokenNameDOT	
equals	TokenNameIdentifier	 equals
(	TokenNameLPAREN	
startKey	TokenNameIdentifier	 start Key
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// skip key excluded by range 	TokenNameCOMMENT_LINE	skip key excluded by range 
indexColumns	TokenNameIdentifier	 index Columns
.	TokenNameDOT	
next	TokenNameIdentifier	 next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
trace	TokenNameIdentifier	 trace
(	TokenNameLPAREN	
"Skipping first key as range excludes it"	TokenNameStringLiteral	Skipping first key as range excludes it
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
while	TokenNamewhile	
(	TokenNameLPAREN	
indexColumns	TokenNameIdentifier	 index Columns
.	TokenNameDOT	
hasNext	TokenNameIdentifier	 has Next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
IColumn	TokenNameIdentifier	 I Column
column	TokenNameIdentifier	 column
=	TokenNameEQUAL	
indexColumns	TokenNameIdentifier	 index Columns
.	TokenNameDOT	
next	TokenNameIdentifier	 next
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
lastSeenKey	TokenNameIdentifier	 last Seen Key
=	TokenNameEQUAL	
column	TokenNameIdentifier	 column
.	TokenNameDOT	
name	TokenNameIdentifier	 name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
column	TokenNameIdentifier	 column
.	TokenNameDOT	
isMarkedForDelete	TokenNameIdentifier	 is Marked For Delete
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
trace	TokenNameIdentifier	 trace
(	TokenNameLPAREN	
"skipping {}"	TokenNameStringLiteral	skipping {}
,	TokenNameCOMMA	
column	TokenNameIdentifier	 column
.	TokenNameDOT	
name	TokenNameIdentifier	 name
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
continue	TokenNamecontinue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
DecoratedKey	TokenNameIdentifier	 Decorated Key
dk	TokenNameIdentifier	 dk
=	TokenNameEQUAL	
baseCfs	TokenNameIdentifier	 base Cfs
.	TokenNameDOT	
partitioner	TokenNameIdentifier	 partitioner
.	TokenNameDOT	
decorateKey	TokenNameIdentifier	 decorate Key
(	TokenNameLPAREN	
lastSeenKey	TokenNameIdentifier	 last Seen Key
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
right	TokenNameIdentifier	 right
.	TokenNameDOT	
isMinimum	TokenNameIdentifier	 is Minimum
(	TokenNameLPAREN	
baseCfs	TokenNameIdentifier	 base Cfs
.	TokenNameDOT	
partitioner	TokenNameIdentifier	 partitioner
)	TokenNameRPAREN	
&&	TokenNameAND_AND	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
right	TokenNameIdentifier	 right
.	TokenNameDOT	
compareTo	TokenNameIdentifier	 compare To
(	TokenNameLPAREN	
dk	TokenNameIdentifier	 dk
)	TokenNameRPAREN	
<	TokenNameLESS	
0	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
trace	TokenNameIdentifier	 trace
(	TokenNameLPAREN	
"Reached end of assigned scan range"	TokenNameStringLiteral	Reached end of assigned scan range
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
endOfData	TokenNameIdentifier	 end Of Data
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
!	TokenNameNOT	
range	TokenNameIdentifier	 range
.	TokenNameDOT	
contains	TokenNameIdentifier	 contains
(	TokenNameLPAREN	
dk	TokenNameIdentifier	 dk
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
trace	TokenNameIdentifier	 trace
(	TokenNameLPAREN	
"Skipping entry {} outside of assigned scan range"	TokenNameStringLiteral	Skipping entry {} outside of assigned scan range
,	TokenNameCOMMA	
dk	TokenNameIdentifier	 dk
.	TokenNameDOT	
token	TokenNameIdentifier	 token
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
continue	TokenNamecontinue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
logger	TokenNameIdentifier	 logger
.	TokenNameDOT	
trace	TokenNameIdentifier	 trace
(	TokenNameLPAREN	
"Returning index hit for {}"	TokenNameStringLiteral	Returning index hit for {}
,	TokenNameCOMMA	
dk	TokenNameIdentifier	 dk
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
ColumnFamily	TokenNameIdentifier	 Column Family
data	TokenNameIdentifier	 data
=	TokenNameEQUAL	
baseCfs	TokenNameIdentifier	 base Cfs
.	TokenNameDOT	
getColumnFamily	TokenNameIdentifier	 get Column Family
(	TokenNameLPAREN	
new	TokenNamenew	
QueryFilter	TokenNameIdentifier	 Query Filter
(	TokenNameLPAREN	
dk	TokenNameIdentifier	 dk
,	TokenNameCOMMA	
path	TokenNameIdentifier	 path
,	TokenNameCOMMA	
filter	TokenNameIdentifier	 filter
.	TokenNameDOT	
initialFilter	TokenNameIdentifier	 initial Filter
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// While the column family we'll get in the end should contains the primary clause column, the initialFilter may not have found it and can thus be null 	TokenNameCOMMENT_LINE	While the column family we'll get in the end should contains the primary clause column, the initialFilter may not have found it and can thus be null 
if	TokenNameif	
(	TokenNameLPAREN	
data	TokenNameIdentifier	 data
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
data	TokenNameIdentifier	 data
=	TokenNameEQUAL	
ColumnFamily	TokenNameIdentifier	 Column Family
.	TokenNameDOT	
create	TokenNameIdentifier	 create
(	TokenNameLPAREN	
baseCfs	TokenNameIdentifier	 base Cfs
.	TokenNameDOT	
metadata	TokenNameIdentifier	 metadata
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
// as in CFS.filter - extend the filter to ensure we include the columns 	TokenNameCOMMENT_LINE	as in CFS.filter - extend the filter to ensure we include the columns 
// from the index expressions, just in case they weren't included in the initialFilter 	TokenNameCOMMENT_LINE	from the index expressions, just in case they weren't included in the initialFilter 
IDiskAtomFilter	TokenNameIdentifier	 I Disk Atom Filter
extraFilter	TokenNameIdentifier	 extra Filter
=	TokenNameEQUAL	
filter	TokenNameIdentifier	 filter
.	TokenNameDOT	
getExtraFilter	TokenNameIdentifier	 get Extra Filter
(	TokenNameLPAREN	
data	TokenNameIdentifier	 data
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
extraFilter	TokenNameIdentifier	 extra Filter
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
ColumnFamily	TokenNameIdentifier	 Column Family
cf	TokenNameIdentifier	 cf
=	TokenNameEQUAL	
baseCfs	TokenNameIdentifier	 base Cfs
.	TokenNameDOT	
getColumnFamily	TokenNameIdentifier	 get Column Family
(	TokenNameLPAREN	
new	TokenNamenew	
QueryFilter	TokenNameIdentifier	 Query Filter
(	TokenNameLPAREN	
dk	TokenNameIdentifier	 dk
,	TokenNameCOMMA	
path	TokenNameIdentifier	 path
,	TokenNameCOMMA	
extraFilter	TokenNameIdentifier	 extra Filter
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
cf	TokenNameIdentifier	 cf
!=	TokenNameNOT_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
data	TokenNameIdentifier	 data
.	TokenNameDOT	
addAll	TokenNameIdentifier	 add All
(	TokenNameLPAREN	
cf	TokenNameIdentifier	 cf
,	TokenNameCOMMA	
HeapAllocator	TokenNameIdentifier	 Heap Allocator
.	TokenNameDOT	
instance	TokenNameIdentifier	 instance
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
if	TokenNameif	
(	TokenNameLPAREN	
isIndexValueStale	TokenNameIdentifier	 is Index Value Stale
(	TokenNameLPAREN	
data	TokenNameIdentifier	 data
,	TokenNameCOMMA	
primary	TokenNameIdentifier	 primary
.	TokenNameDOT	
column_name	TokenNameIdentifier	 column name
,	TokenNameCOMMA	
indexKey	TokenNameIdentifier	 index Key
.	TokenNameDOT	
key	TokenNameIdentifier	 key
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
// delete the index entry w/ its own timestamp 	TokenNameCOMMENT_LINE	delete the index entry w/ its own timestamp 
IColumn	TokenNameIdentifier	 I Column
dummyColumn	TokenNameIdentifier	 dummy Column
=	TokenNameEQUAL	
new	TokenNamenew	
Column	TokenNameIdentifier	 Column
(	TokenNameLPAREN	
primary	TokenNameIdentifier	 primary
.	TokenNameDOT	
column_name	TokenNameIdentifier	 column name
,	TokenNameCOMMA	
indexKey	TokenNameIdentifier	 index Key
.	TokenNameDOT	
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
column	TokenNameIdentifier	 column
.	TokenNameDOT	
timestamp	TokenNameIdentifier	 timestamp
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
PerColumnSecondaryIndex	TokenNameIdentifier	 Per Column Secondary Index
)	TokenNameRPAREN	
index	TokenNameIdentifier	 index
)	TokenNameRPAREN	
.	TokenNameDOT	
delete	TokenNameIdentifier	 delete
(	TokenNameLPAREN	
dk	TokenNameIdentifier	 dk
.	TokenNameDOT	
key	TokenNameIdentifier	 key
,	TokenNameCOMMA	
dummyColumn	TokenNameIdentifier	 dummy Column
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
continue	TokenNamecontinue	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
new	TokenNamenew	
Row	TokenNameIdentifier	 Row
(	TokenNameLPAREN	
dk	TokenNameIdentifier	 dk
,	TokenNameCOMMA	
data	TokenNameIdentifier	 data
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
public	TokenNamepublic	
void	TokenNamevoid	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
