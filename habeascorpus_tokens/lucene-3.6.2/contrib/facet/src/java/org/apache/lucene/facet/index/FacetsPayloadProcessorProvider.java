package	TokenNamepackage	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
index	TokenNameIdentifier	 index
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
ByteArrayInputStream	TokenNameIdentifier	 Byte Array Input Stream
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
ByteArrayOutputStream	TokenNameIdentifier	 Byte Array Output Stream
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
IOException	TokenNameIdentifier	 IO Exception
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
io	TokenNameIdentifier	 io
.	TokenNameDOT	
InputStream	TokenNameIdentifier	 Input Stream
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
HashMap	TokenNameIdentifier	 Hash Map
;	TokenNameSEMICOLON	
import	TokenNameimport	
java	TokenNameIdentifier	 java
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
Map	TokenNameIdentifier	 Map
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
IndexReader	TokenNameIdentifier	 Index Reader
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
PayloadProcessorProvider	TokenNameIdentifier	 Payload Processor Provider
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
Term	TokenNameIdentifier	 Term
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
store	TokenNameIdentifier	 store
.	TokenNameDOT	
Directory	TokenNameIdentifier	 Directory
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
params	TokenNameIdentifier	 params
.	TokenNameDOT	
CategoryListParams	TokenNameIdentifier	 Category List Params
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
index	TokenNameIdentifier	 index
.	TokenNameDOT	
params	TokenNameIdentifier	 params
.	TokenNameDOT	
FacetIndexingParams	TokenNameIdentifier	 Facet Indexing Params
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
facet	TokenNameIdentifier	 facet
.	TokenNameDOT	
taxonomy	TokenNameIdentifier	 taxonomy
.	TokenNameDOT	
directory	TokenNameIdentifier	 directory
.	TokenNameDOT	
DirectoryTaxonomyWriter	TokenNameIdentifier	 Directory Taxonomy Writer
.	TokenNameDOT	
OrdinalMap	TokenNameIdentifier	 Ordinal Map
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
encoding	TokenNameIdentifier	 encoding
.	TokenNameDOT	
IntDecoder	TokenNameIdentifier	 Int Decoder
;	TokenNameSEMICOLON	
import	TokenNameimport	
org	TokenNameIdentifier	 org
.	TokenNameDOT	
apache	TokenNameIdentifier	 apache
.	TokenNameDOT	
lucene	TokenNameIdentifier	 lucene
.	TokenNameDOT	
util	TokenNameIdentifier	 util
.	TokenNameDOT	
encoding	TokenNameIdentifier	 encoding
.	TokenNameDOT	
IntEncoder	TokenNameIdentifier	 Int Encoder
;	TokenNameSEMICOLON	
/** * Licensed to the Apache Software Foundation (ASF) under one or more * contributor license agreements. See the NOTICE file distributed with * this work for additional information regarding copyright ownership. * The ASF licenses this file to You under the Apache License, Version 2.0 * (the "License"); you may not use this file except in compliance with * the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */	TokenNameCOMMENT_JAVADOC	 Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at * http://www.apache.org/licenses/LICENSE-2.0 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. 
/** * A {@link PayloadProcessorProvider} for updating facets ordinal references, * based on an ordinal map. You should use this code in conjunction with merging * taxonomies - after you merge taxonomies, you receive an {@link OrdinalMap} * which maps the 'old' payloads to the 'new' ones. You can use that map to * re-map the payloads which contain the facets information (ordinals) either * before or while merging the indexes. * <p> * For re-mapping the ordinals before you merge the indexes, do the following: * * <pre> * // merge the old taxonomy with the new one. * OrdinalMap map = LuceneTaxonomyWriter.addTaxonomies(); * int[] ordmap = map.getMap(); * * // re-map the ordinals on the old directory. * Directory oldDir; * FacetsPayloadProcessorProvider fppp = new FacetsPayloadProcessorProvider( * oldDir, ordmap); * IndexWriterConfig conf = new IndexWriterConfig(VER, ANALYZER); * conf.setMergePolicy(new ForceOptimizeMergePolicy()); * IndexWriter writer = new IndexWriter(oldDir, conf); * writer.setPayloadProcessorProvider(fppp); * writer.forceMerge(1); * writer.close(); * * // merge that directory with the new index. * IndexWriter newWriter; // opened on the 'new' Directory * newWriter.addIndexes(oldDir); * newWriter.commit(); * </pre> * * For re-mapping the ordinals during index merge, do the following: * * <pre> * // merge the old taxonomy with the new one. * OrdinalMap map = LuceneTaxonomyWriter.addTaxonomies(); * int[] ordmap = map.getMap(); * * // Add the index and re-map ordinals on the go * IndexReader r = IndexReader.open(oldDir); * IndexWriterConfig conf = new IndexWriterConfig(VER, ANALYZER); * IndexWriter writer = new IndexWriter(newDir, conf); * writer.setPayloadProcessorProvider(fppp); * writer.addIndexes(r); * writer.commit(); * </pre> * <p> * <b>NOTE:</b> while the second example looks simpler, IndexWriter may trigger * a long merge due to addIndexes. The first example avoids this perhaps * unneeded merge, as well as can be done separately (e.g. on another node) * before the index is merged. * * @lucene.experimental */	TokenNameCOMMENT_JAVADOC	 A {@link PayloadProcessorProvider} for updating facets ordinal references, based on an ordinal map. You should use this code in conjunction with merging taxonomies - after you merge taxonomies, you receive an {@link OrdinalMap} which maps the 'old' payloads to the 'new' ones. You can use that map to re-map the payloads which contain the facets information (ordinals) either before or while merging the indexes. <p> For re-mapping the ordinals before you merge the indexes, do the following: * <pre> // merge the old taxonomy with the new one. OrdinalMap map = LuceneTaxonomyWriter.addTaxonomies(); int[] ordmap = map.getMap(); * // re-map the ordinals on the old directory. Directory oldDir; FacetsPayloadProcessorProvider fppp = new FacetsPayloadProcessorProvider( oldDir, ordmap); IndexWriterConfig conf = new IndexWriterConfig(VER, ANALYZER); conf.setMergePolicy(new ForceOptimizeMergePolicy()); IndexWriter writer = new IndexWriter(oldDir, conf); writer.setPayloadProcessorProvider(fppp); writer.forceMerge(1); writer.close(); * // merge that directory with the new index. IndexWriter newWriter; // opened on the 'new' Directory newWriter.addIndexes(oldDir); newWriter.commit(); </pre> * For re-mapping the ordinals during index merge, do the following: * <pre> // merge the old taxonomy with the new one. OrdinalMap map = LuceneTaxonomyWriter.addTaxonomies(); int[] ordmap = map.getMap(); * // Add the index and re-map ordinals on the go IndexReader r = IndexReader.open(oldDir); IndexWriterConfig conf = new IndexWriterConfig(VER, ANALYZER); IndexWriter writer = new IndexWriter(newDir, conf); writer.setPayloadProcessorProvider(fppp); writer.addIndexes(r); writer.commit(); </pre> <p> <b>NOTE:</b> while the second example looks simpler, IndexWriter may trigger a long merge due to addIndexes. The first example avoids this perhaps unneeded merge, as well as can be done separately (e.g. on another node) before the index is merged. * @lucene.experimental 
public	TokenNamepublic	
class	TokenNameclass	
FacetsPayloadProcessorProvider	TokenNameIdentifier	 Facets Payload Processor Provider
extends	TokenNameextends	
PayloadProcessorProvider	TokenNameIdentifier	 Payload Processor Provider
{	TokenNameLBRACE	
private	TokenNameprivate	
final	TokenNamefinal	
Directory	TokenNameIdentifier	 Directory
workDir	TokenNameIdentifier	 work Dir
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
ReaderPayloadProcessor	TokenNameIdentifier	 Reader Payload Processor
dirProcessor	TokenNameIdentifier	 dir Processor
;	TokenNameSEMICOLON	
/** * Construct FacetsPayloadProcessorProvider with FacetIndexingParams * * @param dir the {@link Directory} containing the segments to update * @param ordinalMap an array mapping previous facets ordinals to new ones * @param indexingParams the facets indexing parameters */	TokenNameCOMMENT_JAVADOC	 Construct FacetsPayloadProcessorProvider with FacetIndexingParams * @param dir the {@link Directory} containing the segments to update @param ordinalMap an array mapping previous facets ordinals to new ones @param indexingParams the facets indexing parameters 
public	TokenNamepublic	
FacetsPayloadProcessorProvider	TokenNameIdentifier	 Facets Payload Processor Provider
(	TokenNameLPAREN	
Directory	TokenNameIdentifier	 Directory
dir	TokenNameIdentifier	 dir
,	TokenNameCOMMA	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
ordinalMap	TokenNameIdentifier	 ordinal Map
,	TokenNameCOMMA	
FacetIndexingParams	TokenNameIdentifier	 Facet Indexing Params
indexingParams	TokenNameIdentifier	 indexing Params
)	TokenNameRPAREN	
{	TokenNameLBRACE	
workDir	TokenNameIdentifier	 work Dir
=	TokenNameEQUAL	
dir	TokenNameIdentifier	 dir
;	TokenNameSEMICOLON	
dirProcessor	TokenNameIdentifier	 dir Processor
=	TokenNameEQUAL	
new	TokenNamenew	
FacetsDirPayloadProcessor	TokenNameIdentifier	 Facets Dir Payload Processor
(	TokenNameLPAREN	
indexingParams	TokenNameIdentifier	 indexing Params
,	TokenNameCOMMA	
ordinalMap	TokenNameIdentifier	 ordinal Map
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
ReaderPayloadProcessor	TokenNameIdentifier	 Reader Payload Processor
getReaderProcessor	TokenNameIdentifier	 get Reader Processor
(	TokenNameLPAREN	
IndexReader	TokenNameIdentifier	 Index Reader
reader	TokenNameIdentifier	 reader
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
return	TokenNamereturn	
(	TokenNameLPAREN	
workDir	TokenNameIdentifier	 work Dir
==	TokenNameEQUAL_EQUAL	
reader	TokenNameIdentifier	 reader
.	TokenNameDOT	
directory	TokenNameIdentifier	 directory
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
?	TokenNameQUESTION	
dirProcessor	TokenNameIdentifier	 dir Processor
:	TokenNameCOLON	
null	TokenNamenull	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
public	TokenNamepublic	
static	TokenNamestatic	
class	TokenNameclass	
FacetsDirPayloadProcessor	TokenNameIdentifier	 Facets Dir Payload Processor
extends	TokenNameextends	
ReaderPayloadProcessor	TokenNameIdentifier	 Reader Payload Processor
{	TokenNameLBRACE	
private	TokenNameprivate	
final	TokenNamefinal	
Map	TokenNameIdentifier	 Map
<	TokenNameLESS	
Term	TokenNameIdentifier	 Term
,	TokenNameCOMMA	
CategoryListParams	TokenNameIdentifier	 Category List Params
>	TokenNameGREATER	
termMap	TokenNameIdentifier	 term Map
=	TokenNameEQUAL	
new	TokenNamenew	
HashMap	TokenNameIdentifier	 Hash Map
<	TokenNameLESS	
Term	TokenNameIdentifier	 Term
,	TokenNameCOMMA	
CategoryListParams	TokenNameIdentifier	 Category List Params
>	TokenNameGREATER	
(	TokenNameLPAREN	
1	TokenNameIntegerLiteral	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
ordinalMap	TokenNameIdentifier	 ordinal Map
;	TokenNameSEMICOLON	
/** * Construct FacetsDirPayloadProcessor with custom FacetIndexingParams * @param ordinalMap an array mapping previous facets ordinals to new ones * @param indexingParams the facets indexing parameters */	TokenNameCOMMENT_JAVADOC	 Construct FacetsDirPayloadProcessor with custom FacetIndexingParams @param ordinalMap an array mapping previous facets ordinals to new ones @param indexingParams the facets indexing parameters 
protected	TokenNameprotected	
FacetsDirPayloadProcessor	TokenNameIdentifier	 Facets Dir Payload Processor
(	TokenNameLPAREN	
FacetIndexingParams	TokenNameIdentifier	 Facet Indexing Params
indexingParams	TokenNameIdentifier	 indexing Params
,	TokenNameCOMMA	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
ordinalMap	TokenNameIdentifier	 ordinal Map
)	TokenNameRPAREN	
{	TokenNameLBRACE	
this	TokenNamethis	
.	TokenNameDOT	
ordinalMap	TokenNameIdentifier	 ordinal Map
=	TokenNameEQUAL	
ordinalMap	TokenNameIdentifier	 ordinal Map
;	TokenNameSEMICOLON	
for	TokenNamefor	
(	TokenNameLPAREN	
CategoryListParams	TokenNameIdentifier	 Category List Params
params	TokenNameIdentifier	 params
:	TokenNameCOLON	
indexingParams	TokenNameIdentifier	 indexing Params
.	TokenNameDOT	
getAllCategoryListParams	TokenNameIdentifier	 get All Category List Params
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
termMap	TokenNameIdentifier	 term Map
.	TokenNameDOT	
put	TokenNameIdentifier	 put
(	TokenNameLPAREN	
params	TokenNameIdentifier	 params
.	TokenNameDOT	
getTerm	TokenNameIdentifier	 get Term
(	TokenNameLPAREN	
)	TokenNameRPAREN	
,	TokenNameCOMMA	
params	TokenNameIdentifier	 params
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
PayloadProcessor	TokenNameIdentifier	 Payload Processor
getProcessor	TokenNameIdentifier	 get Processor
(	TokenNameLPAREN	
Term	TokenNameIdentifier	 Term
term	TokenNameIdentifier	 term
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
CategoryListParams	TokenNameIdentifier	 Category List Params
params	TokenNameIdentifier	 params
=	TokenNameEQUAL	
termMap	TokenNameIdentifier	 term Map
.	TokenNameDOT	
get	TokenNameIdentifier	 get
(	TokenNameLPAREN	
term	TokenNameIdentifier	 term
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
if	TokenNameif	
(	TokenNameLPAREN	
params	TokenNameIdentifier	 params
==	TokenNameEQUAL_EQUAL	
null	TokenNamenull	
)	TokenNameRPAREN	
{	TokenNameLBRACE	
return	TokenNamereturn	
null	TokenNamenull	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
return	TokenNamereturn	
new	TokenNamenew	
FacetsPayloadProcessor	TokenNameIdentifier	 Facets Payload Processor
(	TokenNameLPAREN	
params	TokenNameIdentifier	 params
,	TokenNameCOMMA	
ordinalMap	TokenNameIdentifier	 ordinal Map
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
/** A PayloadProcessor for updating facets ordinal references, based on an ordinal map */	TokenNameCOMMENT_JAVADOC	 A PayloadProcessor for updating facets ordinal references, based on an ordinal map 
public	TokenNamepublic	
static	TokenNamestatic	
class	TokenNameclass	
FacetsPayloadProcessor	TokenNameIdentifier	 Facets Payload Processor
extends	TokenNameextends	
PayloadProcessor	TokenNameIdentifier	 Payload Processor
{	TokenNameLBRACE	
private	TokenNameprivate	
final	TokenNamefinal	
IntEncoder	TokenNameIdentifier	 Int Encoder
encoder	TokenNameIdentifier	 encoder
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
IntDecoder	TokenNameIdentifier	 Int Decoder
decoder	TokenNameIdentifier	 decoder
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
ordinalMap	TokenNameIdentifier	 ordinal Map
;	TokenNameSEMICOLON	
private	TokenNameprivate	
final	TokenNamefinal	
ByteArrayOutputStream	TokenNameIdentifier	 Byte Array Output Stream
os	TokenNameIdentifier	 os
=	TokenNameEQUAL	
new	TokenNamenew	
ByteArrayOutputStream	TokenNameIdentifier	 Byte Array Output Stream
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
/** * @param params defines the encoding of facet ordinals as payload * @param ordinalMap an array mapping previous facets ordinals to new ones */	TokenNameCOMMENT_JAVADOC	 @param params defines the encoding of facet ordinals as payload @param ordinalMap an array mapping previous facets ordinals to new ones 
protected	TokenNameprotected	
FacetsPayloadProcessor	TokenNameIdentifier	 Facets Payload Processor
(	TokenNameLPAREN	
CategoryListParams	TokenNameIdentifier	 Category List Params
params	TokenNameIdentifier	 params
,	TokenNameCOMMA	
int	TokenNameint	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
ordinalMap	TokenNameIdentifier	 ordinal Map
)	TokenNameRPAREN	
{	TokenNameLBRACE	
encoder	TokenNameIdentifier	 encoder
=	TokenNameEQUAL	
params	TokenNameIdentifier	 params
.	TokenNameDOT	
createEncoder	TokenNameIdentifier	 create Encoder
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
decoder	TokenNameIdentifier	 decoder
=	TokenNameEQUAL	
encoder	TokenNameIdentifier	 encoder
.	TokenNameDOT	
createMatchingDecoder	TokenNameIdentifier	 create Matching Decoder
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
this	TokenNamethis	
.	TokenNameDOT	
ordinalMap	TokenNameIdentifier	 ordinal Map
=	TokenNameEQUAL	
ordinalMap	TokenNameIdentifier	 ordinal Map
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
int	TokenNameint	
payloadLength	TokenNameIdentifier	 payload Length
(	TokenNameLPAREN	
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
return	TokenNamereturn	
os	TokenNameIdentifier	 os
.	TokenNameDOT	
size	TokenNameIdentifier	 size
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
@	TokenNameAT	
Override	TokenNameIdentifier	 Override
public	TokenNamepublic	
byte	TokenNamebyte	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
processPayload	TokenNameIdentifier	 process Payload
(	TokenNameLPAREN	
byte	TokenNamebyte	
[	TokenNameLBRACKET	
]	TokenNameRBRACKET	
payload	TokenNameIdentifier	 payload
,	TokenNameCOMMA	
int	TokenNameint	
start	TokenNameIdentifier	 start
,	TokenNameCOMMA	
int	TokenNameint	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
throws	TokenNamethrows	
IOException	TokenNameIdentifier	 IO Exception
{	TokenNameLBRACE	
InputStream	TokenNameIdentifier	 Input Stream
is	TokenNameIdentifier	 is
=	TokenNameEQUAL	
new	TokenNamenew	
ByteArrayInputStream	TokenNameIdentifier	 Byte Array Input Stream
(	TokenNameLPAREN	
payload	TokenNameIdentifier	 payload
,	TokenNameCOMMA	
start	TokenNameIdentifier	 start
,	TokenNameCOMMA	
length	TokenNameIdentifier	 length
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
decoder	TokenNameIdentifier	 decoder
.	TokenNameDOT	
reInit	TokenNameIdentifier	 re Init
(	TokenNameLPAREN	
is	TokenNameIdentifier	 is
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
os	TokenNameIdentifier	 os
.	TokenNameDOT	
reset	TokenNameIdentifier	 reset
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
encoder	TokenNameIdentifier	 encoder
.	TokenNameDOT	
reInit	TokenNameIdentifier	 re Init
(	TokenNameLPAREN	
os	TokenNameIdentifier	 os
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
long	TokenNamelong	
ordinal	TokenNameIdentifier	 ordinal
;	TokenNameSEMICOLON	
while	TokenNamewhile	
(	TokenNameLPAREN	
(	TokenNameLPAREN	
ordinal	TokenNameIdentifier	 ordinal
=	TokenNameEQUAL	
decoder	TokenNameIdentifier	 decoder
.	TokenNameDOT	
decode	TokenNameIdentifier	 decode
(	TokenNameLPAREN	
)	TokenNameRPAREN	
)	TokenNameRPAREN	
!=	TokenNameNOT_EQUAL	
IntDecoder	TokenNameIdentifier	 Int Decoder
.	TokenNameDOT	
EOS	TokenNameIdentifier	 EOS
)	TokenNameRPAREN	
{	TokenNameLBRACE	
int	TokenNameint	
newOrdinal	TokenNameIdentifier	 new Ordinal
=	TokenNameEQUAL	
ordinalMap	TokenNameIdentifier	 ordinal Map
[	TokenNameLBRACKET	
(	TokenNameLPAREN	
int	TokenNameint	
)	TokenNameRPAREN	
ordinal	TokenNameIdentifier	 ordinal
]	TokenNameRBRACKET	
;	TokenNameSEMICOLON	
encoder	TokenNameIdentifier	 encoder
.	TokenNameDOT	
encode	TokenNameIdentifier	 encode
(	TokenNameLPAREN	
newOrdinal	TokenNameIdentifier	 new Ordinal
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
encoder	TokenNameIdentifier	 encoder
.	TokenNameDOT	
close	TokenNameIdentifier	 close
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
return	TokenNamereturn	
os	TokenNameIdentifier	 os
.	TokenNameDOT	
toByteArray	TokenNameIdentifier	 to Byte Array
(	TokenNameLPAREN	
)	TokenNameRPAREN	
;	TokenNameSEMICOLON	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
}	TokenNameRBRACE	
